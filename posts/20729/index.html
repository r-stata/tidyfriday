<!DOCTYPE html>
<html lang="zh-cn">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>1998～2014 年工企海关匹配结果 | 微信公众号 RStata</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://tidyfriday.cn/posts/20729/index.html">
  <!-- Alternative links -->
  
  <!-- Icon -->
  <link rel="icon" href="/images/pad.svg">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/images/pad.svg">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  
<link rel="stylesheet" href="/css/navy.css">

  <!-- endbuild -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-lato@0.0.75/index.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="微信公众号 RStata" type="application/atom+xml">
  <!-- Open Graph -->
  <meta name="description" content="前不久给大家分享过工企地理位置信息数据和海关地理位置信息数据：  工企地理位置：1998～2014 年工业企业数据库地理位置数据（含经纬度、所处省市区县、南北方属性以及距离秦岭淮河线的距离） 海关地理位置：2000～2016 年海关地理信息数据（含经纬度及其所处的省市区县）  今天我们分享一份工企与海关数据的匹配结果，借鉴相关文献，工企与海关的匹配可以分为下面 5 个步骤：  清洗工企数据库里面的">
<meta property="og:type" content="article">
<meta property="og:title" content="1998～2014 年工企海关匹配结果">
<meta property="og:url" content="https://tidyfriday.cn/posts/20729/">
<meta property="og:site_name" content="微信公众号 RStata">
<meta property="og:description" content="前不久给大家分享过工企地理位置信息数据和海关地理位置信息数据：  工企地理位置：1998～2014 年工业企业数据库地理位置数据（含经纬度、所处省市区县、南北方属性以及距离秦岭淮河线的距离） 海关地理位置：2000～2016 年海关地理信息数据（含经纬度及其所处的省市区县）  今天我们分享一份工企与海关数据的匹配结果，借鉴相关文献，工企与海关的匹配可以分为下面 5 个步骤：  清洗工企数据库里面的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mdniceczx.oss-cn-beijing.aliyuncs.com/image_20210614133739.png">
<meta property="og:image" content="https://mdniceczx.oss-cn-beijing.aliyuncs.com/image_20210614135945.png">
<meta property="og:image" content="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2021-05-29%20%E4%B8%8A%E5%8D%8811.03.19_20210529110323.png">
<meta property="og:image" content="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2021-05-29%20%E4%B8%8A%E5%8D%8811.04.16_20210529110421.png">
<meta property="article:published_time" content="2023-04-21T11:14:00.000Z">
<meta property="article:modified_time" content="2023-04-21T15:41:46.000Z">
<meta property="article:author" content="RStata">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mdniceczx.oss-cn-beijing.aliyuncs.com/image_20210614133739.png">
  <!-- Google Analytics -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a id="logo" href="/">RStata</a>
    </h1>
    <nav id="main-nav">
      <a href="/archives/" class="main-nav-link">归档</a><a href="/r-gallery/" class="main-nav-link">R 语言绘图案例</a><a href="/stata-gallery/" class="main-nav-link">Stata 绘图案例</a><a href="/rsdb2/" class="main-nav-link">RStata课程与数据库</a><a href="/templates/" class="main-nav-link">模板库</a><a href="/books/" class="main-nav-link">电子书</a><a href="/about/" class="main-nav-link">关于</a>
      <div id="search-input-wrap">
        <div id="search-input-icon">
          <i class="fa fa-search"></i>
        </div>
        <input type="search" id="search-input" placeholder="Search...">
      </div>
    </nav>
    <div>
      <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/r-stata" class="main-nav-link"><i class="fa fa-github-alt"></i></a>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div class="wrapper">
    <div class="inner">
      <article class="article post" itemscope itemtype="http://schema.org/Article">
  <header class="article-header">
    
      <h1 class="article-title" itemprop="name">1998～2014 年工企海关匹配结果</h1>
    
    <a href="/posts/20729/" class="article-date"><time datetime="2023-04-21T11:14:00.000Z">2023-04-21</time></a>
  </header>
  <div class="article-content" itemprop="articleBody">
    <p>前不久给大家分享过工企地理位置信息数据和海关地理位置信息数据：</p>
<ol>
<li>工企地理位置：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://mp.weixin.qq.com/s/uI1wuAKNLf4i3cFUCY9Pyg">1998～2014 年工业企业数据库地理位置数据（含经纬度、所处省市区县、南北方属性以及距离秦岭淮河线的距离）</a></li>
<li>海关地理位置：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://mp.weixin.qq.com/s/6puOs1kmo3n55iUE1wO6DA">2000～2016 年海关地理信息数据（含经纬度及其所处的省市区县）</a></li>
</ol>
<p>今天我们分享一份工企与海关数据的匹配结果，借鉴相关文献，工企与海关的匹配可以分为下面 5 个步骤：</p>
<ol>
<li>清洗工企数据库里面的企业名称、邮政编码和固定电话变量（等下要用这三个变量进行匹配）；</li>
<li>清洗海关数据库里面的企业名称、邮编和电话变量；</li>
<li>在工企数据库里面生成一个 ID 变量用以在匹配过程中识别每个观测值，然后只保留企业名称、邮政编码和固定电话、年份、ID 几个变量（这样可以避免因为数据过大导致匹配过程过慢）；</li>
<li>对海关数据库进行汇总（例如只需要每个公司每年的进出口额的话）；</li>
<li>匹配海关和工企数据然后再根据 ID 变量把工企数据库的其它变量也合并进来。</li>
</ol>
<p>关于这五个步骤的代码实现，可以学习我们之前推出的 Stata 课程：「如何匹配海关和工企数据？」：</p>
<blockquote>
<p>如何匹配中国工业企业数据库和海关数据库？以 2013 年为例：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://rstata.duanshu.com/#/brief/course/5463b8d7afcb438ca1e537fa76c1a45d">https://rstata.duanshu.com/#/brief/course/5463b8d7afcb438ca1e537fa76c1a45d</a></p>
</blockquote>
<p>这次分享的数据包含下面两种版本的：</p>
<ol>
<li>先把海关数据汇总成每个公司的进出口额数据，然后和工企数据匹配的结果数据（下面称为汇总版本，其观测值是一个个的公司）；</li>
<li>直接把海关数据和工企数据进行匹配（下面称为完整版本，其观测值是一条条的商品）。</li>
</ol>
<p>两个版本的结果数据使用的匹配方法是一样的，但是由于细微的差异，结果也有细微的差异，下表展示的是匹配效果。<code>工企数据库中的工企数量</code> 列展示的是匹配使用的工企数据库的每年样本数；<code>汇总版本涉及的工企数量</code> 列展示的是汇总版本匹配结果中涉及的工企数量，最后一列是匹配率（汇总版本涉及的工企数量 / 工企数据库中的工企数量）：</p>
<table>
<thead>
<tr>
<th align="center">年份</th>
<th align="center">工企数据库中的工企数量</th>
<th align="center">汇总版本涉及的工企数量</th>
<th align="center">匹配率</th>
</tr>
</thead>
<tbody><tr>
<td align="center">2000</td>
<td align="center">162872</td>
<td align="center">22310</td>
<td align="center">13.7%</td>
</tr>
<tr>
<td align="center">2001</td>
<td align="center">171254</td>
<td align="center">26446</td>
<td align="center">15.4%</td>
</tr>
<tr>
<td align="center">2002</td>
<td align="center">181542</td>
<td align="center">29943</td>
<td align="center">16.5%</td>
</tr>
<tr>
<td align="center">2003</td>
<td align="center">196206</td>
<td align="center">34096</td>
<td align="center">17.4%</td>
</tr>
<tr>
<td align="center">2004</td>
<td align="center">279011</td>
<td align="center">52966</td>
<td align="center">19.0%</td>
</tr>
<tr>
<td align="center">2005</td>
<td align="center">270023</td>
<td align="center">53475</td>
<td align="center">19.8%</td>
</tr>
<tr>
<td align="center">2006</td>
<td align="center">301930</td>
<td align="center">61467</td>
<td align="center">20.4%</td>
</tr>
<tr>
<td align="center">2007</td>
<td align="center">336732</td>
<td align="center">89237</td>
<td align="center">26.5%</td>
</tr>
<tr>
<td align="center">2008</td>
<td align="center">412212</td>
<td align="center">73364</td>
<td align="center">17.8%</td>
</tr>
<tr>
<td align="center">2009</td>
<td align="center">366130</td>
<td align="center">64562</td>
<td align="center">17.6%</td>
</tr>
<tr>
<td align="center">2010</td>
<td align="center">442539</td>
<td align="center">77420</td>
<td align="center">17.5%</td>
</tr>
<tr>
<td align="center">2011</td>
<td align="center">302593</td>
<td align="center">59789</td>
<td align="center">19.8%</td>
</tr>
<tr>
<td align="center">2012</td>
<td align="center">324604</td>
<td align="center">79824</td>
<td align="center">24.6%</td>
</tr>
<tr>
<td align="center">2013</td>
<td align="center">344875</td>
<td align="center">83893</td>
<td align="center">24.3%</td>
</tr>
<tr>
<td align="center">2014</td>
<td align="center">309138</td>
<td align="center">60068</td>
<td align="center">19.4%</td>
</tr>
</tbody></table>
<p>下图会更直观：</p>
<p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/image_20210614133739.png" alt=""></p>
<p>如果大家想自行匹配的话，可以使用文初提到的两个数据，然后参考课程匹配。</p>
<p>为了更好的确认匹配数据的可靠性，我们计算了每年平均各个公司的进口额和出口额，如下图所示：</p>
<p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/image_20210614135945.png" alt=""></p>
<p>感觉连续性还不错！</p>
<p>另外这两份数据都非常大，已经拆分成了逐年的数据，可以直接使用 append 进行合并（Stata），数据格式是也是仅提供供 Stata 读取的 dta 格式。</p>
<p>关于汇总版如何合并成面板数据，可以参考这个课程：</p>
<blockquote>
<p>如何仿照 Brandt 方法把工企数据匹配成面板？：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://rstata.duanshu.com/#/brief/course/a3e155a19934433ab90913f1547b8300">https://rstata.duanshu.com/#/brief/course/a3e155a19934433ab90913f1547b8300</a></p>
</blockquote>
<p>此次分享的数据还有一份：ID 对照表。提供这份数据的原因在于很多小伙伴的电脑内存不大，没法读取完整版本的结果（很多年份的完整版本有 20多 GB），另外也提供了一份分拆的海关数据（很多年份的完整版本有 20 多 GB，这样把每个年份的也都拆分成小文件更方便大家操作）。</p>
<p>尽管如此，还是担心大家的电脑无法读取这份大数据，所以我还提供了一份完整版的小文件分拆版（每个文件不到 2GB）。</p>
<p>下面再展示下部分的数据预览：</p>
<p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2021-05-29%20%E4%B8%8A%E5%8D%8811.03.19_20210529110323.png" alt="2007 年工企与海关匹配完整版"></p>
<p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2021-05-29%20%E4%B8%8A%E5%8D%8811.04.16_20210529110421.png" alt="2006 年工企与海关匹配汇总版"></p>

  </div>
  
<section id="comments">
<div id="valine-thread"></div>
</section>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    new Valine({
        el: '#valine-thread' ,
        notify: true,
        verify: false,
        app_id: 'HS0fE2GH92TyPjSpxeuEpr9P-gzGzoHsz',
        app_key: 'hyvGUifU6e34ODKmahBUtoN6',
        placeholder: '在这里评论～记得留下邮箱哈，这样有回复的时候会有邮件通知。',
        avatar: 'monsterid',
        avatar_cdn: 'https://gravatar.loli.net/avatar/',
        pageSize: '2'
    });
</script>

</article>

    </div>
  </div>
</div>
    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2025 <a href="https://github.com/hexojs/hexo/graphs/contributors" rel="external nofollow noreferrer" target="_blank">RStata</a><br>
      Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>.
    </div>
    <div id="footer-links">
      <a href="https://github.com/r-stata" rel="external nofollow noreferrer" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>

      <a href="/wechat" class="footer-link" target="_blank"><i class="fa fa-weixin"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/archives/" class="mobile-nav-link">归档</a><a href="/r-gallery/" class="mobile-nav-link">R 语言绘图案例</a><a href="/stata-gallery/" class="mobile-nav-link">Stata 绘图案例</a><a href="/rsdb2/" class="mobile-nav-link">RStata课程与数据库</a><a href="/templates/" class="mobile-nav-link">模板库</a><a href="/books/" class="mobile-nav-link">电子书</a><a href="/about/" class="mobile-nav-link">关于</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/r-stata" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></span>
    <select id="mobile-lang-select" data-canonical="">
      
        <option value="en">English</option>
      
        <option value="zh-tw">正體中文</option>
      
        <option value="zh-cn" selected>简体中文</option>
      
        <option value="ru">Русский</option>
      
        <option value="ko">한국어</option>
      
        <option value="pt-br">Português (Brasil)</option>
      
        <option value="th">ภาษาไทย</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- Cookie -->
<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
<!-- build:js build/js/main.js -->

<script src="/js/lang_select.js"></script>


<script src="/js/mobile_nav.js"></script>

<!-- endbuild -->

<!-- Algolia -->


</body>
</html>
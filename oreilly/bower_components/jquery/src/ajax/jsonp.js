define(["../core","./var/nonce","./var/rquery","../ajax"],function(c,a,l){var p=[],i=/(=)\?(?=&|$)|\?\?/;c.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=p.pop()||c.expando+"_"+a++;return this[n]=!0,n}}),c.ajaxPrefilter("json jsonp",function(n,a,o){var t,r,s,e=!1!==n.jsonp&&(i.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&i.test(n.data)&&"data");if(e||"jsonp"===n.dataTypes[0])return t=n.jsonpCallback=c.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,e?n[e]=n[e].replace(i,"$1"+t):!1!==n.jsonp&&(n.url+=(l.test(n.url)?"&":"?")+n.jsonp+"="+t),n.converters["script json"]=function(){return s||c.error(t+" was not called"),s[0]},n.dataTypes[0]="json",r=window[t],window[t]=function(){s=arguments},o.always(function(){window[t]=r,n[t]&&(n.jsonpCallback=a.jsonpCallback,p.push(t)),s&&c.isFunction(r)&&r(s[0]),s=r=void 0}),"script"})});
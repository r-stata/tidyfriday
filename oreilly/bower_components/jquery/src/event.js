define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./data/var/data_priv","./core/init","./data/accepts","./selector"],function(m,g,y,h,p,e,b){var s=/^key/,l=/^(?:mouse|pointer|contextmenu)|click/,v=/^(?:focusinfocus|focusoutblur)$/,T=/^([^.]*)(?:\.(.+)|)$/;function n(){return!0}function c(){return!1}function t(){try{return document.activeElement}catch(e){}}return m.event={global:{},add:function(t,e,n,i,o){var r,a,s,l,p,c,u,d,f,h=b.get(t);if(h)for(n.handler&&(n=(r=n).handler,o=r.selector),n.guid||(n.guid=m.guid++),(s=h.events)||(s=h.events={}),(a=h.handle)||(a=h.handle=function(e){return typeof m!==g&&m.event.triggered!==e.type?m.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(y)||[""]).length;l--;)u=f=(d=T.exec(e[l])||[])[1],d=(d[2]||"").split(".").sort(),u&&(p=m.event.special[u]||{},u=(o?p.delegateType:p.bindType)||u,p=m.event.special[u]||{},f=m.extend({type:u,origType:f,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&m.expr.match.needsContext.test(o),namespace:d.join(".")},r),(c=s[u])||((c=s[u]=[]).delegateCount=0,p.setup&&!1!==p.setup.call(t,i,d,a)||t.addEventListener&&t.addEventListener(u,a,!1)),p.add&&(p.add.call(t,f),f.handler.guid||(f.handler.guid=n.guid)),o?c.splice(c.delegateCount++,0,f):c.push(f),m.event.global[u]=!0)},remove:function(e,t,n,i,o){var r,a,s,l,p,c,u,d,f,h,g,v=b.hasData(e)&&b.get(e);if(v&&(l=v.events)){for(p=(t=(t||"").match(y)||[""]).length;p--;)if(f=g=(s=T.exec(t[p])||[])[1],h=(s[2]||"").split(".").sort(),f){for(u=m.event.special[f]||{},d=l[f=(i?u.delegateType:u.bindType)||f]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=r=d.length;r--;)c=d[r],!o&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(d.splice(r,1),c.selector&&d.delegateCount--,u.remove&&u.remove.call(e,c));a&&!d.length&&(u.teardown&&!1!==u.teardown.call(e,h,v.handle)||m.removeEvent(e,f,v.handle),delete l[f])}else for(f in l)m.event.remove(e,f+t[p],n,i,!0);m.isEmptyObject(l)&&(delete v.handle,b.remove(e,"events"))}},trigger:function(e,t,n,i){var o,r,a,s,l,p,c=[n||document],u=h.call(e,"type")?e.type:e,d=h.call(e,"namespace")?e.namespace.split("."):[],f=r=n=n||document;if(3!==n.nodeType&&8!==n.nodeType&&!v.test(u+m.event.triggered)&&(0<=u.indexOf(".")&&(u=(d=u.split(".")).shift(),d.sort()),s=u.indexOf(":")<0&&"on"+u,(e=e[m.expando]?e:new m.Event(u,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=d.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:m.makeArray(t,[e]),p=m.event.special[u]||{},i||!p.trigger||!1!==p.trigger.apply(n,t))){if(!i&&!p.noBubble&&!m.isWindow(n)){for(a=p.delegateType||u,v.test(a+u)||(f=f.parentNode);f;f=f.parentNode)c.push(f),r=f;r===(n.ownerDocument||document)&&c.push(r.defaultView||r.parentWindow||window)}for(o=0;(f=c[o++])&&!e.isPropagationStopped();)e.type=1<o?a:p.bindType||u,(l=(b.get(f,"events")||{})[e.type]&&b.get(f,"handle"))&&l.apply(f,t),(l=s&&f[s])&&l.apply&&m.acceptData(f)&&(e.result=l.apply(f,t),!1===e.result&&e.preventDefault());return e.type=u,i||e.isDefaultPrevented()||p._default&&!1!==p._default.apply(c.pop(),t)||!m.acceptData(n)||s&&m.isFunction(n[u])&&!m.isWindow(n)&&((r=n[s])&&(n[s]=null),n[m.event.triggered=u](),m.event.triggered=void 0,r&&(n[s]=r)),e.result}},dispatch:function(e){e=m.event.fix(e);var t,n,i,o,r,a=p.call(arguments),s=(b.get(this,"events")||{})[e.type]||[],l=m.event.special[e.type]||{};if((a[0]=e).delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,e)){for(r=m.event.handlers.call(this,e,s),t=0;(i=r[t++])&&!e.isPropagationStopped();)for(e.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(o.namespace)||(e.handleObj=o,e.data=o.data,void 0!==(o=((m.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a))&&!1===(e.result=o)&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,o,r,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==e.type){for(i=[],n=0;n<s;n++)void 0===i[o=(r=t[n]).selector+" "]&&(i[o]=r.needsContext?0<=m(o,this).index(l):m.find(o,this,null,[l]).length),i[o]&&i.push(r);i.length&&a.push({elem:l,handlers:i})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,o=t.button;return null==e.pageX&&null!=t.clientX&&(n=(i=e.target.ownerDocument||document).documentElement,i=i.body,e.pageX=t.clientX+(n&&n.scrollLeft||i&&i.scrollLeft||0)-(n&&n.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||i&&i.scrollTop||0)-(n&&n.clientTop||i&&i.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[m.expando])return e;var t,n,i,o=e.type,r=e,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=l.test(o)?this.mouseHooks:s.test(o)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new m.Event(r),t=i.length;t--;)e[n=i[t]]=r[n];return e.target||(e.target=document),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,r):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==t()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===t()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&m.nodeName(this,"input"))return this.click(),!1},_default:function(e){return m.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){e=m.extend(new m.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?m.event.trigger(e,null,t):m.event.dispatch.call(t,e),e.isDefaultPrevented()&&n.preventDefault()}},m.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},m.Event=function(e,t){if(!(this instanceof m.Event))return new m.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?n:c):this.type=e,t&&m.extend(this,t),this.timeStamp=e&&e.timeStamp||m.now(),this[m.expando]=!0},m.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=n,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=n,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=n,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,o){m.event.special[e]={delegateType:o,bindType:o,handle:function(e){var t,n=e.relatedTarget,i=e.handleObj;return n&&(n===this||m.contains(this,n))||(e.type=i.origType,t=i.handler.apply(this,arguments),e.type=o),t}}}),e.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(n,i){function o(e){m.event.simulate(i,e.target,m.event.fix(e),!0)}m.event.special[i]={setup:function(){var e=this.ownerDocument||this,t=b.access(e,i);t||e.addEventListener(n,o,!0),b.access(e,i,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=b.access(e,i)-1;t?b.access(e,i,t):(e.removeEventListener(n,o,!0),b.remove(e,i))}}}),m.fn.extend({on:function(e,t,n,i,o){var r,a;if("object"==typeof e){for(a in"string"!=typeof t&&(n=n||t,t=void 0),e)this.on(a,t,n,e[a],o);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),!1===i)i=c;else if(!i)return this;return 1===o&&(r=i,(i=function(e){return m().off(e),r.apply(this,arguments)}).guid=r.guid||(r.guid=m.guid++)),this.each(function(){m.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,o;if(e&&e.preventDefault&&e.handleObj)i=e.handleObj,m(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler);else{if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=c),this.each(function(){m.event.remove(this,e,n,t)});for(o in e)this.off(o,t,e[o])}return this},trigger:function(e,t){return this.each(function(){m.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return m.event.trigger(e,t,n,!0)}}),m});
define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./core/init","./data/accepts","./selector"],function(m,g,y,f,u,e){var t=/^(?:input|select|textarea)$/i,s=/^key/,l=/^(?:mouse|pointer|contextmenu)|click/,v=/^(?:focusinfocus|focusoutblur)$/,b=/^([^.]*)(?:\.(.+)|)$/;function n(){return!0}function c(){return!1}function i(){try{return document.activeElement}catch(e){}}return m.event={global:{},add:function(e,t,n,i,a){var r,o,s,l,u,c,p,d,h,f=m._data(e);if(f)for(n.handler&&(n=(s=n).handler,a=s.selector),n.guid||(n.guid=m.guid++),(r=f.events)||(r=f.events={}),(u=f.handle)||((u=f.handle=function(e){return typeof m===g||e&&m.event.triggered===e.type?void 0:m.event.dispatch.apply(u.elem,arguments)}).elem=e),o=(t=(t||"").match(y)||[""]).length;o--;)p=h=(d=b.exec(t[o])||[])[1],d=(d[2]||"").split(".").sort(),p&&(l=m.event.special[p]||{},p=(a?l.delegateType:l.bindType)||p,l=m.event.special[p]||{},h=m.extend({type:p,origType:h,data:i,handler:n,guid:n.guid,selector:a,needsContext:a&&m.expr.match.needsContext.test(a),namespace:d.join(".")},s),(c=r[p])||((c=r[p]=[]).delegateCount=0,l.setup&&!1!==l.setup.call(e,i,d,u)||(e.addEventListener?e.addEventListener(p,u,!1):e.attachEvent&&e.attachEvent("on"+p,u))),l.add&&(l.add.call(e,h),h.handler.guid||(h.handler.guid=n.guid)),a?c.splice(c.delegateCount++,0,h):c.push(h),m.event.global[p]=!0)},remove:function(e,t,n,i,a){var r,o,s,l,u,c,p,d,h,f,g,v=m.hasData(e)&&m._data(e);if(v&&(c=v.events)){for(u=(t=(t||"").match(y)||[""]).length;u--;)if(h=g=(s=b.exec(t[u])||[])[1],f=(s[2]||"").split(".").sort(),h){for(p=m.event.special[h]||{},d=c[h=(i?p.delegateType:p.bindType)||h]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=d.length;r--;)o=d[r],!a&&g!==o.origType||n&&n.guid!==o.guid||s&&!s.test(o.namespace)||i&&i!==o.selector&&("**"!==i||!o.selector)||(d.splice(r,1),o.selector&&d.delegateCount--,p.remove&&p.remove.call(e,o));l&&!d.length&&(p.teardown&&!1!==p.teardown.call(e,f,v.handle)||m.removeEvent(e,h,v.handle),delete c[h])}else for(h in c)m.event.remove(e,h+t[u],n,i,!0);m.isEmptyObject(c)&&(delete v.handle,m._removeData(e,"events"))}},trigger:function(e,t,n,i){var a,r,o,s,l,u,c=[n||document],p=f.call(e,"type")?e.type:e,d=f.call(e,"namespace")?e.namespace.split("."):[],h=l=n=n||document;if(3!==n.nodeType&&8!==n.nodeType&&!v.test(p+m.event.triggered)&&(0<=p.indexOf(".")&&(p=(d=p.split(".")).shift(),d.sort()),r=p.indexOf(":")<0&&"on"+p,(e=e[m.expando]?e:new m.Event(p,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=d.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:m.makeArray(t,[e]),s=m.event.special[p]||{},i||!s.trigger||!1!==s.trigger.apply(n,t))){if(!i&&!s.noBubble&&!m.isWindow(n)){for(o=s.delegateType||p,v.test(o+p)||(h=h.parentNode);h;h=h.parentNode)c.push(h),l=h;l===(n.ownerDocument||document)&&c.push(l.defaultView||l.parentWindow||window)}for(u=0;(h=c[u++])&&!e.isPropagationStopped();)e.type=1<u?o:s.bindType||p,(a=(m._data(h,"events")||{})[e.type]&&m._data(h,"handle"))&&a.apply(h,t),(a=r&&h[r])&&a.apply&&m.acceptData(h)&&(e.result=a.apply(h,t),!1===e.result&&e.preventDefault());if(e.type=p,!i&&!e.isDefaultPrevented()&&(!s._default||!1===s._default.apply(c.pop(),t))&&m.acceptData(n)&&r&&n[p]&&!m.isWindow(n)){(l=n[r])&&(n[r]=null),m.event.triggered=p;try{n[p]()}catch(e){}m.event.triggered=void 0,l&&(n[r]=l)}return e.result}},dispatch:function(e){e=m.event.fix(e);var t,n,i,a,r,o=u.call(arguments),s=(m._data(this,"events")||{})[e.type]||[],l=m.event.special[e.type]||{};if((o[0]=e).delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,e)){for(r=m.event.handlers.call(this,e,s),t=0;(i=r[t++])&&!e.isPropagationStopped();)for(e.currentTarget=i.elem,a=0;(n=i.handlers[a++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(n.namespace)||(e.handleObj=n,e.data=n.data,void 0!==(n=((m.event.special[n.origType]||{}).handle||n.handler).apply(i.elem,o))&&!1===(e.result=n)&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,a,r,o=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(a=[],r=0;r<s;r++)void 0===a[n=(i=t[r]).selector+" "]&&(a[n]=i.needsContext?0<=m(n,this).index(l):m.find(n,this,null,[l]).length),a[n]&&a.push(i);a.length&&o.push({elem:l,handlers:a})}return s<t.length&&o.push({elem:this,handlers:t.slice(s)}),o},fix:function(e){if(e[m.expando])return e;var t,n,i,a=e.type,r=e,o=this.fixHooks[a];for(o||(this.fixHooks[a]=o=l.test(a)?this.mouseHooks:s.test(a)?this.keyHooks:{}),i=o.props?this.props.concat(o.props):this.props,e=new m.Event(r),t=i.length;t--;)e[n=i[t]]=r[n];return e.target||(e.target=r.srcElement||document),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,a=t.button,r=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=(n=e.target.ownerDocument||document).documentElement,n=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&r&&(e.relatedTarget=r===e.target?t.toElement:r),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==i()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===i()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(m.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return m.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){e=m.extend(new m.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?m.event.trigger(e,null,t):m.event.dispatch.call(t,e),e.isDefaultPrevented()&&n.preventDefault()}},m.removeEvent=document.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){t="on"+t;e.detachEvent&&(typeof e[t]===g&&(e[t]=null),e.detachEvent(t,n))},m.Event=function(e,t){if(!(this instanceof m.Event))return new m.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?n:c):this.type=e,t&&m.extend(this,t),this.timeStamp=e&&e.timeStamp||m.now(),this[m.expando]=!0},m.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=n,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=n,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=n,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,a){m.event.special[e]={delegateType:a,bindType:a,handle:function(e){var t,n=e.relatedTarget,i=e.handleObj;return n&&(n===this||m.contains(this,n))||(e.type=i.origType,t=i.handler.apply(this,arguments),e.type=a),t}}}),e.submitBubbles||(m.event.special.submit={setup:function(){if(m.nodeName(this,"form"))return!1;m.event.add(this,"click._submit keypress._submit",function(e){e=e.target,e=m.nodeName(e,"input")||m.nodeName(e,"button")?e.form:void 0;e&&!m._data(e,"submitBubbles")&&(m.event.add(e,"submit._submit",function(e){e._submit_bubble=!0}),m._data(e,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&m.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(m.nodeName(this,"form"))return!1;m.event.remove(this,"._submit")}}),e.changeBubbles||(m.event.special.change={setup:function(){if(t.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(m.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),m.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),m.event.simulate("change",this,e,!0)})),!1;m.event.add(this,"beforeactivate._change",function(e){e=e.target;t.test(e.nodeName)&&!m._data(e,"changeBubbles")&&(m.event.add(e,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||m.event.simulate("change",this.parentNode,e,!0)}),m._data(e,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return m.event.remove(this,"._change"),!t.test(this.nodeName)}}),e.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(n,i){function a(e){m.event.simulate(i,e.target,m.event.fix(e),!0)}m.event.special[i]={setup:function(){var e=this.ownerDocument||this,t=m._data(e,i);t||e.addEventListener(n,a,!0),m._data(e,i,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=m._data(e,i)-1;t?m._data(e,i,t):(e.removeEventListener(n,a,!0),m._removeData(e,i))}}}),m.fn.extend({on:function(e,t,n,i,a){var r,o;if("object"==typeof e){for(r in"string"!=typeof t&&(n=n||t,t=void 0),e)this.on(r,t,n,e[r],a);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),!1===i)i=c;else if(!i)return this;return 1===a&&(o=i,(i=function(e){return m().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=m.guid++)),this.each(function(){m.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,a;if(e&&e.preventDefault&&e.handleObj)i=e.handleObj,m(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler);else{if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=c),this.each(function(){m.event.remove(this,e,n,t)});for(a in e)this.off(a,t,e[a])}return this},trigger:function(e,t){return this.each(function(){m.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return m.event.trigger(e,t,n,!0)}}),m});
define(["../core","../core/init","../deferred"],function(d){var t;function o(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",a,!1),window.removeEventListener("load",a,!1)):(document.detachEvent("onreadystatechange",a),window.detachEvent("onload",a))}function a(){!document.addEventListener&&"load"!==event.type&&"complete"!==document.readyState||(o(),d.ready())}d.fn.ready=function(e){return d.ready.promise().done(e),this},d.extend({isReady:!1,readyWait:1,holdReady:function(e){e?d.readyWait++:d.ready(!0)},ready:function(e){if(!0===e?!--d.readyWait:!d.isReady){if(!document.body)return setTimeout(d.ready);(d.isReady=!0)!==e&&0<--d.readyWait||(t.resolveWith(document,[d]),d.fn.triggerHandler&&(d(document).triggerHandler("ready"),d(document).off("ready")))}}}),d.ready.promise=function(e){if(!t)if(t=d.Deferred(),"complete"===document.readyState)setTimeout(d.ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1);else{document.attachEvent("onreadystatechange",a),window.attachEvent("onload",a);var n=!1;try{n=null==window.frameElement&&document.documentElement}catch(e){}n&&n.doScroll&&!function t(){if(!d.isReady){try{n.doScroll("left")}catch(e){return setTimeout(t,50)}o(),d.ready()}}()}return t.promise(e)}});
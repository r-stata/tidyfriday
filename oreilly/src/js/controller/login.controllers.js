!function(){"use strict";function n(o,s,e,t){var i=this;i.css={loginFormErrorMessage:0,signupType:"mobile",signupFirstTime:!0,signupSMSCountDown:60,signupSMSSendButton:!0},i.data={newUser:{username:"",password:""},signupUser:{email:"",mobile:"",smscode:"",username:"",password:""}},i.event={login:function(n){n.$invalid?(n.username.$setDirty(),n.password.$setDirty()):t.login(i.data.newUser).then(function(n){console.log(n),o.location.href="/"}).catch(function(n){n&&n.data&&n.data.code&&(i.css.loginFormErrorMessage=n.data.code),e.errorXHR(n)})},logout:function(){t.logout().then(function(n){console.log(n),o.location.href="/"}).catch(function(n){e.errorXHR(n)})},changeSignupType:function(n){i.css.signupType=n},getSignupSMS:function(n){var o;n.mobile.$invalid?n.mobile.$setDirty():(i.css.signupFirstTime=!1,i.css.signupSMSSendButton=!1,o=s(function(){i.css.signupSMSCountDown=i.css.signupSMSCountDown-1,i.css.signupSMSCountDown<=0&&(s.cancel(o),i.css.signupSMSCountDown=60,i.css.signupSMSSendButton=!0)},1e3),t.getSMS(i.data.signupUser.mobile,"signup").then(function(n){console.log(n.data)}).catch(function(n){e.errorXHR(n)}))},signupSMS:function(n){n.$invalid?(n.smscode.$setDirty(),n.username.$setDirty(),n.password.$setDirty()):t.signup(i.data.signupUser).then(function(n){console.log(n)}).catch(function(n){n&&n.data&&n.data.code&&(i.css.loginFormErrorMessage=n.data.code),e.errorXHR(n)})}}}angular.module("websiteApp").controller("loginController",n),n.$inject=["$window","$interval","Logger","User"]}();
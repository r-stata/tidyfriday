require=function r(i,o,a){function s(n,t){if(!o[n]){if(!i[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(l)return l(n,!0);t=new Error("Cannot find module '"+n+"'");throw t.code="MODULE_NOT_FOUND",t}e=o[n]={exports:{}};i[n][0].call(e.exports,function(t){var e=i[n][1][t];return s(e||t)},e,e.exports,r,i,o,a)}return o[n].exports}for(var l="function"==typeof require&&require,t=0;t<a.length;t++)s(a[t]);return s}({1:[function(t,e,n){e.exports=[{name:"Circle stroked",tags:["circle","disc","shape","shapes","geometric","stroke","round"],icon:"circle-stroked"},{name:"Circle solid",tags:["circle","shape","shapes","geometric","round"],icon:"circle"},{name:"Square stroked",tags:["box","square","shapes","shape","geometric","stroke"],icon:"square-stroked"},{name:"Square solid",tags:["box","square","shape","shapes","geometric"],icon:"square"},{name:"Triangle stroked",tags:["triangle","shape","shapes","geometric","stroke"],icon:"triangle-stroked"},{name:"Triangle solid",tags:["triangle","shape","shapes","geometric"],icon:"triangle"},{name:"Star stroked",tags:["star","shape","shapes","geometric","stroke"],icon:"star-stroked"},{name:"Star solid",tags:["star","shape","shapes","geometric"],icon:"star"},{name:"Cross",tags:["cross","x","ex","shape","shapes","geometric"],icon:"cross"},{name:"Marker Stroke",tags:["marker","point","shape","shapes","stroke"],icon:"marker-stroked"},{name:"Marker Solid",tags:["marker","point","shape","shapes"],icon:"marker"},{name:"Religious Jewish",tags:["jewish","judaism","hebrew","star","david","religious","religion","temple","synagogue"],icon:"religious-jewish"},{name:"Religious Christian",tags:["christian","cross","religious","religion","church","cathedral"],icon:"religious-christian"},{name:"Religious Muslim",tags:["muslim","crescent","star","religious","religion","mosque"],icon:"religious-muslim"},{name:"Cemetery",tags:["cemetery","graveyard","funeral","religious","religion","memorial"],icon:"cemetery"},{name:"Rocket",tags:["rocket","space","launch","transportation"],icon:"rocket"},{name:"Airport",tags:["airplane","plane","airport","transportation"],icon:"airport"},{name:"Heliport",tags:["heliport","helicopter","transportation"],icon:"heliport"},{name:"Rail",tags:["rail","train","transportation"],icon:"rail"},{name:"Rail Metro",tags:["rail","train","metro","subway","rapid-transit","transportation"],icon:"rail-metro"},{name:"Rail Light",tags:["rail","train","light-rail","transportation"],icon:"rail-light"},{name:"Bus",tags:["vehicle","bus","transportation"],icon:"bus"},{name:"Fuel",tags:["petrol","fuel","gas","transportation","station"],icon:"fuel"},{name:"Parking",tags:["parking","transportation"],icon:"parking"},{name:"Parking Garage",tags:["parking","transportation","garage"],icon:"parking-garage"},{name:"Airfield",tags:["airfield","airport","plane","landing strip"],icon:"airfield"},{name:"Roadblock",tags:["roadblock","stop","warning","dead end"],icon:"roadblock"},{name:"Ferry",tags:["ship","boat","water","ferry","transportation"],icon:"ferry"},{name:"Harbor",tags:["marine","dock","water","wharf"],icon:"harbor"},{name:"Bicycle",tags:["cycling","cycle","transportation"],icon:"bicycle"},{name:"Park",tags:["recreation","park","forest","tree","green","woods","nature"],icon:"park"},{name:"Park 2",tags:["recreation","park","forest","tree","green","woods","nature"],icon:"park2"},{name:"Museum",tags:["recreation","museum","tourism"],icon:"museum"},{name:"Lodging",tags:["lodging","hotel","recreation","motel","tourism"],icon:"lodging"},{name:"Monument",tags:["recreation","statue","monument","tourism"],icon:"monument"},{name:"Zoo",tags:["recreation","zoo","animal","giraffe"],icon:"zoo"},{name:"Garden",tags:["recreation","garden","park","flower","nature"],icon:"garden"},{name:"Campsite",tags:["recreation","campsite","camp","camping","tent","nature"],icon:"campsite"},{name:"Theatre",tags:["recreation","theatre","theater","entertainment","play","performance"],icon:"theatre"},{name:"Art gallery",tags:["art","center","museum","gallery","creative","recreation","entertainment","studio"],icon:"art-gallery"},{name:"Pitch",tags:["pitch","track","athletic","sports","field"],icon:"pitch"},{name:"Soccer",tags:["soccer","sports"],icon:"soccer"},{name:"American Football",tags:["football","sports"],icon:"america-football"},{name:"Tennis",tags:["tennis","court","ball","sports"],icon:"tennis"},{name:"Basketball",tags:["basketball","ball","sports"],icon:"basketball"},{name:"Baseball",tags:["baseball","softball","ball","sports"],icon:"baseball"},{name:"Golf",tags:["golf","sports","course"],icon:"golf"},{name:"Swimming",tags:["swimming","water","swim","sports"],icon:"swimming"},{name:"Cricket",tags:["cricket","sports"],icon:"cricket"},{name:"Skiing",tags:["winter","skiing","ski","sports"],icon:"skiing"},{name:"School",tags:["school","highschool","elementary","children","amenity","middle"],icon:"school"},{name:"College",tags:["college","school","amenity","university"],icon:"college"},{name:"Library",tags:["library","books","amenity"],icon:"library"},{name:"Post",tags:["post","office","amenity","mail","letter"],icon:"post"},{name:"Fire station",tags:["fire","station","amenity"],icon:"fire-station"},{name:"Town hall",tags:["townhall","mayor","building","amenity","government"],icon:"town-hall"},{name:"Police",tags:["police","jail","arrest","amenity","station"],icon:"police"},{name:"Prison",tags:["prison","jail","amenity"],icon:"prison"},{name:"Embassy",tags:["embassy","diplomacy","consulate","amenity","flag"],icon:"embassy"},{name:"Beer",tags:["bar","beer","drink","commercial","biergarten","pub"],icon:"beer"},{name:"Restaurant",tags:["restaurant","commercial"],icon:"restaurant"},{name:"Cafe",tags:["cafe","coffee","commercial","tea"],icon:"cafe"},{name:"Shop",tags:["shop","mall","commercial","store"],icon:"shop"},{name:"Fast Food",tags:["food","fast","commercial","burger","drive-through"],icon:"fast-food"},{name:"Bar",tags:["bar","drink","commercial","club","martini","lounge"],icon:"bar"},{name:"Bank",tags:["bank","atm","commercial","money"],icon:"bank"},{name:"Grocery",tags:["food","grocery","commercial","store","market"],icon:"grocery"},{name:"Cinema",tags:["cinema","theatre","film","movie","commercial","theater","entertainment"],icon:"cinema"},{name:"Pharmacy",tags:["pharmacy","drugs","medication","social","medicine","prescription"],icon:"pharmacy"},{name:"Hospital",tags:["hospital","health","medication","social","medicine","medical","clinic"],icon:"hospital"},{name:"Danger",tags:["minefield","landmine","disaster","dangerous","hazard"],icon:"danger"},{name:"Industrial",tags:["industrial","factory","property","building"],icon:"industrial"},{name:"Warehouse",tags:["warehouse","property","storage","building"],icon:"warehouse"},{name:"Commercial",tags:["commercial","property","business","building"],icon:"commercial"},{name:"Building",tags:["building","property","structure","business","building"],icon:"building"},{name:"Place of worship",tags:["religion","ceremony","religious","nondenominational","church","temple"],icon:"place-of-worship"},{name:"Alcohol shop",tags:["alcohol","liquor","store","shop","beer","wine","vodka"],icon:"alcohol-shop"},{name:"Logging",tags:["logger","chainsaw","woods","industry"],icon:"logging"},{name:"Oil well",tags:["oil","natural","environment","industry","resources"],icon:"oil-well"},{name:"Slaughterhouse",tags:["cows","cattle","food","meat","industry","resources"],icon:"slaughterhouse"},{name:"Dam",tags:["water","natural","hydro","hydroelectric","energy","environment","industry","resources"],icon:"dam"},{name:"Water",tags:["water","natural","hydro","lake","river","ocean","resources"],icon:"water"},{name:"Wetland",tags:["water","swamp","natural"],icon:"wetland"},{name:"Disability",tags:["handicap","wheelchair","access"],icon:"disability"},{name:"Telephone",tags:["payphone","call"],icon:"telephone"},{name:"Emergency Telephone",tags:["payphone","danger","safety","call"],icon:"emergency-telephone"},{name:"Toilets",tags:["bathroom","men","women","sink","washroom","lavatory"],icon:"toilets"},{name:"Waste Basket",tags:["trash","rubbish","bin","garbage"],icon:"waste-basket"},{name:"Music",tags:["stage","performance","band","concert","venue"],icon:"music"},{name:"Land Use",tags:["zoning","usage","area"],icon:"land-use"},{name:"City",tags:["area","point","place","urban"],icon:"city"},{name:"Town",tags:["area","point","place","small"],icon:"town"},{name:"Village",tags:["area","point","place","small","rural"],icon:"village"},{name:"Farm",tags:["building","farming","crops","plants","agriculture","rural"],icon:"farm"},{name:"Bakery",tags:["bakery","pastry","croissant","food","shop","bread"],icon:"bakery"},{name:"Dog Park",tags:["dog","pet"],icon:"dog-park"},{name:"Lighthouse",tags:["building","navigation","nautical","ocean","logistics"],icon:"lighthouse"},{name:"Clothing Store",tags:["clothing","store","shop"],icon:"clothing-store"},{name:"Polling Place",tags:["poll","polling","vote"],icon:"polling-place"},{name:"Playground",tags:["playground","play","park","children"],icon:"playground"},{name:"Entrance",tags:["entrance","enter","subway","rail"],icon:"entrance"},{name:"Heart",tags:["heart","love","shape","shapes","wedding"],icon:"heart"},{name:"London Underground",tags:["deprecated"],icon:"london-underground"},{name:"Minefield",tags:["deprecated"],icon:"minefield"},{name:"Rail Underground",tags:["deprecated"],icon:"rail-underground"},{name:"Rail Above",tags:["deprecated"],icon:"rail-above"},{name:"Camera",tags:["camera","photo","commercial","shop"],icon:"camera"},{name:"Laundry",tags:["laundry","washing machine","dry_cleaning","commercial","store"],icon:"laundry"},{name:"Car",tags:["car","auto","vehicle","transportation"],icon:"car"},{name:"Suitcase",tags:["suitcase","travel","travel agency","commercial","store"],icon:"suitcase"},{name:"Hairdresser",tags:["scissors","barber shop","barber","stylist","hair","cut","salon"],icon:"hairdresser"},{name:"Chemist",tags:["shop","science","chemistry","experiment","research","pharmacy"],icon:"chemist"},{name:"Mobile phone",tags:["phone","cellphone","communication","mobile"],icon:"mobilephone"},{name:"Scooter",tags:["bike","transportation","vehicle","route","moped","motorcycle"],icon:"scooter"},{name:"Gift",tags:["gift","shop","commercial","store"],icon:"gift"},{name:"Ice cream",tags:["ice","sweets","food","shop"],icon:"ice-cream"},{name:"Dentist",tags:["dentist","tooth","health","medication","social","medicine","medical"],icon:"dentist"}]},{}],2:[function(t,n,e){var i,o=t("browser-request"),a="https://api.github.com";function u(t,e){t=document.createElement(t);return e&&(t.className=e),t}function c(t,r){o({uri:a+t,headers:{Authorization:"token "+i},json:!0,crossOrigin:!0},function(t,e,n){r(null,n)})}n.exports=function(t,e){return i=t,a=e||a,n.exports},n.exports.open=function(){var i=u("div","gist-map-browser"),o=0;function a(){c("/gists?page="+o,function(t,e){if(t)throw t;e.filter(s).forEach(l);for(var n=i.getElementsByClassName("gist-map-next"),r=0;r<n.length;r++)n[r].parentNode.removeChild(n[r]);t=i.appendChild(u("div","gist-map-next"));t.innerHTML="load more",t.onclick=function(){o++,a()}})}var r=function(t){};function s(t){var e,n=!1;for(e in t.files)e.match(/\.(geo)?json/i)&&(n=!0);return n}function l(t){var e=i.appendChild(u("div","gist-map-item"));e.appendChild(u("div","gist-map-title")).textContent=t.description,e.appendChild(u("div","gist-map-contents")).textContent=Object.keys(t.files).join(", "),e.onclick=function(n){c("/gists/"+t.id,function(t,e){r(e,n)})}}var e={container:i,onclick:function(t){return r=t,e},appendTo:function(t){return t.appendChild(i),e}};return a(),e}},{"browser-request":6}],3:[function(t,r,e){var a,i=t("queue-async"),s=t("browser-request"),n=t("treeui"),l="https://api.github.com",u=!1;function o(o,a){0===o.length?c("/user",function(t,n){c("/user/orgs",function(t,e){e=e.map(function(t){return[t]});a(null,[n].concat(e))})}):1===o.length?"User"===o[0].type?c("/users/"+o[0].login+"/repos",function(t,e){a(null,e.map(function(t){return[o[0],t]}))}):c("/orgs/"+o[0].login+"/repos",function(t,e){a(null,e.map(function(t){return[o[0],t]}))}):2===o.length?c("/repos/"+o[1].full_name+"/branches",function(t,e){a(null,e.map(function(t){return[o[0],o[1],t]}))}):3===o.length?c("/repos/"+o[1].full_name+"/git/trees/"+o[2].commit.sha,function(t,e){var n=[];!e.length&&e.tree&&(e=[e]);for(var r=0;r<e.length;r++)for(var i=0;i<e[r].tree.length;i++)n.push([o[0],o[1],o[2],e[r].tree[i]]);u&&n.push([o[0],o[1],o[2],{type:"new",name:"+ New File"}]),a(null,n)}):3<o.length&&c("/repos/"+o[1].full_name+"/git/trees/"+o[o.length-1].sha,function(t,e){var n=[];!e.length&&e.tree&&(e=[e]);for(var r=0;r<e.length;r++)for(var i=0;i<e[r].tree.length;i++)n.push(o.concat([e[r].tree[i]]));u&&n.push([o[0],o[1],o[2],{type:"new",name:"+ New File"}]),a(null,n)})}function c(e,n){var o=i(1);o.defer(function r(t,i){s({uri:t||l+e,headers:{Authorization:"token "+a},json:!0,crossOrigin:!0},function(t,e,n){e=(e.getResponseHeader("Link")||"").match(/\<([^\>]+)\>\; rel="next"/);e&&o.defer(r,e[1]),i(null,n)})},null).awaitAll(function(t,e){e?(e=e.reduce(function(t,e){return t.concat(e)},[]),n(t,e)):n(t)})}r.exports=function(t,e,n){return a=t,void 0!==e&&(u=e),l=n||l,r.exports},r.exports.open=function(){return n(o).expandable(function(t){t=t[t.length-1];return"blob"!==t.type&&"commit"!==t.type&&"new"!==t.type}).display(function(t){t=t[t.length-1];return t.name||t.login||t.path})},r.exports.request=c},{"browser-request":6,"queue-async":90,treeui:139}],4:[function(f,x,t){!function(e){"use strict";function p(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function d(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var g=f("util/"),r=Object.prototype.hasOwnProperty,m=Array.prototype.slice,n="foo"===function(){}.name;function y(t){return Object.prototype.toString.call(t)}function b(t){return!d(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var o=x.exports=t,i=/\s*function\s+([^\(\s]*)\s*/;function a(t){if(g.isFunction(t))return n?t.name:(t=t.toString().match(i))&&t[1]}function s(t,e){return"string"!=typeof t||t.length<e?t:t.slice(0,e)}function l(t){return n||!g.isFunction(t)?g.inspect(t):"[Function"+((t=a(t))?": "+t:"")+"]"}function u(t,e,n,r,i){throw new o.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function t(t,e){t||u(t,!0,e,"==",o.ok)}function v(t,e,n,r){if(t===e)return!0;if(d(t)&&d(e))return 0===p(t,e);if(g.isDate(t)&&g.isDate(e))return t.getTime()===e.getTime();if(g.isRegExp(t)&&g.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(b(t)&&b(e)&&y(t)===y(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===p(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(d(t)!==d(e))return!1;var i=(r=r||{actual:[],expected:[]}).actual.indexOf(t);if(-1===i||i!==r.expected.indexOf(e)){r.actual.push(t),r.expected.push(e);var o=t,a=e,s=n,l=r;if(null==o||null==a)return!1;if(g.isPrimitive(o)||g.isPrimitive(a))return o===a;if(s&&Object.getPrototypeOf(o)!==Object.getPrototypeOf(a))return!1;i=w(o),r=w(a);if(i&&!r||!i&&r)return!1;if(i)return o=m.call(o),a=m.call(a),v(o,a,s);var u,c,h=_(o),f=_(a);if(h.length!==f.length)return!1;for(h.sort(),f.sort(),c=h.length-1;0<=c;c--)if(h[c]!==f[c])return!1;for(c=h.length-1;0<=c;c--)if(u=h[c],!v(o[u],a[u],s,l))return!1}return!0}return n?t===e:t==e}function w(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function c(t,e){if(t&&e){if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return 1}catch(t){}return Error.isPrototypeOf(e)?void 0:!0===e.call({},t)}}function h(t,e,n,r){if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),e=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!e&&u(e,n,"Missing expected exception"+r);var i="string"==typeof r,o=!t&&e&&!n;if((!t&&g.isError(e)&&i&&c(e,n)||o)&&u(e,n,"Got unwanted exception"+r),t&&e&&n&&!c(e,n)||!t&&e)throw e}o.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=s(l((n=this).actual),128)+" "+n.operator+" "+s(l(n.expected),128),this.generatedMessage=!0);var e,n=t.stackStartFunction||u;Error.captureStackTrace?Error.captureStackTrace(this,n):(t=new Error).stack&&(t=t.stack,e=a(n),0<=(e=t.indexOf("\n"+e))&&(e=t.indexOf("\n",e+1),t=t.substring(e+1)),this.stack=t)},g.inherits(o.AssertionError,Error),o.fail=u,o.ok=t,o.equal=function(t,e,n){t!=e&&u(t,e,n,"==",o.equal)},o.notEqual=function(t,e,n){t==e&&u(t,e,n,"!=",o.notEqual)},o.deepEqual=function(t,e,n){v(t,e,!1)||u(t,e,n,"deepEqual",o.deepEqual)},o.deepStrictEqual=function(t,e,n){v(t,e,!0)||u(t,e,n,"deepStrictEqual",o.deepStrictEqual)},o.notDeepEqual=function(t,e,n){v(t,e,!1)&&u(t,e,n,"notDeepEqual",o.notDeepEqual)},o.notDeepStrictEqual=function t(e,n,r){v(e,n,!0)&&u(e,n,r,"notDeepStrictEqual",t)},o.strictEqual=function(t,e,n){t!==e&&u(t,e,n,"===",o.strictEqual)},o.notStrictEqual=function(t,e,n){t===e&&u(t,e,n,"!==",o.notStrictEqual)},o.throws=function(t,e,n){h(!0,t,e,n)},o.doesNotThrow=function(t,e,n){h(!1,t,e,n)},o.ifError=function(t){if(t)throw t};var _=Object.keys||function(t){var e,n=[];for(e in t)r.call(t,e)&&n.push(e);return n}}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"util/":142}],5:[function(t,e,n){"use strict";n.byteLength=function(t){return 3*t.length/4-h(t)},n.toByteArray=function(t){var e,n,r,i,o,a=t.length,s=(i=h(t),o=new c(3*a/4-i),n=0<i?a-4:a,0);for(e=0;e<n;e+=4,0)r=u[t.charCodeAt(e)]<<18|u[t.charCodeAt(e+1)]<<12|u[t.charCodeAt(e+2)]<<6|u[t.charCodeAt(e+3)],o[s++]=r>>16&255,o[s++]=r>>8&255,o[s++]=255&r;2===i?(r=u[t.charCodeAt(e)]<<2|u[t.charCodeAt(e+1)]>>4,o[s++]=255&r):1===i&&(r=u[t.charCodeAt(e)]<<10|u[t.charCodeAt(e+1)]<<4|u[t.charCodeAt(e+2)]>>2,o[s++]=r>>8&255,o[s++]=255&r);return o},n.fromByteArray=function(t){for(var e,n=t.length,r=n%3,i="",o=[],a=0,s=n-r;a<s;a+=16383)o.push(function(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16)+(t[o+1]<<8)+t[o+2],i.push(function(t){return l[t>>18&63]+l[t>>12&63]+l[t>>6&63]+l[63&t]}(r));return i.join("")}(t,a,s<a+16383?s:a+16383));1==r?(e=t[n-1],i=(i+=l[e>>2])+l[e<<4&63]+"=="):2==r&&(e=(t[n-2]<<8)+t[n-1],i=(i=(i+=l[e>>10])+l[e>>4&63])+l[e<<2&63]+"=");return o.push(i),o.join("")};for(var l=[],u=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=r.length;i<o;++i)l[i]=r[i],u[r.charCodeAt(i)]=i;function h(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},{}],6:[function(t,e,n){var r,i;r=this,i=function(){var g=XMLHttpRequest;if(!g)throw new Error("missing XMLHttpRequest");m.log={trace:b,debug:b,info:b,warn:b,error:b};function m(t,e){if("function"!=typeof e)throw new Error("Bad callback given: "+e);if(!t)throw new Error("No options given");var n=t.onResponse;if((t="string"==typeof t?{uri:t}:JSON.parse(JSON.stringify(t))).onResponse=n,t.verbose&&(m.log=function(){var t,e,n={},r=["trace","debug","info","warn","error"];for(e=0;e<r.length;e++)n[t=r[e]]=b,"undefined"!=typeof console&&console&&console[t]&&(n[t]=function(n,r){return function(t,e){"object"==typeof e&&(t+=" "+JSON.stringify(e));return n[r].call(n,t)}}(console,t));return n}()),t.url&&(t.uri=t.url,delete t.url),!t.uri&&""!==t.uri)throw new Error("options.uri is a required argument");if("string"!=typeof t.uri)throw new Error("options.uri must be a string");for(var r=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],i=0;i<r.length;i++)if(t[r[i]])throw new Error("options."+r[i]+" is not supported");if(t.callback=e,t.method=t.method||"GET",t.headers=t.headers||{},t.body=t.body||null,t.timeout=t.timeout||m.DEFAULT_TIMEOUT,t.headers.host)throw new Error("Options.headers.host is not supported");t.json&&(t.headers.accept=t.headers.accept||"application/json","GET"!==t.method&&(t.headers["content-type"]="application/json"),"boolean"!=typeof t.json?t.body=JSON.stringify(t.json):"string"!=typeof t.body&&(t.body=JSON.stringify(t.body)));function o(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return n.join("&")}t.qs&&(n="string"==typeof t.qs?t.qs:o(t.qs),-1!==t.uri.indexOf("?")?t.uri=t.uri+"&"+n:t.uri=t.uri+"?"+n);if(t.form){if("string"==typeof t.form)throw"form name unsupported";if("POST"===t.method){var a=(t.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(t.headers["content-type"]=a){case"application/x-www-form-urlencoded":t.body=o(t.form).replace(/%20/g,"+");break;case"multipart/form-data":var s=function(t){var e,n={},r=(n.boundry="-------------------------------"+Math.floor(1e9*Math.random()),[]);for(e in t)t.hasOwnProperty(e)&&r.push("--"+n.boundry+'\nContent-Disposition: form-data; name="'+e+'"\n\n'+t[e]+"\n");return r.push("--"+n.boundry+"--"),n.body=r.join(""),n.length=n.body.length,n.type="multipart/form-data; boundary="+n.boundry,n}(t.form);t.body=s.body,t.headers["content-type"]=s.type;break;default:throw new Error("unsupported encoding:"+a)}}}t.onResponse=t.onResponse||b,!0===t.onResponse&&(t.onResponse=e,t.callback=b),!t.headers.authorization&&t.auth&&(t.headers.authorization="Basic "+function(t){var e,n,r,i,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,s=0,l="",u=[];if(!t)return t;for(;i=t.charCodeAt(a++),e=t.charCodeAt(a++),n=t.charCodeAt(a++),e=(i=i<<16|e<<8|n)>>12&63,n=i>>6&63,r=63&i,u[s++]=o.charAt(i>>18&63)+o.charAt(e)+o.charAt(n)+o.charAt(r),a<t.length;);switch(l=u.join(""),t.length%3){case 1:l=l.slice(0,-2)+"==";break;case 2:l=l.slice(0,-1)+"="}return l}(t.auth.username+":"+t.auth.password));var l=t,u=new g,c=!1,h=function(t){var e=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{n=location.href}catch(t){(n=document.createElement("a")).href="",n=n.href}var n=e.exec(n.toLowerCase())||[],e=e.exec(t.toLowerCase());return!(!e||e[1]==n[1]&&e[2]==n[2]&&(e[3]||("http:"===e[1]?80:443))==(n[3]||("http:"===n[1]?80:443)))}(l.uri),n="withCredentials"in u;if(y+=1,u.seq_id=y,u.id=y+": "+l.method+" "+l.uri,u._id=u.id,h&&!n)return(n=new Error("Browser does not support cross-origin request: "+l.uri)).cors="unsupported",l.callback(n,u);u.timeoutTimer=setTimeout(function(){c=!0;var t=new Error("ETIMEDOUT");return t.code="ETIMEDOUT",t.duration=l.timeout,m.log.error("Timeout",{id:u._id,milliseconds:l.timeout}),l.callback(t,u)},l.timeout);var f={response:!1,loading:!1,end:!1};return u.onreadystatechange=function(t){if(c)return m.log.debug("Ignoring timed out state change",{state:u.readyState,id:u.id});if(m.log.debug("State change",{state:u.readyState,id:u.id,timed_out:c}),u.readyState===g.OPENED)for(var e in m.log.debug("Request started",{id:u.id}),l.headers)u.setRequestHeader(e,l.headers[e]);else u.readyState===g.HEADERS_RECEIVED?p():u.readyState===g.LOADING?(p(),d()):u.readyState===g.DONE&&(p(),d(),function(){if(!f.end){if(f.end=!0,m.log.debug("Request done",{id:u.id}),u.body=u.responseText,l.json)try{u.body=JSON.parse(u.responseText)}catch(t){return l.callback(t,u)}l.callback(null,u,u.body)}}())},u.open(l.method,l.uri,!0),h&&(u.withCredentials=!!l.withCredentials),u.send(l.body),u;function p(){if(!f.response){var t;if(f.response=!0,m.log.debug("Got response",{id:u.id,status:u.status}),clearTimeout(u.timeoutTimer),u.statusCode=u.status,h&&0==u.statusCode)return(t=new Error("CORS request rejected: "+l.uri)).cors="rejected",f.loading=!0,f.end=!0,l.callback(t,u);l.onResponse(null,u)}}function d(){f.loading||(f.loading=!0,m.log.debug("Response body loading",{id:u.id}))}}var y=0;m.withCredentials=!1,m.DEFAULT_TIMEOUT=18e4,m.defaults=function(i,t){function e(r){return function(t,e){for(var n in t="string"==typeof t?{uri:t}:JSON.parse(JSON.stringify(t)),i)void 0===t[n]&&(t[n]=i[n]);return r(t,e)}}var n=e(m);return n.get=e(m.get),n.post=e(m.post),n.put=e(m.put),n.head=e(m.head),n};function b(){}return["get","put","post","head"].forEach(function(t){var n=t.toUpperCase();m[t.toLowerCase()]=function(t){"string"==typeof t?t={method:n,uri:t}:(t=JSON.parse(JSON.stringify(t))).method=n;var e=[t].concat(Array.prototype.slice.apply(arguments,[1]));return m.apply(this,e)}}),m.couch=function(t,i){return(t="string"==typeof t?{uri:t}:t).json=!0,t.body&&(t.json=t.body),delete t.body,i=i||b,m(t,function(t,e,n){if(!t&&(e.statusCode<200||299<e.statusCode)&&n.error)for(var r in t=new Error("CouchDB error: "+(n.error.reason||n.error.error)),n)t[r]=n[r];return i(t,e,n)})},m},"function"==typeof define&&define.amd?define([],i):"object"==typeof n?e.exports=i():r.returnExports=i()},{}],7:[function(t,e,n){},{}],8:[function(t,e,n){arguments[4][7][0].apply(n,arguments)},{dup:7}],9:[function(t,e,n){"use strict";var S=t("base64-js"),o=t("ieee754"),r=(n.Buffer=h,n.SlowBuffer=function(t){+t!=t&&(t=0);return h.alloc(+t)},n.INSPECT_MAX_BYTES=50,2147483647);function a(t){if(r<t)throw new RangeError("Invalid typed array length");t=new Uint8Array(t);return t.__proto__=h.prototype,t}function h(t,e,n){if("number"!=typeof t)return i(t,e,n);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(t)}function i(t,e,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer){var r=t,i=e;if(r.byteLength,i<0||r.byteLength<i)throw new RangeError("'offset' is out of bounds");if(r.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");return(r=void 0===i&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,i):new Uint8Array(r,i,n)).__proto__=h.prototype,r}if("string"!=typeof t){i=t;if(h.isBuffer(i))return n=0|c(i.length),0!==(r=a(n)).length&&i.copy(r,0,0,n),r;if(i){if("undefined"!=typeof ArrayBuffer&&i.buffer instanceof ArrayBuffer||"length"in i)return"number"!=typeof i.length||function(t){return t!=t}(i.length)?a(0):u(i);if("Buffer"===i.type&&Array.isArray(i.data))return u(i.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}var o,n=t,t=e;if(h.isEncoding(t="string"==typeof t&&""!==t?t:"utf8"))return e=0|f(n,t),o=a(e),o=(n=o.write(n,t))!==e?o.slice(0,n):o;throw new TypeError('"encoding" must be a valid string encoding')}function s(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t){return s(t),a(t<0?0:0|c(t))}function u(t){for(var e=t.length<0?0:0|c(t.length),n=a(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function c(t){if(r<=t)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return 0|t}function f(t,e){if(h.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;var n=(t="string"!=typeof t?""+t:t).length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return M(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return C(t).length;default:if(r)return M(t).length;e=(""+e).toLowerCase(),r=!0}}function p(t,e,n){var r,i=!1;if((e=void 0===e||e<0?0:e)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":var o=this,a=e,s=n,l=o.length;(!s||s<0||l<s)&&(s=l);for(var u="",c=a=!a||a<0?0:a;c<s;++c)u+=function(t){return t<16?"0"+t.toString(16):t.toString(16)}(o[c]);return u;case"utf8":case"utf-8":return E(this,e,n);case"ascii":var h=this,l=e,f=n,p="";f=Math.min(h.length,f);for(var d=l;d<f;++d)p+=String.fromCharCode(127&h[d]);return p;case"latin1":case"binary":var g=this,a=e,m=n,y="";m=Math.min(g.length,m);for(var b=a;b<m;++b)y+=String.fromCharCode(g[b]);return y;case"base64":return v=this,r=n,0===(w=e)&&r===v.length?S.fromByteArray(v):S.fromByteArray(v.slice(w,r));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var v=e,w=n,_=this.slice(v,w),x="",k=0;k<_.length;k+=2)x+=String.fromCharCode(_[k]+256*_[k+1]);return x;default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function d(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,(n=(n=isNaN(n)?i?0:t.length-1:n)<0?t.length+n:n)>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=h.from(e,r)),h.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(t,e,n):m(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,i){var o=1,a=t.length,s=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a/=o=2,s/=2,n/=2}function l(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i)for(var u=-1,c=n;c<a;c++)if(l(t,c)===l(e,-1===u?0:c-u)){if(c-(u=-1===u?c:u)+1===s)return u*o}else-1!==u&&(c-=c-u),u=-1;else for(c=n=a<n+s?a-s:n;0<=c;c--){for(var h=!0,f=0;f<s;f++)if(l(t,c+f)!==l(e,f)){h=!1;break}if(h)return c}return-1}function y(t,e,n,r){return A(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function b(t,e,n,r){return A(function(t,e){for(var n,r,i=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i.push(n%256),i.push(r);return i}(e,t.length-n),t,n,r)}function E(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,l,u=t[i],c=null,h=239<u?4:223<u?3:191<u?2:1;if(i+h<=n)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(o=t[i+1]))&&127<(l=(31&u)<<6|63&o)&&(c=l);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&2047<(l=(15&u)<<12|(63&o)<<6|63&a)&&(l<55296||57343<l)&&(c=l);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)&&l<1114112&&(c=l)}null===c?(c=65533,h=1):65535<c&&(r.push((c-=65536)>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=h}var f=r,p=f.length;if(p<=v)return String.fromCharCode.apply(String,f);for(var d="",g=0;g<p;)d+=String.fromCharCode.apply(String,f.slice(g,g+=v));return d}n.kMaxLength=r,(h.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}())||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),h.poolSize=8192,h.from=i,h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,h.alloc=function(t,e,n){return e=e,n=n,s(t=t),!(t<=0)&&void 0!==e?"string"==typeof n?a(t).fill(e,n):a(t).fill(e):a(t)},h.allocUnsafe=l,h.allocUnsafeSlow=l,h.isBuffer=function(t){return!(null==t||!t._isBuffer)},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);if(void 0===e)for(i=e=0;i<t.length;++i)e+=t[i].length;for(var n=h.allocUnsafe(e),r=0,i=0;i<t.length;++i){var o=t[i];if(!h.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},h.byteLength=f,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},h.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?E(this,0,t):p.apply(this,arguments)},h.prototype.equals=function(t){if(h.isBuffer(t))return this===t||0===h.compare(this,t);throw new TypeError("Argument must be a Buffer")},h.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},h.prototype.compare=function(t,e,n,r,i){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),(e=void 0===e?0:e)<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=e)return 0;if(i<=r)return-1;if(n<=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),l=this.slice(r,i),u=t.slice(e,n),c=0;c<s;++c)if(l[c]!==u[c]){o=l[c],a=u[c];break}return o<a?-1:a<o?1:0},h.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},h.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},h.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},h.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||i<n)&&(n=i),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var o,a,s,l=!1;;)switch(r){case"hex":var u=this,c=t,h=e,f=n,p=(h=Number(h)||0,u.length-h);if((!f||p<(f=Number(f)))&&(f=p),(p=c.length)%2!=0)throw new TypeError("Invalid hex string");p/2<f&&(f=p/2);for(var d=0;d<f;++d){var g=parseInt(c.substr(2*d,2),16);if(isNaN(g))return d;u[h+d]=g}return d;case"utf8":case"utf-8":return p=e,s=n,A(M(t,(a=this).length-p),a,p,s);case"ascii":return y(this,t,e,n);case"latin1":case"binary":return y(this,t,e,n);case"base64":return a=this,s=e,o=n,A(C(t),a,s,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,t,e,n);default:if(l)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),l=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var v=4096;function w(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+e)throw new RangeError("Trying to access beyond buffer length")}function _(t,e,n,r,i,o){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<e||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function x(t,e,n,r){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function k(t,e,n,r,i){return e=+e,n>>>=0,i||x(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function I(t,e,n,r,i){return e=+e,n>>>=0,i||x(t,0,n,8),o.write(t,e,n,r,52,8),n+8}h.prototype.slice=function(t,e){var n=this.length,n=((t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),e<t&&(e=t),this.subarray(t,e));return n.__proto__=h.prototype,n},h.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||w(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},h.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||w(t,e,this.length);for(var r=this[t+--e],i=1;0<e&&(i*=256);)r+=this[t+--e]*i;return r},h.prototype.readUInt8=function(t,e){return t>>>=0,e||w(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return t>>>=0,e||w(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return t>>>=0,e||w(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return t>>>=0,e||w(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return t>>>=0,e||w(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||w(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return(i*=128)<=r&&(r-=Math.pow(2,8*e)),r},h.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||w(t,e,this.length);for(var r=e,i=1,o=this[t+--r];0<r&&(i*=256);)o+=this[t+--r]*i;return(i*=128)<=o&&(o-=Math.pow(2,8*e)),o},h.prototype.readInt8=function(t,e){return t>>>=0,e||w(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){t>>>=0,e||w(t,2,this.length);e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},h.prototype.readInt16BE=function(t,e){t>>>=0,e||w(t,2,this.length);e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},h.prototype.readInt32LE=function(t,e){return t>>>=0,e||w(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return t>>>=0,e||w(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return t>>>=0,e||w(t,4,this.length),o.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return t>>>=0,e||w(t,4,this.length),o.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return t>>>=0,e||w(t,8,this.length),o.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return t>>>=0,e||w(t,8,this.length),o.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||_(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},h.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||_(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;0<=--i&&(o*=256);)this[e+i]=t/o&255;return e+n},h.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,1,255,0),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},h.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeIntLE=function(t,e,n,r){t=+t,e>>>=0,r||_(this,t,e,n,(r=Math.pow(2,8*n-1))-1,-r);var i=0,o=1,a=0;for(this[e]=255&t;++i<n&&(o*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/o>>0)-a&255;return e+n},h.prototype.writeIntBE=function(t,e,n,r){t=+t,e>>>=0,r||_(this,t,e,n,(r=Math.pow(2,8*n-1))-1,-r);var i=n-1,o=1,a=0;for(this[e+i]=255&t;0<=--i&&(o*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/o>>0)-a&255;return e+n},h.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,1,127,-128),this[e]=255&(t=t<0?255+t+1:t),e+1},h.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},h.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,4,2147483647,-2147483648),this[e]=(t=t<0?4294967295+t+1:t)>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeFloatLE=function(t,e,n){return k(this,t,e,!0,n)},h.prototype.writeFloatBE=function(t,e,n){return k(this,t,e,!1,n)},h.prototype.writeDoubleLE=function(t,e,n){return I(this,t,e,!0,n)},h.prototype.writeDoubleBE=function(t,e,n){return I(this,t,e,!1,n)},h.prototype.copy=function(t,e,n,r){if(n=n||0,r||0===r||(r=this.length),e>=t.length&&(e=t.length),(r=0<r&&r<n?n:r)===n)return 0;if(0===t.length||0===this.length)return 0;if((e=e||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length);var i,o=(r=t.length-e<r-n?t.length-e+n:r)-n;if(this===t&&n<e&&e<r)for(i=o-1;0<=i;--i)t[i+e]=this[i+n];else if(o<1e3)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},h.prototype.fill=function(t,e,n,r){if("string"==typeof t){var i;if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1!==t.length||(i=t.charCodeAt(0))<256&&(t=i),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!h.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(!(n<=e))if(e>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(t=t||0))for(s=e;s<n;++s)this[s]=t;else for(var o=h.isBuffer(t)?t:new h(t,r),a=o.length,s=0;s<n-e;++s)this[s+e]=o[s%a];return this};var L=/[^+/0-9A-Za-z-_]/g;function M(t,e){e=e||1/0;for(var n,r=t.length,i=null,o=[],a=0;a<r;++a){if(55295<(n=t.charCodeAt(a))&&n<57344){if(!i){if(56319<n){-1<(e-=3)&&o.push(239,191,189);continue}if(a+1===r){-1<(e-=3)&&o.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(e-=3)&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(e-=3)&&o.push(239,191,189);if(i=null,n<128){if(--e<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function C(t){return S.toByteArray(function(t){var e;if((t=((e=t).trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(L,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function A(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}},{"base64-js":5,ieee754:35}],10:[function(t,n,e){!function(h){"use strict";function e(t){return Object.prototype.toString.call(t)}var f=function(t){return Array.isArray(t)||"object"==typeof t&&"[object Array]"===e(t)},p=function(t){return"object"==typeof t&&"[object Date]"===e(t)},d=function(t){return"object"==typeof t&&"[object RegExp]"===e(t)},g=function(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e};function t(t,a,e,s){var l=[],u=[],c=void 0!==h;return void 0===a&&(a=!0),function t(e,n){if(null===e)return null;if(0==n)return e;var r,i;if("object"!=typeof e)return e;if(f(e)?r=[]:d(e)?(r=new RegExp(e.source,g(e)),e.lastIndex&&(r.lastIndex=e.lastIndex)):p(e)?r=new Date(e.getTime()):c&&h.isBuffer(e)?(r=new h(e.length),e.copy(r)):r=void 0===s?Object.create(Object.getPrototypeOf(e)):Object.create(s),a){var o=l.indexOf(e);if(-1!=o)return u[o];l.push(e),u.push(r)}for(i in e)r[i]=t(e[i],n-1);return r}(t,e=void 0===e?1/0:e)}"object"==typeof n&&(n.exports=t),t.clonePrototype=function(t){var e;return null===t?null:((e=function(){}).prototype=t,new e)}}.call(this,t("buffer").Buffer)},{buffer:9}],11:[function(t,e,n){var m=t("dsv"),y=t("sexagesimal");function b(t){return!!t.match(/(Lat)(itude)?/gi)}function v(t){return!!t.match(/(L)(on|ng)(gitude)?/i)}function a(t){return"object"==typeof t?Object.keys(t).length:0}function w(i){var o=[];return[",",";","\t","|"].forEach(function(t){var e=m(t).parse(i);if(1<=e.length){for(var n=a(e[0]),r=0;r<e.length;r++)if(a(e[r])!==n)return;o.push({delimiter:t,arity:Object.keys(e[0]).length})}}),o.length?o.sort(function(t,e){return e.arity-t.arity})[0].delimiter:null}e.exports={isLon:v,isLat:b,csv:m.csv.parse,tsv:m.tsv.parse,dsv:m,auto:function(t){var e=w(t);return e?m(e).parse(t):null},csv2geojson:function(t,e,n){n||(n=e,e={}),e.delimiter=e.delimiter||",";var r=e.latfield||"",i=e.lonfield||"",o=[],a={type:"FeatureCollection",features:o};if("auto"===e.delimiter&&"string"==typeof t&&(e.delimiter=w(t),!e.delimiter))return n({type:"Error",message:"Could not autodetect delimiter"});var s="string"==typeof t?m(e.delimiter).parse(t):t;if(!s.length)return n(null,a);if(!r||!i){for(var l in s[0])!r&&b(l)&&(r=l),!i&&v(l)&&(i=l);if(!r||!i){var u,c=[];for(u in s[0])c.push(u);return n({type:"Error",message:"Latitude and longitude fields not present",data:s,fields:c})}}for(var h,f,p,d=[],g=0;g<s.length;g++)void 0!==s[g][i]&&void 0!==s[g][i]&&(f=s[g][i],h=s[g][r],(p=y(f,"EW"))&&(f=p),(p=y(h,"NS"))&&(h=p),p=parseFloat(f),f=parseFloat(h),isNaN(p)||isNaN(f)?d.push({message:"A row contained an invalid value for latitude or longitude",row:s[g]}):(e.includeLatLon||(delete s[g][i],delete s[g][r]),o.push({type:"Feature",properties:s[g],geometry:{type:"Point",coordinates:[parseFloat(p),parseFloat(f)]}})));n(d.length?d:null,a)},toLine:function(t){for(var e=t.features,n={type:"Feature",geometry:{type:"LineString",coordinates:[]}},r=0;r<e.length;r++)n.geometry.coordinates.push(e[r].geometry.coordinates);return n.properties=e[0].properties,{type:"FeatureCollection",features:[n]}},toPolygon:function(t){for(var e=t.features,n={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},r=0;r<e.length;r++)n.geometry.coordinates[0].push(e[r].geometry.coordinates);return n.properties=e[0].properties,{type:"FeatureCollection",features:[n]}}}},{dsv:18,sexagesimal:91}],12:[function(t,e,n){function r(){var c=d3.dispatch("change","rowfocus");return d3.rebind(function(t){t.each(function(t){var s,e=d3.select(this),l=d3.set(),n=(t.map(Object.keys).forEach(function(t){t.forEach(function(t){l.add(t)})}),e.selectAll(".controls").data([t]).enter().append("div").attr("class","controls").append("button").on("click",function(){var t=prompt("column name");t&&(l.add(t),u())}));n.append("span").attr("class","icon-plus"),n.append("span").text(" new column");t=(n=e.selectAll("table").data([t]).enter().append("table")).append("thead");function u(){var n=l.values(),t=s.select("thead").select("tr").selectAll("th").data(n,function(t){return t}),e=t.enter().append("th"),r=(e.append("span").text(String),e.append("button")),e=e.append("button"),i=(t.exit().remove(),s.select("tbody").selectAll("tr").data(function(t){return t})),t=(i.enter().append("tr"),i.exit().remove(),i.selectAll("td").data(n,function(t){return t}));function o(t){var e,n;t.data[d3.select(this).attr("field")]=(e=this.value,(n=parseFloat(e)).toString()===e?n:e),c.change(t.data,t.index)}function a(t){return t.entries().reduce(function(t,e){return t[e.key]=e.value,t},{})}t.enter().append("td").append("input").attr("field",String),t.exit().remove(),r.on("click",function(t){var n=t;confirm("Delete column "+n+"?")&&(l.remove(n),i.selectAll("input").data(function(t,e){t=d3.map(t),t.remove(n),t=a(t);return c.change(t,e),{data:t,index:e}}),u())}),r.append("span").attr("class","icon-minus"),r.append("span").text(" delete"),e.append("span").text(" rename"),e.on("click",function(t){var n=t,r=prompt("New name for column "+n+"?");r&&(l.remove(n),l.add(r),i.selectAll("input").data(function(t,e){t=d3.map(t),t.set(r,t.get(n)),t.remove(n),t=a(t);return c.change(t,e),{data:t,index:e}}),u())}),i.selectAll("input").data(function(t,e){return d3.range(n.length).map(function(){return{data:t,index:e}})}).classed("disabled",function(t){return void 0===t.data[d3.select(this).attr("field")]}).property("value",function(t){t=t.data[d3.select(this).attr("field")];return isNaN(t)?t||"":t}).on("keyup",o).on("change",o).on("click",function(t){void 0===t.data[d3.select(this).attr("field")]&&(t.data[d3.select(this).attr("field")]="",u())}).on("focus",function(t){c.rowfocus(t.data,t.index)})}n.append("tbody"),t.append("tr"),s=e.select("table"),u()})},c,"on")}void 0!==e&&(e.exports=function(t){return r})},{}],13:[function(t,e,n){e.exports.structure=t("./src/structure")},{"./src/structure":17}],14:[function(t,e,n){var a=t("./fieldsize"),s={string:"C",number:"N",boolean:"L"};function r(t){var e,n,r={},i=[];for(e in t)r[e]=typeof t[e];for(n in r){var o=s[r[n]];i.push({name:n,type:o,size:a[o]})}return i}e.exports.multi=function(t){var i={};return t.forEach(function(t){var e,n=i,r=t;for(e in r)n[e]=r[e]}),r(i)},e.exports.bytesPer=function(t){return t.reduce(function(t,e){return t+e.size},1)},e.exports.obj=r},{"./fieldsize":15}],15:[function(t,e,n){e.exports={C:254,L:1,D:8,N:18,M:18,F:18,B:8}},{}],16:[function(t,e,n){e.exports.lpad=function(t,e,n){for(;t.length<e;)t=n+t;return t},e.exports.rpad=function(t,e,n){for(;t.length<e;)t+=n;return t},e.exports.writeField=function(t,e,n,r){for(var i=0;i<e;i++)t.setUint8(r,n.charCodeAt(i)),r++;return r}},{}],17:[function(t,e,n){t("./fieldsize");var s=t("./lib"),l=t("./fields");e.exports=function(t){var e=l.multi(t),n=32*e.length+1,r=l.bytesPer(e),i=new ArrayBuffer(32+n+r*t.length),o=new Date,a=new DataView(i),i=(a.setUint8(0,3),a.setUint8(1,o.getFullYear()-1900),a.setUint8(2,o.getMonth()),a.setUint8(3,o.getDate()),a.setUint32(4,t.length,!0),32+n);return a.setUint16(8,i,!0),a.setUint16(10,r,!0),a.setInt8(n-1,13),e.forEach(function(t,n){t.name.split("").slice(0,8).forEach(function(t,e){a.setInt8(32+32*n+e,t.charCodeAt(0))}),a.setInt8(32+32*n+11,t.type.charCodeAt(0)),a.setInt8(32+32*n+16,t.size),"N"==t.type&&a.setInt8(32+32*n+17,0)}),offset=32+n,t.forEach(function(n,t){a.setUint8(offset,32),offset++,e.forEach(function(t){var e=n[t.name]||0;switch(t.type){case"L":a.setUint8(offset,e?84:70),offset++;break;case"D":offset=s.writeField(a,8,s.lpad(e.toString(),8," "),offset);break;case"N":offset=s.writeField(a,t.size,s.lpad(e.toString(),t.size," ").substr(0,18),offset);break;case"C":offset=s.writeField(a,t.size,s.rpad(e.toString(),t.size," "),offset);break;default:throw new Error("Unknown field type")}})}),a.setUint8(offset-1,26),a}},{"./fields":14,"./fieldsize":15,"./lib":16}],18:[function(t,e,n){e.exports=new Function('dsv.version = "0.0.3";\n\ndsv.tsv = dsv("\\t");\ndsv.csv = dsv(",");\n\nfunction dsv(delimiter) {\n  var dsv = {},\n      reFormat = new RegExp("[\\"" + delimiter + "\\n]"),\n      delimiterCode = delimiter.charCodeAt(0);\n\n  dsv.parse = function(text, f) {\n    var o;\n    return dsv.parseRows(text, function(row, i) {\n      if (o) return o(row, i - 1);\n      var a = new Function("d", "return {" + row.map(function(name, i) {\n        return JSON.stringify(name) + ": d[" + i + "]";\n      }).join(",") + "}");\n      o = f ? function(row, i) { return f(a(row), i); } : a;\n    });\n  };\n\n  dsv.parseRows = function(text, f) {\n    var EOL = {}, // sentinel value for end-of-line\n        EOF = {}, // sentinel value for end-of-file\n        rows = [], // output rows\n        N = text.length,\n        I = 0, // current character index\n        n = 0, // the current line number\n        t, // the current token\n        eol; // is the current token followed by EOL?\n\n    function token() {\n      if (I >= N) return EOF; // special case: end of file\n      if (eol) return eol = false, EOL; // special case: end of line\n\n      // special case: quotes\n      var j = I;\n      if (text.charCodeAt(j) === 34) {\n        var i = j;\n        while (i++ < N) {\n          if (text.charCodeAt(i) === 34) {\n            if (text.charCodeAt(i + 1) !== 34) break;\n            ++i;\n          }\n        }\n        I = i + 2;\n        var c = text.charCodeAt(i + 1);\n        if (c === 13) {\n          eol = true;\n          if (text.charCodeAt(i + 2) === 10) ++I;\n        } else if (c === 10) {\n          eol = true;\n        }\n        return text.substring(j + 1, i).replace(/""/g, "\\"");\n      }\n\n      // common case: find next delimiter or newline\n      while (I < N) {\n        var c = text.charCodeAt(I++), k = 1;\n        if (c === 10) eol = true; // \\n\n        else if (c === 13) { eol = true; if (text.charCodeAt(I) === 10) ++I, ++k; } // \\r|\\r\\n\n        else if (c !== delimiterCode) continue;\n        return text.substring(j, I - k);\n      }\n\n      // special case: last token before EOF\n      return text.substring(j);\n    }\n\n    while ((t = token()) !== EOF) {\n      var a = [];\n      while (t !== EOL && t !== EOF) {\n        a.push(t);\n        t = token();\n      }\n      if (f && !(a = f(a, n++))) continue;\n      rows.push(a);\n    }\n\n    return rows;\n  };\n\n  dsv.format = function(rows) {\n    if (Array.isArray(rows[0])) return dsv.formatRows(rows); // deprecated; use formatRows\n    var fieldSet = {}, fields = [];\n\n    // Compute unique fields in order of discovery.\n    rows.forEach(function(row) {\n      for (var field in row) {\n        if (!(field in fieldSet)) {\n          fields.push(fieldSet[field] = field);\n        }\n      }\n    });\n\n    return [fields.map(formatValue).join(delimiter)].concat(rows.map(function(row) {\n      return fields.map(function(field) {\n        return formatValue(row[field]);\n      }).join(delimiter);\n    })).join("\\n");\n  };\n\n  dsv.formatRows = function(rows) {\n    return rows.map(formatRow).join("\\n");\n  };\n\n  function formatRow(row) {\n    return row.map(formatValue).join(delimiter);\n  }\n\n  function formatValue(text) {\n    return reFormat.test(text) ? "\\"" + text.replace(/\\"/g, "\\"\\"") + "\\"" : text;\n  }\n\n  return dsv;\n}\n;return dsv')()},{}],19:[function(t,e,n){"use strict";var a=/["'&<>]/;e.exports=function(t){var e,n=""+t,t=a.exec(n);if(!t)return n;var r="",i=0,o=0;for(i=t.index;i<n.length;i++){switch(n.charCodeAt(i)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#39;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}o!==i&&(r+=n.substring(o,i)),o=i+1,r+=e}return o!==i?r+n.substring(o,i):r}},{}],20:[function(t,e,n){function r(){if(!(this instanceof r))return new r;this._bbox=[1/0,1/0,-1/0,-1/0],this._valid=!1}(e.exports=r).prototype.include=function(t){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[0]),this._bbox[3]=Math.max(this._bbox[3],t[1]),this},r.prototype.union=function(t){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this},r.prototype.bbox=function(){return this._valid?this._bbox:null},r.prototype.contains=function(t){return this._valid?this._bbox[0]<=t[0]&&this._bbox[1]<=t[1]&&this._bbox[2]>=t[0]&&this._bbox[3]>=t[1]:null},r.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null}},{}],21:[function(t,e,n){var r="undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(d){"use strict";var g,m,y,b,v,w,o,_,x,k,t,S,n,e,r;if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent))return g=d.document,m=function(){return d.URL||d.webkitURL||d},y=g.createElementNS("http://www.w3.org/1999/xhtml","a"),b=!d.externalHost&&"download"in y,v=d.webkitRequestFileSystem,w=d.requestFileSystem||v||d.mozRequestFileSystem,o=function(t){(d.setImmediate||d.setTimeout)(function(){throw t},0)},_="application/octet-stream",x=0,k=[],t=function(){for(var t=k.length;t--;){var e=k[t];"string"==typeof e?m().revokeObjectURL(e):e.remove()}k.length=0},S=function(t,e,n){for(var r=(e=[].concat(e)).length;r--;){var i=t["on"+e[r]];if("function"==typeof i)try{i.call(t,n||t)}catch(t){o(t)}}},r=function(t,e){return new n(t,e)},(e=(n=function(r,n){function i(){!c&&t||(t=h(r)),a?a.location.href=t:window.open(t,"_blank"),l.readyState=l.DONE,f()}function o(t){return function(){if(l.readyState!==l.DONE)return t.apply(this,arguments)}}var t,a,e,s,l=this,u=r.type,c=!1,h=function(){var t=m().createObjectURL(r);return k.push(t),t},f=function(){S(l,"writestart progress write writeend".split(" "))},p={create:!0,exclusive:!1};l.readyState=l.INIT,n=n||"download",b?(t=h(r),y.href=t,y.download=n,e=y,(s=g.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,d,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(s),l.readyState=l.DONE,f()):(d.chrome&&u&&u!==_&&(e=r.slice||r.webkitSlice,r=e.call(r,0,r.size,_),c=!0),v&&"download"!==n&&(n+=".download"),u!==_&&!v||(a=d),w?(x+=r.size,w(d.TEMPORARY,x,o(function(t){t.root.getDirectory("saved",p,o(function(t){function e(){t.getFile(n,p,o(function(n){n.createWriter(o(function(e){e.onwriteend=function(t){a.location.href=n.toURL(),k.push(n),l.readyState=l.DONE,S(l,"writeend",t)},e.onerror=function(){var t=e.error;t.code!==t.ABORT_ERR&&i()},"writestart progress write abort".split(" ").forEach(function(t){e["on"+t]=l["on"+t]}),e.write(r),l.abort=function(){e.abort(),l.readyState=l.DONE},l.readyState=l.WRITING}),i)}),i)}t.getFile(n,{create:!1},o(function(t){t.remove(),e()}),o(function(t){(t.code===t.NOT_FOUND_ERR?e:i)()}))}),i)}),i)):i())}).prototype).abort=function(){this.readyState=this.DONE,S(this,"abort")},e.readyState=e.INIT=0,e.WRITING=1,e.DONE=2,e.error=e.onwritestart=e.onprogress=e.onwrite=e.onabort=e.onerror=e.onwriteend=null,d.addEventListener("unload",t,!1),r.unload=function(){t(),d.removeEventListener("unload",t,!1)},r}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);null!=e?e.exports=r:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return r})},{}],22:[function(t,e,n){var o=t("wgs84");function r(t){var e=0;if(t&&0<t.length){e+=Math.abs(i(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(i(t[n]))}return e}function i(t){var e=0;if(2<t.length){for(var n,r,i=0;i<t.length-1;i++)n=t[i],e+=a((r=t[i+1])[0]-n[0])*(2+Math.sin(a(n[1]))+Math.sin(a(r[1])));e=e*o.RADIUS*o.RADIUS/2}return e}function a(t){return t*Math.PI/180}e.exports=function(t){if("Polygon"===t.type)return r(t.coordinates);if("MultiPolygon"!==t.type)return null;for(var e=0,n=0;n<t.coordinates.length;n++)e+=r(t.coordinates[n]);return e}},{wgs84:144}],23:[function(t,e,n){e.exports=function(t,e){return function n(t){if(Array.isArray(t)&&t.length&&"number"==typeof t[0])return[t];return t.reduce(function(t,e){return Array.isArray(e)&&Array.isArray(e[0])?t.concat(n(e)):(t.push(e),t)},[])}(t)}},{}],24:[function(t,e,n){var r=t("geojson-normalize"),i=t("geojson-flatten"),o=t("./flatten");e.exports=function(t){var e;return t?(t=i(r(t)),e=[],t.features.forEach(function(t){t.geometry&&(e=e.concat(o(t.geometry.coordinates)))}),e):[]}},{"./flatten":23,"geojson-flatten":26,"geojson-normalize":27}],25:[function(t,e,n){var i=t("geojson-coords"),r=t("traverse"),o=t("extent");function a(t){for(var e=o(),n=i(t),r=0;r<n.length;r++)e.include(n[r]);return e}e.exports=function(t){return a(t).bbox()},e.exports.polygon=function(t){return a(t).polygon()},e.exports.bboxify=function(t){return r(t).map(function(t){t&&"string"==typeof t.type&&(t.bbox=a(t).bbox(),this.update(t))})}},{extent:20,"geojson-coords":24,traverse:138}],26:[function(t,e,n){e.exports=function n(e,t){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce(function(t,e){return t.concat(n(e))},[]),e;case"Feature":return n(e.geometry).map(function(t){return{type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t}});case"MultiPoint":return e.coordinates.map(function(t){return{type:"Point",coordinates:t}});case"MultiPolygon":return e.coordinates.map(function(t){return{type:"Polygon",coordinates:t}});case"MultiLineString":return e.coordinates.map(function(t){return{type:"LineString",coordinates:t}});case"GeometryCollection":return e.geometries;case"Point":case"Polygon":case"LineString":return[e];default:return e}}},{}],27:[function(t,e,n){e.exports=function(t){if(!t||!t.type)return null;var e=r[t.type];if(!e)return null;return"geometry"===e?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}:"feature"===e?{type:"FeatureCollection",features:[t]}:"featurecollection"===e?t:void 0};var r={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},{}],28:[function(t,e,n){function i(){return Math.random()-.5}e.exports=function(t,e){if("point"===e){for(var n=[],r=0;r<t;r++)n.push({type:"Feature",geometry:{type:"Point",coordinates:[360*i(),180*i()]},properties:{}});return{type:"FeatureCollection",features:n}}}},{}],29:[function(t,e,n){var r=t("geojson-area");function i(e,n){return function(t){return e(t,n)}}function o(t,e){return"Polygon"===t.type?t.coordinates=a(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(i(a,e))),t}function a(t,e){t[0]=s(t[0],e=!!e);for(var n=1;n<t.length;n++)t[n]=s(t[n],!e);return t}function s(t,e){return 0<=r.ring(t)===e?t:t.reverse()}e.exports=function t(e,n){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(i(t,n)),e;case"Feature":return e.geometry=t(e.geometry,n),e;case"Polygon":case"MultiPolygon":return o(e,n);default:return e}}},{"geojson-area":30}],30:[function(t,e,n){var o=t("wgs84");function r(t){var e=0;if(t&&0<t.length){e+=Math.abs(i(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(i(t[n]))}return e}function i(t){var e=0;if(2<t.length){for(var n,r,i=0;i<t.length-1;i++)n=t[i],e+=a((r=t[i+1])[0]-n[0])*(2+Math.sin(a(n[1]))+Math.sin(a(r[1])));e=e*o.RADIUS*o.RADIUS/2}return e}function a(t){return t*Math.PI/180}e.exports.geometry=function(t){{if("Polygon"===t.type)return r(t.coordinates);if("MultiPolygon"!==t.type)return null;for(var e=0,n=0;n<t.coordinates.length;n++)e+=r(t.coordinates[n]);return e}},e.exports.ring=i},{wgs84:144}],31:[function(t,e,n){var r=t("dsv");e.exports=function(t,e){switch(t.type){case"FeatureCollection":break;case"Feature":t={type:"FeatureCollection",features:[t]};break;case"Point":t={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};break;default:return null}return r(e||",").format(t.features.filter(function(t){return"Point"==t.geometry.type}).map(function(t){var e=JSON.parse(JSON.stringify(t.properties));return e.lon=t.geometry.coordinates[0],e.lat=t.geometry.coordinates[1],e}))}},{dsv:18}],32:[function(t,e,n){var p=t("jsonlint-lines");e.exports.hint=function(e){var t,o=[];function n(t){t.type?h[t.type]?t&&h[t.type](t):o.push({message:"The type "+t.type+" is unknown",line:t.__line__}):o.push({message:"The type property is required and was not found",line:t.__line__})}function r(t,e){return t.every(function(t){return null!==t&&typeof t===e})}function i(t,e,n){if(void 0===t[e])return o.push({message:'"'+e+'" property required',line:t.__line__});if("array"===n){if(!Array.isArray(t[e]))return o.push({message:'"'+e+'" property should be an array, but is an '+typeof t[e]+" instead",line:t.__line__})}else if(n&&typeof t[e]!==n)return o.push({message:'"'+e+'" property should be '+n+", but is an "+typeof t[e]+" instead",line:t.__line__})}function a(t,e){return Array.isArray(t)?t.length<2?o.push({message:"position must have 2 or more elements",line:t.__line__||e}):r(t,"number")?void 0:o.push({message:"each element in a position must be a number",line:t.__line__||e}):o.push({message:"position should be an array, is a "+typeof t+" instead",line:t.__line__||e})}function s(n,e,r,i){if(void 0===i&&void 0!==n.__line__&&(i=n.__line__),0===r)a(n,i);else{if(1===r&&e)if("LinearRing"===e){if(!Array.isArray(n[n.length-1]))return o.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:i});n.length<4&&o.push({message:"a LinearRing of coordinates needs to have four or more positions",line:i}),!n.length||n[n.length-1].length===n[0].length&&n[n.length-1].every(function(t,e){return n[0][e]===t})||o.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:i})}else"Line"===e&&n.length<2&&o.push({message:"a line needs to have two or more coordinates to be valid",line:i});if(!Array.isArray(n))return o.push({message:"coordinates must be list of positions",line:i});n.forEach(function(t){s(t,e,r-1,t.__line__||i)})}}function l(t){var e,n;t.crs&&("object"==typeof t.crs?(e=i(t.crs,"type","string"),n=i(t.crs,"properties","object"),e||n||("name"==t.crs.type?i(t.crs.properties,"name","string"):"link"==t.crs.type&&i(t.crs.properties,"href","string"))):o.push({message:"the value of the crs property must be an object, not a "+typeof t.crs,line:t.__line__}))}function u(t){t.bbox&&(Array.isArray(t.bbox)?r(t.bbox,"number")||o.push({message:"each element in a bbox property must be a number",line:t.bbox.__line__}):o.push({message:"bbox property must be an array of numbers, but is a "+typeof t.bbox,line:t.__line__}))}function c(t){l(t),u(t),void 0!==t.id&&"string"!=typeof t.id&&"number"!=typeof t.id&&o.push({message:'Feature "id" property must have a string or number value',line:t.__line__}),"Feature"!==t.type&&o.push({message:"GeoJSON features must have a type=feature property",line:t.__line__}),i(t,"properties","object"),i(t,"geometry","object")||t.geometry&&n(t.geometry)}var h={Point:function(t){l(t),u(t),i(t,"coordinates","array")||a(t.coordinates)},Feature:c,MultiPoint:function(t){l(t),u(t),i(t,"coordinates","array")||s(t.coordinates,"",1)},LineString:function(t){l(t),u(t),i(t,"coordinates","array")||s(t.coordinates,"Line",1)},MultiLineString:function(t){l(t),u(t),i(t,"coordinates","array")||s(t.coordinates,"Line",2)},FeatureCollection:function(t){if(l(t),u(t),!i(t,"features","array")){if(!r(t.features,"object"))return o.push({message:"Every feature must be an object",line:t.__line__});t.features.forEach(c)}},GeometryCollection:function(t){l(t),u(t),i(t,"geometries","array")||t.geometries.forEach(function(t){t&&n(t)})},Polygon:function(t){l(t),u(t),i(t,"coordinates","array")||s(t.coordinates,"LinearRing",2)},MultiPolygon:function(t){l(t),u(t),i(t,"coordinates","array")||s(t.coordinates,"LinearRing",3)}};if("string"!=typeof e)return[{message:"Expected string input",line:0}];try{t=p.parse(e)}catch(t){var e=t.message.match(/line (\d+)/),f=0;return[{line:(f=e?parseInt(e[1],10):f)-1,message:t.message,error:t}]}return"object"!=typeof t||null==t?o.push({message:"The root of a GeoJSON object must be an object.",line:0}):n(t),o}},{"jsonlint-lines":37}],33:[function(t,e,n){var r=t("dsv").csv.parse;e.exports=function(t){var e=r(t).reduce(function(t,e){return t[e.shape_id]=(t[e.shape_id]||[]).concat(e),t},{});return{type:"FeatureCollection",features:Object.keys(e).map(function(t){return{type:"Feature",id:t,properties:{shape_id:t},geometry:{type:"LineString",coordinates:e[t].sort(function(t,e){return+t.shape_pt_sequence-e.shape_pt_sequence}).map(function(t){return[parseFloat(t.shape_pt_lon),parseFloat(t.shape_pt_lat)]})}}})}}},{dsv:34}],34:[function(t,e,n){e.exports=new Function('dsv.version = "0.0.4";\n\ndsv.tsv = dsv("\\t");\ndsv.csv = dsv(",");\n\nfunction dsv(delimiter) {\n  var dsv = {},\n      reFormat = new RegExp("[\\"" + delimiter + "\\n]"),\n      delimiterCode = delimiter.charCodeAt(0);\n\n  dsv.parse = function(text, f) {\n    var o;\n    return dsv.parseRows(text, function(row, i) {\n      if (o) return o(row, i - 1);\n      var a = new Function("d", "return {" + row.map(function(name, i) {\n        return JSON.stringify(name) + ": d[" + i + "]";\n      }).join(",") + "}");\n      o = f ? function(row, i) { return f(a(row), i); } : a;\n    });\n  };\n\n  dsv.parseRows = function(text, f) {\n    var EOL = {}, // sentinel value for end-of-line\n        EOF = {}, // sentinel value for end-of-file\n        rows = [], // output rows\n        N = text.length,\n        I = 0, // current character index\n        n = 0, // the current line number\n        t, // the current token\n        eol; // is the current token followed by EOL?\n\n    function token() {\n      if (I >= N) return EOF; // special case: end of file\n      if (eol) return eol = false, EOL; // special case: end of line\n\n      // special case: quotes\n      var j = I;\n      if (text.charCodeAt(j) === 34) {\n        var i = j;\n        while (i++ < N) {\n          if (text.charCodeAt(i) === 34) {\n            if (text.charCodeAt(i + 1) !== 34) break;\n            ++i;\n          }\n        }\n        I = i + 2;\n        var c = text.charCodeAt(i + 1);\n        if (c === 13) {\n          eol = true;\n          if (text.charCodeAt(i + 2) === 10) ++I;\n        } else if (c === 10) {\n          eol = true;\n        }\n        return text.slice(j + 1, i).replace(/""/g, "\\"");\n      }\n\n      // common case: find next delimiter or newline\n      while (I < N) {\n        var c = text.charCodeAt(I++), k = 1;\n        if (c === 10) eol = true; // \\n\n        else if (c === 13) { eol = true; if (text.charCodeAt(I) === 10) ++I, ++k; } // \\r|\\r\\n\n        else if (c !== delimiterCode) continue;\n        return text.slice(j, I - k);\n      }\n\n      // special case: last token before EOF\n      return text.slice(j);\n    }\n\n    while ((t = token()) !== EOF) {\n      var a = [];\n      while (t !== EOL && t !== EOF) {\n        a.push(t);\n        t = token();\n      }\n      if (f && (a = f(a, n++)) == null) continue;\n      rows.push(a);\n    }\n\n    return rows;\n  };\n\n  dsv.format = function(rows) {\n    if (Array.isArray(rows[0])) return dsv.formatRows(rows); // deprecated; use formatRows\n    var fieldSet = {}, fields = [];\n\n    // Compute unique fields in order of discovery.\n    rows.forEach(function(row) {\n      for (var field in row) {\n        if (!(field in fieldSet)) {\n          fields.push(fieldSet[field] = field);\n        }\n      }\n    });\n\n    return [fields.map(formatValue).join(delimiter)].concat(rows.map(function(row) {\n      return fields.map(function(field) {\n        return formatValue(row[field]);\n      }).join(delimiter);\n    })).join("\\n");\n  };\n\n  dsv.formatRows = function(rows) {\n    return rows.map(formatRow).join("\\n");\n  };\n\n  function formatRow(row) {\n    return row.map(formatValue).join(delimiter);\n  }\n\n  function formatValue(text) {\n    return reFormat.test(text) ? "\\"" + text.replace(/\\"/g, "\\"\\"") + "\\"" : text;\n  }\n\n  return dsv;\n}\n;return dsv')()},{}],35:[function(t,e,n){n.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?i-1:0,f=n?-1:1,i=t[e+h];for(h+=f,o=i&(1<<-c)-1,i>>=-c,c+=s;0<c;o=256*o+t[e+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;0<c;a=256*a+t[e+h],h+=f,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(i?-1:1);a+=Math.pow(2,r),o-=u}return(i?-1:1)*a*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var a,s,l=8*o-i-1,u=(1<<l)-1,c=u>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,o=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(r=Math.pow(2,-a))<1&&(a--,r*=2),2<=(e+=1<=a+c?h/r:h*Math.pow(2,1-c))*r&&(a++,r/=2),u<=a+c?(s=0,a=u):1<=a+c?(s=(e*r-1)*Math.pow(2,i),a+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,i),a=0));8<=i;t[n+f]=255&s,f+=p,s/=256,i-=8);for(a=a<<i|s,l+=i;0<l;t[n+f]=255&a,f+=p,a/=256,l-=8);t[n+f-p]|=128*o}},{}],36:[function(t,e,n){function r(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}e.exports=function(t){return null!=t&&(r(t)||"function"==typeof(e=t).readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))||!!t._isBuffer);var e}},{}],37:[function(i,o,a){!function(e){(t={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(t,e,n,r,i,o,a){var s=o.length-1;switch(i){case 1:this.$=t.replace(/\\(\\|")/g,"$1").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(t);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=o[s-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:this.$=o[s-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[o[s-2],o[s]];break;case 16:this.$={},this.$[o[s][0]]=o[s][1];break;case 17:this.$=o[s-2],o[s-2][o[s][0]]=o[s][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 19:this.$=o[s-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[o[s]];break;case 21:this.$=o[s-2],o[s-2].push(o[s])}},table:[{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],12:1,13:2,15:7,16:8,17:[1,14],23:[1,15]},{1:[3]},{14:[1,16]},{14:[2,7],18:[2,7],22:[2,7],24:[2,7]},{14:[2,8],18:[2,8],22:[2,8],24:[2,8]},{14:[2,9],18:[2,9],22:[2,9],24:[2,9]},{14:[2,10],18:[2,10],22:[2,10],24:[2,10]},{14:[2,11],18:[2,11],22:[2,11],24:[2,11]},{14:[2,12],18:[2,12],22:[2,12],24:[2,12]},{14:[2,3],18:[2,3],22:[2,3],24:[2,3]},{14:[2,4],18:[2,4],22:[2,4],24:[2,4]},{14:[2,5],18:[2,5],22:[2,5],24:[2,5]},{14:[2,1],18:[2,1],21:[2,1],22:[2,1],24:[2,1]},{14:[2,2],18:[2,2],22:[2,2],24:[2,2]},{3:20,4:[1,12],18:[1,17],19:18,20:19},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:23,15:7,16:8,17:[1,14],23:[1,15],24:[1,21],25:22},{1:[2,6]},{14:[2,13],18:[2,13],22:[2,13],24:[2,13]},{18:[1,24],22:[1,25]},{18:[2,16],22:[2,16]},{21:[1,26]},{14:[2,18],18:[2,18],22:[2,18],24:[2,18]},{22:[1,28],24:[1,27]},{22:[2,20],24:[2,20]},{14:[2,14],18:[2,14],22:[2,14],24:[2,14]},{3:20,4:[1,12],20:29},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:30,15:7,16:8,17:[1,14],23:[1,15]},{14:[2,19],18:[2,19],22:[2,19],24:[2,19]},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:31,15:7,16:8,17:[1,14],23:[1,15]},{18:[2,17],22:[2,17]},{18:[2,15],22:[2,15]},{22:[2,21],24:[2,21]}],defaultActions:{16:[2,6]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){var e=this,n=[0],r=[null],i=[],o=this.table,a="",s=0,l=0,u=0,c=1,h=(this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,void 0===(this.yy.parser=this).lexer.yylloc&&(this.lexer.yylloc={}),this.lexer.yylloc),f=(i.push(h),this.lexer.options&&this.lexer.options.ranges);"function"==typeof this.yy.parseError?this.parseError=this.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var p,d,g,m,y,b,v,w={};;){if(g=n[n.length-1],void 0===(m=this.defaultActions[g]||(null==p&&(_=void 0,p=_="number"!=typeof(_=e.lexer.lex()||c)&&e.symbols_[_]||_),o[g]&&o[g][p]))||!m.length||!m[0]){var _="",x=[];for(y in o[g])this.terminals_[y]&&2<y&&x.push("'"+this.terminals_[y]+"'");_=this.lexer.showPosition?"Parse error on line "+(s+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(s+1)+": Unexpected "+(p==c?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(_,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:h,expected:x})}if(m[0]instanceof Array&&1<m.length)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+p);switch(m[0]){case 1:n.push(p),r.push(this.lexer.yytext),i.push(this.lexer.yylloc),n.push(m[1]),p=null,d?(p=d,d=null):(l=this.lexer.yyleng,a=this.lexer.yytext,s=this.lexer.yylineno,h=this.lexer.yylloc,0<u&&u--);break;case 2:if(b=this.productions_[m[1]][1],w.$=r[r.length-b],w._$={first_line:i[i.length-(b||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(b||1)].first_column,last_column:i[i.length-1].last_column},f&&(w._$.range=[i[i.length-(b||1)].range[0],i[i.length-1].range[1]]),void 0!==(v=this.performAction.call(w,a,l,s,this.yy,m[1],r,i)))return v;b&&(n=n.slice(0,-1*b*2),r=r.slice(0,-1*b),i=i.slice(0,-1*b)),n.push(this.productions_[m[1]][0]),r.push(w.$),i.push(w._$),v=o[n[n.length-2]][n[n.length-1]],n.push(v);break;case 3:return!0}}return!0}}).lexer={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g),t=(this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e,this.match.split(/(?:\r\n?|\n)/g)),r=(this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1),this.yylloc.range);return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===t.length?this.yylloc.first_column:0)+t[t.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),(n=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack)for(var i in r)this[i]=r[i];return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var t,e,n,r,i=this._currentRules(),o=0;o<i.length;o++)if((n=this._input.match(this.rules[i[o]]))&&(!e||n[0].length>e[0].length))if(e=n,r=o,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,i[o])))return t;if(!this._backtrack)return!1;e=!1}else if(!this.options.flex)break;return e?!1!==(t=this.test_match(e,i[r]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL).rules},topState:function(t){return 0<=(t=this.conditionStack.length-1-Math.abs(t||0))?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n,r){switch(n){case 0:break;case 1:return 6;case 2:return e.yytext=e.yytext.substr(1,e.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};var t,n=new((r.prototype=t).Parser=r);function r(){this.yy={}}void 0!==i&&void 0!==a&&(a.parser=n,a.Parser=n.Parser,a.parse=function(){return n.parse.apply(n,arguments)},a.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),e.exit(1));t=i("fs").readFileSync(i("path").normalize(t[1]),"utf8");return a.parser.parse(t)},void 0!==o&&i.main===o&&a.main(e.argv.slice(1)))}.call(this,i("_process"))},{_process:88,fs:8,path:85}],38:[function(t,e,n){"use strict";var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(t,e){for(var n,r,i,o,a,s,l="",u=0;u<t.length;)i=(n=t.charCodeAt(u++))>>2,o=(3&n)<<4|(n=t.charCodeAt(u++))>>4,a=(15&n)<<2|(r=t.charCodeAt(u++))>>6,s=63&r,isNaN(n)?a=s=64:isNaN(r)&&(s=64),l=l+c.charAt(i)+c.charAt(o)+c.charAt(a)+c.charAt(s);return l},n.decode=function(t,e){var n,r,i,o,a,s,l="",u=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<t.length;)i=c.indexOf(t.charAt(u++)),n=(15&(o=c.indexOf(t.charAt(u++))))<<4|(a=c.indexOf(t.charAt(u++)))>>2,r=(3&a)<<6|(s=c.indexOf(t.charAt(u++))),l+=String.fromCharCode(i<<2|o>>4),64!=a&&(l+=String.fromCharCode(n)),64!=s&&(l+=String.fromCharCode(r));return l}},{}],39:[function(t,e,n){"use strict";function r(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}r.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},e.exports=r},{}],40:[function(t,e,n){"use strict";n.STORE={magic:"\0\0",compress:function(t,e){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},n.DEFLATE=t("./flate")},{"./flate":45}],41:[function(t,e,n){"use strict";var a=t("./utils"),s=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];e.exports=function(t,e){if(void 0===t||!t.length)return 0;var n,r="string"!==a.getTypeOf(t);void 0===e&&(e=0);e^=-1;for(var i=0,o=t.length;i<o;i++)n=r?t[i]:t.charCodeAt(i),e=e>>>8^s[255&(e^n)];return-1^e}},{"./utils":58}],42:[function(t,e,n){"use strict";var r=t("./utils");function i(t){this.data=null,this.length=0,this.index=0}i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,n=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)n=(n<<8)+this.byteAt(e);return this.index+=t,n},readString:function(t){return r.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}},e.exports=i},{"./utils":58}],43:[function(t,e,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!1,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],44:[function(t,e,n){"use strict";var r=t("./utils");n.string2binary=function(t){return r.string2binary(t)},n.string2Uint8Array=function(t){return r.transformTo("uint8array",t)},n.uint8Array2String=function(t){return r.transformTo("string",t)},n.string2Blob=function(t){t=r.transformTo("arraybuffer",t);return r.arrayBuffer2Blob(t)},n.arrayBuffer2Blob=function(t){return r.arrayBuffer2Blob(t)},n.transformTo=function(t,e){return r.transformTo(t,e)},n.getTypeOf=function(t){return r.getTypeOf(t)},n.checkSupport=function(t){return r.checkSupport(t)},n.MAX_VALUE_16BITS=r.MAX_VALUE_16BITS,n.MAX_VALUE_32BITS=r.MAX_VALUE_32BITS,n.pretty=function(t){return r.pretty(t)},n.findCompression=function(t){return r.findCompression(t)},n.isRegExp=function(t){return r.isRegExp(t)}},{"./utils":58}],45:[function(t,e,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=t("pako");n.uncompressInputType=r?"uint8array":"array",n.compressInputType=r?"uint8array":"array",n.magic="\b\0",n.compress=function(t,e){return i.deflateRaw(t,{level:e.level||-1})},n.uncompress=function(t){return i.inflateRaw(t)}},{pako:69}],46:[function(t,e,n){"use strict";var r=t("./base64");function i(t,e){if(!(this instanceof i))return new i(t,e);this.files={},this.comment=null,this.root="",t&&this.load(t,e),this.clone=function(){var t,e=new i;for(t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(i.prototype=t("./object")).load=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.utils=t("./deprecatedPublicUtils"),i.base64={encode:function(t){return r.encode(t)},decode:function(t){return r.decode(t)}},i.compressions=t("./compressions"),e.exports=i},{"./base64":38,"./compressions":40,"./defaults":43,"./deprecatedPublicUtils":44,"./load":47,"./object":50,"./support":54}],47:[function(t,e,n){"use strict";var o=t("./base64"),a=t("./zipEntries");e.exports=function(t,e){var n,r,i;for((e=e||{}).base64&&(t=o.decode(t)),n=(t=new a(t,e)).files,r=0;r<n.length;r++)i=n[r],this.file(i.fileName,i.decompressed,{binary:!0,optimizedBinaryString:!0,date:i.date,dir:i.dir,comment:i.fileComment.length?i.fileComment:null,unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions,createFolders:e.createFolders});return t.zipComment.length&&(this.comment=t.zipComment),this}},{"./base64":38,"./zipEntries":59}],48:[function(t,e,n){!function(n){"use strict";e.exports=function(t,e){return new n(t,e)},e.exports.test=function(t){return n.isBuffer(t)}}.call(this,t("buffer").Buffer)},{buffer:9}],49:[function(t,e,n){"use strict";t=t("./uint8ArrayReader");function r(t){this.data=t,this.length=this.data.length,this.index=0}(r.prototype=new t).readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=r},{"./uint8ArrayReader":55}],50:[function(t,e,n){"use strict";function r(t){var e;return t._data instanceof c&&(t._data=t._data.getContent(),t.options.binary=!0,t.options.base64=!1,"uint8array"===m.getTypeOf(t._data)&&(e=t._data,t._data=new Uint8Array(e.length),0!==e.length&&t._data.set(e,0))),t._data}function o(t){var e=r(t);return"string"===m.getTypeOf(e)?!t.options.binary&&l.nodebuffer?h(e,"utf-8"):t.asBinary():e}function i(t){var e=r(this);return null==e?"":(this.options.base64&&(e=v.decode(e)),e=t&&this.options.binary?I.utf8decode(e):m.transformTo("string",e),t||this.options.binary?e:m.transformTo("string",I.utf8encode(e)))}function a(t,e,n){this.name=t,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=e,this.options=n,this._initialMetadata={dir:n.dir,date:n.date}}function d(t,e){for(var n="",r=0;r<e;r++)n+=String.fromCharCode(255&t),t>>>=8;return n}function s(t,e){return e=void 0!==e&&e,t=E(t),this.files[t]||f.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]}function p(t,e,n){var r,i=new c;return t._data instanceof c?(i.uncompressedSize=t._data.uncompressedSize,i.crc32=t._data.crc32,0===i.uncompressedSize||t.dir?(e=w.STORE,i.compressedContent="",i.crc32=0):t._data.compressionMethod===e.magic?i.compressedContent=t._data.getCompressedContent():(r=t._data.getContent(),i.compressedContent=e.compress(m.transformTo(e.compressInputType,r),n))):((r=o(t))&&0!==r.length&&!t.dir||(e=w.STORE,r=""),i.uncompressedSize=r.length,i.crc32=y(r),i.compressedContent=e.compress(m.transformTo(e.compressInputType,r),n)),i.compressedSize=i.compressedContent.length,i.compressionMethod=e.magic,i}function g(t,e,n,r,i){n.compressedContent;var o=m.transformTo("string",_.utf8encode(e.name)),a=e.comment||"",s=m.transformTo("string",_.utf8encode(a)),l=o.length!==e.name.length,a=s.length!==a.length,u=e.options,c="",h=(e._initialMetadata.dir!==e.dir?e:u).dir,u=(e._initialMetadata.date!==e.date?e:u).date,f=0,p=0,e=(h&&(f|=16),"UNIX"===i?(p=798,f|=(i=e.unixPermissions,h=h,(65535&(i?i:h?16893:33204))<<16)):(p=20,f|=63&(e.dosPermissions||0)),i=u.getHours(),i=(i=((i<<=6)|u.getMinutes())<<5)|u.getSeconds()/2,h=u.getFullYear()-1980,h=(h=((h<<=4)|u.getMonth()+1)<<5)|u.getDate(),l&&(e=d(1,1)+d(y(o),4)+o,c+="up"+d(e.length,2)+e),a&&(u=d(1,1)+d(this.crc32(s),4)+s,c+="uc"+d(u.length,2)+u),""),e=(e=(e=(e=(e=(e=(e=(e=(e+="\n\0")+(l||a?"\0\b":"\0\0")+n.compressionMethod)+d(i,2))+d(h,2))+d(n.crc32,4))+d(n.compressedSize,4))+d(n.uncompressedSize,4))+d(o.length,2))+d(c.length,2);return{fileRecord:b.LOCAL_FILE_HEADER+e+o+c,dirRecord:b.CENTRAL_FILE_HEADER+d(p,2)+e+d(s.length,2)+"\0\0\0\0"+d(f,4)+d(r,4)+o+c+s,compressedObject:n}}var l=t("./support"),m=t("./utils"),y=t("./crc32"),b=t("./signature"),u=t("./defaults"),v=t("./base64"),w=t("./compressions"),c=t("./compressedObject"),h=t("./nodeBuffer"),_=t("./utf8"),x=t("./stringWriter"),k=t("./uint8ArrayWriter"),S=(a.prototype={asText:function(){return i.call(this,!0)},asBinary:function(){return i.call(this,!1)},asNodeBuffer:function(){var t=o(this);return m.transformTo("nodebuffer",t)},asUint8Array:function(){var t=o(this);return m.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}},function(){for(var t,e={},n=0;n<arguments.length;n++)for(t in arguments[n])arguments[n].hasOwnProperty(t)&&void 0===e[t]&&(e[t]=arguments[n][t]);return e}),f=function(t,e,n){var r=m.getTypeOf(e);if(!0!==(i=(i=n)||{}).base64||null!==i.binary&&void 0!==i.binary||(i.binary=!0),(i=S(i,u)).date=i.date||new Date,null!==i.compression&&(i.compression=i.compression.toUpperCase()),"string"==typeof(n=i).unixPermissions&&(n.unixPermissions=parseInt(n.unixPermissions,8)),n.unixPermissions&&16384&n.unixPermissions&&(n.dir=!0),n.dosPermissions&&16&n.dosPermissions&&(n.dir=!0),n.dir&&(t=E(t)),n.createFolders&&(i=function(t){if(t.slice(-1)=="/")t=t.substring(0,t.length-1);var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""}(t))&&s.call(this,i,!0),n.dir||null==e)n.base64=!1,n.binary=!1,r=e=null;else if("string"===r)n.binary&&!n.base64&&!0!==n.optimizedBinaryString&&(e=m.string2binary(e));else{if(n.base64=!1,n.binary=!0,!(r||e instanceof c))throw new Error("The data of '"+t+"' is in an unsupported format !");"arraybuffer"===r&&(e=m.transformTo("uint8array",e))}var i=new a(t,e,n);return this.files[t]=i},E=function(t){return"/"!=t.slice(-1)&&(t+="/"),t},I={load:function(t,e){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(t){var e,n,r,i=[];for(e in this.files)this.files.hasOwnProperty(e)&&(r=this.files[e],r=new a(r.name,r._data,S(r.options)),n=e.slice(this.root.length,e.length),e.slice(0,this.root.length)===this.root&&t(n,r)&&i.push(r));return i},file:function(n,t,e){var r;return 1===arguments.length?m.isRegExp(n)?(r=n,this.filter(function(t,e){return!e.dir&&r.test(t)})):this.filter(function(t,e){return!e.dir&&t===n})[0]||null:(n=this.root+n,f.call(this,n,t,e),this)},folder:function(n){var t,e;return n?m.isRegExp(n)?this.filter(function(t,e){return e.dir&&n.test(t)}):(t=this.root+n,t=s.call(this,t),(e=this.clone()).root=t.name,e):this},remove:function(n){n=this.root+n;var t=this.files[n];if(t||("/"!=n.slice(-1)&&(n+="/"),t=this.files[n]),t&&!t.dir)delete this.files[n];else for(var e=this.filter(function(t,e){return e.name.slice(0,n.length)===n}),r=0;r<e.length;r++)delete this.files[e[r].name];return this},generate:function(t){t=S(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip"}),m.checkSupport(t.type),"darwin"!==t.platform&&"freebsd"!==t.platform&&"linux"!==t.platform&&"sunos"!==t.platform||(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var e,n=[],r=0,i=0,o=m.transformTo("string",this.utf8encode(t.comment||this.comment||""));for(e in this.files)if(this.files.hasOwnProperty(e)){var a=this.files[e],s=a.options.compression||t.compression.toUpperCase(),l=w[s];if(!l)throw new Error(s+" is not a valid compression method !");s=a.options.compressionOptions||t.compressionOptions||{},l=p.call(this,a,l,s),s=g.call(this,e,a,l,r,t.platform);r+=s.fileRecord.length+l.compressedSize,i+=s.dirRecord.length,n.push(s)}for(var o=b.CENTRAL_DIRECTORY_END+"\0\0\0\0"+d(n.length,2)+d(n.length,2)+d(i,4)+d(r,4)+d(o.length,2)+o,u=t.type.toLowerCase(),c=new("uint8array"===u||"arraybuffer"===u||"blob"===u||"nodebuffer"===u?k:x)(r+i+o.length),h=0;h<n.length;h++)c.append(n[h].fileRecord),c.append(n[h].compressedObject.compressedContent);for(h=0;h<n.length;h++)c.append(n[h].dirRecord);c.append(o);var f=c.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return m.transformTo(t.type.toLowerCase(),f);case"blob":return m.arrayBuffer2Blob(m.transformTo("arraybuffer",f),t.mimeType);case"base64":return t.base64?v.encode(f):f;default:return f}},crc32:function(t,e){return y(t,e)},utf8encode:function(t){return m.transformTo("string",_.utf8encode(t))},utf8decode:function(t){return _.utf8decode(t)}};e.exports=I},{"./base64":38,"./compressedObject":39,"./compressions":40,"./crc32":41,"./defaults":43,"./nodeBuffer":48,"./signature":51,"./stringWriter":53,"./support":54,"./uint8ArrayWriter":56,"./utf8":57,"./utils":58}],51:[function(t,e,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],52:[function(t,e,n){"use strict";var r=t("./dataReader"),i=t("./utils");function o(t,e){this.data=t,e||(this.data=i.string2binary(this.data)),this.length=this.data.length,this.index=0}(o.prototype=new r).byteAt=function(t){return this.data.charCodeAt(t)},o.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)},o.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=o},{"./dataReader":42,"./utils":58}],53:[function(t,e,n){"use strict";function r(){this.data=[]}var i=t("./utils");r.prototype={append:function(t){t=i.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}},e.exports=r},{"./utils":58}],54:[function(t,e,r){!function(e){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer=void 0!==e,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{e=new ArrayBuffer(0);try{r.blob=0===new Blob([e],{type:"application/zip"}).size}catch(t){try{var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);n.append(e),r.blob=0===n.getBlob("application/zip").size}catch(t){r.blob=!1}}}}.call(this,t("buffer").Buffer)},{buffer:9}],55:[function(t,e,n){"use strict";t=t("./dataReader");function r(t){t&&(this.data=t,this.length=this.data.length,this.index=0)}(r.prototype=new t).byteAt=function(t){return this.data[t]},r.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),n=t.charCodeAt(1),r=t.charCodeAt(2),i=t.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===e&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===i)return o;return-1},r.prototype.readData=function(t){var e;return this.checkOffset(t),0===t?new Uint8Array(0):(e=this.data.subarray(this.index,this.index+t),this.index+=t,e)},e.exports=r},{"./dataReader":42}],56:[function(t,e,n){"use strict";function r(t){this.data=new Uint8Array(t),this.index=0}var i=t("./utils");r.prototype={append:function(t){0!==t.length&&(t=i.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}},e.exports=r},{"./utils":58}],57:[function(t,e,n){"use strict";for(var s=t("./utils"),u=t("./support"),c=t("./nodeBuffer"),l=new Array(256),r=0;r<256;r++)l[r]=252<=r?6:248<=r?5:240<=r?4:224<=r?3:192<=r?2:1;l[254]=l[254]=1;function o(t){for(var e,n,r=t.length,i=new Array(2*r),o=0,a=0;a<r;)if((e=t[a++])<128)i[o++]=e;else if(4<(n=l[e]))i[o++]=65533,a+=n-1;else{for(e&=2===n?31:3===n?15:7;1<n&&a<r;)e=e<<6|63&t[a++],n--;1<n?i[o++]=65533:e<65536?i[o++]=e:(e-=65536,i[o++]=55296|e>>10&1023,i[o++]=56320|1023&e)}return i.length!==o&&(i.subarray?i=i.subarray(0,o):i.length=o),s.applyFromCharCode(i)}n.utf8encode=function(t){if(u.nodebuffer)return c(t,"utf-8");for(var e,n,r,i,o=t,a=o.length,s=0,l=0;l<a;l++)55296==(64512&(n=o.charCodeAt(l)))&&l+1<a&&56320==(64512&(r=o.charCodeAt(l+1)))&&(n=65536+(n-55296<<10)+(r-56320),l++),s+=n<128?1:n<2048?2:n<65536?3:4;for(e=new(u.uint8array?Uint8Array:Array)(s),l=i=0;i<s;l++)55296==(64512&(n=o.charCodeAt(l)))&&l+1<a&&56320==(64512&(r=o.charCodeAt(l+1)))&&(n=65536+(n-55296<<10)+(r-56320),l++),n<128?e[i++]=n:(n<2048?e[i++]=192|n>>>6:(n<65536?e[i++]=224|n>>>12:(e[i++]=240|n>>>18,e[i++]=128|n>>>12&63),e[i++]=128|n>>>6&63),e[i++]=128|63&n);return e},n.utf8decode=function(t){if(u.nodebuffer)return s.transformTo("nodebuffer",t).toString("utf-8");for(var e=[],n=0,r=(t=s.transformTo(u.uint8array?"uint8array":"array",t)).length;n<r;){var i=function(t,e){for(var n=(e=(e=e||t.length)>t.length?t.length:e)-1;0<=n&&128==(192&t[n]);)n--;return!(n<0)&&0!==n&&n+l[t[n]]>e?n:e}(t,Math.min(n+65536,r));u.uint8array?e.push(o(t.subarray(n,i))):e.push(o(t.slice(n,i))),n=i}return e.join("")}},{"./nodeBuffer":48,"./support":54,"./utils":58}],58:[function(t,e,u){"use strict";var n=t("./support"),r=t("./compressions"),c=t("./nodeBuffer");function i(t){return t}function o(t,e){for(var n=0;n<t.length;++n)e[n]=255&t.charCodeAt(n);return e}function a(t){var e=65536,n=[],r=t.length,i=u.getTypeOf(t),o=0,a=!0;try{switch(i){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,c(0))}}catch(t){a=!1}if(!a){for(var s="",l=0;l<t.length;l++)s+=String.fromCharCode(t[l]);return s}for(;o<r&&1<e;)try{n.push("array"===i||"nodebuffer"===i?String.fromCharCode.apply(null,t.slice(o,Math.min(o+e,r))):String.fromCharCode.apply(null,t.subarray(o,Math.min(o+e,r)))),o+=e}catch(t){e=Math.floor(e/2)}return n.join("")}function s(t,e){for(var n=0;n<t.length;n++)e[n]=t[n];return e}u.string2binary=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(255&t.charCodeAt(n));return e},u.arrayBuffer2Blob=function(e,n){u.checkSupport("blob"),n=n||"application/zip";try{return new Blob([e],{type:n})}catch(t){try{var r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return r.append(e),r.getBlob(n)}catch(t){throw new Error("Bug : can't construct the Blob.")}}},u.applyFromCharCode=a;var l={};l.string={string:i,array:function(t){return o(t,new Array(t.length))},arraybuffer:function(t){return l.string.uint8array(t).buffer},uint8array:function(t){return o(t,new Uint8Array(t.length))},nodebuffer:function(t){return o(t,c(t.length))}},l.array={string:a,array:i,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return c(t)}},l.arraybuffer={string:function(t){return a(new Uint8Array(t))},array:function(t){return s(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:i,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return c(new Uint8Array(t))}},l.uint8array={string:a,array:function(t){return s(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:i,nodebuffer:function(t){return c(t)}},l.nodebuffer={string:a,array:function(t){return s(t,new Array(t.length))},arraybuffer:function(t){return l.nodebuffer.uint8array(t).buffer},uint8array:function(t){return s(t,new Uint8Array(t.length))},nodebuffer:i},u.transformTo=function(t,e){if(e=e||"",!t)return e;u.checkSupport(t);var n=u.getTypeOf(e);return l[n][t](e)},u.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":n.nodebuffer&&c.test(t)?"nodebuffer":n.uint8array&&t instanceof Uint8Array?"uint8array":n.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},u.checkSupport=function(t){if(!n[t.toLowerCase()])throw new Error(t+" is not supported by this browser")},u.MAX_VALUE_16BITS=65535,u.MAX_VALUE_32BITS=-1,u.pretty=function(t){for(var e,n="",r=0;r<(t||"").length;r++)n+="\\x"+((e=t.charCodeAt(r))<16?"0":"")+e.toString(16).toUpperCase();return n},u.findCompression=function(t){for(var e in r)if(r.hasOwnProperty(e)&&r[e].magic===t)return r[e];return null},u.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}},{"./compressions":40,"./nodeBuffer":48,"./support":54}],59:[function(t,e,n){"use strict";var r=t("./stringReader"),i=t("./nodeBufferReader"),o=t("./uint8ArrayReader"),a=t("./utils"),s=t("./signature"),l=t("./zipEntry"),u=t("./support"),c=t("./object");function h(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}h.prototype={checkSignature:function(t){var e=this.reader.readString(4);if(e!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+a.pretty(e)+", expected "+a.pretty(t)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=c.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,n,r=this.zip64EndOfCentralSize-44;0<r;)t=this.reader.readInt(2),e=this.reader.readInt(4),n=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){for(var t,e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===s.CENTRAL_FILE_HEADER;)(t=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(-1===t){var e=!0;try{this.reader.setIndex(0),this.checkSignature(s.LOCAL_FILE_HEADER),e=!1}catch(t){}throw e?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory")}if(this.reader.setIndex(t),this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,-1===(t=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(t),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(t){var e=a.getTypeOf(t);"string"!==e||u.uint8array?this.reader="nodebuffer"===e?new i(t):new o(a.transformTo("uint8array",t)):this.reader=new r(t,this.loadOptions.optimizedBinaryString)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=h},{"./nodeBufferReader":49,"./object":50,"./signature":51,"./stringReader":52,"./support":54,"./uint8ArrayReader":55,"./utils":58,"./zipEntry":60}],60:[function(t,e,n){"use strict";var r=t("./stringReader"),o=t("./utils"),i=t("./compressedObject"),a=t("./object");function s(t,e){this.options=t,this.loadOptions=e}s.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(n,r,i){return function(){var t=n.index,e=(n.setIndex(r),n.readData(i));return n.setIndex(t),e}},prepareContent:function(t,e,n,r,i){return function(){var t=o.transformTo(r.uncompressInputType,this.getCompressedContent()),t=r.uncompress(t);if(t.length!==i)throw new Error("Bug : uncompressed data size mismatch");return t}},readLocalPart:function(t){var e;if(t.skip(22),this.fileNameLength=t.readInt(2),e=t.readInt(2),this.fileName=t.readString(this.fileNameLength),t.skip(e),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(e=o.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new i,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,e),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,e,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=o.transformTo("string",this.decompressed.getContent()),a.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readString(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readString(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileName.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){var e;this.extraFields[1]&&(e=new r(this.extraFields[1].value),this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4)))},readExtraFields:function(t){var e,n,r,i=t.index;for(this.extraFields=this.extraFields||{};t.index<i+this.extraFieldsLength;)e=t.readInt(2),n=t.readInt(2),r=t.readString(n),this.extraFields[e]={id:e,length:n,value:r}},handleUTF8:function(){var t;this.useUTF8()?(this.fileName=a.utf8decode(this.fileName),this.fileComment=a.utf8decode(this.fileComment)):(null!==(t=this.findExtraFieldUnicodePath())&&(this.fileName=t),null!==(t=this.findExtraFieldUnicodeComment())&&(this.fileComment=t))},findExtraFieldUnicodePath:function(){var t,e=this.extraFields[28789];return!e||1!==(t=new r(e.value)).readInt(1)||a.crc32(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readString(e.length-5))},findExtraFieldUnicodeComment:function(){var t,e=this.extraFields[25461];return!e||1!==(t=new r(e.value)).readInt(1)||a.crc32(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readString(e.length-5))}},e.exports=s},{"./compressedObject":39,"./object":50,"./stringReader":52,"./utils":58}],61:[function(t,e,n){var a=t("spherical"),r=t("geojson-area");e.exports.circle=function(e,r,t){e=L.latLng(e);var i=(t=t||{}).parts||20;function n(t){for(var e=[],n=0;n<i+1;n++)e.push(a.radial([t.lng,t.lat],n/i*360,r).reverse());return e}var o=L.polygon(n(e),t);return o.setLatLng=function(t){return e=t,o.setLatLngs(n(e)),o},o.getRadius=function(t){return r},o.setRadius=function(t){return r=t,o.setLatLngs(n(e)),o},o},e.exports.area=function(t){t=t.toGeoJSON();return r(t.geometry)}},{"geojson-area":22,spherical:103}],62:[function(t,e,n){var r,i,o;r=window,i=r.documentMode,o="onhashchange"in r&&(void 0===i||7<i),L.Hash=function(t){this.onHashChange=L.Util.bind(this.onHashChange,this),t&&this.init(t)},L.Hash.parseHash=function(t){var e,n,t=(t=0===t.indexOf("#")?t.substr(1):t).split("/");return 3==t.length&&(e=parseInt(t[0],10),n=parseFloat(t[1]),t=parseFloat(t[2]),!(isNaN(e)||isNaN(n)||isNaN(t))&&{center:new L.LatLng(n,t),zoom:e})},L.Hash.formatHash=function(t){var e=t.getCenter(),t=t.getZoom(),n=Math.max(0,Math.ceil(Math.log(t)/Math.LN2));return"#"+[t,e.lat.toFixed(n),e.lng.toFixed(n)].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(t){this.map=t,this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},removeFrom:function(t){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var t=this.formatHash(this.map);this.lastHash!=t&&(location.replace(t),this.lastHash=t)},movingMap:!1,update:function(){var t=location.hash;t!==this.lastHash&&((t=this.parseHash(t))?(this.movingMap=!0,this.map.setView(t.center,t.zoom),this.movingMap=!1):this.onMapMove(this.map))},changeDefer:100,changeTimeout:null,onHashChange:function(){var t;this.changeTimeout||((t=this).changeTimeout=setTimeout(function(){t.update(),t.changeTimeout=null},this.changeDefer))},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend",this.onMapMove,this),o?L.DomEvent.addListener(r,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend",this.onMapMove,this),o?L.DomEvent.removeListener(r,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1}},L.hash=function(t){return new L.Hash(t)},L.Map.prototype.addHash=function(){this._hash=L.hash(this)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}},{}],63:[function(t,o,a){!function(t){!function(){var c={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:e,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:e,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:e,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};function l(t){this.tokens=[],this.tokens.links={},this.options=t||p.defaults,this.rules=c.normal,this.options.gfm&&(this.options.tables?this.rules=c.tables:this.rules=c.gfm)}c.bullet=/(?:[*+-]|\d+\.)/,c.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,c.item=t(c.item,"gm")(/bull/g,c.bullet)(),c.list=t(c.list)(/bull/g,c.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+c.def.source+")")(),c.blockquote=t(c.blockquote)("def",c.def)(),c._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",c.html=t(c.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,c._tag)(),c.paragraph=t(c.paragraph)("hr",c.hr)("heading",c.heading)("lheading",c.lheading)("blockquote",c.blockquote)("tag","<"+c._tag)("def",c.def)(),c.normal=f({},c),c.gfm=f({},c.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/}),c.gfm.paragraph=t(c.paragraph)("(?!","(?!"+c.gfm.fences.source.replace("\\1","\\2")+"|"+c.list.source.replace("\\1","\\3")+"|")(),c.tables=f({},c.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),l.rules=c,l.lex=function(t,e){return new l(e).lex(t)},l.prototype.lex=function(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(t,!0)},l.prototype.token=function(t,e,n){for(var r,i,o,a,s,l,u,t=t.replace(/^ +$/gm,"");t;)if((i=this.rules.newline.exec(t))&&(t=t.substring(i[0].length),1<i[0].length&&this.tokens.push({type:"space"})),i=this.rules.code.exec(t))t=t.substring(i[0].length),i=i[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?i:i.replace(/\n+$/,"")});else if(i=this.rules.fences.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"code",lang:i[2],text:i[3]});else if(i=this.rules.heading.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"heading",depth:i[1].length,text:i[2]});else if(e&&(i=this.rules.nptable.exec(t))){for(t=t.substring(i[0].length),a={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/\n$/,"").split("\n")},l=0;l<a.align.length;l++)/^ *-+: *$/.test(a.align[l])?a.align[l]="right":/^ *:-+: *$/.test(a.align[l])?a.align[l]="center":/^ *:-+ *$/.test(a.align[l])?a.align[l]="left":a.align[l]=null;for(l=0;l<a.cells.length;l++)a.cells[l]=a.cells[l].split(/ *\| */);this.tokens.push(a)}else if(i=this.rules.lheading.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"heading",depth:"="===i[2]?1:2,text:i[1]});else if(i=this.rules.hr.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"hr"});else if(i=this.rules.blockquote.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"blockquote_start"}),i=i[0].replace(/^ *> ?/gm,""),this.token(i,e,!0),this.tokens.push({type:"blockquote_end"});else if(i=this.rules.list.exec(t)){for(t=t.substring(i[0].length),o=i[2],this.tokens.push({type:"list_start",ordered:1<o.length}),r=!1,u=(i=i[0].match(this.rules.item)).length,l=0;l<u;l++)s=(a=i[l]).length,~(a=a.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(s-=a.length,a=this.options.pedantic?a.replace(/^ {1,4}/gm,""):a.replace(new RegExp("^ {1,"+s+"}","gm"),"")),!this.options.smartLists||l===u-1||o===(s=c.bullet.exec(i[l+1])[0])||1<o.length&&1<s.length||(t=i.slice(l+1).join("\n")+t,l=u-1),s=r||/\n\n(?!\s*$)/.test(a),l!==u-1&&(r="\n"===a.charAt(a.length-1),s=s||r),this.tokens.push({type:s?"loose_item_start":"list_item_start"}),this.token(a,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(i=this.rules.html.exec(t))t=t.substring(i[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:"pre"===i[1]||"script"===i[1]||"style"===i[1],text:i[0]});else if(!n&&e&&(i=this.rules.def.exec(t)))t=t.substring(i[0].length),this.tokens.links[i[1].toLowerCase()]={href:i[2],title:i[3]};else if(e&&(i=this.rules.table.exec(t))){for(t=t.substring(i[0].length),a={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/(?: *\| *)?\n$/,"").split("\n")},l=0;l<a.align.length;l++)/^ *-+: *$/.test(a.align[l])?a.align[l]="right":/^ *:-+: *$/.test(a.align[l])?a.align[l]="center":/^ *:-+ *$/.test(a.align[l])?a.align[l]="left":a.align[l]=null;for(l=0;l<a.cells.length;l++)a.cells[l]=a.cells[l].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(a)}else if(e&&(i=this.rules.paragraph.exec(t)))t=t.substring(i[0].length),this.tokens.push({type:"paragraph",text:"\n"===i[1].charAt(i[1].length-1)?i[1].slice(0,-1):i[1]});else if(i=this.rules.text.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"text",text:i[0]});else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0));return this.tokens};var n={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:e,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:e,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};function r(t,e){if(this.options=e||p.defaults,this.links=t,this.rules=n.normal,this.renderer=this.options.renderer||new i,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=n.breaks:this.rules=n.gfm:this.options.pedantic&&(this.rules=n.pedantic)}function i(t){this.options=t||{}}function u(t){this.tokens=[],this.token=null,this.options=t||p.defaults,this.options.renderer=this.options.renderer||new i,this.renderer=this.options.renderer,this.renderer.options=this.options}function h(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function t(r,i){return r=r.source,i=i||"",function t(e,n){return e?(n=(n=n.source||n).replace(/(^|[^\[])\^/g,"$1"),r=r.replace(e,n),t):new RegExp(r,i)}}function e(){}function f(t){for(var e,n,r=1;r<arguments.length;r++)for(n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function p(t,n,r){if(r||"function"==typeof n){r||(r=n,n=null);var i,o=(n=f({},p.defaults,n||{})).highlight,e=0;try{i=l.lex(t,n)}catch(t){return r(t)}function a(){var t,e;try{t=u.parse(i,n)}catch(t){e=t}return n.highlight=o,e?r(e):r(null,t)}var s=i.length;if(!o||o.length<3)return a();if(delete n.highlight,!s)return a();for(;e<i.length;e++)!function(n){"code"!==n.type?--s||a():o(n.text,n.lang,function(t,e){if(null==e||e===n.text)return--s||a();n.text=e,n.escaped=!0,--s||a()})}(i[e])}else try{return n=n&&f({},p.defaults,n),u.parse(l.lex(t,n),n)}catch(t){if(t.message+="\nPlease report this to https://github.com/chjj/marked.",(n||p.defaults).silent)return"<p>An error occured:</p><pre>"+h(t.message+"",!0)+"</pre>";throw t}}n._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,n._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,n.link=t(n.link)("inside",n._inside)("href",n._href)(),n.reflink=t(n.reflink)("inside",n._inside)(),n.normal=f({},n),n.pedantic=f({},n.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),n.gfm=f({},n.normal,{escape:t(n.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:t(n.text)("]|","~]|")("|","|https?://|")()}),n.breaks=f({},n.gfm,{br:t(n.br)("{2,}","*")(),text:t(n.gfm.text)("{2,}","*")()}),r.rules=n,r.output=function(t,e,n){return new r(e,n).output(t)},r.prototype.output=function(t){for(var e,n,r,i,o="";t;)if(i=this.rules.escape.exec(t))t=t.substring(i[0].length),o+=i[1];else if(i=this.rules.autolink.exec(t))t=t.substring(i[0].length),r="@"===i[2]?(n=":"===i[1].charAt(6)?this.mangle(i[1].substring(7)):this.mangle(i[1]),this.mangle("mailto:")+n):n=h(i[1]),o+=this.renderer.link(r,null,n);else if(!this.inLink&&(i=this.rules.url.exec(t)))t=t.substring(i[0].length),r=n=h(i[1]),o+=this.renderer.link(r,null,n);else if(i=this.rules.tag.exec(t))!this.inLink&&/^<a /i.test(i[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(i[0])&&(this.inLink=!1),t=t.substring(i[0].length),o+=this.options.sanitize?h(i[0]):i[0];else if(i=this.rules.link.exec(t))t=t.substring(i[0].length),this.inLink=!0,o+=this.outputLink(i,{href:i[2],title:i[3]}),this.inLink=!1;else if((i=this.rules.reflink.exec(t))||(i=this.rules.nolink.exec(t)))t=t.substring(i[0].length),e=(i[2]||i[1]).replace(/\s+/g," "),(e=this.links[e.toLowerCase()])&&e.href?(this.inLink=!0,o+=this.outputLink(i,e),this.inLink=!1):(o+=i[0].charAt(0),t=i[0].substring(1)+t);else if(i=this.rules.strong.exec(t))t=t.substring(i[0].length),o+=this.renderer.strong(this.output(i[2]||i[1]));else if(i=this.rules.em.exec(t))t=t.substring(i[0].length),o+=this.renderer.em(this.output(i[2]||i[1]));else if(i=this.rules.code.exec(t))t=t.substring(i[0].length),o+=this.renderer.codespan(h(i[2],!0));else if(i=this.rules.br.exec(t))t=t.substring(i[0].length),o+=this.renderer.br();else if(i=this.rules.del.exec(t))t=t.substring(i[0].length),o+=this.renderer.del(this.output(i[1]));else if(i=this.rules.text.exec(t))t=t.substring(i[0].length),o+=h(this.smartypants(i[0]));else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0));return o},r.prototype.outputLink=function(t,e){var n=h(e.href),e=e.title?h(e.title):null;return"!"!==t[0].charAt(0)?this.renderer.link(n,e,this.output(t[1])):this.renderer.image(n,e,h(t[1]))},r.prototype.smartypants=function(t){return this.options.smartypants?t.replace(/--/g,"—").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):t},r.prototype.mangle=function(t){for(var e,n="",r=t.length,i=0;i<r;i++)e=t.charCodeAt(i),n+="&#"+(e=.5<Math.random()?"x"+e.toString(16):e)+";";return n},i.prototype.code=function(t,e,n){var r;return this.options.highlight&&null!=(r=this.options.highlight(t,e))&&r!==t&&(n=!0,t=r),e?'<pre><code class="'+this.options.langPrefix+h(e,!0)+'">'+(n?t:h(t,!0))+"\n</code></pre>\n":"<pre><code>"+(n?t:h(t,!0))+"\n</code></pre>"},i.prototype.blockquote=function(t){return"<blockquote>\n"+t+"</blockquote>\n"},i.prototype.html=function(t){return t},i.prototype.heading=function(t,e,n){return"<h"+e+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+t+"</h"+e+">\n"},i.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},i.prototype.list=function(t,e){e=e?"ol":"ul";return"<"+e+">\n"+t+"</"+e+">\n"},i.prototype.listitem=function(t){return"<li>"+t+"</li>\n"},i.prototype.paragraph=function(t){return"<p>"+t+"</p>\n"},i.prototype.table=function(t,e){return"<table>\n<thead>\n"+t+"</thead>\n<tbody>\n"+e+"</tbody>\n</table>\n"},i.prototype.tablerow=function(t){return"<tr>\n"+t+"</tr>\n"},i.prototype.tablecell=function(t,e){var n=e.header?"th":"td";return(e.align?"<"+n+' style="text-align:'+e.align+'">':"<"+n+">")+t+"</"+n+">\n"},i.prototype.strong=function(t){return"<strong>"+t+"</strong>"},i.prototype.em=function(t){return"<em>"+t+"</em>"},i.prototype.codespan=function(t){return"<code>"+t+"</code>"},i.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},i.prototype.del=function(t){return"<del>"+t+"</del>"},i.prototype.link=function(t,e,n){if(this.options.sanitize){try{var r=decodeURIComponent(t.replace(/&([#\w]+);/g,function(t,e){return"colon"===(e=e.toLowerCase())?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""})).replace(/[^\w:]/g,"").toLowerCase()}catch(t){return""}if(0===r.indexOf("javascript:"))return""}r='<a href="'+t+'"';return e&&(r+=' title="'+e+'"'),r+=">"+n+"</a>"},i.prototype.image=function(t,e,n){t='<img src="'+t+'" alt="'+n+'"';return e&&(t+=' title="'+e+'"'),t+=this.options.xhtml?"/>":">"},u.parse=function(t,e,n){return new u(e).parse(t)},u.prototype.parse=function(t){this.inline=new r(t.links,this.options,this.renderer),this.tokens=t.reverse();for(var e="";this.next();)e+=this.tok();return e},u.prototype.next=function(){return this.token=this.tokens.pop()},u.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},u.prototype.parseText=function(){for(var t=this.token.text;"text"===this.peek().type;)t+="\n"+this.next().text;return this.inline.output(t)},u.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":for(var t,e,n="",r="",i="",o=0;o<this.token.header.length;o++)this.token.align[o],i+=this.renderer.tablecell(this.inline.output(this.token.header[o]),{header:!0,align:this.token.align[o]});for(n+=this.renderer.tablerow(i),o=0;o<this.token.cells.length;o++){for(t=this.token.cells[o],i="",e=0;e<t.length;e++)i+=this.renderer.tablecell(this.inline.output(t[e]),{header:!1,align:this.token.align[e]});r+=this.renderer.tablerow(i)}return this.renderer.table(n,r);case"blockquote_start":for(r="";"blockquote_end"!==this.next().type;)r+=this.tok();return this.renderer.blockquote(r);case"list_start":for(var r="",n=this.token.ordered;"list_end"!==this.next().type;)r+=this.tok();return this.renderer.list(r,n);case"list_item_start":for(r="";"list_item_end"!==this.next().type;)r+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(r);case"loose_item_start":for(r="";"list_item_end"!==this.next().type;)r+=this.tok();return this.renderer.listitem(r);case"html":n=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(n);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},e.exec=e,p.options=p.setOptions=function(t){return f(p.defaults,t),p},p.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new i,xhtml:!1},p.Parser=u,p.parser=u.parse,p.Renderer=i,p.Lexer=l,p.lexer=l.lex,p.InlineLexer=r,p.inlineLexer=r.output,p.parse=p,"object"==typeof a?o.exports=p:"function"==typeof define&&define.amd?define(function(){return p}):this.marked=p}.call(function(){return this||("undefined"!=typeof window?window:t)}())}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],64:[function(t,e,n){var M=t("./lodash.custom.js"),C=t("geojson-rewind"),l=t("./polygon_features.json");e.exports=(t=function(t,L){var e,r,i,o;function a(t,e,n){t.hasAttribute(n)&&(e[n]=t.getAttribute(n))}return L=M.merge({flatProperties:!1,uninterestingTags:{source:!0,source_ref:!0,"source:ref":!0,history:!0,attribution:!0,created_by:!0,"tiger:county":!0,"tiger:tlid":!0,"tiger:upload_uuid":!0},polygonFeatures:l},L),"undefined"!=typeof XMLDocument&&t instanceof XMLDocument||"undefined"==typeof XMLDocument&&t.childNodes?(e=t,r=new Array,i=new Array,o=new Array,M.each(e.getElementsByTagName("node"),function(t,e){var n={};M.each(t.getElementsByTagName("tag"),function(t){n[t.getAttribute("k")]=t.getAttribute("v")}),r[e]={type:"node"},a(t,r[e],"id"),a(t,r[e],"lat"),a(t,r[e],"lon"),a(t,r[e],"version"),a(t,r[e],"timestamp"),a(t,r[e],"changeset"),a(t,r[e],"uid"),a(t,r[e],"user"),M.isEmpty(n)||(r[e].tags=n)}),M.each(e.getElementsByTagName("way"),function(t,e){var n={},r=[];M.each(t.getElementsByTagName("tag"),function(t){n[t.getAttribute("k")]=t.getAttribute("v")}),M.each(t.getElementsByTagName("nd"),function(t,e){r[e]=t.getAttribute("ref")}),i[e]={type:"way"},a(t,i[e],"id"),a(t,i[e],"version"),a(t,i[e],"timestamp"),a(t,i[e],"changeset"),a(t,i[e],"uid"),a(t,i[e],"user"),0<r.length&&(i[e].nodes=r),M.isEmpty(n)||(i[e].tags=n)}),M.each(e.getElementsByTagName("relation"),function(t,e){var n={},r=[];M.each(t.getElementsByTagName("tag"),function(t){n[t.getAttribute("k")]=t.getAttribute("v")}),M.each(t.getElementsByTagName("member"),function(t,e){r[e]={},a(t,r[e],"ref"),a(t,r[e],"role"),a(t,r[e],"type")}),o[e]={type:"relation"},a(t,o[e],"id"),a(t,o[e],"version"),a(t,o[e],"timestamp"),a(t,o[e],"changeset"),a(t,o[e],"uid"),a(t,o[e],"user"),0<r.length&&(o[e].members=r),M.isEmpty(n)||(o[e].tags=n)}),s(r,i,o)):function(t){for(var e=new Array,n=new Array,r=new Array,i=0;i<t.elements.length;i++)switch(t.elements[i].type){case"node":var o=t.elements[i];e.push(o);break;case"way":o=M.clone(t.elements[i]);o.nodes=M.clone(o.nodes),n.push(o);break;case"relation":var a=M.clone(t.elements[i]);a.members=M.clone(a.members),r.push(a)}return s(e,n,r)}(t);function s(t,e,n){function r(t,e){if("object"!=typeof e&&(e={}),"function"==typeof L.uninterestingTags)return!L.uninterestingTags(t,e);for(var n in t)if(!0!==L.uninterestingTags[n]&&!0!==e[n]&&e[n]!==t[n])return 1}function h(t){var e={timestamp:t.timestamp,version:t.version,changeset:t.changeset,user:t.user,uid:t.uid};for(k in e)void 0===e[k]&&delete e[k];return e}for(var i=new Object,o=0;o<t.length;o++)void 0!==t[o].lat&&(i[t[o].id]=t[o]);for(var a=new Object,o=0;o<t.length;o++)void 0!==t[o].tags&&r(t[o].tags)&&(a[t[o].id]=!0);for(o=0;o<n.length;o++)if(M.isArray(n[o].members))for(var s=0;s<n[o].members.length;s++)"node"==n[o].members[s].type&&(a[n[o].members[s].ref]=!0);for(var f=new Object,l=new Object,o=0;o<e.length;o++)if(M.isArray(e[o].nodes)){f[e[o].id]=e[o];for(s=0;s<e[o].nodes.length;s++)l[e[o].nodes[s]]=!0,e[o].nodes[s]=i[e[o].nodes[s]]}for(var u=new Array,o=0;o<t.length;o++)l[t[o].id]&&!a[t[o].id]||u.push(t[o]);for(var c=new Array,o=0;o<n.length;o++)M.isArray(n[o].members)&&(c[n[o].id]=n[o]);for(var p,d={node:{},way:{},relation:{}},o=0;o<n.length;o++)if(M.isArray(n[o].members))for(var g,m,y,s=0;s<n[o].members.length;s++){switch(n[o].members[s].type){case"node":g=i[n[o].members[s].ref];break;case"way":g=f[n[o].members[s].ref];break;case"relation":g=c[n[o].members[s].ref]}g&&(m=n[o].members[s].type,y=n[o].members[s].ref,void 0===d[m][y]&&(d[m][y]=[]),d[m][y].push({role:n[o].members[s].role,rel:n[o].id,reltags:n[o].tags}))}var b={type:"FeatureCollection",features:new Array};for(o=0;o<u.length;o++)void 0!==u[o].lon&&void 0!==u[o].lat&&b.features.push({type:"Feature",id:"node/"+u[o].id,properties:{type:"node",id:u[o].id,tags:u[o].tags||{},relations:d.node[u[o].id]||[],meta:h(u[o])},geometry:{type:"Point",coordinates:[+u[o].lon,+u[o].lat]}});for(var v={type:"FeatureCollection",features:new Array},w={type:"FeatureCollection",features:new Array},o=0;o<n.length;o++)if(void 0!==n[o].tags&&("multipolygon"==n[o].tags.type||"boundary"==n[o].tags.type)){if(M.isArray(n[o].members)){for(var _=0,s=0;s<n[o].members.length;s++)"outer"==n[o].members[s].role&&_++;if(n[o].members.forEach(function(t){f[t.ref]&&("outer"!==t.role||r(f[t.ref].tags,n[o].tags)||(f[t.ref].is_multipolygon_outline=!0),"inner"!==t.role||r(f[t.ref].tags)||(f[t.ref].is_multipolygon_outline=!0))}),0!=_){var x=!1,S=null;if(x=1!=_||r(n[o].tags,{type:!0})?x:!0){x=n[o].members.filter(function(t){return"outer"===t.role})[0];if(void 0===(x=f[x.ref]))continue;x.is_multipolygon_outline=!0,S=E(x,n[o])}else S=E(n[o],n[o]);!1!==S&&w.features.push(S)}}function E(t,e){var n=!1;function r(t){function e(t){return t[t.length-1]}for(var n,r,i,o,a,s,l=[];t.length;)for(n=t.pop().nodes.slice(),l.push(n);t.length&&n[0]!==e(n);){for(r=n[0],i=e(n),o=0;o<t.length;o++){if(i===(s=t[o].nodes)[0]){a=n.push,s=s.slice(1);break}if(i===e(s)){a=n.push,s=s.slice(0,-1).reverse();break}if(r==e(s)){a=n.unshift,s=s.slice(0,-1);break}if(r==s[0]){a=n.unshift,s=s.slice(1).reverse();break}s=a=null}if(!s)break;t.splice(o,1),a.apply(n,s)}return l}function i(t){function e(t){return t.map(function(t){return[+t.lat,+t.lon]})}var n;for(t=e(t),n=0;n<o.length;n++)if(function(t,e){for(var n=0;n<e.length;n++)if(function(t,e){for(var n=t[0],r=t[1],i=false,o=0,a=e.length-1;o<e.length;a=o++){var s=e[o][0],l=e[o][1];var u=e[a][0],c=e[a][1];var h=l>r!=c>r&&n<(u-s)*(r-l)/(c-l)+s;if(h)i=!i}return i}(e[n],t))return!0;return!1}(e(o[n]),t))return n}e=(e=e.members.filter(function(t){return"way"===t.type})).map(function(t){var e=f[t.ref];if(void 0!==e)return{id:t.ref,role:t.role||"outer",way:e,nodes:e.nodes.filter(function(t){return void 0!==t||!(n=!0)})};n=!0});for(var o=r((e=M.compact(e)).filter(function(t){return"outer"===t.role})),a=r(e.filter(function(t){return"inner"===t.role})),s=o.map(function(t){return[t]}),l=0;l<a.length;l++){var u=i(a[l]);void 0!==u&&s[u].push(a[l])}var c,e=[];return 0!=(e=M.compact(s.map(function(t){t=M.compact(t.map(function(t){if(!(t.length<4))return M.compact(t.map(function(t){return[+t.lon,+t.lat]}))}));if(0!=t.length)return t}))).length&&(c="MultiPolygon",1===e.length&&(c="Polygon",e=e[0]),t={type:"Feature",id:t.type+"/"+t.id,properties:{type:t.type,id:t.id,tags:t.tags||{},relations:d[t.type][t.id]||[],meta:h(t)},geometry:{type:c,coordinates:e}},n&&(t.properties.tainted=!0),t)}}for(var I,o=0;o<e.length;o++)if(M.isArray(e[o].nodes)&&!e[o].is_multipolygon_outline){for(e[o].tainted=!1,e[o].hidden=!1,coords=new Array,s=0;s<e[o].nodes.length;s++)"object"==typeof e[o].nodes[s]?coords.push([+e[o].nodes[s].lon,+e[o].nodes[s].lat]):e[o].tainted=!0;coords.length<=1||(I="LineString",void 0!==e[o].nodes[0]&&e[o].nodes[0]===e[o].nodes[e[o].nodes.length-1]&&void 0!==e[o].tags&&function(t){var e=L.polygonFeatures;if("function"==typeof e)return e(t);if("no"!==t.area)for(var n in t){var r=t[n],n=e[n];if(void 0!==n&&"no"!==r){if(!0===n)return 1;if(n.included_values&&!0===n.included_values[r])return 1;if(n.excluded_values&&!0!==n.excluded_values[r])return 1}}return}(e[o].tags)&&(I="Polygon",coords=[coords]),S={type:"Feature",id:"way/"+e[o].id,properties:{type:"way",id:e[o].id,tags:e[o].tags||{},relations:d.way[e[o].id]||[],meta:h(e[o])},geometry:{type:I,coordinates:coords}},e[o].tainted&&(S.properties.tainted=!0),("LineString"==I?v:w).features.push(S))}return(p={type:"FeatureCollection",features:[]}).features=p.features.concat(w.features),p.features=p.features.concat(v.features),p.features=p.features.concat(b.features),L.flatProperties&&p.features.forEach(function(t){t.properties=M.merge(t.properties.meta,t.properties.tags,{id:t.properties.type+"/"+t.properties.id})}),p=C(p,!0)}}).toGeojson=t},{"./lodash.custom.js":65,"./polygon_features.json":68,"geojson-rewind":67}],65:[function(t,Ct,At){!function(Mt){!function(){var B=[],R={},F=40,G=/\w*$/,Z=/^\s*function[ \n\r\t]+\w/,U=/\bthis\b/,D=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],i="[object Arguments]",o="[object Array]",h="[object Boolean]",f="[object Date]",W="[object Error]",e="[object Function]",p="[object Number]",a="[object Object]",d="[object RegExp]",g="[object String]",m={},J=(m[e]=!1,{configurable:!(m[i]=m[o]=m[h]=m[f]=m[p]=m[a]=m[d]=m[g]=!0),enumerable:!1,value:null,writable:!1}),s={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},l={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},H=l[typeof window]&&window||this,V=l[typeof At]&&At&&!At.nodeType&&At,t=l[typeof Ct]&&Ct&&!Ct.nodeType&&Ct,q=t&&t.exports===V&&V,n=l[typeof Mt]&&Mt;function y(){return B.pop()||[]}function Y(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function b(t){t.length=0,B.length<F&&B.push(t)}function v(t,e,n){for(var r=-1,i=(n=void 0===n?t?t.length:0:n)-(e=e||0)||0,o=Array(i<0?0:i);++r<i;)o[r]=t[e+r];return o}!n||n.global!==n&&n.window!==n||(H=n);var X=[],$=Error.prototype,u=Object.prototype,K=String.prototype,w=u.toString,Q=RegExp("^"+String(w).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),tt=Function.prototype.toString,r=j(r=Object.getPrototypeOf)&&r,_=u.hasOwnProperty,x=X.push,c=u.propertyIsEnumerable,et=X.unshift,nt=function(){try{var t={},e=j(e=Object.defineProperty)&&e,n=e(t,t,t)&&e}catch(t){}return n}(),S=j(S=Object.create)&&S,n=j(n=Array.isArray)&&n,E=j(E=Object.keys)&&E,I={},L=(I[o]=Array,I[h]=Boolean,I[f]=Date,I[e]=Function,I[a]=Object,I[p]=Number,I[d]=RegExp,I[g]=String,{});L[o]=L[f]=L[p]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},L[h]=L[g]={constructor:!0,toString:!0,valueOf:!0},L[W]=L[e]=L[d]={constructor:!0,toString:!0},L[a]={constructor:!0};for(var rt=D.length;rt--;){var M,it=D[rt];for(M in L)_.call(L,M)&&!_.call(L[M],it)&&(L[M][it]=!1)}function C(){}var A=C.support={},ot=(!function(){function t(){this.x=1}var e,n={0:1,length:1},r=[];for(e in t.prototype={valueOf:1,y:1},new t)r.push(e);for(e in arguments);A.argsClass=w.call(arguments)==i,A.argsObject=arguments.constructor==Object&&!(arguments instanceof Array),A.enumErrorProps=c.call($,"message")||c.call($,"name"),A.enumPrototypes=c.call(t,"prototype"),A.funcDecomp=!j(H.WinRTError)&&U.test(function(){return this}),A.funcNames="string"==typeof Function.name,A.nonEnumArgs=0!=e,A.nonEnumShadows=!/valueOf/.test(r),A.ownLast="x"!=r[0],A.spliceObjects=(X.splice.call(n,0,1),!n[0]),A.unindexedChars="x"[0]+Object("x")[0]!="xx";try{A.nodeClass=!(w.call(document)==a&&!({toString:0}+""))}catch(t){A.nodeClass=!0}}(1),function(t){var e="var index, iterable = "+t.firstArg+", result = "+t.init+";\nif (!iterable) return result;\n"+t.top+";",n=(t.array?(e+="\nvar length = iterable.length; index = -1;\nif ("+t.array+") {  ",A.unindexedChars&&(e+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),e+="\n  while (++index < length) {\n    "+t.loop+";\n  }\n}\nelse {  "):A.nonEnumArgs&&(e+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+t.loop+";\n    }\n  } else {  "),A.enumPrototypes&&(e+="\n  var skipProto = typeof iterable == 'function';\n  "),A.enumErrorProps&&(e+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  "),[]);if(A.enumPrototypes&&n.push('!(skipProto && index == "prototype")'),A.enumErrorProps&&n.push('!(skipErrorProps && (index == "message" || index == "name"))'),t.useHas&&t.keys)e+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",n.length&&(e+="    if ("+n.join(" && ")+") {\n  "),e+=t.loop+";    ",n.length&&(e+="\n    }"),e+="\n  }  ";else if(e+="\n  for (index in iterable) {\n",t.useHas&&n.push("hasOwnProperty.call(iterable, index)"),n.length&&(e+="    if ("+n.join(" && ")+") {\n  "),e+=t.loop+";    ",n.length&&(e+="\n    }"),e+="\n  }    ",A.nonEnumShadows){for(e+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;k<7;k++)e+="\n    index = '"+t.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",t.useHas||(e+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),e+=") {\n      "+t.loop+";\n    }      ";e+="\n  }    "}return(t.array||A.nonEnumArgs)&&(e+="\n}"),e+=t.bottom+";\nreturn result"});function at(t){var r=t[0],i=t[2],o=t[4];function a(){var t,e,n;return i&&(t=v(i),x.apply(t,arguments)),this instanceof a?(e=st(r.prototype),z(n=r.apply(e,t||arguments))?n:e):r.apply(o,t||arguments)}return ft(a,t),a}function st(t,e){return z(t)?S(t):{}}function lt(){}function ut(i,o,t){if("function"!=typeof i)return It;if(void 0===o||!("prototype"in i))return i;var e,n=i.__bindData__;if(void 0!==n||(n=(n=A.funcNames?!i.name:n)||!A.funcDecomp)||(e=tt.call(i),(n=A.funcNames?n:!Z.test(e))||(n=U.test(e),ft(i,n))),!1===n||!0!==n&&1&n[1])return i;switch(t){case 1:return function(t){return i.call(o,t)};case 2:return function(t,e){return i.call(o,t,e)};case 3:return function(t,e,n){return i.call(o,t,e,n)};case 4:return function(t,e,n,r){return i.call(o,t,e,n,r)}}return Et(i,o)}function ct(t){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=1&i,c=2&i,h=4&i,f=8&i,p=r;function d(){var t,e,n=u?s:this;return o&&(t=v(o),x.apply(t,arguments)),(a||h)&&(t=t||v(arguments),a&&x.apply(t,a),h&&t.length<l)?(i|=16,ct([r,f?i:-4&i,t,null,s,l])):(t=t||arguments,c&&(r=n[p]),this instanceof d?(n=st(r.prototype),z(e=r.apply(n,t))?e:n):r.apply(n,t))}return ft(d,t),d}function ht(t,e,n,r,i,o){var a=1&e,s=4&e,l=16&e,u=32&e;if(!(2&e)&&!N(t))throw new TypeError;l&&!n.length&&(e&=-17,l=n=!1),u&&!r.length&&(e&=-33,u=r=!1);var c=t&&t.__bindData__;return c&&!0!==c?((c=v(c))[2]&&(c[2]=v(c[2])),c[3]&&(c[3]=v(c[3])),!a||1&c[1]||(c[4]=i),!a&&1&c[1]&&(e|=8),!s||4&c[1]||(c[5]=o),l&&x.apply(c[2]||(c[2]=[]),n),u&&et.apply(c[3]||(c[3]=[]),r),c[1]|=e,ht.apply(null,c)):(1==e||17===e?at:ct)([t,e,n,r,i,o])}function P(){s.shadowedProps=D,s.array=s.bottom=s.loop=s.top="",s.init="iterable",s.useHas=!0;for(var t,e=0;t=arguments[e];e++)for(var n in t)s[n]=t[n];var r=s.args;return s.firstArg=/^[^,]+/.exec(r)[0],Function("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+r+") {\n"+ot(s)+"\n}")(ut,W,$,_,R,O,T,kt,s.keys,u,l,L,g,K,w)}function j(t){return"function"==typeof t&&Q.test(t)}S||(st=function(t){var e;return z(t)&&(lt.prototype=t,e=new lt,lt.prototype=null),e||H.Object()});var ft=nt?function(t,e){J.value=e,nt(t,"__bindData__",J)}:Lt;function pt(t){var e,r;return!(!t||w.call(t)!=a||N(e=t.constructor)&&!(e instanceof e)||!A.argsClass&&O(t)||!A.nodeClass&&Y(t))&&(A.ownLast?(wt(t,function(t,e,n){return r=_.call(n,e),!1}),!1!==r):(wt(t,function(t,e){r=e}),void 0===r||_.call(t,r)))}function O(t){return t&&"object"==typeof t&&"number"==typeof t.length&&w.call(t)==i||!1}A.argsClass||(O=function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&_.call(t,"callee")&&!c.call(t,"callee")||!1});var T=n||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&w.call(t)==o||!1},dt=P({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),n=E?function(t){return z(t)?(A.enumPrototypes&&"function"==typeof t||A.nonEnumArgs&&t.length&&O(t)?dt:E)(t):[]}:dt,gt={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3)",array:"typeof length == 'number'",keys:n,loop:"if (callback(iterable[index], index, collection) === false) return result"},mt={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:n,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},yt={top:"if (!objectTypes[typeof iterable]) return result;\n"+gt.top,array:!1},bt=P(gt),vt=P(mt,{top:mt.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"});var wt=P(gt,yt,{useHas:!1}),_t=P(gt,yt);function N(t){return"function"==typeof t}function z(t){return!(!t||!l[typeof t])}N(/x/)&&(N=function(t){return"function"==typeof t&&w.call(t)==e});var xt=r?function(t){var e,n;return!(!t||w.call(t)!=a||!A.argsClass&&O(t))&&((n=j(e=t.valueOf)&&(n=r(e))&&r(n))?t==n||r(t)==n:pt(t))}:pt;function kt(t){return"string"==typeof t||t&&"object"==typeof t&&w.call(t)==g||!1}function St(t,e,n){if(e&&void 0===n&&T(t))for(var r=-1,i=t.length;++r<i&&!1!==e(t[r],r,t););else bt(t,e,n);return t}function Et(t,e){return 2<arguments.length?ht(t,17,v(arguments,2),null,e):ht(t,1,null,null,e)}function It(t){return t}function Lt(){}C.assign=vt,C.bind=Et,C.compact=function(t){for(var e=-1,n=t?t.length:0,r=[];++e<n;){var i=t[e];i&&r.push(i)}return r},C.forEach=St,C.forIn=wt,C.forOwn=_t,C.keys=n,C.merge=function(t){var e=arguments,n=2;if(z(t)){3<(n="number"!=typeof e[2]?e.length:n)&&"function"==typeof e[n-2]?r=ut(e[--n-1],e[n--],2):2<n&&"function"==typeof e[n-1]&&(r=e[--n]);for(var r,i=v(arguments,1,n),o=-1,a=y(),s=y();++o<n;)!function l(u,t,c,h,f){(T(t)?St:_t)(t,function(t,e){var n,r,i=t,o=u[e];if(t&&((r=T(t))||xt(t))){for(var a,s=h.length;s--;)if(n=h[s]==t){o=f[s];break}n||(c&&(a=void 0!==(i=c(o,t)))&&(o=i),a||(o=r?T(o)?o:[]:xt(o)?o:{}),h.push(t),f.push(o),a||l(o,t,c,h,f))}else void 0!==(i=c&&void 0===(i=c(o,t))?t:i)&&(o=i);u[e]=o})}(t,i[o],r,a,s);b(a),b(s)}return t},C.each=St,C.extend=vt,C.clone=function(t,e,n,r){return"boolean"!=typeof e&&null!=e&&(r=n,n=e,e=!1),function n(t,r,i,o,a){if(i){var s=i(t);if(void 0!==s)return s}if(!z(t))return t;var e=w.call(t);if(!m[e]||!A.nodeClass&&Y(t))return t;var l=I[e];switch(e){case h:case f:return new l(+t);case p:case g:return new l(t);case d:return(s=l(t.source,G.exec(t))).lastIndex=t.lastIndex,s}e=T(t);if(r){for(var u=!o,c=(o=o||y(),a=a||y(),o.length);c--;)if(o[c]==t)return a[c];s=e?l(t.length):{}}else s=e?v(t):vt({},t);return e&&(_.call(t,"index")&&(s.index=t.index),_.call(t,"input")&&(s.input=t.input)),r&&(o.push(t),a.push(s),(e?bt:_t)(t,function(t,e){s[e]=n(t,r,i,o,a)}),u&&(b(o),b(a))),s}(t,e,"function"==typeof n&&ut(n,r,1))},C.identity=It,C.isArguments=O,C.isArray=T,C.isEmpty=function(t){var e=!0;if(t){var n=w.call(t),r=t.length;if(n==o||n==g||(A.argsClass?n==i:O(t))||n==a&&"number"==typeof r&&N(t.splice))return!r;_t(t,function(){return e=!1})}return e},C.isFunction=N,C.isObject=z,C.isPlainObject=xt,C.isString=kt,C.noop=Lt,C.VERSION="2.4.1",V&&t&&q&&((t.exports=C)._=C)}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],66:[function(t,e,n){arguments[4][30][0].apply(n,arguments)},{dup:30,wgs84:144}],67:[function(t,e,n){var r=t("geojson-area");function i(e,n){return function(t){return e(t,n)}}function o(t,e){return"Polygon"===t.type?t.coordinates=a(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(i(a,e))),t}function a(t,e){t[0]=s(t[0],!(e=!!e));for(var n=1;n<t.length;n++)t[n]=s(t[n],e);return t}function s(t,e){return 0<=r.ring(t)===e?t:t.reverse()}e.exports=function t(e,n){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(i(t,n)),e;case"Feature":return e.geometry=t(e.geometry,n),e;case"Polygon":case"MultiPolygon":return o(e,n);default:return e}}},{"geojson-area":66}],68:[function(t,e,n){e.exports={building:!0,highway:{included_values:{services:!0,rest_area:!0,escape:!0}},natural:{excluded_values:{coastline:!0,ridge:!0,arete:!0,tree_row:!0}},landuse:!0,waterway:{included_values:{riverbank:!0,dock:!0,boatyard:!0,dam:!0}},amenity:!0,leisure:!0,barrier:{included_values:{city_wall:!0,ditch:!0,hedge:!0,retaining_wall:!0,wall:!0,spikes:!0}},railway:{included_values:{station:!0,turntable:!0,roundhouse:!0,platform:!0}},area:!0,boundary:!0,man_made:{excluded_values:{cutline:!0,embankment:!0,pipeline:!0}},power:{included_values:{generator:!0,station:!0,sub_station:!0,transformer:!0}},place:!0,shop:!0,aeroway:{excluded_values:{taxiway:!0}},tourism:!0,historic:!0,public_transport:!0,office:!0,"building:part":!0,military:!0,ruins:!0,"area:highway":!0,craft:!0}},{}],69:[function(t,e,n){"use strict";var r={};(0,t("./lib/utils/common").assign)(r,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=r},{"./lib/deflate":70,"./lib/inflate":71,"./lib/utils/common":72,"./lib/zlib/constants":75}],70:[function(t,e,n){"use strict";var a=t("./zlib/deflate"),s=t("./utils/common"),l=t("./utils/strings"),r=t("./zlib/messages"),i=t("./zlib/zstream"),u=Object.prototype.toString;function o(t){if(!(this instanceof o))return new o(t);this.options=s.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});t=this.options;if(t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,(this.strm.avail_out=0)!==(e=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy)))throw new Error(r[e]);if(t.header&&a.deflateSetHeader(this.strm,t.header),t.dictionary){var e,t="string"==typeof t.dictionary?l.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary;if(0!==(e=a.deflateSetDictionary(this.strm,t)))throw new Error(r[e]);this._dict_set=!0}}function c(t,e){e=new o(e);if(e.push(t,!0),e.err)throw e.msg;return e.result}o.prototype.push=function(t,e){var n,r,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;r=e===~~e?e:!0===e?4:0,"string"==typeof t?i.input=l.string2buf(t):"[object ArrayBuffer]"===u.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new s.Buf8(o),i.next_out=0,i.avail_out=o),1!==(n=a.deflate(i,r))&&0!==n)return this.onEnd(n),!(this.ended=!0)}while(0!==i.avail_out&&(0!==i.avail_in||4!==r&&2!==r)||("string"===this.options.to?this.onData(l.buf2binstring(s.shrinkBuf(i.output,i.next_out))):this.onData(s.shrinkBuf(i.output,i.next_out))),(0<i.avail_in||0===i.avail_out)&&1!==n);return 4===r?(n=a.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==r||(this.onEnd(0),!(i.avail_out=0))},o.prototype.onData=function(t){this.chunks.push(t)},o.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Deflate=o,n.deflate=c,n.deflateRaw=function(t,e){return(e=e||{}).raw=!0,c(t,e)},n.gzip=function(t,e){return(e=e||{}).gzip=!0,c(t,e)}},{"./utils/common":72,"./utils/strings":73,"./zlib/deflate":77,"./zlib/messages":82,"./zlib/zstream":84}],71:[function(t,e,n){"use strict";var h=t("./zlib/inflate"),f=t("./utils/common"),p=t("./utils/strings"),d=t("./zlib/constants"),r=t("./zlib/messages"),i=t("./zlib/zstream"),o=t("./zlib/gzheader"),g=Object.prototype.toString;function a(t){if(!(this instanceof a))return new a(t);this.options=f.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options,t=(e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0,h.inflateInit2(this.strm,e.windowBits));if(t!==d.Z_OK)throw new Error(r[t]);this.header=new o,h.inflateGetHeader(this.strm,this.header)}function s(t,e){e=new a(e);if(e.push(t,!0),e.err)throw e.msg;return e.result}a.prototype.push=function(t,e){var n,r,i,o,a,s=this.strm,l=this.options.chunkSize,u=this.options.dictionary,c=!1;if(this.ended)return!1;r=e===~~e?e:!0===e?d.Z_FINISH:d.Z_NO_FLUSH,"string"==typeof t?s.input=p.binstring2buf(t):"[object ArrayBuffer]"===g.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new f.Buf8(l),s.next_out=0,s.avail_out=l),(n=h.inflate(s,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&u&&(a="string"==typeof u?p.string2buf(u):"[object ArrayBuffer]"===g.call(u)?new Uint8Array(u):u,n=h.inflateSetDictionary(this.strm,a)),n===d.Z_BUF_ERROR&&!0===c&&(n=d.Z_OK,c=!1),n!==d.Z_STREAM_END&&n!==d.Z_OK)return this.onEnd(n),!(this.ended=!0)}while(!s.next_out||0!==s.avail_out&&n!==d.Z_STREAM_END&&(0!==s.avail_in||r!==d.Z_FINISH&&r!==d.Z_SYNC_FLUSH)||("string"===this.options.to?(a=p.utf8border(s.output,s.next_out),i=s.next_out-a,o=p.buf2string(s.output,a),s.next_out=i,s.avail_out=l-i,i&&f.arraySet(s.output,s.output,a,i,0),this.onData(o)):this.onData(f.shrinkBuf(s.output,s.next_out))),0===s.avail_in&&0===s.avail_out&&(c=!0),(0<s.avail_in||0===s.avail_out)&&n!==d.Z_STREAM_END);return(r=n===d.Z_STREAM_END?d.Z_FINISH:r)===d.Z_FINISH?(n=h.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===d.Z_OK):r!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(s.avail_out=0))},a.prototype.onData=function(t){this.chunks.push(t)},a.prototype.onEnd=function(t){t===d.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Inflate=a,n.inflate=s,n.inflateRaw=function(t,e){return(e=e||{}).raw=!0,s(t,e)},n.ungzip=s},{"./utils/common":72,"./utils/strings":73,"./zlib/constants":75,"./zlib/gzheader":78,"./zlib/inflate":80,"./zlib/messages":82,"./zlib/zstream":84}],72:[function(t,e,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array,i=(n.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}}return t},n.shrinkBuf=function(t,e){if(t.length!==e){if(t.subarray)return t.subarray(0,e);t.length=e}return t},{arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){for(var e,n,r,i=0,o=0,a=t.length;o<a;o++)i+=t[o].length;for(r=new Uint8Array(i),o=e=0,a=t.length;o<a;o++)n=t[o],r.set(n,e),e+=n.length;return r}}),o={arraySet:function(t,e,n,r,i){for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};n.setTyped=function(t){t?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],73:[function(t,e,n){"use strict";var l=t("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var u=new l.Buf8(256),r=0;r<256;r++)u[r]=252<=r?6:248<=r?5:240<=r?4:224<=r?3:192<=r?2:1;function c(t,e){if(e<65537&&(t.subarray&&o||!t.subarray&&i))return String.fromCharCode.apply(null,l.shrinkBuf(t,e));for(var n="",r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n}u[254]=u[254]=1,n.string2buf=function(t){for(var e,n,r,i,o=t.length,a=0,s=0;s<o;s++)55296==(64512&(n=t.charCodeAt(s)))&&s+1<o&&56320==(64512&(r=t.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),a+=n<128?1:n<2048?2:n<65536?3:4;for(e=new l.Buf8(a),s=i=0;i<a;s++)55296==(64512&(n=t.charCodeAt(s)))&&s+1<o&&56320==(64512&(r=t.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),n<128?e[i++]=n:(n<2048?e[i++]=192|n>>>6:(n<65536?e[i++]=224|n>>>12:(e[i++]=240|n>>>18,e[i++]=128|n>>>12&63),e[i++]=128|n>>>6&63),e[i++]=128|63&n);return e},n.buf2binstring=function(t){return c(t,t.length)},n.binstring2buf=function(t){for(var e=new l.Buf8(t.length),n=0,r=e.length;n<r;n++)e[n]=t.charCodeAt(n);return e},n.buf2string=function(t,e){for(var n,r,i=e||t.length,o=new Array(2*i),a=0,s=0;s<i;)if((n=t[s++])<128)o[a++]=n;else if(4<(r=u[n]))o[a++]=65533,s+=r-1;else{for(n&=2===r?31:3===r?15:7;1<r&&s<i;)n=n<<6|63&t[s++],r--;1<r?o[a++]=65533:n<65536?o[a++]=n:(n-=65536,o[a++]=55296|n>>10&1023,o[a++]=56320|1023&n)}return c(o,a)},n.utf8border=function(t,e){for(var n=(e=(e=e||t.length)>t.length?t.length:e)-1;0<=n&&128==(192&t[n]);)n--;return!(n<0)&&0!==n&&n+u[t[n]]>e?n:e}},{"./common":72}],74:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){for(var i=65535&t|0,o=t>>>16&65535|0,a=0;0!==n;){for(n-=a=2e3<n?2e3:n;o=o+(i=i+e[r++]|0)|0,--a;);i%=65521,o%=65521}return i|o<<16|0}},{}],75:[function(t,e,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],76:[function(t,e,n){"use strict";var s=function(){for(var t=[],e=0;e<256;e++){for(var n=e,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}();e.exports=function(t,e,n,r){var i=s,o=r+n;t^=-1;for(var a=r;a<o;a++)t=t>>>8^i[255&(t^e[a])];return-1^t}},{}],77:[function(t,z,e){"use strict";var s,h=t("../utils/common"),l=t("./trees"),f=t("./adler32"),p=t("./crc32"),B=t("./messages"),u=0,c=4,d=0,g=-2,R=-1,F=4,G=2,m=8,Z=9,n=286,U=30,D=19,W=2*n+1,J=15,y=3,b=258,v=b+y+1,w=42,_=113,x=1,k=2,S=3,E=4;function I(t,e){return t.msg=B[e],e}function L(t){return(t<<1)-(4<t?9:0)}function M(t){for(var e=t.length;0<=--e;)t[e]=0}function C(t){var e=t.state,n=e.pending;0!==(n=n>t.avail_out?t.avail_out:n)&&(h.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function A(t,e){l._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,C(t.strm)}function P(t,e){t.pending_buf[t.pending++]=e}function j(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function o(t,e){var n,r,i=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-v?t.strstart-(t.w_size-v):0,u=t.window,c=t.w_mask,h=t.prev,f=t.strstart+b,p=u[o+a-1],d=u[o+a];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(u[(n=e)+a]===d&&u[n+a-1]===p&&u[n]===u[o]&&u[++n]===u[o+1]){for(o+=2,n++;u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<f;);if(r=b-(f-o),o=f-b,a<r){if(t.match_start=e,s<=(a=r))break;p=u[o+a-1],d=u[o+a]}}}while((e=h[e&c])>l&&0!=--i);return a<=t.lookahead?a:t.lookahead}function O(t){var e,n,r,i,o,a,s,l,u,c=t.w_size;do{if(l=t.window_size-t.lookahead-t.strstart,t.strstart>=c+(c-v)){for(h.arraySet(t.window,t.window,c,c,0),t.match_start-=c,t.strstart-=c,t.block_start-=c,e=n=t.hash_size;r=t.head[--e],t.head[e]=c<=r?r-c:0,--n;);for(e=n=c;r=t.prev[--e],t.prev[e]=c<=r?r-c:0,--n;);l+=c}if(0===t.strm.avail_in)break;if(o=t.strm,a=t.window,s=t.strstart+t.lookahead,l=l,u=void 0,u=o.avail_in,n=0===(u=l<u?l:u)?0:(o.avail_in-=u,h.arraySet(a,o.input,o.next_in,u,s),1===o.state.wrap?o.adler=f(o.adler,a,u,s):2===o.state.wrap&&(o.adler=p(o.adler,a,u,s)),o.next_in+=u,o.total_in+=u,u),t.lookahead+=n,t.lookahead+t.insert>=y)for(i=t.strstart-t.insert,t.ins_h=t.window[i],t.ins_h=(t.ins_h<<t.hash_shift^t.window[i+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[i+y-1])&t.hash_mask,t.prev[i&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=i,i++,t.insert--,!(t.lookahead+t.insert<y)););}while(t.lookahead<v&&0!==t.strm.avail_in)}function r(t,e){for(var n,r;;){if(t.lookahead<v){if(O(t),t.lookahead<v&&e===u)return x;if(0===t.lookahead)break}if(n=0,t.lookahead>=y&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+y-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-v&&(t.match_length=o(t,n)),t.match_length>=y)if(r=l._tr_tally(t,t.strstart-t.match_start,t.match_length-y),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=y){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+y-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=l._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(A(t,!1),0===t.strm.avail_out))return x}return t.insert=t.strstart<y-1?t.strstart:y-1,e===c?(A(t,!0),0===t.strm.avail_out?S:E):t.last_lit&&(A(t,!1),0===t.strm.avail_out)?x:k}function i(t,e){for(var n,r,i;;){if(t.lookahead<v){if(O(t),t.lookahead<v&&e===u)return x;if(0===t.lookahead)break}if(n=0,t.lookahead>=y&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+y-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=y-1,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-v&&(t.match_length=o(t,n),t.match_length<=5&&(1===t.strategy||t.match_length===y&&4096<t.strstart-t.match_start)&&(t.match_length=y-1)),t.prev_length>=y&&t.match_length<=t.prev_length){for(i=t.strstart+t.lookahead-y,r=l._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-y),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+y-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=y-1,t.strstart++,r&&(A(t,!1),0===t.strm.avail_out))return x}else if(t.match_available){if((r=l._tr_tally(t,0,t.window[t.strstart-1]))&&A(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return x}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=l._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<y-1?t.strstart:y-1,e===c?(A(t,!0),0===t.strm.avail_out?S:E):t.last_lit&&(A(t,!1),0===t.strm.avail_out)?x:k}function a(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new h.Buf16(2*W),this.dyn_dtree=new h.Buf16(2*(2*U+1)),this.bl_tree=new h.Buf16(2*(2*D+1)),M(this.dyn_ltree),M(this.dyn_dtree),M(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new h.Buf16(J+1),this.heap=new h.Buf16(2*n+1),M(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new h.Buf16(2*n+1),M(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function T(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=G,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?w:_,t.adler=2===e.wrap?0:1,e.last_flush=u,l._tr_init(e),d):I(t,g)}function N(t){var e=T(t);return e===d&&((t=t.state).window_size=2*t.w_size,M(t.head),t.max_lazy_match=s[t.level].max_lazy,t.good_match=s[t.level].good_length,t.nice_match=s[t.level].nice_length,t.max_chain_length=s[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=y-1,t.match_available=0,t.ins_h=0),e}function V(t,e,n,r,i,o){if(!t)return g;var a=1;if(e===R&&(e=6),r<0?(a=0,r=-r):15<r&&(a=2,r-=16),i<1||Z<i||n!==m||r<8||15<r||e<0||9<e||o<0||F<o)return I(t,g);8===r&&(r=9);var s=new H;return(t.state=s).strm=t,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+y-1)/y),s.window=new h.Buf8(2*s.w_size),s.head=new h.Buf16(s.hash_size),s.prev=new h.Buf16(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new h.Buf8(s.pending_buf_size),s.d_buf=+s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=e,s.strategy=o,s.method=n,N(t)}s=[new a(0,0,0,0,function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(O(t),0===t.lookahead&&e===u)return x;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,A(t,!1),0===t.strm.avail_out))return x;if(t.strstart-t.block_start>=t.w_size-v&&(A(t,!1),0===t.strm.avail_out))return x}return t.insert=0,e===c?(A(t,!0),0===t.strm.avail_out?S:E):(t.strstart>t.block_start&&(A(t,!1),t.strm.avail_out),x)}),new a(4,4,8,4,r),new a(4,5,16,8,r),new a(4,6,32,32,r),new a(4,4,16,16,i),new a(8,16,32,32,i),new a(8,16,128,128,i),new a(8,32,128,256,i),new a(32,128,258,1024,i),new a(32,258,258,4096,i)],e.deflateInit=function(t,e){return V(t,e,m,15,8,0)},e.deflateInit2=V,e.deflateReset=N,e.deflateResetKeep=T,e.deflateSetHeader=function(t,e){return!t||!t.state||2!==t.state.wrap?g:(t.state.gzhead=e,d)},e.deflate=function(t,e){var n,r,i,o;if(!t||!t.state||5<e||e<0)return t?I(t,g):g;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||666===r.status&&e!==c)return I(t,0===t.avail_out?-5:g);if(r.strm=t,n=r.last_flush,r.last_flush=e,r.status===w&&(2===r.wrap?(t.adler=0,P(r,31),P(r,139),P(r,8),r.gzhead?(P(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),P(r,255&r.gzhead.time),P(r,r.gzhead.time>>8&255),P(r,r.gzhead.time>>16&255),P(r,r.gzhead.time>>24&255),P(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),P(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(P(r,255&r.gzhead.extra.length),P(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=p(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(P(r,0),P(r,0),P(r,0),P(r,0),P(r,0),P(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),P(r,3),r.status=_)):(a=m+(r.w_bits-8<<4)<<8,a|=(2<=r.strategy||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(a|=32),a+=31-a%31,r.status=_,j(r,a),0!==r.strstart&&(j(r,t.adler>>>16),j(r,65535&t.adler)),t.adler=1)),69===r.status)if(r.gzhead.extra){for(i=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>i&&(t.adler=p(t.adler,r.pending_buf,r.pending-i,i)),C(t),i=r.pending,r.pending!==r.pending_buf_size));)P(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>i&&(t.adler=p(t.adler,r.pending_buf,r.pending-i,i)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(t.adler=p(t.adler,r.pending_buf,r.pending-i,i)),C(t),i=r.pending,r.pending===r.pending_buf_size)){o=1;break}}while(o=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,P(r,o),0!==o);r.gzhead.hcrc&&r.pending>i&&(t.adler=p(t.adler,r.pending_buf,r.pending-i,i)),0===o&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(t.adler=p(t.adler,r.pending_buf,r.pending-i,i)),C(t),i=r.pending,r.pending===r.pending_buf_size)){o=1;break}}while(o=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,P(r,o),0!==o);r.gzhead.hcrc&&r.pending>i&&(t.adler=p(t.adler,r.pending_buf,r.pending-i,i)),0===o&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&C(t),r.pending+2<=r.pending_buf_size&&(P(r,255&t.adler),P(r,t.adler>>8&255),t.adler=0,r.status=_)):r.status=_),0!==r.pending){if(C(t),0===t.avail_out)return r.last_flush=-1,d}else if(0===t.avail_in&&L(e)<=L(n)&&e!==c)return I(t,-5);if(666===r.status&&0!==t.avail_in)return I(t,-5);if(0!==t.avail_in||0!==r.lookahead||e!==u&&666!==r.status){var a=2===r.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(O(t),0===t.lookahead)){if(e===u)return x;break}if(t.match_length=0,n=l._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(A(t,!1),0===t.strm.avail_out))return x}return t.insert=0,e===c?(A(t,!0),0===t.strm.avail_out?S:E):t.last_lit&&(A(t,!1),0===t.strm.avail_out)?x:k}(r,e):3===r.strategy?function(t,e){for(var n,r,i,o,a=t.window;;){if(t.lookahead<=b){if(O(t),t.lookahead<=b&&e===u)return x;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=y&&0<t.strstart&&(r=a[i=t.strstart-1])===a[++i]&&r===a[++i]&&r===a[++i]){for(o=t.strstart+b;r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<o;);t.match_length=b-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=y?(n=l._tr_tally(t,1,t.match_length-y),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=l._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(A(t,!1),0===t.strm.avail_out))return x}return t.insert=0,e===c?(A(t,!0),0===t.strm.avail_out?S:E):t.last_lit&&(A(t,!1),0===t.strm.avail_out)?x:k}(r,e):s[r.level].func(r,e);if(a!==S&&a!==E||(r.status=666),a===x||a===S)return 0===t.avail_out&&(r.last_flush=-1),d;if(a===k&&(1===e?l._tr_align(r):5!==e&&(l._tr_stored_block(r,0,0,!1),3===e&&(M(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),C(t),0===t.avail_out))return r.last_flush=-1,d}return e!==c||!(r.wrap<=0)&&(2===r.wrap?(P(r,255&t.adler),P(r,t.adler>>8&255),P(r,t.adler>>16&255),P(r,t.adler>>24&255),P(r,255&t.total_in),P(r,t.total_in>>8&255),P(r,t.total_in>>16&255),P(r,t.total_in>>24&255)):(j(r,t.adler>>>16),j(r,65535&t.adler)),C(t),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending)?d:1},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==w&&69!==e&&73!==e&&91!==e&&103!==e&&e!==_&&666!==e?I(t,g):(t.state=null,e===_?I(t,-3):d):g},e.deflateSetDictionary=function(t,e){var n,r,i,o,a,s,l,u=e.length;if(!t||!t.state)return g;if(2===(o=(n=t.state).wrap)||1===o&&n.status!==w||n.lookahead)return g;for(1===o&&(t.adler=f(t.adler,e,u,0)),n.wrap=0,u>=n.w_size&&(0===o&&(M(n.head),n.strstart=0,n.block_start=0,n.insert=0),l=new h.Buf8(n.w_size),h.arraySet(l,e,u-n.w_size,n.w_size,0),e=l,u=n.w_size),l=t.avail_in,a=t.next_in,s=t.input,t.avail_in=u,t.next_in=0,t.input=e,O(n);n.lookahead>=y;){for(r=n.strstart,i=n.lookahead-(y-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+y-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--i;);n.strstart=r,n.lookahead=y-1,O(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=y-1,n.match_available=0,t.next_in=a,t.input=s,t.avail_in=l,n.wrap=o,d},e.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":72,"./adler32":74,"./crc32":76,"./messages":82,"./trees":83}],78:[function(t,e,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],79:[function(t,e,n){"use strict";e.exports=function(t,e){var n,r,i,o,a,s,l=t.state,u=t.next_in,c=t.input,h=u+(t.avail_in-5),f=t.next_out,p=t.output,d=f-(e-t.avail_out),g=f+(t.avail_out-257),m=l.dmax,y=l.wsize,b=l.whave,v=l.wnext,w=l.window,_=l.hold,x=l.bits,k=l.lencode,S=l.distcode,E=(1<<l.lenbits)-1,I=(1<<l.distbits)-1;t:do{for(x<15&&(_+=c[u++]<<x,x+=8,_+=c[u++]<<x,x+=8),n=k[_&E];;){if(_>>>=r=n>>>24,x-=r,0===(r=n>>>16&255))p[f++]=65535&n;else{if(!(16&r)){if(0==(64&r)){n=k[(65535&n)+(_&(1<<r)-1)];continue}if(32&r){l.mode=12;break t}t.msg="invalid literal/length code",l.mode=30;break t}for(i=65535&n,(r&=15)&&(x<r&&(_+=c[u++]<<x,x+=8),i+=_&(1<<r)-1,_>>>=r,x-=r),x<15&&(_+=c[u++]<<x,x+=8,_+=c[u++]<<x,x+=8),n=S[_&I];;){if(_>>>=r=n>>>24,x-=r,!(16&(r=n>>>16&255))){if(0==(64&r)){n=S[(65535&n)+(_&(1<<r)-1)];continue}t.msg="invalid distance code",l.mode=30;break t}if(o=65535&n,x<(r&=15)&&(_+=c[u++]<<x,(x+=8)<r&&(_+=c[u++]<<x,x+=8)),m<(o+=_&(1<<r)-1)){t.msg="invalid distance too far back",l.mode=30;break t}if(_>>>=r,x-=r,(r=f-d)<o){if(b<(r=o-r)&&l.sane){t.msg="invalid distance too far back",l.mode=30;break t}if(s=w,(a=0)===v){if(a+=y-r,r<i){for(i-=r;p[f++]=w[a++],--r;);a=f-o,s=p}}else if(v<r){if(a+=y+v-r,(r-=v)<i){for(i-=r;p[f++]=w[a++],--r;);if(a=0,v<i){for(i-=r=v;p[f++]=w[a++],--r;);a=f-o,s=p}}}else if(a+=v-r,r<i){for(i-=r;p[f++]=w[a++],--r;);a=f-o,s=p}for(;2<i;)p[f++]=s[a++],p[f++]=s[a++],p[f++]=s[a++],i-=3;i&&(p[f++]=s[a++],1<i&&(p[f++]=s[a++]))}else{for(a=f-o;p[f++]=p[a++],p[f++]=p[a++],p[f++]=p[a++],2<(i-=3););i&&(p[f++]=p[a++],1<i&&(p[f++]=p[a++]))}break}}break}}while(u<h&&f<g);_&=(1<<(x-=(i=x>>3)<<3))-1,t.next_in=u-=i,t.next_out=f,t.avail_in=u<h?h-u+5:5-(u-h),t.avail_out=f<g?g-f+257:257-(f-g),l.hold=_,l.bits=x}},{}],80:[function(t,e,n){"use strict";var P=t("../utils/common"),j=t("./adler32"),O=t("./crc32"),T=t("./inffast"),N=t("./inftrees"),z=1,B=2,R=0,F=-2,G=1,r=852,i=592;function Z(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function o(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new P.Buf16(320),this.work=new P.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=G,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new P.Buf32(r),e.distcode=e.distdyn=new P.Buf32(i),e.sane=1,e.back=-1,R):F}function s(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,a(t)):F}function l(t,e){var n,r;return!t||!t.state||(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e))?F:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,s(t))}function u(t,e){var n;return t?(n=new o,(t.state=n).window=null,(n=l(t,e))!==R&&(t.state=null),n):F}var U,D,W=!0;function J(t,e,n,r){var i,t=t.state;return null===t.window&&(t.wsize=1<<t.wbits,t.wnext=0,t.whave=0,t.window=new P.Buf8(t.wsize)),r>=t.wsize?(P.arraySet(t.window,e,n-t.wsize,t.wsize,0),t.wnext=0,t.whave=t.wsize):(r<(i=t.wsize-t.wnext)&&(i=r),P.arraySet(t.window,e,n-r,i,t.wnext),(r-=i)?(P.arraySet(t.window,e,n-r,r,0),t.wnext=r,t.whave=t.wsize):(t.wnext+=i,t.wnext===t.wsize&&(t.wnext=0),t.whave<t.wsize&&(t.whave+=i))),0}n.inflateReset=s,n.inflateReset2=l,n.inflateResetKeep=a,n.inflateInit=function(t){return u(t,15)},n.inflateInit2=u,n.inflate=function(t,e){var n,r,i,o,a,s,l,u,c,h,f,p,d,g,m,y,b,v,w,_,x,k,S,E,I=0,L=new P.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return F;12===(n=t.state).mode&&(n.mode=13),a=t.next_out,i=t.output,l=t.avail_out,o=t.next_in,r=t.input,s=t.avail_in,u=n.hold,c=n.bits,h=s,f=l,k=R;t:for(;;)switch(n.mode){case G:if(0===n.wrap)n.mode=13;else{for(;c<16;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}if(2&n.wrap&&35615===u)L[n.check=0]=255&u,L[1]=u>>>8&255,n.check=O(n.check,L,2,0),c=u=0,n.mode=2;else if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31)t.msg="incorrect header check",n.mode=30;else if(8!=(15&u))t.msg="unknown compression method",n.mode=30;else{if(c-=4,x=8+(15&(u>>>=4)),0===n.wbits)n.wbits=x;else if(x>n.wbits){t.msg="invalid window size",n.mode=30;break}n.dmax=1<<x,t.adler=n.check=1,n.mode=512&u?10:12,c=u=0}}break;case 2:for(;c<16;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}if(n.flags=u,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&(L[0]=255&u,L[1]=u>>>8&255,n.check=O(n.check,L,2,0)),c=u=0,n.mode=3;case 3:for(;c<32;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}n.head&&(n.head.time=u),512&n.flags&&(L[0]=255&u,L[1]=u>>>8&255,L[2]=u>>>16&255,L[3]=u>>>24&255,n.check=O(n.check,L,4,0)),c=u=0,n.mode=4;case 4:for(;c<16;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&(L[0]=255&u,L[1]=u>>>8&255,n.check=O(n.check,L,2,0)),c=u=0,n.mode=5;case 5:if(1024&n.flags){for(;c<16;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&(L[0]=255&u,L[1]=u>>>8&255,n.check=O(n.check,L,2,0)),c=u=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((p=s<(p=n.length)?s:p)&&(n.head&&(x=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),P.arraySet(n.head.extra,r,o,p,x)),512&n.flags&&(n.check=O(n.check,r,p,o)),s-=p,o+=p,n.length-=p),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===s)break t;for(p=0;x=r[o+p++],n.head&&x&&n.length<65536&&(n.head.name+=String.fromCharCode(x)),x&&p<s;);if(512&n.flags&&(n.check=O(n.check,r,p,o)),s-=p,o+=p,x)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===s)break t;for(p=0;x=r[o+p++],n.head&&x&&n.length<65536&&(n.head.comment+=String.fromCharCode(x)),x&&p<s;);if(512&n.flags&&(n.check=O(n.check,r,p,o)),s-=p,o+=p,x)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;c<16;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}if(u!==(65535&n.check)){t.msg="header crc mismatch",n.mode=30;break}c=u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=12;break;case 10:for(;c<32;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}t.adler=n.check=Z(u),c=u=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=a,t.avail_out=l,t.next_in=o,t.avail_in=s,n.hold=u,n.bits=c,2;t.adler=n.check=1,n.mode=12;case 12:if(5===e||6===e)break t;case 13:if(n.last)u>>>=7&c,c-=7&c,n.mode=27;else{for(;c<3;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}switch(n.last=1&u,--c,3&(u>>>=1)){case 0:n.mode=14;break;case 1:C=A=void 0;var C,A=n;if(W){for(U=new P.Buf32(512),D=new P.Buf32(32),C=0;C<144;)A.lens[C++]=8;for(;C<256;)A.lens[C++]=9;for(;C<280;)A.lens[C++]=7;for(;C<288;)A.lens[C++]=8;for(N(z,A.lens,0,288,U,0,A.work,{bits:9}),C=0;C<32;)A.lens[C++]=5;N(B,A.lens,0,32,D,0,A.work,{bits:5}),W=!1}if(A.lencode=U,A.lenbits=9,A.distcode=D,A.distbits=5,n.mode=20,6!==e)break;u>>>=2,c-=2;break t;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=30}u>>>=2,c-=2}break;case 14:for(u>>>=7&c,c-=7&c;c<32;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&u,c=u=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(p=n.length){if(0===(p=l<(p=s<p?s:p)?l:p))break t;P.arraySet(i,r,o,p,a),s-=p,o+=p,l-=p,a+=p,n.length-=p}else n.mode=12;break;case 17:for(;c<14;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}if(n.nlen=257+(31&u),u>>>=5,c-=5,n.ndist=1+(31&u),u>>>=5,c-=5,n.ncode=4+(15&u),u>>>=4,c-=4,286<n.nlen||30<n.ndist){t.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;c<3;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}n.lens[M[n.have++]]=7&u,u>>>=3,c-=3}for(;n.have<19;)n.lens[M[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,S={bits:n.lenbits},k=N(0,n.lens,0,19,n.lencode,0,n.work,S),n.lenbits=S.bits,k){t.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;y=(I=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,b=65535&I,!((m=I>>>24)<=c);){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}if(b<16)u>>>=m,c-=m,n.lens[n.have++]=b;else{if(16===b){for(E=m+2;c<E;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}if(u>>>=m,c-=m,0===n.have){t.msg="invalid bit length repeat",n.mode=30;break}x=n.lens[n.have-1],p=3+(3&u),u>>>=2,c-=2}else if(17===b){for(E=m+3;c<E;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}x=0,p=3+(7&(u>>>=m)),u>>>=3,c=c-m-3}else{for(E=m+7;c<E;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}x=0,p=11+(127&(u>>>=m)),u>>>=7,c=c-m-7}if(n.have+p>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=30;break}for(;p--;)n.lens[n.have++]=x}}if(30===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,S={bits:n.lenbits},k=N(z,n.lens,0,n.nlen,n.lencode,0,n.work,S),n.lenbits=S.bits,k){t.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,S={bits:n.distbits},k=N(B,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S),n.distbits=S.bits,k){t.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(6<=s&&258<=l){t.next_out=a,t.avail_out=l,t.next_in=o,t.avail_in=s,n.hold=u,n.bits=c,T(t,f),a=t.next_out,i=t.output,l=t.avail_out,o=t.next_in,r=t.input,s=t.avail_in,u=n.hold,c=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;y=(I=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,b=65535&I,!((m=I>>>24)<=c);){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}if(y&&0==(240&y)){for(v=m,w=y,_=b;y=(I=n.lencode[_+((u&(1<<v+w)-1)>>v)])>>>16&255,b=65535&I,!(v+(m=I>>>24)<=c);){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}u>>>=v,c-=v,n.back+=v}if(u>>>=m,c-=m,n.back+=m,n.length=b,0===y){n.mode=26;break}if(32&y){n.back=-1,n.mode=12;break}if(64&y){t.msg="invalid literal/length code",n.mode=30;break}n.extra=15&y,n.mode=22;case 22:if(n.extra){for(E=n.extra;c<E;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;y=(I=n.distcode[u&(1<<n.distbits)-1])>>>16&255,b=65535&I,!((m=I>>>24)<=c);){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}if(0==(240&y)){for(v=m,w=y,_=b;y=(I=n.distcode[_+((u&(1<<v+w)-1)>>v)])>>>16&255,b=65535&I,!(v+(m=I>>>24)<=c);){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}u>>>=v,c-=v,n.back+=v}if(u>>>=m,c-=m,n.back+=m,64&y){t.msg="invalid distance code",n.mode=30;break}n.offset=b,n.extra=15&y,n.mode=24;case 24:if(n.extra){for(E=n.extra;c<E;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===l)break t;if(n.offset>(p=f-l)){if((p=n.offset-p)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=30;break}d=p>n.wnext?(p-=n.wnext,n.wsize-p):n.wnext-p,p>n.length&&(p=n.length),g=n.window}else g=i,d=a-n.offset,p=n.length;for(l-=p=l<p?l:p,n.length-=p;i[a++]=g[d++],--p;);0===n.length&&(n.mode=21);break;case 26:if(0===l)break t;i[a++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;c<32;){if(0===s)break t;s--,u|=r[o++]<<c,c+=8}if(f-=l,t.total_out+=f,n.total+=f,f&&(t.adler=n.check=(n.flags?O:j)(n.check,i,f,a-f)),f=l,(n.flags?u:Z(u))!==n.check){t.msg="incorrect data check",n.mode=30;break}c=u=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;c<32;){if(0===s)break t;s--,u+=r[o++]<<c,c+=8}if(u!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=30;break}c=u=0}n.mode=29;case 29:k=1;break t;case 30:k=-3;break t;case 31:return-4;default:return F}return t.next_out=a,t.avail_out=l,t.next_in=o,t.avail_in=s,n.hold=u,n.bits=c,(n.wsize||f!==t.avail_out&&n.mode<30&&(n.mode<27||4!==e))&&J(t,t.output,t.next_out,f-t.avail_out)?(n.mode=31,-4):(h-=t.avail_in,f-=t.avail_out,t.total_in+=h,t.total_out+=f,n.total+=f,n.wrap&&f&&(t.adler=n.check=(n.flags?O:j)(n.check,i,f,t.next_out-f)),t.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==h&&0===f||4===e)&&k===R?-5:k)},n.inflateEnd=function(t){var e;return t&&t.state?((e=t.state).window&&(e.window=null),t.state=null,R):F},n.inflateGetHeader=function(t,e){return!t||!t.state||0==(2&(t=t.state).wrap)?F:((t.head=e).done=!1,R)},n.inflateSetDictionary=function(t,e){var n,r=e.length;return!t||!t.state||0!==(n=t.state).wrap&&11!==n.mode?F:11===n.mode&&j(1,e,r,0)!==n.check?-3:J(t,e,r,r)?(n.mode=31,-4):(n.havedict=1,R)},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":72,"./adler32":74,"./crc32":76,"./inffast":79,"./inftrees":81}],81:[function(t,e,n){"use strict";var T=t("../utils/common"),N=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],z=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],B=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],R=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,n,r,i,o,a,s){for(var l,u,c,h,f,p,d,g,m,y=s.bits,b=0,v=0,w=0,_=0,x=0,k=0,S=0,E=0,I=0,L=0,M=null,C=0,A=new T.Buf16(16),P=new T.Buf16(16),j=null,O=0,b=0;b<=15;b++)A[b]=0;for(v=0;v<r;v++)A[e[n+v]]++;for(x=y,_=15;1<=_&&0===A[_];_--);if(_<x&&(x=_),0===_)i[o++]=20971520,i[o++]=20971520,s.bits=1;else{for(w=1;w<_&&0===A[w];w++);for(x<w&&(x=w),b=E=1;b<=15;b++)if((E=(E<<=1)-A[b])<0)return-1;if(0<E&&(0===t||1!==_))return-1;for(P[1]=0,b=1;b<15;b++)P[b+1]=P[b]+A[b];for(v=0;v<r;v++)0!==e[n+v]&&(a[P[e[n+v]]++]=v);if(p=0===t?(M=j=a,19):1===t?(M=N,C-=257,j=z,O-=257,256):(M=B,j=R,-1),b=w,f=o,c=-1,h=(I=1<<(k=x))-1,1===t&&852<I||2===t&&592<I)return 1;for(S=v=L=0;;){for(m=a[v]<p?(g=0,a[v]):a[v]>p?(g=j[O+a[v]],M[C+a[v]]):(g=96,0),l=1<<(d=b-S),w=u=1<<k;i[f+(L>>S)+(u-=l)]=d<<24|g<<16|m|0,0!==u;);for(l=1<<b-1;L&l;)l>>=1;if(L=0!==l?(L&l-1)+l:0,v++,0==--A[b]){if(b===_)break;b=e[n+a[v]]}if(x<b&&(L&h)!==c){for(f+=w,E=1<<(k=b-(S=0===S?x:S));k+S<_&&!((E-=A[k+S])<=0);)k++,E<<=1;if(I+=1<<k,1===t&&852<I||2===t&&592<I)return 1;i[c=L&h]=x<<24|k<<16|f-o|0}}0!==L&&(i[f+L]=b-S<<24|64<<16|0),s.bits=x}return 0}},{"../utils/common":72}],82:[function(t,e,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],83:[function(n,o,t){"use strict";var a=n("../utils/common"),c=0,h=1;function e(t){for(var e=t.length;0<=--e;)t[e]=0}var s,l,u,f=29,p=256,d=p+1+f,g=30,m=19,E=2*d+1,I=15,r=16,F=7,y=256,b=16,v=17,w=18,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=new Array(2*(d+2)),L=(e(S),new Array(2*g)),M=(e(L),new Array(512)),C=(e(M),new Array(256)),A=(e(C),new Array(f)),P=(e(A),new Array(g));function j(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function O(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function T(t){return t<256?M[t]:M[256+(t>>>7)]}function i(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function N(t,e,n){t.bi_valid>r-n?(t.bi_buf|=e<<t.bi_valid&65535,i(t,t.bi_buf),t.bi_buf=e>>r-t.bi_valid,t.bi_valid+=n-r):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function z(t,e,n){N(t,n[2*e],n[2*e+1])}function Z(t,e){for(var n=0;n|=1&t,t>>>=1,n<<=1,0<--e;);return n>>>1}function U(t,e,n){for(var r,i=new Array(I+1),o=0,a=1;a<=I;a++)i[a]=o=o+n[a-1]<<1;for(r=0;r<=e;r++){var s=t[2*r+1];0!==s&&(t[2*r]=Z(i[s]++,s))}}function D(t){for(var e=0;e<d;e++)t.dyn_ltree[2*e]=0;for(e=0;e<g;e++)t.dyn_dtree[2*e]=0;for(e=0;e<m;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*y]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function W(t){8<t.bi_valid?i(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function J(t,e,n,r){var i=2*e,o=2*n;return t[i]<t[o]||t[i]===t[o]&&r[e]<=r[n]}function B(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&J(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!J(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r}function H(t,e,n){var r,i,o,a,s=0;if(0!==t.last_lit)for(;r=t.pending_buf[t.d_buf+2*s]<<8|t.pending_buf[t.d_buf+2*s+1],i=t.pending_buf[t.l_buf+s],s++,0==r?z(t,i,e):(z(t,(o=C[i])+p+1,e),0!==(a=_[o])&&N(t,i-=A[o],a),z(t,o=T(--r),n),0!==(a=x[o])&&N(t,r-=P[o],a)),s<t.last_lit;);z(t,y,e)}function R(t,e){var n,r,i,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=E,n=0;n<l;n++)0!==o[2*n]?(t.heap[++t.heap_len]=u=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(i=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[i]=0,t.opt_len--,s&&(t.static_len-=a[2*i+1]);for(e.max_code=u,n=t.heap_len>>1;1<=n;n--)B(t,o,n);for(i=l;n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],B(t,o,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,o[2*i]=o[2*n]+o[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,o[2*n+1]=o[2*r+1]=i,t.heap[1]=i++,B(t,o,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1];for(var c,h,f,p,d,g=t,m=e.dyn_tree,y=e.max_code,b=e.stat_desc.static_tree,v=e.stat_desc.has_stree,w=e.stat_desc.extra_bits,_=e.stat_desc.extra_base,x=e.stat_desc.max_length,k=0,S=0;S<=I;S++)g.bl_count[S]=0;for(m[2*g.heap[g.heap_max]+1]=0,c=g.heap_max+1;c<E;c++)x<(S=m[2*m[2*(h=g.heap[c])+1]+1]+1)&&(S=x,k++),m[2*h+1]=S,y<h||(g.bl_count[S]++,p=0,_<=h&&(p=w[h-_]),d=m[2*h],g.opt_len+=d*(S+p),v&&(g.static_len+=d*(b[2*h+1]+p)));if(0!==k){do{for(S=x-1;0===g.bl_count[S];)S--}while(g.bl_count[S]--,g.bl_count[S+1]+=2,g.bl_count[x]--,0<(k-=2));for(S=x;0!==S;S--)for(h=g.bl_count[S];0!==h;)y<(f=g.heap[--c])||(m[2*f+1]!==S&&(g.opt_len+=(S-m[2*f+1])*m[2*f],m[2*f+1]=S),h--)}U(o,u,t.bl_count)}function V(t,e,n){var r,i,o=-1,a=e[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=e[2*(r+1)+1],++s<l&&i===a||(s<u?t.bl_tree[2*i]+=s:0!==i?(i!==o&&t.bl_tree[2*i]++,t.bl_tree[2*b]++):s<=10?t.bl_tree[2*v]++:t.bl_tree[2*w]++,o=i,u=(s=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4))}function q(t,e,n){var r,i,o=-1,a=e[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),r=0;r<=n;r++)if(i=a,a=e[2*(r+1)+1],!(++s<l&&i===a)){if(s<u)for(;z(t,i,t.bl_tree),0!=--s;);else 0!==i?(i!==o&&(z(t,i,t.bl_tree),s--),z(t,b,t.bl_tree),N(t,s-3,2)):s<=10?(z(t,v,t.bl_tree),N(t,s-3,3)):(z(t,w,t.bl_tree),N(t,s-11,7));o=i,u=(s=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4)}}e(P);var Y=!1;function X(t,e,n,r){N(t,0+(r?1:0),3),r=e,e=n,n=!0,W(t=t),n&&(i(t,e),i(t,~e)),a.arraySet(t.pending_buf,t.window,r,e,t.pending),t.pending+=e}t._tr_init=function(t){if(!Y){for(var e,n,r,i=new Array(I+1),o=0,a=0;a<f-1;a++)for(A[a]=o,e=0;e<1<<_[a];e++)C[o++]=a;for(C[o-1]=a,a=r=0;a<16;a++)for(P[a]=r,e=0;e<1<<x[a];e++)M[r++]=a;for(r>>=7;a<g;a++)for(P[a]=r<<7,e=0;e<1<<x[a]-7;e++)M[256+r++]=a;for(n=0;n<=I;n++)i[n]=0;for(e=0;e<=143;)S[2*e+1]=8,e++,i[8]++;for(;e<=255;)S[2*e+1]=9,e++,i[9]++;for(;e<=279;)S[2*e+1]=7,e++,i[7]++;for(;e<=287;)S[2*e+1]=8,e++,i[8]++;for(U(S,d+1,i),e=0;e<g;e++)L[2*e+1]=5,L[2*e]=Z(e,5);s=new j(S,_,p+1,d,I),l=new j(L,x,0,g,I),u=new j(new Array(0),G,0,m,F),Y=!0}t.l_desc=new O(t.dyn_ltree,s),t.d_desc=new O(t.dyn_dtree,l),t.bl_desc=new O(t.bl_tree,u),t.bi_buf=0,t.bi_valid=0,D(t)},t._tr_stored_block=X,t._tr_flush_block=function(t,e,n,r){var i,o,a=0;if(0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){for(var e=4093624447,n=0;n<=31;n++,e>>>=1)if(1&e&&0!==t.dyn_ltree[2*n])return c;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return h;for(n=32;n<p;n++)if(0!==t.dyn_ltree[2*n])return h;return c}(t)),R(t,t.l_desc),R(t,t.d_desc),a=function(t){var e;for(V(t,t.dyn_ltree,t.l_desc.max_code),V(t,t.dyn_dtree,t.d_desc.max_code),R(t,t.bl_desc),e=m-1;3<=e&&0===t.bl_tree[2*k[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),i=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==e)X(t,e,n,r);else if(4===t.strategy||o===i)N(t,2+(r?1:0),3),H(t,S,L);else{N(t,4+(r?1:0),3);var s,l=t,e=t.l_desc.max_code+1,n=t.d_desc.max_code+1,u=a+1;for(N(l,e-257,5),N(l,n-1,5),N(l,u-4,4),s=0;s<u;s++)N(l,l.bl_tree[2*k[s]+1],3);q(l,l.dyn_ltree,e-1),q(l,l.dyn_dtree,n-1),H(t,t.dyn_ltree,t.dyn_dtree)}D(t),r&&W(t)},t._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(C[n]+p+1)]++,t.dyn_dtree[2*T(e)]++),t.last_lit===t.lit_bufsize-1},t._tr_align=function(t){N(t,2,3),z(t,y,S),16===(t=t).bi_valid?(i(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":72}],84:[function(t,e,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],85:[function(t,e,u){!function(i){function o(t,e){for(var n=0,r=t.length-1;0<=r;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;)t.unshift("..");return t}function n(t){return e.exec(t).slice(1)}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function a(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}u.resolve=function(){for(var t="",e=!1,n=arguments.length-1;-1<=n&&!e;n--){var r=0<=n?arguments[n]:i.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(t=r+"/"+t,e="/"===r.charAt(0))}return(e?"/":"")+(t=o(a(t.split("/"),function(t){return!!t}),!e).join("/"))||"."},u.normalize=function(t){var e=u.isAbsolute(t),n="/"===r(t,-1);return(t=(t=o(a(t.split("/"),function(t){return!!t}),!e).join("/"))||e?t:".")&&n&&(t+="/"),(e?"/":"")+t},u.isAbsolute=function(t){return"/"===t.charAt(0)},u.join=function(){var t=Array.prototype.slice.call(arguments,0);return u.normalize(a(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},u.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;0<=n&&""===t[n];n--);return n<e?[]:t.slice(e,n-e+1)}t=u.resolve(t).substr(1),e=u.resolve(e).substr(1);for(var r=n(t.split("/")),i=n(e.split("/")),o=Math.min(r.length,i.length),a=o,s=0;s<o;s++)if(r[s]!==i[s]){a=s;break}for(var l=[],s=a;s<r.length;s++)l.push("..");return(l=l.concat(i.slice(a))).join("/")},u.sep="/",u.delimiter=":",u.dirname=function(t){var t=n(t),e=t[0],t=t[1];return e||t?e+(t=t&&t.substr(0,t.length-1)):"."},u.basename=function(t,e){t=n(t)[2];return t=e&&t.substr(-1*e.length)===e?t.substr(0,t.length-e.length):t},u.extname=function(t){return n(t)[3]};var r="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}.call(this,t("_process"))},{_process:88}],86:[function(t,e,n){"use strict";var r={};function s(t,e){t=Math.round(t*e),(t<<=1)<0&&(t=~t);for(var n="";32<=t;)n+=String.fromCharCode(63+(32|31&t)),t>>=5;return n+=String.fromCharCode(t+63)}function i(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].slice().reverse());return e}r.decode=function(t,e){for(var n,r=0,i=0,o=0,a=[],s=0,l=0,u=null,c=Math.pow(10,e||5);r<t.length;){for(u=null,l=s=0;l|=(31&(u=t.charCodeAt(r++)-63))<<s,s+=5,32<=u;);for(n=1&l?~(l>>1):l>>1,s=l=0;l|=(31&(u=t.charCodeAt(r++)-63))<<s,s+=5,32<=u;);a.push([(i+=n)/c,(o+=1&l?~(l>>1):l>>1)/c])}return a},r.encode=function(t,e){if(!t.length)return"";for(var n=Math.pow(10,e||5),r=s(t[0][0],n)+s(t[0][1],n),i=1;i<t.length;i++)var o=t[i],a=t[i-1],r=(r+=s(o[0]-a[0],n))+s(o[1]-a[1],n);return r},r.fromGeoJSON=function(t,e){if((t=t&&"Feature"===t.type?t.geometry:t)&&"LineString"===t.type)return r.encode(i(t.coordinates),e);throw new Error("Input must be a GeoJSON LineString")},r.toGeoJSON=function(t,e){return{type:"LineString",coordinates:i(r.decode(t,e))}},"object"==typeof e&&e.exports&&(e.exports=r)},{}],87:[function(t,e,n){e.exports=function(t){for(var e,n,r=t.split("\n"),i=!0,o=!1,a=[],s=[],l=[],t={type:"FeatureCollection",features:[]},u=1;u<r.length;u++)if(0===r[u].indexOf("END")){if(!o){a.push(s);break}i=!(o=!1),0<l.length&&(s.push(l),l=[])}else i?(o=!(i=!1),e=0===r[u].indexOf("!"),0<s.length&&!e&&(a.push(s),s=[])):l.push(function(t){t=t.replace(/^\s*|\s*$/g,"").split(/\s+/);return[parseFloat(t[0]),parseFloat(t[1])]}(r[u]));return t.features.push({type:"Feature",properties:{},geometry:{type:1===a.length?"Polygon":"MultiPolygon",coordinates:1===(n=a).length?n[0]:n}}),t}},{}],88:[function(t,e,n){var r,i,e=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return(r=setTimeout)(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}var l,u=[],c=!1,h=-1;function f(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&p())}function p(){if(!c){for(var t=s(f),e=(c=!0,u.length);e;){for(l=u,u=[];++h<e;)l&&l[h].run();h=-1,e=u.length}l=null,c=!1,!function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return(i=clearTimeout)(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}e.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new d(t,e)),1!==u.length||c||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=g,e.addListener=g,e.once=g,e.off=g,e.removeListener=g,e.removeAllListeners=g,e.emit=g,e.binding=function(t){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(t){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],89:[function(t,e,n){e.exports.stringQs=function(t){return t.split("&").reduce(function(t,e){e=e.split("=");return 2===e.length&&(t[e[0]]=null===e[1]?"":decodeURIComponent(e[1])),t},{})},e.exports.qsString=function(e,t){return Object.keys(e).sort().map(function(t){return encodeURIComponent(t)+"="+(""+e[t]).replace("&","%26")}).join("&")}},{}],90:[function(t,e,n){!function(){var p=[].slice;function t(r){var e,i,n,o=[],a=0,s=0,l=0,u=null,c=d;function h(){for(;i=a<o.length&&s<r;){var t=a++,e=o[t],n=p.call(e,1);n.push(function(n){return function(t,e){--s,null==u&&(null!=t?(u=t,a=l=NaN,f()):(o[n]=e,--l?i||h():f()))}}(t)),++s,e[0].apply(null,n)}}function f(){null!=u?c(u):n?c(u,o):c.apply(null,[u].concat(o))}return r=r||1/0,e={defer:function(){return u||(o.push(arguments),++l,h()),e},await:function(t){return c=t,n=!1,l||f(),e},awaitAll:function(t){return c=t,n=!0,l||f(),e}}}function d(){}t.version="1.0.7","function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof e&&e.exports?e.exports=t:this.queue=t}()},{}],91:[function(t,e,n){e.exports=function(t,e){return e=e||"NSEW","string"!=typeof t||!(t=t.match(/^([0-9.]+)°? *(?:([0-9.]+)['’′‘] *)?(?:([0-9.]+)(?:''|"|”|″) *)?([NSEW])?/))||t[4]&&-1===e.indexOf(t[4])?null:((t[1]?parseFloat(t[1]):0)+(t[2]?parseFloat(t[2])/60:0)+(t[3]?parseFloat(t[3])/3600:0))*(t[4]&&"S"===t[4]||"W"===t[4]?-1:1)}},{}],92:[function(t,e,n){e.exports.download=t("./src/download"),e.exports.write=t("./src/write"),e.exports.zip=t("./src/zip")},{"./src/download":93,"./src/write":101,"./src/zip":102}],93:[function(t,e,n){var r=t("./zip");e.exports=function(t,e){t=r(t,e);location.href="data:application/zip;base64,"+t}},{"./zip":102}],94:[function(t,e,n){e.exports.enlarge=function(t,e){return e[0]<t.xmin&&(t.xmin=e[0]),e[0]>t.xmax&&(t.xmax=e[0]),e[1]<t.ymin&&(t.ymin=e[1]),e[1]>t.ymax&&(t.ymax=e[1]),t},e.exports.enlargeExtent=function(t,e){return e.xmax>t.xmax&&(t.xmax=e.xmax),e.xmin<t.xmin&&(t.xmin=e.xmin),e.ymax>t.ymax&&(t.ymax=e.ymax),e.ymin<t.ymin&&(t.ymin=e.ymin),t},e.exports.blank=function(){return{xmin:Number.MAX_VALUE,ymin:Number.MAX_VALUE,xmax:-Number.MAX_VALUE,ymax:-Number.MAX_VALUE}}},{}],95:[function(t,e,n){var o=t("./types").jstypes;function r(t){var e,n,r={},i=[];for(e in t)r[e]=typeof t[e];for(n in r)i.push({name:n,type:o[r[n]]});return i}e.exports.geojson=function(t){var i={};return t.forEach(function(t){var e,n=i,r=t.properties;for(e in r)n[e]=r[e]}),r(i)},e.exports.obj=r},{"./types":100}],96:[function(t,e,n){function r(n,r){return function(t){var e,t=t.features.filter((e=n,function(t){return t.geometry.type===e}));return{geometries:t.map(i),properties:t.map(o),type:r}}}function i(t){return void 0!==t.geometry.coordinates[0]&&void 0!==t.geometry.coordinates[0][0]&&void 0!==t.geometry.coordinates[0][0][0]?t.geometry.coordinates[0]:t.geometry.coordinates}function o(t){return t.properties}e.exports.point=r("Point","POINT"),e.exports.line=r("LineString","POLYLINE"),e.exports.polygon=r("Polygon","POLYGON")},{}],97:[function(t,e,n){var r=t("./extent");e.exports.write=function(t,e,n,r){var i=100,o=0,a=0;t.forEach(function(t,e){n.setInt32(o,e),n.setInt32(o+4,10),n.setInt32(o+8,1,!0),n.setFloat64(o+12,t[0],!0),n.setFloat64(o+20,t[1],!0),r.setInt32(a,i/2),r.setInt32(a+4,10),a+=8,o+=28,i+=28})},e.exports.extent=function(t){return t.reduce(function(t,e){return r.enlarge(t,e)},r.blank())},e.exports.shxLength=function(t){return 8*t.length},e.exports.shpLength=function(t){return 28*t.length}},{"./extent":94}],98:[function(t,e,n){var c=t("./extent");function h(t,e){return void 0===e&&(e=[]),"object"==typeof t[0][0]?t.reduce(function(t,e){return t.concat(h(e))},e):t}e.exports.write=function(t,e,i,o,a){var s=0,l=0,u=100;t.forEach(function(t,e){var t=h(t),n=16*t.length+48,r=t.reduce(function(t,e){return c.enlarge(t,e)},c.blank());o.setInt32(l,u/2),o.setInt32(l+4,n/2),l+=8,u+=8+n,i.setInt32(s,e+1),i.setInt32(s+4,n/2),i.setInt32(s+8,a,!0),i.setFloat64(s+12,r.xmin,!0),i.setFloat64(s+20,r.ymin,!0),i.setFloat64(s+28,r.xmax,!0),i.setFloat64(s+36,r.ymax,!0),i.setInt32(s+44,1,!0),i.setInt32(s+48,t.length,!0),i.setInt32(s+52,0,!0),t.forEach(function(t,e){i.setFloat64(s+56+16*e,t[0],!0),i.setFloat64(s+56+16*e+8,t[1],!0)}),s+=8+n})},e.exports.shpLength=function(t){return 56*t.length+16*h(t).length},e.exports.shxLength=function(t){return 8*t.length},e.exports.extent=function(t){return h(t).reduce(function(t,e){return c.enlarge(t,e)},c.blank())}},{"./extent":94}],99:[function(t,e,n){e.exports='GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]]'},{}],100:[function(t,e,n){e.exports.geometries={NULL:0,POINT:1,POLYLINE:3,POLYGON:5,MULTIPOINT:8,POINTZ:11,POLYLINEZ:13,POLYGONZ:15,MULTIPOINTZ:18,POINTM:21,POLYLINEM:23,POLYGONM:25,MULTIPOINTM:28,MULTIPATCH:31}},{}],101:[function(t,e,n){var h=t("./types"),f=t("dbf"),p=t("./prj"),r=(t("./extent"),t("./fields"),t("assert"),t("./points")),t=t("./poly"),d={1:r,5:t,3:t};function g(t,e){t.setInt32(0,9994),t.setInt32(28,1e3,!0),t.setInt32(32,e,!0)}function m(t,e){e.setFloat64(36,t.xmin,!0),e.setFloat64(44,t.ymin,!0),e.setFloat64(52,t.xmax,!0),e.setFloat64(60,t.ymax,!0)}e.exports=function(t,e,n,r){var e=h.geometries[e],i=d[e],o=100+i.shpLength(n),a=100+i.shxLength(n),s=new ArrayBuffer(o),l=new DataView(s),a=new ArrayBuffer(a),u=new DataView(a),c=i.extent(n),i=(g(l,e),g(u,e),m(c,l),m(c,u),i.write(n,c,new DataView(s,100),new DataView(a,100),e),l.setInt32(24,o/2),u.setInt32(24,50+4*n.length),f.structure(t));r(null,{shp:l,shx:u,dbf:i,prj:p})}},{"./extent":94,"./fields":95,"./points":97,"./poly":98,"./prj":99,"./types":100,assert:4,dbf:13}],102:[function(t,e,n){var a=t("./write"),r=t("./geojson"),s=t("./prj"),l=t("jszip");e.exports=function(t,i){var e=new l,o=e.folder(i&&i.folder?i.folder:"layers");return[r.point(t),r.line(t),r.polygon(t)].forEach(function(r){r.geometries.length&&a(r.properties,r.type,r.geometries,function(t,e){var n=i&&i.types[r.type.toLowerCase()]?i.types[r.type.toLowerCase()]:r.type;o.file(n+".shp",e.shp.buffer,{binary:!0}),o.file(n+".shx",e.shx.buffer,{binary:!0}),o.file(n+".dbf",e.dbf.buffer,{binary:!0}),o.file(n+".prj",s)})}),e.generate({compression:"STORE"})}},{"./geojson":96,"./prj":99,"./write":101,jszip:46}],103:[function(t,e,n){var o=t("wgs84");function a(t){return t*(Math.PI/180)}function s(t){return t*(180/Math.PI)}e.exports.heading=function(t,e){var n=Math.sin(Math.PI*(t[0]-e[0])/180)*Math.cos(Math.PI*e[1]/180),t=Math.cos(Math.PI*t[1]/180)*Math.sin(Math.PI*e[1]/180)-Math.sin(Math.PI*t[1]/180)*Math.cos(Math.PI*e[1]/180)*Math.cos(Math.PI*(t[0]-e[0])/180);return 180*Math.atan2(n,t)/Math.PI},e.exports.distance=function(t,e){var n=Math.sin(Math.PI*(e[0]-t[0])/360),r=Math.sin(Math.PI*(e[1]-t[1])/360),r=r*r+n*n*Math.cos(Math.PI*t[1]/180)*Math.cos(Math.PI*e[1]/180);return 2*o.RADIUS*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))},e.exports.radial=function(t,e,n){var e=a(e),n=n/o.RADIUS,r=a(t[0]),t=a(t[1]),i=Math.asin(Math.sin(t)*Math.cos(n)+Math.cos(t)*Math.sin(n)*Math.cos(e));return[s((r-Math.atan2(Math.sin(e)*Math.sin(n)*Math.cos(t),Math.cos(n)-Math.sin(t)*Math.sin(i))+Math.PI)%(2*Math.PI)-Math.PI),s(i)]}},{wgs84:144}],104:[function(t,h,e){!function(e){var r,n,t,i=this.window||e,o={},e=i.document,a="localStorage";if(o.disabled=!1,o.set=function(t,e){},o.get=function(t){},o.remove=function(t){},o.clear=function(){},o.transact=function(t,e,n){var r=o.get(t);null==n&&(n=e,e=null),n(r=void 0===r?e||{}:r),o.set(t,r)},o.getAll=function(){},o.forEach=function(){},o.serialize=function(t){return JSON.stringify(t)},o.deserialize=function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e||void 0}},function(){try{return a in i&&i[a]}catch(t){}}())r=i[a],o.set=function(t,e){return void 0===e?o.remove(t):(r.setItem(t,o.serialize(e)),e)},o.get=function(t){return o.deserialize(r.getItem(t))},o.remove=function(t){r.removeItem(t)},o.clear=function(){r.clear()},o.getAll=function(){var n={};return o.forEach(function(t,e){n[t]=e}),n},o.forEach=function(t){for(var e=0;e<r.length;e++){var n=r.key(e);t(n,o.get(n))}};else if(e.documentElement.addBehavior){try{(t=new ActiveXObject("htmlfile")).open(),t.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),t.close(),n=t.w.frames[0].document,r=n.createElement("div")}catch(t){r=e.createElement("div"),n=e.body}function s(e){return function(){var t=Array.prototype.slice.call(arguments,0),t=(t.unshift(r),n.appendChild(r),r.addBehavior("#default#userData"),r.load(a),e.apply(o,t));return n.removeChild(r),t}}var l=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function u(t){return t.replace(l,"___")}o.set=s(function(t,e,n){return e=u(e),void 0===n?o.remove(e):(t.setAttribute(e,o.serialize(n)),t.save(a),n)}),o.get=s(function(t,e){return e=u(e),o.deserialize(t.getAttribute(e))}),o.remove=s(function(t,e){e=u(e),t.removeAttribute(e),t.save(a)}),o.clear=s(function(t){var e=t.XMLDocument.documentElement.attributes;t.load(a);for(var n,r=0;n=e[r];r++)t.removeAttribute(n.name);t.save(a)}),o.getAll=function(t){var n={};return o.forEach(function(t,e){n[t]=e}),n},o.forEach=s(function(t,e){for(var n,r=t.XMLDocument.documentElement.attributes,i=0;n=r[i];++i)e(n.name,o.deserialize(t.getAttribute(n.name)))})}try{var c="__storejs__";o.set(c,c),o.get(c)!=c&&(o.disabled=!0),o.remove(c)}catch(t){o.disabled=!0}o.enabled=!o.disabled,void 0!==h&&h.exports?h.exports=o:"function"==typeof define&&define.amd?define(o):i.store=o}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],105:[function(t,e,n){function r(t){return t&&t.length?" "+t.map(function(t){return t[0]+'="'+t[1]+'"'}).join(" "):""}e.exports.attr=r,e.exports.tagClose=function(t,e){return"<"+t+r(e)+"/>"},e.exports.tag=function(t,e,n){return"<"+t+r(n)+">"+e+"</"+t+">"},e.exports.encode=function(t){return(null===t?"":t.toString()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}},{}],106:[function(r,e,a){!function(t){toGeoJSON=function(){"use strict";var l,e=/\s*/g,i=/^\s*|\s*$/g,o=/\s+/;function p(t,e){return t.getElementsByTagName(e)}function u(t,e){return t.getAttribute(e)}function n(t,e){return parseFloat(u(t,e))}function d(t,e){t=p(t,e);return t.length?t[0]:null}function g(t){for(var e=0,n=[];e<t.length;e++)n[e]=parseFloat(t[e]);return n}function m(t){var e;return t&&(e=t).normalize&&e.normalize(),t&&t.firstChild&&t.firstChild.nodeValue}function y(t){return g(t.replace(e,"").split(","))}function b(t){for(var e=t.replace(i,"").split(o),n=[],r=0;r<e.length;r++)n.push(y(e[r]));return n}function h(t){var e=[n(t,"lon"),n(t,"lat")],t=d(t,"ele");return t&&e.push(parseFloat(m(t))),e}function v(){return{type:"FeatureCollection",features:[]}}return"undefined"!=typeof XMLSerializer?l=new XMLSerializer:"object"!=typeof a||"object"!=typeof t||t.browser||(l=new(r("xmldom").XMLSerializer)),{kml:function(t,e){for(var n,r=v(),c={},h=["Polygon","LineString","Point","Track"],i=p(t,"Placemark"),o=p(t,"Style"),a=0;a<o.length;a++)c["#"+u(o[a],"id")]=function(t){if(!t||!t.length)return 0;for(var e=0,n=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e)|0;return n}((n=o[a],l.serializeToString(n))).toString(16);for(var s=0;s<i.length;s++)r.features=r.features.concat(function(t){var e,n=function t(e){var n,r,i,o,a,s=[];if(d(e,"MultiGeometry"))return t(d(e,"MultiGeometry"));if(d(e,"MultiTrack"))return t(d(e,"MultiTrack"));for(i=0;i<h.length;i++)if(r=p(e,h[i]))for(o=0;o<r.length;o++)if(n=r[o],"Point"==h[i])s.push({type:"Point",coordinates:y(m(d(n,"coordinates")))});else if("LineString"==h[i])s.push({type:"LineString",coordinates:b(m(d(n,"coordinates")))});else if("Polygon"==h[i]){var l=p(n,"LinearRing"),u=[];for(a=0;a<l.length;a++)u.push(b(m(d(l[a],"coordinates"))));s.push({type:"Polygon",coordinates:u})}else"Track"==h[i]&&s.push({type:"LineString",coordinates:f(n)});return s}(t),r={},i=m(d(t,"name")),o=m(d(t,"styleUrl")),a=m(d(t,"description")),s=d(t,"TimeSpan"),t=d(t,"ExtendedData");if(!n.length)return[];i&&(r.name=i);o&&c[o]&&(r.styleUrl=o,r.styleHash=c[o]);a&&(r.description=a);s&&(i=m(d(s,"begin")),o=m(d(s,"end")),r.timespan={begin:i,end:o});if(t){var l=p(t,"Data"),u=p(t,"SimpleData");for(e=0;e<l.length;e++)r[l[e].getAttribute("name")]=m(d(l[e],"value"));for(e=0;e<u.length;e++)r[u[e].getAttribute("name")]=m(u[e])}return[{type:"Feature",geometry:1===n.length?n[0]:{type:"GeometryCollection",geometries:n},properties:r}]}(i[s]));function f(t){for(var e=p(t,"coord"),n=[],r=0;r<e.length;r++)n.push(g(m(e[r]).split(" ")));return n}return r},gpx:function(t,e){for(var n,r,i=p(t,"trk"),o=p(t,"rte"),a=p(t,"wpt"),s=v(),l=0;l<i.length;l++)s.features.push(u(i[l],"trkpt"));for(l=0;l<o.length;l++)s.features.push(u(o[l],"rtept"));for(l=0;l<a.length;l++)s.features.push((n=a[l],r=void 0,(r=c(n)).sym=m(d(n,"sym")),{type:"Feature",properties:r,geometry:{type:"Point",coordinates:h(n)}}));function u(t,e){for(var n=p(t,e),r=[],i=0;i<n.length;i++)r.push(h(n[i]));return{type:"Feature",properties:c(t),geometry:{type:"LineString",coordinates:r}}}function c(t){for(var e=["name","desc","author","copyright","link","time","keywords"],n={},r=0;r<e.length;r++)n[e[r]]=m(d(t,e[r]));var i,o=n,a={};for(i in o)o[i]&&(a[i]=o[i]);return a}return s}}}(),void 0!==e&&(e.exports=toGeoJSON)}.call(this,r("_process"))},{_process:88,xmldom:7}],107:[function(t,e,n){var t=t("strxml"),a=t.tag,s=t.encode;function r(o){return function(t){var e,n,r="",i="";return o.simplestyle&&((e=t.properties)["marker-size"]||e["marker-symbol"]||e["marker-color"])&&(e=t.properties,r=a("Style",a("IconStyle",a("Icon",a("href",function(t){var e=t["marker-size"]||"medium",n=t["marker-symbol"]?"-"+t["marker-symbol"]:"",t=(t["marker-color"]||"7e7e7e").replace("#","");return"https://api.tiles.mapbox.com/v3/marker/pin-"+e.charAt(0)+n+"+"+t+".png"}(e))))+a("hotSpot","",[["xunits","fraction"],["yunits","fraction"],["x",.5],["y",.5]]),[["id",c(e)]]),i=a("styleUrl","#"+c(t.properties))),t.properties&&l.valid(t.geometry)&&(e=l.any(t.geometry))?r+a("Placemark",((r=t.properties)[(n=o).name]?a("name",s(r[n.name])):"")+((r=t.properties)[(n=o).description]?a("description",s(r[n.description])):"")+(r=t.properties,a("ExtendedData",function(t){var e,n=[];for(e in t)n.push([e,t[e]]);return n}(r).map(u).join("")))+((n=t.properties)[(r=o).timestamp]?a("TimeStamp",a("when",s(n[r.timestamp]))):"")+e+i):""}}e.exports=function(t,e){return'<?xml version="1.0" encoding="UTF-8"?>'+a("kml",a("Document",(void 0!==(n=e=e||{documentName:void 0,documentDescription:void 0,name:"name",description:"description",simplestyle:!1,timestamp:"timestamp"}).documentName?a("name",n.documentName):"")+(void 0!==(n=e).documentDescription?a("description",n.documentDescription):"")+function(t,e){if(!t.type)return"";switch(t.type){case"FeatureCollection":return t.features?t.features.map(r(e)).join(""):"";case"Feature":return r(e)(t);default:return r(e)({type:"Feature",geometry:t,properties:{}})}}(t,e)),[["xmlns","http://www.opengis.net/kml/2.2"]]);var n};var l={Point:function(t){return a("Point",a("coordinates",t.coordinates.join(",")))},LineString:function(t){return a("LineString",a("coordinates",i(t.coordinates)))},Polygon:function(t){var e;return t.coordinates.length?(e=t.coordinates[0],t=t.coordinates.slice(1),e=a("outerBoundaryIs",a("LinearRing",a("coordinates",i(e)))),t=t.map(function(t){return a("innerBoundaryIs",a("LinearRing",a("coordinates",i(t))))}).join(""),a("Polygon",e+t)):""},MultiPoint:function(t){return t.coordinates.length?a("MultiGeometry",t.coordinates.map(function(t){return l.Point({coordinates:t})}).join("")):""},MultiPolygon:function(t){return t.coordinates.length?a("MultiGeometry",t.coordinates.map(function(t){return l.Polygon({coordinates:t})}).join("")):""},MultiLineString:function(t){return t.coordinates.length?a("MultiGeometry",t.coordinates.map(function(t){return l.LineString({coordinates:t})}).join("")):""},GeometryCollection:function(t){return a("MultiGeometry",t.geometries.map(l.any).join(""))},valid:function(t){return t&&t.type&&(t.coordinates||"GeometryCollection"===t.type&&t.geometries.every(l.valid))},any:function(t){return l[t.type]?l[t.type](t):""}};function i(t){return t.map(function(t){return t.join(",")}).join(" ")}function u(t){return a("Data",a("value",s(t[1])),[["name",s(t[0])]])}function c(t){return(t["marker-symbol"]||"")+(t["marker-color"]||"").replace("#","")+(t["marker-size"]||"")}},{strxml:105}],108:[function(t,e,n){var r=t("./type");t("../../");function o(){}e.exports=function(t,i){var e,n=r({geometry:function(t){var e=t.properties,n=i[t.id];if(n)if(e)for(var r in n)e[r]=n[r];else for(var r in n){t.properties=n;break}this.defaults.geometry.call(this,t)},LineString:o,MultiLineString:o,Point:o,MultiPoint:o,Polygon:o,MultiPolygon:o});for(e in t.objects)n.object(t.objects[e])}},{"../../":"topojson","./type":136}],109:[function(t,e,n){e.exports=function(t){var n=1/0,r=1/0,i=-1/0,o=-1/0;function e(t){t&&s.hasOwnProperty(t.type)&&s[t.type](t)}var a,s={GeometryCollection:function(t){t.geometries.forEach(e)},Point:function(t){l(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(l)},LineString:function(t){u(t.coordinates)},MultiLineString:function(t){t.coordinates.forEach(u)},Polygon:function(t){t.coordinates.forEach(u)},MultiPolygon:function(t){t.coordinates.forEach(c)}};function l(t){var e=t[0],t=t[1];e<n&&(n=e),i<e&&(i=e),t<r&&(r=t),o<t&&(o=t)}function u(t){t.forEach(l)}function c(t){t.forEach(u)}for(a in t)e(t[a]);return[n,r,i,o]}},{}],110:[function(t,e,n){n.name="cartesian",n.formatDistance=function(t){return t.toString()},n.ringArea=function(t){var e,n=-1,r=t.length,i=t[r-1],o=0;for(;++n<r;)e=i,i=t[n],o+=e[0]*i[1]-e[1]*i[0];return.5*o},n.absoluteArea=Math.abs,n.triangleArea=function(t){return Math.abs((t[0][0]-t[2][0])*(t[1][1]-t[0][1])-(t[0][0]-t[1][0])*(t[2][1]-t[0][1]))},n.distance=function(t,e,n,r){t-=n,n=e-r;return Math.sqrt(t*t+n*n)}},{}],111:[function(t,e,n){var u=t("./type"),c=t("./coordinate-systems"),h=t("../../");function f(l,u){return function(t){if(e=t.length){for(var e,n,r,i,o=new Array(e),a=-1/0,s=0;s<e;++s)a<(i=Math.abs(o[s]=l(t[s])))&&(a=i,n=s);n&&(r=t[n],t[n]=t[0],t[0]=r,r=o[n],o[n]=o[0],o[0]=r),o[0]<0&&u(t[0]);for(s=1;s<e;++s)0<o[s]&&u(t[s])}}}function p(){}e.exports=function(t,e){if("Topology"===t.type){var n=t,r=e,i=null;r&&"coordinate-system"in r&&(i=c[r["coordinate-system"]]);var o,a=f(function(t){return i.ringArea(h.feature(n,{type:"Polygon",arcs:[t]}).geometry.coordinates[0])},function(t){var e=-1,n=t.length;t.reverse();for(;++e<n;)t[e]=~t[e]}),s=u({LineString:p,MultiLineString:p,Point:p,MultiPoint:p,Polygon:function(t){a(t.arcs)},MultiPolygon:function(t){t.arcs.forEach(a)}});for(o in n.objects)s.object(n.objects[o])}else r=t,t=null,(e=e)&&"coordinate-system"in e&&(t=c[e["coordinate-system"]]),l=f(t.ringArea,function(t){t.reverse()}),u({LineString:p,MultiLineString:p,Point:p,MultiPoint:p,Polygon:function(t){l(t.coordinates)},MultiPolygon:function(t){t.coordinates.forEach(l)}}).object(r);var l}},{"../../":"topojson","./coordinate-systems":113,"./type":136}],112:[function(t,e,n){e.exports=function(t,n){function e(t){var e=n(t);null==e?delete t.id:t.id=e}arguments.length<2&&(n=function(t){return t.id});var r,i,o={Feature:e,FeatureCollection:function(t){t.features.forEach(e)}};for(r in t)(i=t[r])&&o.hasOwnProperty(i.type)&&o[i.type](i);return t}},{}],113:[function(t,e,n){e.exports={cartesian:t("./cartesian"),spherical:t("./spherical")}},{"./cartesian":110,"./spherical":123}],114:[function(t,e,n){e.exports=function(t){for(var e=t.arcs,n=-1,r=e.length;++n<r;)for(var i,o,a=e[n],s=0,l=a.length,u=a[0],c=u[0],h=u[1];++s<l;)i=(u=a[s])[0],o=u[1],a[s]=[i-c,o-h],c=i,h=o;return t}},{}],115:[function(t,e,n){var g=t("./type"),m=t("./prune"),y=t("./clockwise"),b=t("./coordinate-systems"),v=t("../../");function w(){}function _(){return!1}e.exports=function(e,t){var n,r=null,i=!0,o=!0,a=_;if(t&&("coordinate-system"in t&&(r=b[t["coordinate-system"]]),"minimum-area"in t&&(n=+t["minimum-area"]),"preserve-attached"in t&&(o=!!t["preserve-attached"]),"force-clockwise"in t&&(i=!!t["force-clockwise"])),i&&y(e,t),0<n||(n=Number.MIN_VALUE),o){var l={},u=0,s=g({LineString:w,MultiLineString:w,Point:w,MultiPoint:w,MultiPolygon:function(t){for(var e=t.arcs,n=-1,r=e.length;++n<r;)this.polygon(e[n])},Polygon:function(t){this.polygon(t.arcs)},polygon:function(t){for(var e=0,n=t.length;e<n;++e,++u)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i],s=l[a=a<0?~a:a];l[a]=0<=s&&s!==u?-1:u}}}),a=function(t){for(var e=0,n=t.length;e<n;++e){var r=t[e];if(l[r<0?~r:r]<0)return!0}};for(c in e.objects)s.object(e.objects[c])}var c,h=g({LineString:w,MultiLineString:w,Point:w,MultiPoint:w,Polygon:function(t){t.arcs=f(t.arcs),t.arcs&&t.arcs.length||(t.type=null,delete t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(f).filter(function(t){return t&&t.length}),t.arcs.length||(t.type=null,delete t.arcs)},GeometryCollection:function(t){this.defaults.GeometryCollection.call(this,t),t.geometries=t.geometries.filter(function(t){return null!=t.type}),t.geometries.length||(t.type=null,delete t.geometries)}});for(c in e.objects)h.object(e.objects[c]);function f(t){return t.length&&(e=t[0],a(e)||r.absoluteArea(d(e))>=n)?[t.shift()].concat(t.filter(p)):null;var e}function p(t){return a(t)||r.absoluteArea(-d(t))>=n}function d(t){return r.ringArea(v.feature(e,{type:"Polygon",arcs:[t]}).geometry.coordinates[0])}m(e,t)}},{"../../":"topojson","./clockwise":111,"./coordinate-systems":113,"./prune":119,"./type":136}],116:[function(t,e,n){e.exports=function(t){function e(t){var e=t.geometry;return null==e?t.type=null:(i(e),t.type=e.type,e.geometries?t.geometries=e.geometries:e.coordinates&&(t.coordinates=e.coordinates)),delete t.geometry,t}function i(t){return t?(a.hasOwnProperty(t.type)&&a[t.type](t),t):{type:null}}var n,r,o={Feature:e,FeatureCollection:function(t){return t.type="GeometryCollection",t.geometries=t.features,t.features.forEach(e),delete t.features,t}},a={GeometryCollection:function(t){for(var e=t.geometries,n=-1,r=e.length;++n<r;)e[n]=i(e[n])},MultiPoint:function(t){t.coordinates.length?t.coordinates.length<2&&(t.type="Point",t.coordinates=t.coordinates[0]):(t.type=null,delete t.coordinates)},LineString:function(t){t.coordinates.length||(t.type=null,delete t.coordinates)},MultiLineString:function(t){for(var e=t.coordinates,n=0,r=0,i=e.length;n<i;++n){var o=e[n];o.length&&(e[r++]=o)}r?r<2?(t.type="LineString",t.coordinates=e[0]):t.coordinates.length=r:(t.type=null,delete t.coordinates)},Polygon:function(t){for(var e=t.coordinates,n=0,r=0,i=e.length;n<i;++n){var o=e[n];o.length&&(e[r++]=o)}r?t.coordinates.length=r:(t.type=null,delete t.coordinates)},MultiPolygon:function(t){for(var e=t.coordinates,n=0,r=0,i=e.length;n<i;++n){for(var o=e[n],a=0,s=0,l=o.length;a<l;++a){var u=o[a];u.length&&(o[s++]=u)}s&&(o.length=s,e[r++]=o)}r?r<2?(t.type="Polygon",t.coordinates=e[0]):e.length=r:(t.type=null,delete t.coordinates)}};for(n in t)t[n]=((r=t[n])&&o.hasOwnProperty(r.type)?o[r.type]:i)(r);return t}},{}],117:[function(t,e,n){var c=t("./quantize");e.exports=function(t,e,n){if(e){if(n===e||!t.bbox.every(isFinite))return t;var e=n/e,r=c(0,0,e,e);t.transform.scale[0]/=e,t.transform.scale[1]/=e}else{var e=t.bbox,i=isFinite(e[0])?e[0]:0,o=isFinite(e[1])?e[1]:0,a=isFinite(e[2])?e[2]:0,e=isFinite(e[3])?e[3]:0,r=c(-i,-o,a-i?(n-1)/(a-i):1,e-o?(n-1)/(e-o):1);t.transform=r.transform}function s(t){t&&u.hasOwnProperty(t.type)&&u[t.type](t)}var l,u={GeometryCollection:function(t){t.geometries.forEach(s)},Point:function(t){r.point(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(r.point)}};for(l in t.objects)s(t.objects[l]);return t.arcs=t.arcs.map(function(t){return r.line(t=t.map(function(t){return t.slice()})),t.length<2&&t.push(t[0]),t}),t}},{"./quantize":120}],118:[function(t,e,n){var f=t("./quantize");e.exports=function(t,e,n,r){arguments.length<4&&(r=n);var i=isFinite(e[0])?e[0]:0,o=isFinite(e[1])?e[1]:0,a=isFinite(e[2])?e[2]:0,s=isFinite(e[3])?e[3]:0,l=f(-i,-o,a-i?(r-1)/(a-i)*n/r:1,s-o?(r-1)/(s-o)*n/r:1);function u(t){t&&h.hasOwnProperty(t.type)&&h[t.type](t)}var c,h={GeometryCollection:function(t){t.geometries.forEach(u)},Point:function(t){l.point(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(l.point)},LineString:function(t){t=t.coordinates;l.line(t),t.length<2&&(t[1]=t[0])},MultiLineString:function(t){for(var e=t.coordinates,n=0,r=e.length;n<r;++n){var i=e[n];l.line(i),i.length<2&&(i[1]=i[0])}},Polygon:function(t){for(var e=t.coordinates,n=0,r=e.length;n<r;++n){var i=e[n];for(l.line(i);i.length<4;)i.push(i[0])}},MultiPolygon:function(t){for(var e=t.coordinates,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length;o<a;++o){var s=i[o];for(l.line(s);s.length<4;)s.push(s[0])}}};for(c in t)u(t[c]);return l.transform}},{"./quantize":120}],119:[function(t,e,n){e.exports=function(t,e){var n=!1,r=t.objects,a=t.arcs,i=a.length,s=t.arcs=[],l=0,u=new Array(a.length);function o(t){t&&h.hasOwnProperty(t.type)&&h[t.type](t)}e&&"verbose"in e&&(n=!!e.verbose);var c,h={GeometryCollection:function(t){t.geometries.forEach(o)},LineString:function(t){f(t.arcs)},MultiLineString:function(t){t.arcs.forEach(f)},Polygon:function(t){t.arcs.forEach(f)},MultiPolygon:function(t){t.arcs.forEach(p)}};function f(t){for(var e=0,n=t.length;e<n;++e){var r,i=t[e],o=i<0&&(i=~i,!0);null==(r=u[i])&&(u[i]=r=l++,s[r]=a[i]),t[e]=o?~r:r}}function p(t){t.forEach(f)}for(c in r)o(r[c]);return n&&console.warn("prune: retained "+l+" / "+i+" arcs ("+Math.round(l/i*100)+"%)"),t}},{}],120:[function(t,e,n){e.exports=function(e,n,r,i){function c(t){return t[0]=Math.round((t[0]+e)*r),t[1]=Math.round((t[1]+n)*i),t}return{point:c,line:function(t){for(var e,n,r,i=0,o=1,a=t.length,s=c(t[0]),l=s[0],u=s[1];++i<a;)n=(s=c(t[i]))[0],r=s[1],n===l&&r===u||((e=t[o++])[0]=l=n,e[1]=u=r);t.length=o},transform:{scale:[1/r,1/i],translate:[-e,-n]}}}},{}],121:[function(t,e,n){var g=t("./type");function m(){}e.exports=function(t,e){var n,r=0,i=!0,e=(e&&("width"in e&&(u=+e.width),"height"in e&&(c=+e.height),"margin"in e&&(r=+e.margin),"invert"in e&&(i=!!e.invert)),t.bbox),o=e[2]-e[0],a=e[3]-e[1],s=(e[2]+e[0])/2,l=(e[3]+e[1])/2,u=Math.max(0,u-2*r),c=Math.max(0,c-2*r),h=(u&&c?n=Math.min(u/o,c/a):u?c=(n=u/o)*a:u=(n=c/a)*o,i?-n:n),a=f([e[0],e[1]]),o=f([e[2],e[3]]);function f(t){return[t[0]*n+(u/2-s*n)+r,t[1]*h+(c/2-l*h)+r]}if(t.bbox=i?[a[0],o[1],o[0],a[1]]:[a[0],a[1],o[0],o[1]],e=t.transform)e.scale[0]*=n,e.scale[1]*=h,e.translate[0]=u/2+r-(s-e.translate[0])*n,e.translate[1]=c/2+r-(l-e.translate[1])*h;else{var p,d=g({LineString:m,MultiLineString:m,Point:function(t){t.coordinates=f(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(f)},Polygon:m,MultiPolygon:m});for(p in t.objects)d.object(t.objects[p]);t.arcs=t.arcs.map(function(t){return t.map(f)})}return t}},{"./type":136}],122:[function(t,e,n){var s=t("../../"),c=t("./coordinate-systems");e.exports=function(t,e){var n,r,l=0,i=!1,o=null,a=t.arcs.reduce(function(t,e){return t+e.length},0),u=0;return e&&("minimum-area"in e&&(l=+e["minimum-area"]),"coordinate-system"in e&&(o=c[e["coordinate-system"]]),"retain-proportion"in e&&(n=+e["retain-proportion"]),"verbose"in e&&(i=!!e.verbose)),s.presimplify(t,o.triangleArea),n&&(r=[],t.arcs.forEach(function(t){t.forEach(function(t){isFinite(t[2])&&r.push(t[2])})}),e["minimum-area"]=l=a?r.sort(function(t,e){return e-t})[Math.ceil((a-1)*n)]:0,i&&console.warn("simplification: effective minimum area "+l.toPrecision(3))),t.arcs.forEach(t.transform?function(t){for(var e,n,r=0,i=0,o=-1,a=-1,s=t.length;++o<s;)(e=t[o])[2]>=l?((n=t[++a])[0]=e[0]+r,n[1]=e[1]+i,r=i=0):(r+=e[0],i+=e[1]);t.length=++a}:function(t){for(var e,n=-1,r=-1,i=t.length;++n<i;)(e=t[n])[2]>=l&&(t[++r]=e);t.length=++r}),t.arcs.forEach(t.transform?function(t){var e=0,n=0,r=t.length,i=t[0];for(i.length=2;++e<r;)(i=t[e]).length=2,(i[0]||i[1])&&(t[++n]=i);u+=t.length=(n||1)+1}:function(t){var e,n,r=0,i=0,o=t.length,a=t[0],s=a[0],l=a[1];for(a.length=2;++r<o;)e=(a=t[r])[0],n=a[1],a.length=2,s===e&&l===n||(t[++i]=a,s=e,l=n);u+=t.length=(i||1)+1}),i&&console.warn("simplification: retained "+u+" / "+a+" points ("+Math.round(u/a*100)+"%)"),t}},{"../../":"topojson","./coordinate-systems":113}],123:[function(t,e,n){var g=Math.PI,m=g/4,y=g/180;function i(t,e){var n=(e[0]-t[0])*y,r=Math.sin(n),n=Math.cos(n),i=Math.sin(t[1]*y),t=Math.cos(t[1]*y),o=Math.sin(e[1]*y),e=Math.cos(e[1]*y);return Math.atan2(Math.sqrt((r=e*r)*r+(r=t*o-i*e*n)*r),i*o+t*e*n)}function o(t){return(t=Math.sin(t/2))*t}n.name="spherical",n.formatDistance=function(t){var e=t*y*6371;return(1<e?e.toFixed(3)+"km":(1e3*e).toPrecision(3)+"m")+" ("+t.toPrecision(3)+"°)"},n.ringArea=function(t){if(!t.length)return 0;for(var e=0,n=t[0],r=n[0]*y,i=n[1]*y/2+m,o=r,a=Math.cos(i),s=Math.sin(i),l=1,u=t.length;l<u;++l){n=t[l],r=n[0]*y,i=n[1]*y/2+m;var c=r-o,h=Math.cos(i),f=Math.sin(i),p=s*f,d=a*h+p*Math.cos(c),p=p*Math.sin(c);e+=Math.atan2(p,d),o=r,a=h,s=f}return 2*(g<e?e-2*g:e<-g?e+2*g:e)},n.absoluteArea=function(t){return t<0?t+4*g:t},n.triangleArea=function(t){var e=i(t[0],t[1]),n=i(t[1],t[2]),t=i(t[2],t[0]),r=(e+n+t)/2;return 4*Math.atan(Math.sqrt(Math.max(0,Math.tan(r/2)*Math.tan((r-e)/2)*Math.tan((r-n)/2)*Math.tan((r-t)/2))))},n.distance=function(t,e,n,r){return t*=y,e*=y,n*=y,r*=y,2*Math.asin(Math.sqrt(o(r-e)+Math.cos(e)*Math.cos(r)*o(n-t)))}},{}],124:[function(t,e,n){var h=t("./type");e.exports=function(t,e){var n,r,i,o=-180,x=o+.01,k=179.99,a=-90,S=a+.01,s=90,E=s-.01;function I(t){return t<=S?[0,a]:E<=t?[0,s]:[o,t]}function l(t){for(var e=[],n=0,r=t.length;n<r;++n){for(var i=t[n],o=0,a=i.length;o<a;++o){var s=i[o];s.polygon=i,e.push(s);for(var l=0,u=s.length;l<u;++l){var c=s[l],h=c[0],c=c[1];if(h<=x||k<=h||c<=S||E<=c){for(var f=l+1;f<u;++f){var p=s[f],d=p[0],p=p[1];if(x<d&&d<k&&S<p&&p<E)break}if(f!==l+1){if(l?((h=s.slice(0,l+1)).polygon=i,h[h.length-1]=I(c),e[e.length-1]=h):e.pop(),u<=f)break;e.push(s=s.slice(f-1)),s[0]=I(s[0][1]),s.polygon=i,l=-1,u=s.length}}}}i.length=0}for(var g={},m={},l=0,u=e.length;l<u;++l){var y=(v=e[l])[0],b=v[v.length-1];y[0]===b[0]&&y[1]===b[1]?(v.polygon.push(v),e[l]=null):(v.index=l,g[y]=m[b]=v)}for(var v,w,_,l=0;l<u;++l)(v=e[l])&&(y=v[0],b=v[v.length-1],w=m[y],_=g[b],delete g[y],delete m[b],y[0]===b[0]&&y[1]===b[1]?v.polygon.push(v):w?(delete m[y],delete g[w[0]],w.pop(),e[w.index]=null,(v=w.concat(v)).polygon=w.polygon,w===_?v.polygon.push(v):(v.index=u++,e.push(g[v[0]]=m[v[v.length-1]]=v))):_?(delete g[b],delete m[_[_.length-1]],v.pop(),(v=v.concat(_)).polygon=_.polygon,v.index=u++,e[_.index]=null,e.push(g[v[0]]=m[v[v.length-1]]=v)):(v.push(v[0]),v.polygon.push(v)))}e&&(n=e.scale[0],r=e.scale[1],i=e.translate[0],e=e.translate[1],o=Math.round((o-i)/n),Math.round((180-i)/n),a=Math.round((a-e)/r),s=Math.round((s-e)/r),x=Math.round((x-i)/n),k=Math.round((k-i)/n),S=Math.round((S-e)/r),E=Math.round((E-e)/r));var u,c=h({Polygon:function(t){l([t.coordinates])},MultiPolygon:function(t){l(t.coordinates)}});for(u in t)c.object(t[u])}},{"./type":136}],125:[function(t,e,n){t("./type");var c=t("./stitch"),h=t("./coordinate-systems"),f=t("./topology/index"),p=t("./delta"),d=t("./geomify"),g=t("./pre-quantize"),m=t("./post-quantize"),y=t("./bounds"),b=t("./compute-id"),v=t("./transform-properties");e.exports=function(t,e){var n,r=1e4,i=1e4,o=function(t){return t.id},a=function(){},s=!0,l=!1,u=null;if(e&&("verbose"in e&&(l=!!e.verbose),"stitch-poles"in e&&(s=!!e["stitch-poles"]),"coordinate-system"in e&&(u=h[e["coordinate-system"]]),"minimum-area"in e&&e["minimum-area"],"quantization"in e&&(r=i=+e.quantization),"pre-quantization"in e&&(r=+e["pre-quantization"]),"post-quantization"in e&&(i=+e["post-quantization"]),"id"in e&&(o=e.id),"property-transform"in e&&(a=e["property-transform"])),r/i%1)throw new Error("post-quantization is not a divisor of pre-quantization");if(r&&!i)throw new Error("post-quantization is required when input is already quantized");b(t,o),v(t,a),d(t);o=y(t),a=o[0]<-180-1e-6||o[1]<-90-1e-6||o[2]>180+1e-6||o[3]>90+1e-6;if(u||(u=h[a?"cartesian":"spherical"],e&&(e["coordinate-system"]=u.name)),u===h.spherical){if(a)throw new Error("spherical coordinates outside of [±180°, ±90°]");o[0]<1e-6-180&&(o[0]=-180),o[1]<1e-6-90&&(o[1]=-90),o[2]>180-1e-6&&(o[2]=180),o[3]>90-1e-6&&(o[3]=90)}l&&console.warn("bounds: "+o.join(" ")+" ("+u.name+")"),r&&(n=g(t,o,r,i),l&&console.warn("pre-quantization: "+n.scale.map(function(t){return u.formatDistance(t)}).join(" "))),u===h.spherical&&s&&c(t,n);e=f(t);return r&&(e.transform=n),e.bbox=o,l&&console.warn("topology: "+e.arcs.length+" arcs, "+e.arcs.reduce(function(t,e){return t+e.length},0)+" points"),i&&i!==r&&(m(e,r,i),n=e.transform,l&&console.warn("post-quantization: "+n.scale.map(function(t){return u.formatDistance(t)}).join(" "))),i&&p(e),e}},{"./bounds":109,"./compute-id":112,"./coordinate-systems":113,"./delta":114,"./geomify":116,"./post-quantize":117,"./pre-quantize":118,"./stitch":124,"./topology/index":131,"./transform-properties":135,"./type":136}],126:[function(t,e,n){var w=t("./join");function _(t,e,n){for(var r,i=e+(n---e>>1);e<i;++e,--n)r=t[e],t[e]=t[n],t[n]=r}e.exports=function(t){for(var e=w(t),n=t.coordinates,r=t.lines,i=t.rings,o=0,a=r.length;o<a;++o)for(var s=r[o],l=s[0],u=s[1];++l<u;)e.has(n[l])&&(d={0:l,1:s[1]},s[1]=l,s=s.next=d);for(var c,h,f,p,o=0,a=i.length;o<a;++o)for(var d,g=i[o],m=g[0],y=m,b=g[1],v=e.has(n[m]);++y<b;)e.has(n[y])&&(v?(d={0:y,1:g[1]},g[1]=y,g=g.next=d):(p=(f=b)-y,_(c=n,h=m,f),_(c,h,h+p),_(c,h+p,f),n[b]=n[m],v=!0,y=m));return t}},{"./join":132}],127:[function(t,e,n){t("./join");var g=t("./hashmap"),m=t("./point-hash"),y=t("./point-equal");e.exports=function(t){var c=t.coordinates,e=t.lines,n=t.rings,r=e.length+n.length;delete t.lines,delete t.rings;for(var i=0,o=e.length;i<o;++i)for(var a=e[i];a=a.next;)++r;for(i=0,o=n.length;i<o;++i)for(var s=n[i];s=s.next;)++r;for(var u=g(2*r*1.4,m,y),h=t.arcs=[],i=0,o=e.length;i<o;++i)for(a=e[i];l(a),a=a.next;);for(i=0,o=n.length;i<o;++i)if((s=n[i]).next)for(;l(s),s=s.next;);else!function(t){var e,n;if(n=u.get(e=c[t[0]]))for(var r=0,i=n.length;r<i;++r){if(f(o=n[r],t))return t[0]=o[0],t[1]=o[1];if(p(o,t))return t[0]=o[1],t[1]=o[0]}if(n=u.get(e=c[t[0]+d(t)]))for(var o,r=0,i=n.length;r<i;++r){if(f(o=n[r],t))return t[0]=o[0],t[1]=o[1];if(p(o,t))return t[0]=o[1],t[1]=o[0]}n?n.push(t):u.set(e,[t]);h.push(t)}(s);function l(t){var e,n,r,i;if(r=u.get(e=c[t[0]]))for(var o=0,a=r.length;o<a;++o){var s=r[o];if(function(t,e){var n=t[0],r=e[0],i=t[1],t=e[1];if(n-i!=r-t)return;for(;n<=i;++n,++r)if(!y(c[n],c[r]))return;return 1}(s,t))return t[0]=s[0],void(t[1]=s[1])}if(i=u.get(n=c[t[1]]))for(o=0,a=i.length;o<a;++o){var l=i[o];if(function(t,e){var n=t[0],r=e[0],i=t[1],o=e[1];if(n-i!=r-o)return;for(;n<=i;++n,--o)if(!y(c[n],c[o]))return;return 1}(l,t))return t[1]=l[0],void(t[0]=l[1])}r?r.push(t):u.set(e,[t]),i?i.push(t):u.set(n,[t]),h.push(t)}function f(t,e){var n=t[0],r=e[0],i=t[1],o=e[1],a=i-n;if(a==o-r){for(var s=d(t),l=d(e),u=0;u<a;++u)if(!y(c[n+(u+s)%a],c[r+(u+l)%a]))return;return 1}}function p(t,e){var n=t[0],r=e[0],i=t[1],o=e[1],a=i-n;if(a==o-r){for(var s=d(t),l=a-d(e),u=0;u<a;++u)if(!y(c[n+(u+s)%a],c[o-(u+l)%a]))return;return 1}}function d(t){for(var e=t[0],n=t[1],r=e,i=r,o=c[r];++r<n;){var a=c[r];(a[0]<o[0]||a[0]===o[0]&&a[1]<o[1])&&(i=r,o=a)}return i-e}return t}},{"./hashmap":129,"./join":132,"./point-equal":133,"./point-hash":134}],128:[function(t,e,n){e.exports=function(t){var i=-1,o=[],a=[],s=[];function e(t){t&&r.hasOwnProperty(t.type)&&r[t.type](t)}var n,r={GeometryCollection:function(t){t.geometries.forEach(e)},LineString:function(t){t.arcs=l(t.coordinates),delete t.coordinates},MultiLineString:function(t){t.arcs=t.coordinates.map(l),delete t.coordinates},Polygon:function(t){t.arcs=t.coordinates.map(u),delete t.coordinates},MultiPolygon:function(t){t.arcs=t.coordinates.map(c),delete t.coordinates}};function l(t){for(var e=0,n=t.length;e<n;++e)s[++i]=t[e];var r={0:i-n+1,1:i};return o.push(r),r}function u(t){for(var e=0,n=t.length;e<n;++e)s[++i]=t[e];var r={0:i-n+1,1:i};return a.push(r),r}function c(t){return t.map(u)}for(n in t)e(t[n]);return{type:"Topology",coordinates:s,lines:o,rings:a,objects:t}}},{}],129:[function(t,e,n){e.exports=function(o,a,s,t,l,e){3===arguments.length&&(t=e=Array,l=null);for(var u=new t(o=1<<Math.max(4,Math.ceil(Math.log(o)/Math.LN2))),c=new e(o),h=o-1,n=0;n<o;++n)u[n]=l;return{set:function(t,e){for(var n=a(t)&h,r=u[n],i=0;r!=l;){if(s(r,t))return c[n]=e;if(++i>=o)throw new Error("full hashmap");r=u[n=n+1&h]}return u[n]=t,c[n]=e,e},maybeSet:function(t,e){for(var n=a(t)&h,r=u[n],i=0;r!=l;){if(s(r,t))return c[n];if(++i>=o)throw new Error("full hashmap");r=u[n=n+1&h]}return u[n]=t,c[n]=e,e},get:function(t,e){for(var n=a(t)&h,r=u[n],i=0;r!=l;){if(s(r,t))return c[n];if(++i>=o)break;r=u[n=n+1&h]}return e},keys:function(){for(var t=[],e=0,n=u.length;e<n;++e){var r=u[e];r!=l&&t.push(r)}return t}}}},{}],130:[function(t,e,n){e.exports=function(i,o,a,t,s){3===arguments.length&&(t=Array,s=null);for(var l=new t(i=1<<Math.max(4,Math.ceil(Math.log(i)/Math.LN2))),u=i-1,e=0;e<i;++e)l[e]=s;return{add:function(t){for(var e=o(t)&u,n=l[e],r=0;n!=s;){if(a(n,t))return!0;if(++r>=i)throw new Error("full hashset");n=l[e=e+1&u]}return l[e]=t,!0},has:function(t){for(var e=o(t)&u,n=l[e],r=0;n!=s;){if(a(n,t))return!0;if(++r>=i)break;n=l[e=e+1&u]}return!1},values:function(){for(var t=[],e=0,n=l.length;e<n;++e){var r=l[e];r!=s&&t.push(r)}return t}}}},{}],131:[function(t,e,n){var u=t("./hashmap"),c=t("./extract"),h=t("./cut"),f=t("./dedup");function p(t){var e,n=t[0],t=t[1];return t<n&&(e=n,n=t,t=e),n+31*t}function d(t,e){var n,r=t[0],t=t[1],i=e[0],e=e[1];return t<r&&(n=r,r=t,t=n),e<i&&(n=i,i=e,e=n),r===i&&t===e}e.exports=function(t){var e=f(h(c(t))),n=e.coordinates,r=u(1.4*e.arcs.length,p,d);function i(t){t&&a.hasOwnProperty(t.type)&&a[t.type](t)}t=e.objects,e.arcs=e.arcs.map(function(t,e){return r.set(t,e),n.slice(t[0],t[1]+1)}),delete e.coordinates;var o,n=null,a={GeometryCollection:function(t){t.geometries.forEach(i)},LineString:function(t){t.arcs=s(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(s)},Polygon:function(t){t.arcs=t.arcs.map(s)},MultiPolygon:function(t){t.arcs=t.arcs.map(l)}};function s(t){var e=[];do{var n=r.get(t)}while(e.push(t[0]<t[1]?n:~n),t=t.next);return e}function l(t){return t.map(s)}for(o in t)i(t[o]);return e}},{"./cut":126,"./dedup":127,"./extract":128,"./hashmap":129}],132:[function(t,e,n){var E=t("./hashset"),I=t("./hashmap"),L=t("./point-hash"),M=t("./point-equal");e.exports=function(t){for(var i=t.coordinates,e=t.lines,n=t.rings,r=function(){for(var t=I(1.4*i.length,_,x,Int32Array,-1,Int32Array),e=new Int32Array(i.length),n=0,r=i.length;n<r;++n)e[n]=t.maybeSet(n,n);return e}(),o=new Int32Array(i.length),a=new Int32Array(i.length),s=new Int32Array(i.length),l=new Int8Array(i.length),u=0,c=0,h=i.length;c<h;++c)o[c]=a[c]=s[c]=-1;for(c=0,h=e.length;c<h;++c){var f=e[c],p=f[0],d=f[1],g=r[p],m=r[++p];for(++u,l[g]=1;++p<=d;)w(c,g,g=m,m=r[p]);++u,l[m]=1}for(c=0,h=i.length;c<h;++c)o[c]=-1;for(c=0,h=n.length;c<h;++c){var y=n[c],b=y[0]+1,v=y[1];for(w(c,r[v-1],g=r[b-1],m=r[b]);++b<=v;)w(c,g,g=m,m=r[b])}function w(t,e,n,r){var i;o[n]!==t&&(o[n]=t,0<=(t=a[n])?(i=s[n],t===e&&i===r||t===r&&i===e||(++u,l[n]=1)):(a[n]=e,s[n]=r))}function _(t){return L(i[t])}function x(t,e){return M(i[t],i[e])}for(var k,o=a=s=null,S=E(1.4*u,L,M),c=0,h=i.length;c<h;++c)l[k=r[c]]&&S.add(i[k]);return S}},{"./hashmap":129,"./hashset":130,"./point-equal":133,"./point-hash":134}],133:[function(t,e,n){e.exports=function(t,e){return t[0]===e[0]&&t[1]===e[1]}},{}],134:[function(t,e,n){var r=new ArrayBuffer(16),i=new Float64Array(r),o=new Uint32Array(r);e.exports=function(t){i[0]=t[0],i[1]=t[1];t=o[0]^o[1];return 2147483647&(t<<5^t>>7^o[2]^o[3])}},{}],135:[function(t,e,n){e.exports=function(t,o){function e(t){if(t.properties){var e,n=t.properties,r={},i=!0;for(e in n)o(r,e,n[e])&&(i=!1);i?delete t.properties:t.properties=r}}arguments.length<2&&(o=function(){});var n,r,i={Feature:e,FeatureCollection:function(t){t.features.forEach(e)}};for(n in t)(r=t[n])&&i.hasOwnProperty(r.type)&&i[r.type](r);return t}},{}],136:[function(t,e,n){e.exports=function(t){for(var e in r)e in t||(t[e]=r[e]);return t.defaults=r,t};var r={Feature:function(t){t.geometry&&this.geometry(t.geometry)},FeatureCollection:function(t){for(var e=t.features,n=-1,r=e.length;++n<r;)this.Feature(e[n])},GeometryCollection:function(t){for(var e=t.geometries,n=-1,r=e.length;++n<r;)this.geometry(e[n])},LineString:function(t){this.line(t.coordinates)},MultiLineString:function(t){for(var e=t.coordinates,n=-1,r=e.length;++n<r;)this.line(e[n])},MultiPoint:function(t){for(var e=t.coordinates,n=-1,r=e.length;++n<r;)this.point(e[n])},MultiPolygon:function(t){for(var e=t.coordinates,n=-1,r=e.length;++n<r;)this.polygon(e[n])},Point:function(t){this.point(t.coordinates)},Polygon:function(t){this.polygon(t.coordinates)},object:function(t){return null==t?null:o.hasOwnProperty(t.type)?this[t.type](t):this.geometry(t)},geometry:function(t){return null!=t&&i.hasOwnProperty(t.type)?this[t.type](t):null},point:function(){},line:function(t){for(var e=-1,n=t.length;++e<n;)this.point(t[e])},polygon:function(t){for(var e=-1,n=t.length;++e<n;)this.line(t[e])}},i={LineString:1,MultiLineString:1,MultiPoint:1,MultiPolygon:1,Point:1,Polygon:1,GeometryCollection:1},o={Feature:1,FeatureCollection:1}},{}],137:[function(t,a,e){!function(){var t={version:"1.6.8",mesh:function(t){return o(t,e.apply(this,arguments))},meshArcs:e,merge:function(t){return o(t,r.apply(this,arguments))},mergeArcs:r,feature:function(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return i(e,t)})}:i(e,t)},neighbors:function(t){var r={},e=t.map(function(){return[]});function n(t,n){t.forEach(function(t){var e=r[t=t<0?~t:t];e?e.push(n):r[t]=[n]})}function i(t,e){t.forEach(function(t){n(t,e)})}var o,a={LineString:n,MultiLineString:i,Polygon:i,MultiPolygon:function(t,e){t.forEach(function(t){i(t,e)})}};for(o in t.forEach(function e(t,n){"GeometryCollection"===t.type?t.geometries.forEach(function(t){e(t,n)}):t.type in a&&a[t.type](t.arcs,n)}),r)for(var s=r[o],l=s.length,u=0;u<l;++u)for(var c=u+1;c<l;++c){var h,f=s[u],p=s[c];(h=e[f])[o=d(h,p)]!==p&&h.splice(o,0,p),(h=e[p])[o=d(h,f)]!==f&&h.splice(o,0,f)}return e},presimplify:function(t,i){var o,a=p(t.transform),e=function(t){var r,i,o,a,s,l;return t?(o=t.scale[0],a=t.scale[1],s=t.translate[0],l=t.translate[1],function(t,e){e||(r=i=0);var e=(t[0]-s)/o|0,n=(t[1]-l)/a|0;t[0]=e-r,t[1]=n-i,r=e,i=n}):g}(t.transform),s=function(){var t={},a=[],s=0;function r(t,e){for(;0<e;){var n=(e+1>>1)-1,r=a[n];if(0<=h(t,r))break;a[r._=e]=r,a[t._=e=n]=t}}function i(t,e){for(;;){var n=e+1<<1,r=n-1,i=e,o=a[i];if(r<s&&h(a[r],o)<0&&(o=a[i=r]),n<s&&h(a[n],o)<0&&(o=a[i=n]),i===e)break;a[o._=e]=o,a[t._=e=i]=t}}return t.push=function(t){return r(a[t._=s]=t,s++),s},t.pop=function(){var t,e;if(!(s<=0))return t=a[0],0<--s&&i(a[(e=a[s])._=0]=e,0),t},t.remove=function(t){var e,n=t._;if(a[n]===t)return n!==--s&&(h(e=a[s],t)<0?r:i)(a[e._=n]=e,n),n},t}(),n=0;i=i||c;t.arcs.forEach(function(t){var e=[];t.forEach(a);for(var n=1,r=t.length-1;n<r;++n)(o=t.slice(n-1,n+2))[1][2]=i(o),e.push(o),s.push(o);t[0][2]=t[r][2]=1/0;for(n=0,r=e.length;n<r;++n)(o=e[n]).previous=e[n-1],o.next=e[n+1]});for(;o=s.pop();){var r=o.previous,l=o.next;o[1][2]<n?o[1][2]=n:n=o[1][2],r&&(r.next=l,r[2]=o[2],u(r)),l&&(l.previous=r,l[0]=o[0],u(l))}function u(t){s.remove(t),t[1][2]=i(t),s.push(t)}return t.arcs.forEach(function(t){t.forEach(e)}),t}};function f(a,r){var i={},s={},l={},o=[],u=-1;function t(t,e){for(var n in t){n=t[n];delete e[n.start],delete n.start,delete n.end,n.forEach(function(t){i[t<0?~t:t]=1}),o.push(n)}}return r.forEach(function(t,e){var n=a.arcs[t<0?~t:t];n.length<3&&!n[1][0]&&!n[1][1]&&(n=r[++u],r[u]=t,r[e]=n)}),r.forEach(function(t){var e,n,r,i=function(t){var e,n=a.arcs[t<0?~t:t],r=n[0];a.transform?(e=[0,0],n.forEach(function(t){e[0]+=t[0],e[1]+=t[1]})):e=n[n.length-1];return t<0?[e,r]:[r,e]}(t),o=i[0],i=i[1];(e=l[o])?(delete l[e.end],e.push(t),e.end=i,(n=s[i])?(delete s[n.start],r=n===e?e:e.concat(n),s[r.start=e.start]=l[r.end=n.end]=r):s[e.start]=l[e.end]=e):(e=s[i])?(delete s[e.start],e.unshift(t),e.start=o,(n=l[o])?(delete l[n.end],r=n===e?e:n.concat(e),s[r.start=n.start]=l[r.end=e.end]=r):s[e.start]=l[e.end]=e):s[(e=[t]).start=o]=l[e.end=i]=e}),t(l,s),t(s,l),r.forEach(function(t){i[t<0?~t:t]||o.push([t])}),o}function e(t,e,n){var r=[];if(1<arguments.length){var i,o=[];function a(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:i})}function s(t){t.forEach(a)}function l(t){t.forEach(s)}var u={LineString:s,MultiLineString:l,Polygon:l,MultiPolygon:function(t){t.forEach(l)}};!function t(e){"GeometryCollection"===e.type?e.geometries.forEach(t):e.type in u&&u[(i=e).type](e.arcs)}(e),o.forEach(arguments.length<3?function(t){r.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&r.push(t[0].i)})}else for(var c=0,h=t.arcs.length;c<h;++c)r.push(c);return{type:"MultiLineString",arcs:f(t,r)}}function r(a,t){var s={},r=[],i=[];function e(e){e.forEach(function(t){t.forEach(function(t){(s[t=t<0?~t:t]||(s[t]=[])).push(e)})}),r.push(e)}function l(t){return 0<function(t){var e,n=-1,r=t.length,i=t[r-1],o=0;for(;++n<r;)e=i,i=t[n],o+=e[0]*i[1]-e[1]*i[0];return.5*o}(o(a,{type:"Polygon",arcs:[t]}).coordinates[0])}return t.forEach(function(t){"Polygon"===t.type?e(t.arcs):"MultiPolygon"===t.type&&t.arcs.forEach(e)}),r.forEach(function(t){if(!t._){var e=[],n=[t];for(t._=1,i.push(e);t=n.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){s[t<0?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),r.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:i.map(function(t){var e=[];if(t.forEach(function(t){t.forEach(function(t){t.forEach(function(t){s[t<0?~t:t].length<2&&e.push(t)})})}),e=f(a,e),1<(n=e.length))for(var r,i=l(t[0][0]),o=0;o<n;++o)if(i===l(e[o])){r=e[0],e[0]=e[o],e[o]=r;break}return e})}}function i(t,e){t={type:"Feature",id:e.id,properties:e.properties||{},geometry:o(t,e)};return null==e.id&&delete t.id,t}function o(t,e){var d=p(t.transform),g=t.arcs;function n(t){return t=t.slice(),d(t,0),t}function r(t){for(var e=[],n=0,r=t.length;n<r;++n){p=f=c=i=h=a=u=l=s=o=i=void 0;var i=t[n],o=e;o.length&&o.pop();for(var a,s=g[i<0?~i:i],l=0,u=s.length;l<u;++l)o.push(a=s[l].slice()),d(a,l);if(i<0)for(var c,h=o,i=u,f=h.length,p=f-i;p<--f;)c=h[p],h[p++]=h[f],h[f]=c}return e.length<2&&e.push(e[0].slice()),e}function i(t){for(var e=r(t);e.length<4;)e.push(e[0].slice());return e}function o(t){return t.map(i)}var a={Point:function(t){return n(t.coordinates)},MultiPoint:function(t){return t.coordinates.map(n)},LineString:function(t){return r(t.arcs)},MultiLineString:function(t){return t.arcs.map(r)},Polygon:function(t){return o(t.arcs)},MultiPolygon:function(t){return t.arcs.map(o)}};return function t(e){var n=e.type;return"GeometryCollection"===n?{type:n,geometries:e.geometries.map(t)}:n in a?{type:n,coordinates:a[n](e)}:null}(e)}function d(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;t[i]<e?n=1+i:r=i}return n}function c(t){var e=t[0],n=t[1],t=t[2];return Math.abs((e[0]-t[0])*(n[1]-e[1])-(e[0]-n[0])*(t[1]-e[1]))}function h(t,e){return t[1][2]-e[1][2]}function p(t){var n,r,i,o,a,s;return t?(i=t.scale[0],o=t.scale[1],a=t.translate[0],s=t.translate[1],function(t,e){e||(n=r=0),t[0]=(n+=t[0])*i+a,t[1]=(r+=t[1])*o+s}):g}function g(){}"function"==typeof define&&define.amd?define(t):"object"==typeof a&&a.exports?a.exports=t:this.topojson=t}()},{}],138:[function(t,e,n){var i=e.exports=function(t){return new o(t)};function o(t){this.value=t}function r(t,s,l){var u=[],c=[],h=!0;return function r(e){var t=l?f(e):e,i={},n=!0,o={node:t,node_:e,path:[].concat(u),parent:c[c.length-1],parents:c,key:u.slice(-1)[0],isRoot:0===u.length,level:u.length,circular:null,update:function(t,e){o.isRoot||(o.parent.node[o.key]=t),o.node=t,e&&(n=!1)},delete:function(t){delete o.parent.node[o.key],t&&(n=!1)},remove:function(t){d(o.parent.node)?o.parent.node.splice(o.key,1):delete o.parent.node[o.key],t&&(n=!1)},keys:null,before:function(t){i.before=t},after:function(t){i.after=t},pre:function(t){i.pre=t},post:function(t){i.post=t},stop:function(){h=!1},block:function(){n=!1}};return h&&(a(),void 0!==(t=s.call(o,o.node))&&o.update&&o.update(t),i.before&&i.before.call(o,o.node),n&&("object"!=typeof o.node||null===o.node||o.circular||(c.push(o),a(),g(o.keys,function(t,e){u.push(t),i.pre&&i.pre.call(o,o.node[t],t);var n=r(o.node[t]);l&&m.call(o.node,t)&&(o.node[t]=n.node),n.isLast=e==o.keys.length-1,n.isFirst=0==e,i.post&&i.post.call(o,n),u.pop()}),c.pop()),i.after&&i.after.call(o,o.node))),o;function a(){if("object"==typeof o.node&&null!==o.node){o.keys&&o.node_===o.node||(o.keys=p(o.node)),o.isLeaf=0==o.keys.length;for(var t=0;t<c.length;t++)if(c[t].node_===e){o.circular=c[t];break}}else o.isLeaf=!0,o.keys=null;o.notLeaf=!o.isLeaf,o.notRoot=!o.isRoot}}(t).node}function f(e){var t,n,r;return"object"==typeof e&&null!==e?(r=d(e)?[]:"[object Date]"===a(e)?new Date(e.getTime?e.getTime():e):"[object RegExp]"===a(e)?new RegExp(e):"[object Error]"===a(e)?{message:e.message}:"[object Boolean]"===a(e)?new Boolean(e):"[object Number]"===a(e)?new Number(e):"[object String]"===a(e)?new String(e):Object.create&&Object.getPrototypeOf?Object.create(Object.getPrototypeOf(e)):e.constructor===Object?{}:(t=e.constructor&&e.constructor.prototype||e.__proto__||{},(n=function(){}).prototype=t,new n),g(p(e),function(t){r[t]=e[t]}),r):e}o.prototype.get=function(t){for(var e=this.value,n=0;n<t.length;n++){var r=t[n];if(!e||!m.call(e,r)){e=void 0;break}e=e[r]}return e},o.prototype.has=function(t){for(var e=this.value,n=0;n<t.length;n++){var r=t[n];if(!e||!m.call(e,r))return!1;e=e[r]}return!0},o.prototype.set=function(t,e){for(var n=this.value,r=0;r<t.length-1;r++){var i=t[r];m.call(n,i)||(n[i]={}),n=n[i]}return n[t[r]]=e},o.prototype.map=function(t){return r(this.value,t,!0)},o.prototype.forEach=function(t){return this.value=r(this.value,t,!1),this.value},o.prototype.reduce=function(e,t){var n=1===arguments.length,r=n?this.value:t;return this.forEach(function(t){this.isRoot&&n||(r=e.call(this,r,t))}),r},o.prototype.paths=function(){var e=[];return this.forEach(function(t){e.push(this.path)}),e},o.prototype.nodes=function(){var e=[];return this.forEach(function(t){e.push(this.node)}),e},o.prototype.clone=function(){var i=[],o=[];return function e(n){for(var r,t=0;t<i.length;t++)if(i[t]===n)return o[t];return"object"==typeof n&&null!==n?(r=f(n),i.push(n),o.push(r),g(p(n),function(t){r[t]=e(n[t])}),i.pop(),o.pop(),r):n}(this.value)};var p=Object.keys||function(t){var e,n=[];for(e in t)n.push(e);return n};function a(t){return Object.prototype.toString.call(t)}var d=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},g=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)},m=(g(p(o.prototype),function(r){i[r]=function(t){var e=[].slice.call(arguments,1),n=new o(t);return n[r].apply(n,e)}}),Object.hasOwnProperty||function(t,e){return e in t})},{}],139:[function(t,e,n){function u(t,e){t=document.createElement(t);return e&&(t.className=e),t}function c(t,e){return t.appendChild(e)}function h(t,e,n){t.addEventListener(e,n)}e.exports=function(e){var n=u("div","treeui"),i=function(){},o=function(t){return t},a=function(t){return!0};function s(t){var e=t.target,t=t.target.parentNode;if(e.classList.contains("open")){for(var n=t.getElementsByClassName("treeui-level"),r=0;r<n.length;r++)n[r].parentNode.removeChild(n[r]);e.classList.remove("open"),e.innerHTML="▶"}else l(JSON.parse(t.level),c(t,u("div","treeui-level"))),e.classList.add("open"),e.innerHTML="▼"}function l(t,r){e(t,function(t,e){t||e.forEach(function(t){var e,n;c(r,(t=t,(e=u("div","treeui-item")).level=JSON.stringify(t),a(t)&&((n=c(e,u("span","treeui-caret"))).innerHTML="▶",n.level=JSON.stringify(t),h(n,"click",s)),(n=c(e,u("span","treeui-label"))).textContent=o(t),h(n,"click",function(t){i(JSON.parse(t.target.parentNode.level),t)}),e))})})}l([],n);var r={appendTo:function(t){return t.appendChild(n),r},onclick:function(t){return i=t,r},display:function(t){return o=t,r},expandable:function(t){return a=t,r}};return r}},{}],140:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;function n(){}n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],141:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],142:[function(I,t,L){!function(r,i){var t,s=/%[sdj%]/g,o=(L.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(l(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,i=r.length,o=String(t).replace(s,function(t){if("%%"===t)return"%";if(i<=n)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),a=r[n];n<i;a=r[++n])g(a)||!w(a)?o+=" "+a:o+=" "+l(a);return o},L.deprecate=function(t,e){var n;return b(i.process)?function(){return L.deprecate(t,e).apply(this,arguments)}:!0===r.noDeprecation?t:(n=!1,function(){if(!n){if(r.throwDeprecation)throw new Error(e);r.traceDeprecation?console.trace(e):console.error(e),n=!0}return t.apply(this,arguments)})},{});function l(t,e){var n={seen:[],stylize:u};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),d(e)?n.showHidden=e:e&&L._extend(n,e),b(n.showHidden)&&(n.showHidden=!1),b(n.depth)&&(n.depth=2),b(n.colors)&&(n.colors=!1),b(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=a),c(n,t,n.depth)}function a(t,e){e=l.styles[e];return e?"["+l.colors[e][0]+"m"+t+"["+l.colors[e][1]+"m":t}function u(t,e){return t}function c(e,n,r){if(e.customInspect&&n&&k(n.inspect)&&n.inspect!==L.inspect&&(!n.constructor||n.constructor.prototype!==n))return y(t=n.inspect(r,e))?t:c(e,t,r);var t=function(t,e){if(b(e))return t.stylize("undefined","undefined");{var n;if(y(e))return n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",t.stylize(n,"string")}return m(e)?t.stylize(""+e,"number"):d(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}(e,n);if(t)return t;var i,t=Object.keys(n),o=(i={},t.forEach(function(t,e){i[t]=!0}),i);if(e.showHidden&&(t=Object.getOwnPropertyNames(n)),x(n)&&(0<=t.indexOf("message")||0<=t.indexOf("description")))return h(n);if(0===t.length){if(k(n))return a=n.name?": "+n.name:"",e.stylize("[Function"+a+"]","special");if(v(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(x(n))return h(n)}var a="",s=!1,l=["{","}"];if(p(n)&&(s=!0,l=["[","]"]),k(n)&&(a=" [Function"+(n.name?": "+n.name:"")+"]"),v(n)&&(a=" "+RegExp.prototype.toString.call(n)),_(n)&&(a=" "+Date.prototype.toUTCString.call(n)),x(n)&&(a=" "+h(n)),0===t.length&&(!s||0==n.length))return l[0]+a+l[1];if(r<0)return v(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n),u=s?function(e,n,r,i,t){for(var o=[],a=0,s=n.length;a<s;++a)E(n,String(a))?o.push(f(e,n,r,i,String(a),!0)):o.push("");return t.forEach(function(t){t.match(/^\d+$/)||o.push(f(e,n,r,i,t,!0))}),o}(e,n,r,o,t):t.map(function(t){return f(e,n,r,o,t,s)}),e.seen.pop();var u;return 60<u.reduce(function(t,e){return 0<=e.indexOf("\n")&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)?l[0]+(""===a?"":a+"\n ")+" "+u.join(",\n  ")+" "+l[1]:l[0]+a+" "+u.join(", ")+" "+l[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i,o){var a,s,e=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]};if(e.get?s=e.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):e.set&&(s=t.stylize("[Setter]","special")),E(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(e.value)<0?-1<(s=g(n)?c(t,e.value,null):c(t,e.value,n-1)).indexOf("\n")&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),b(a)){if(o&&i.match(/^\d+$/))return s;a=(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(a,"string"))}return a+": "+s}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function g(t){return null===t}function m(t){return"number"==typeof t}function y(t){return"string"==typeof t}function b(t){return void 0===t}function v(t){return w(t)&&"[object RegExp]"===e(t)}function w(t){return"object"==typeof t&&null!==t}function _(t){return w(t)&&"[object Date]"===e(t)}function x(t){return w(t)&&("[object Error]"===e(t)||t instanceof Error)}function k(t){return"function"==typeof t}function e(t){return Object.prototype.toString.call(t)}function n(t){return t<10?"0"+t.toString(10):t.toString(10)}L.debuglog=function(e){var n;return b(t)&&(t=r.env.NODE_DEBUG||""),e=e.toUpperCase(),o[e]||(new RegExp("\\b"+e+"\\b","i").test(t)?(n=r.pid,o[e]=function(){var t=L.format.apply(L,arguments);console.error("%s %d: %s",e,n,t)}):o[e]=function(){}),o[e]},(L.inspect=l).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},L.isArray=p,L.isBoolean=d,L.isNull=g,L.isNullOrUndefined=function(t){return null==t},L.isNumber=m,L.isString=y,L.isSymbol=function(t){return"symbol"==typeof t},L.isUndefined=b,L.isRegExp=v,L.isObject=w,L.isDate=_,L.isError=x,L.isFunction=k,L.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},L.isBuffer=I("./support/isBuffer");var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(t,e){return Object.prototype.hasOwnProperty.call(t,e)}L.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[n(t.getHours()),n(t.getMinutes()),n(t.getSeconds())].join(":"),[t.getDate(),S[t.getMonth()],e].join(" ")),L.format.apply(L,arguments))},L.inherits=I("inherits"),L._extend=function(t,e){if(e&&w(e))for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}.call(this,I("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":141,_process:88,inherits:140}],143:[function(t,e,n){e.exports=r,e.exports.parse=r,e.exports.stringify=function t(e){"Feature"===e.type&&(e=e.geometry);function n(t){return 2===t.length?t[0]+" "+t[1]:3===t.length?t[0]+" "+t[1]+" "+t[2]:void 0}function r(t){return t.map(n).join(", ")}function i(t){return t.map(r).map(a).join(", ")}function o(t){return t.map(i).map(a).join(", ")}function a(t){return"("+t+")"}switch(e.type){case"Point":return"POINT ("+n(e.coordinates)+")";case"LineString":return"LINESTRING ("+r(e.coordinates)+")";case"Polygon":return"POLYGON ("+i(e.coordinates)+")";case"MultiPoint":return"MULTIPOINT ("+r(e.coordinates)+")";case"MultiPolygon":return"MULTIPOLYGON ("+o(e.coordinates)+")";case"MultiLineString":return"MULTILINESTRING ("+i(e.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+e.geometries.map(t).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}};var u=/^[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/;function r(e){var t,n=e.split(";"),e=n.pop(),n=(n.shift()||"").split("=").pop(),r=0;function o(t){t=e.substring(r).match(t);return t?(r+=t[0].length,t[0]):null}function a(){o(/^\s*/)}function i(){a();for(var t,e=0,n=[],r=[n],i=n;t=o(/^(\()/)||o(/^(\))/)||o(/^(\,)/)||o(u);){if("("==t)r.push(i),r[r.length-1].push(i=[]),e++;else if(")"==t){if(!(i=r.pop()))return;if(0===--e)break}else if(","===t)r[r.length-1].push(i=[]);else{if(isNaN(parseFloat(t)))return null;i.push(parseFloat(t))}a()}return 0!==e?null:n}function s(){for(var t,e,n=[];e=o(u)||o(/^(\,)/);)","==e?(n.push(t),t=[]):(t=t||[]).push(parseFloat(e)),a();return t&&n.push(t),n.length?n:null}function l(){return(o(/^(point)/i)&&(a(),o(/^(\()/)&&(e=s())&&(a(),o(/^(\))/)))?{type:"Point",coordinates:e[0]}:null)||(o(/^(linestring)/i)&&(a(),o(/^(\()/)&&(t=s())&&o(/^(\))/))?{type:"LineString",coordinates:t}:null)||(o(/^(polygon)/i)?(a(),{type:"Polygon",coordinates:i()}):null)||function(){if(!o(/^(multipoint)/i))return null;a();var t=i();return t?(a(),{type:"MultiPoint",coordinates:t}):null}()||function(){if(!o(/^(multilinestring)/i))return null;a();var t=i();return t?(a(),{type:"MultiLineString",coordinates:t}):null}()||(o(/^(multipolygon)/i)?(a(),{type:"MultiPolygon",coordinates:i()}):null)||function(){var t,e=[];if(!o(/^(geometrycollection)/i))return null;if(a(),!o(/^(\()/))return null;for(;t=l();)e.push(t),a(),o(/^(\,)/),a();return o(/^(\))/)?{type:"GeometryCollection",geometries:e}:null}();var t,e}return(t=l())&&n.match(/\d+/)&&(t.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+n}}),t}},{}],144:[function(t,e,n){e.exports.RADIUS=6378137,e.exports.FLATTENING=1/298.257223563,e.exports.POLAR_RADIUS=6356752.3142},{}],145:[function(t,r,e){!function(t){function e(t,e){this.buffer=t,this.position=0,this.isBigEndian=e||!1}function n(e,n,r){return function(){var t=(this.isBigEndian?n:e).call(this.buffer,this.position);return this.position+=r,t}}(r.exports=e).prototype.readUInt8=n(t.prototype.readUInt8,t.prototype.readUInt8,1),e.prototype.readUInt16=n(t.prototype.readUInt16LE,t.prototype.readUInt16BE,2),e.prototype.readUInt32=n(t.prototype.readUInt32LE,t.prototype.readUInt32BE,4),e.prototype.readInt8=n(t.prototype.readInt8,t.prototype.readInt8,1),e.prototype.readInt16=n(t.prototype.readInt16LE,t.prototype.readInt16BE,2),e.prototype.readInt32=n(t.prototype.readInt32LE,t.prototype.readInt32BE,4),e.prototype.readFloat=n(t.prototype.readFloatLE,t.prototype.readFloatBE,4),e.prototype.readDouble=n(t.prototype.readDoubleLE,t.prototype.readDoubleBE,8),e.prototype.readVarInt=function(){for(var t,e=0,n=0;e+=(127&(t=this.buffer[this.position+n]))<<7*n,n++,128<=t;);return this.position+=n,e}}.call(this,t("buffer").Buffer)},{buffer:9}],146:[function(t,r,e){!function(n){function t(t,e){this.buffer=new n(t),this.position=0,this.allowResize=e}function e(n,r){return function(t,e){this.ensureSize(r),n.call(this.buffer,t,this.position,e),this.position+=r}}(r.exports=t).prototype.writeUInt8=e(n.prototype.writeUInt8,1),t.prototype.writeUInt16LE=e(n.prototype.writeUInt16LE,2),t.prototype.writeUInt16BE=e(n.prototype.writeUInt16BE,2),t.prototype.writeUInt32LE=e(n.prototype.writeUInt32LE,4),t.prototype.writeUInt32BE=e(n.prototype.writeUInt32BE,4),t.prototype.writeInt8=e(n.prototype.writeInt8,1),t.prototype.writeInt16LE=e(n.prototype.writeInt16LE,2),t.prototype.writeInt16BE=e(n.prototype.writeInt16BE,2),t.prototype.writeInt32LE=e(n.prototype.writeInt32LE,4),t.prototype.writeInt32BE=e(n.prototype.writeInt32BE,4),t.prototype.writeFloatLE=e(n.prototype.writeFloatLE,4),t.prototype.writeFloatBE=e(n.prototype.writeFloatBE,4),t.prototype.writeDoubleLE=e(n.prototype.writeDoubleLE,8),t.prototype.writeDoubleBE=e(n.prototype.writeDoubleBE,8),t.prototype.writeBuffer=function(t){this.ensureSize(t.length),t.copy(this.buffer,this.position,0,t.length),this.position+=t.length},t.prototype.writeVarInt=function(t){for(var e=1;0!=(4294967168&t);)this.writeUInt8(127&t|128),t>>>=7,e++;return this.writeUInt8(127&t),e},t.prototype.ensureSize=function(t){if(this.buffer.length<this.position+t){if(!this.allowResize)throw new RangeError("index out of range");t=new n(this.position+t);this.buffer.copy(t,0,0,this.buffer.length),this.buffer=t}}}.call(this,t("buffer").Buffer)},{buffer:9}],147:[function(t,e,n){!function(n){e.exports=i;var s=t("./types"),l=t("./point"),u=t("./linestring"),c=t("./polygon"),h=t("./multipoint"),f=t("./multilinestring"),p=t("./multipolygon"),d=t("./geometrycollection"),g=t("./binaryreader"),r=t("./binarywriter"),o=t("./wktparser"),m=t("./zigzag.js");function i(){this.srid=void 0,this.hasZ=!1,this.hasM=!1}i.parse=function(t,e){if("string"==typeof t||t instanceof o)return i._parseWkt(t);if(n.isBuffer(t)||t instanceof g)return i._parseWkb(t,e);throw new Error("first argument must be a string or Buffer")},i._parseWkt=function(t){var e,n=t instanceof o?t:new o(t),t=n.matchRegex([/^SRID=(\d+);/]),t=(t&&(e=parseInt(t[1],10)),n.matchType()),r=n.matchDimension(),i={srid:e,hasZ:r.hasZ,hasM:r.hasM};switch(t){case s.wkt.Point:return l._parseWkt(n,i);case s.wkt.LineString:return u._parseWkt(n,i);case s.wkt.Polygon:return c._parseWkt(n,i);case s.wkt.MultiPoint:return h._parseWkt(n,i);case s.wkt.MultiLineString:return f._parseWkt(n,i);case s.wkt.MultiPolygon:return p._parseWkt(n,i);case s.wkt.GeometryCollection:return d._parseWkt(n,i)}},i._parseWkb=function(t,e){var n,r={},i=t instanceof g?t:new g(t);switch(i.isBigEndian=!i.readInt8(),t=i.readUInt32(),r.hasSrid=536870912==(536870912&t),r.isEwkb=536870912&t||1073741824&t||2147483648&t,r.hasSrid&&(r.srid=i.readUInt32()),r.hasZ=!1,r.hasM=!1,n=r.isEwkb||e&&e.isEwkb?(2147483648&t&&(r.hasZ=!0),1073741824&t&&(r.hasM=!0),15&t):1e3<=t&&t<2e3?(r.hasZ=!0,t-1e3):2e3<=t&&t<3e3?(r.hasM=!0,t-2e3):3e3<=t&&t<4e3?(r.hasZ=!0,r.hasM=!0,t-3e3):t){case s.wkb.Point:return l._parseWkb(i,r);case s.wkb.LineString:return u._parseWkb(i,r);case s.wkb.Polygon:return c._parseWkb(i,r);case s.wkb.MultiPoint:return h._parseWkb(i,r);case s.wkb.MultiLineString:return f._parseWkb(i,r);case s.wkb.MultiPolygon:return p._parseWkb(i,r);case s.wkb.GeometryCollection:return d._parseWkb(i,r);default:throw new Error("GeometryType "+n+" not supported")}},i.parseTwkb=function(t){var e={},n=t instanceof g?t:new g(t),t=n.readUInt8(),r=n.readUInt8(),i=15&t;if(e.precision=m.decode(t>>4),e.precisionFactor=Math.pow(10,e.precision),e.hasBoundingBox=r>>0&1,e.hasSizeAttribute=r>>1&1,e.hasIdList=r>>2&1,e.hasExtendedPrecision=r>>3&1,e.isEmpty=r>>4&1,e.hasExtendedPrecision?(t=n.readUInt8(),e.hasZ=1==(1&t),e.hasM=2==(2&t),e.zPrecision=m.decode((28&t)>>2),e.zPrecisionFactor=Math.pow(10,e.zPrecision),e.mPrecision=m.decode((224&t)>>5),e.mPrecisionFactor=Math.pow(10,e.mPrecision)):(e.hasZ=!1,e.hasM=!1),e.hasSizeAttribute&&n.readVarInt(),e.hasBoundingBox){var o=2;e.hasZ&&o++,e.hasM&&o++;for(var a=0;a<o;a++)n.readVarInt(),n.readVarInt()}switch(i){case s.wkb.Point:return l._parseTwkb(n,e);case s.wkb.LineString:return u._parseTwkb(n,e);case s.wkb.Polygon:return c._parseTwkb(n,e);case s.wkb.MultiPoint:return h._parseTwkb(n,e);case s.wkb.MultiLineString:return f._parseTwkb(n,e);case s.wkb.MultiPolygon:return p._parseTwkb(n,e);case s.wkb.GeometryCollection:return d._parseTwkb(n,e);default:throw new Error("GeometryType "+i+" not supported")}},i.parseGeoJSON=function(t){var e;switch(t.type){case s.geoJSON.Point:e=l._parseGeoJSON(t);break;case s.geoJSON.LineString:e=u._parseGeoJSON(t);break;case s.geoJSON.Polygon:e=c._parseGeoJSON(t);break;case s.geoJSON.MultiPoint:e=h._parseGeoJSON(t);break;case s.geoJSON.MultiLineString:e=f._parseGeoJSON(t);break;case s.geoJSON.MultiPolygon:e=p._parseGeoJSON(t);break;case s.geoJSON.GeometryCollection:e=d._parseGeoJSON(t);break;default:throw new Error("GeometryType "+t.type+" not supported")}if(t.crs&&t.crs.type&&"name"===t.crs.type&&t.crs.properties&&t.crs.properties.name){var n=t.crs.properties.name;if(0===n.indexOf("EPSG:"))e.srid=parseInt(n.substring(5));else{if(0!==n.indexOf("urn:ogc:def:crs:EPSG::"))throw new Error("Unsupported crs: "+n);e.srid=parseInt(n.substring(22))}}return e},i.prototype.toEwkt=function(){return"SRID="+this.srid+";"+this.toWkt()},i.prototype.toEwkb=function(){var t=new r(this._getWkbSize()+4),e=this.toWkb();return t.writeInt8(1),t.writeUInt32LE(536870912|e.slice(1,5).readUInt32LE(0),!0),t.writeUInt32LE(this.srid),t.writeBuffer(e.slice(5)),t.buffer},i.prototype._getWktType=function(t,e){return this.hasZ&&this.hasM?t+=" ZM ":this.hasZ?t+=" Z ":this.hasM&&(t+=" M "),!e||this.hasZ||this.hasM||(t+=" "),e&&(t+="EMPTY"),t},i.prototype._getWktCoordinate=function(t){var e=t.x+" "+t.y;return this.hasZ&&(e+=" "+t.z),this.hasM&&(e+=" "+t.m),e},i.prototype._writeWkbType=function(t,e,n){var r=0;void 0!==this.srid||n&&void 0!==n.srid?(this.hasZ&&(r|=2147483648),this.hasM&&(r|=1073741824)):this.hasZ&&this.hasM?r+=3e3:this.hasZ?r+=1e3:this.hasM&&(r+=2e3),t.writeUInt32LE(r+e,!0)},i.getTwkbPrecision=function(t,e,n){return{xy:t,z:e,m:n,xyFactor:Math.pow(10,t),zFactor:Math.pow(10,e),mFactor:Math.pow(10,n)}},i.prototype._writeTwkbHeader=function(t,e,n,r){n=(m.encode(n.xy)<<4)+e,e=(this.hasZ||this.hasM)<<3;e+=r<<4,t.writeUInt8(n),t.writeUInt8(e),(this.hasZ||this.hasM)&&(r=0,this.hasZ&&(r|=1),this.hasM&&(r|=2),t.writeUInt8(r))},i.prototype.toGeoJSON=function(t){var e={};return this.srid&&t&&(t.shortCrs?e.crs={type:"name",properties:{name:"EPSG:"+this.srid}}:t.longCrs&&(e.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+this.srid}})),e}}.call(this,{isBuffer:t("../../is-buffer/index.js")})},{"../../is-buffer/index.js":36,"./binaryreader":145,"./binarywriter":146,"./geometrycollection":148,"./linestring":149,"./multilinestring":150,"./multipoint":151,"./multipolygon":152,"./point":153,"./polygon":154,"./types":155,"./wktparser":156,"./zigzag.js":158}],148:[function(t,e,n){e.exports=s;var e=t("util"),i=t("./types"),o=t("./geometry"),a=t("./binarywriter");function s(t){o.call(this),this.geometries=t||[],0<this.geometries.length&&(this.hasZ=this.geometries[0].hasZ,this.hasM=this.geometries[0].hasM)}e.inherits(s,o),s.Z=function(t){t=new s(t);return t.hasZ=!0,t},s.M=function(t){t=new s(t);return t.hasM=!0,t},s.ZM=function(t){t=new s(t);return t.hasZ=!0,t.hasM=!0,t},s._parseWkt=function(t,e){var n=new s;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,!t.isMatch(["EMPTY"])){for(t.expectGroupStart();n.geometries.push(o.parse(t)),t.isMatch([","]););t.expectGroupEnd()}return n},s._parseWkb=function(t,e){for(var n=new s,r=(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.readUInt32()),i=0;i<r;i++)n.geometries.push(o.parse(t,e));return n},s._parseTwkb=function(t,e){var n=new s;if(n.hasZ=e.hasZ,n.hasM=e.hasM,!e.isEmpty)for(var r=t.readVarInt(),i=0;i<r;i++)n.geometries.push(o.parseTwkb(t));return n},s._parseGeoJSON=function(t){for(var e=new s,n=0;n<t.geometries.length;n++)e.geometries.push(o.parseGeoJSON(t.geometries[n]));return 0<e.geometries.length&&(e.hasZ=e.geometries[0].hasZ),e},s.prototype.toWkt=function(){if(0===this.geometries.length)return this._getWktType(i.wkt.GeometryCollection,!0);for(var t=this._getWktType(i.wkt.GeometryCollection,!1)+"(",e=0;e<this.geometries.length;e++)t+=this.geometries[e].toWkt()+",";return t=t.slice(0,-1),t+=")"},s.prototype.toWkb=function(){var t=new a(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,i.wkb.GeometryCollection),t.writeUInt32LE(this.geometries.length);for(var e=0;e<this.geometries.length;e++)t.writeBuffer(this.geometries[e].toWkb({srid:this.srid}));return t.buffer},s.prototype.toTwkb=function(){var t=new a(0,!0),e=o.getTwkbPrecision(5,0,0),n=0===this.geometries.length;if(this._writeTwkbHeader(t,i.wkb.GeometryCollection,e,n),0<this.geometries.length){t.writeVarInt(this.geometries.length);for(var r=0;r<this.geometries.length;r++)t.writeBuffer(this.geometries[r].toTwkb())}return t.buffer},s.prototype._getWkbSize=function(){for(var t=9,e=0;e<this.geometries.length;e++)t+=this.geometries[e]._getWkbSize();return t},s.prototype.toGeoJSON=function(t){var e=o.prototype.toGeoJSON.call(this,t);e.type=i.geoJSON.GeometryCollection,e.geometries=[];for(var n=0;n<this.geometries.length;n++)e.geometries.push(this.geometries[n].toGeoJSON());return e}},{"./binarywriter":146,"./geometry":147,"./types":155,util:142}],149:[function(t,e,n){e.exports=u;var e=t("util"),o=t("./geometry"),a=t("./types"),s=t("./point"),l=t("./binarywriter");function u(t){o.call(this),this.points=t||[],0<this.points.length&&(this.hasZ=this.points[0].hasZ,this.hasM=this.points[0].hasM)}e.inherits(u,o),u.Z=function(t){t=new u(t);return t.hasZ=!0,t},u.M=function(t){t=new u(t);return t.hasM=!0,t},u.ZM=function(t){t=new u(t);return t.hasZ=!0,t.hasM=!0,t},u._parseWkt=function(t,e){var n=new u;return n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"])||(t.expectGroupStart(),n.points.push.apply(n.points,t.matchCoordinates(e)),t.expectGroupEnd()),n},u._parseWkb=function(t,e){for(var n=new u,r=(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.readUInt32()),i=0;i<r;i++)n.points.push(s._readWkbPoint(t,e));return n},u._parseTwkb=function(t,e){var n=new u;if(n.hasZ=e.hasZ,n.hasM=e.hasM,!e.isEmpty)for(var r=new s(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),i=t.readVarInt(),o=0;o<i;o++)n.points.push(s._readTwkbPoint(t,e,r));return n},u._parseGeoJSON=function(t){var e=new u;0<t.coordinates.length&&(e.hasZ=2<t.coordinates[0].length);for(var n=0;n<t.coordinates.length;n++)e.points.push(s._readGeoJSONPoint(t.coordinates[n]));return e},u.prototype.toWkt=function(){return 0===this.points.length?this._getWktType(a.wkt.LineString,!0):this._getWktType(a.wkt.LineString,!1)+this._toInnerWkt()},u.prototype._toInnerWkt=function(){for(var t="(",e=0;e<this.points.length;e++)t+=this._getWktCoordinate(this.points[e])+",";return t=t.slice(0,-1),t+=")"},u.prototype.toWkb=function(t){var e=new l(this._getWkbSize());e.writeInt8(1),this._writeWkbType(e,a.wkb.LineString,t),e.writeUInt32LE(this.points.length);for(var n=0;n<this.points.length;n++)this.points[n]._writeWkbPoint(e);return e.buffer},u.prototype.toTwkb=function(){var t=new l(0,!0),e=o.getTwkbPrecision(5,0,0),n=0===this.points.length;if(this._writeTwkbHeader(t,a.wkb.LineString,e,n),0<this.points.length){t.writeVarInt(this.points.length);for(var r=new s(0,0,0,0),i=0;i<this.points.length;i++)this.points[i]._writeTwkbPoint(t,e,r)}return t.buffer},u.prototype._getWkbSize=function(){var t=16;return this.hasZ&&(t+=8),this.hasM&&(t+=8),9+this.points.length*t},u.prototype.toGeoJSON=function(t){var e=o.prototype.toGeoJSON.call(this,t);e.type=a.geoJSON.LineString,e.coordinates=[];for(var n=0;n<this.points.length;n++)this.hasZ?e.coordinates.push([this.points[n].x,this.points[n].y,this.points[n].z]):e.coordinates.push([this.points[n].x,this.points[n].y]);return e}},{"./binarywriter":146,"./geometry":147,"./point":153,"./types":155,util:142}],150:[function(t,e,n){e.exports=h;var e=t("util"),a=t("./types"),s=t("./geometry"),u=t("./point"),c=t("./linestring"),l=t("./binarywriter");function h(t){s.call(this),this.lineStrings=t||[],0<this.lineStrings.length&&(this.hasZ=this.lineStrings[0].hasZ,this.hasM=this.lineStrings[0].hasM)}e.inherits(h,s),h.Z=function(t){t=new h(t);return t.hasZ=!0,t},h.M=function(t){t=new h(t);return t.hasM=!0,t},h.ZM=function(t){t=new h(t);return t.hasZ=!0,t.hasM=!0,t},h._parseWkt=function(t,e){var n=new h;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,!t.isMatch(["EMPTY"])){for(t.expectGroupStart();t.expectGroupStart(),n.lineStrings.push(new c(t.matchCoordinates(e))),t.expectGroupEnd(),t.isMatch([","]););t.expectGroupEnd()}return n},h._parseWkb=function(t,e){for(var n=new h,r=(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.readUInt32()),i=0;i<r;i++)n.lineStrings.push(s.parse(t,e));return n},h._parseTwkb=function(t,e){var n=new h;if(n.hasZ=e.hasZ,n.hasM=e.hasM,!e.isEmpty)for(var r=new u(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),i=t.readVarInt(),o=0;o<i;o++){for(var a=new c,s=(a.hasZ=e.hasZ,a.hasM=e.hasM,t.readVarInt()),l=0;l<s;l++)a.points.push(u._readTwkbPoint(t,e,r));n.lineStrings.push(a)}return n},h._parseGeoJSON=function(t){var e=new h;0<t.coordinates.length&&0<t.coordinates[0].length&&(e.hasZ=2<t.coordinates[0][0].length);for(var n=0;n<t.coordinates.length;n++)e.lineStrings.push(c._parseGeoJSON({coordinates:t.coordinates[n]}));return e},h.prototype.toWkt=function(){if(0===this.lineStrings.length)return this._getWktType(a.wkt.MultiLineString,!0);for(var t=this._getWktType(a.wkt.MultiLineString,!1)+"(",e=0;e<this.lineStrings.length;e++)t+=this.lineStrings[e]._toInnerWkt()+",";return t=t.slice(0,-1),t+=")"},h.prototype.toWkb=function(){var t=new l(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,a.wkb.MultiLineString),t.writeUInt32LE(this.lineStrings.length);for(var e=0;e<this.lineStrings.length;e++)t.writeBuffer(this.lineStrings[e].toWkb({srid:this.srid}));return t.buffer},h.prototype.toTwkb=function(){var t=new l(0,!0),e=s.getTwkbPrecision(5,0,0),n=0===this.lineStrings.length;if(this._writeTwkbHeader(t,a.wkb.MultiLineString,e,n),0<this.lineStrings.length){t.writeVarInt(this.lineStrings.length);for(var r=new u(0,0,0,0),i=0;i<this.lineStrings.length;i++){t.writeVarInt(this.lineStrings[i].points.length);for(var o=0;o<this.lineStrings[i].points.length;o++)this.lineStrings[i].points[o]._writeTwkbPoint(t,e,r)}}return t.buffer},h.prototype._getWkbSize=function(){for(var t=9,e=0;e<this.lineStrings.length;e++)t+=this.lineStrings[e]._getWkbSize();return t},h.prototype.toGeoJSON=function(t){var e=s.prototype.toGeoJSON.call(this,t);e.type=a.geoJSON.MultiLineString,e.coordinates=[];for(var n=0;n<this.lineStrings.length;n++)e.coordinates.push(this.lineStrings[n].toGeoJSON().coordinates);return e}},{"./binarywriter":146,"./geometry":147,"./linestring":149,"./point":153,"./types":155,util:142}],151:[function(t,e,n){e.exports=u;var e=t("util"),o=t("./types"),a=t("./geometry"),s=t("./point"),l=t("./binarywriter");function u(t){a.call(this),this.points=t||[],0<this.points.length&&(this.hasZ=this.points[0].hasZ,this.hasM=this.points[0].hasM)}e.inherits(u,a),u.Z=function(t){t=new u(t);return t.hasZ=!0,t},u.M=function(t){t=new u(t);return t.hasM=!0,t},u.ZM=function(t){t=new u(t);return t.hasZ=!0,t.hasM=!0,t},u._parseWkt=function(t,e){var n=new u;return n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"])||(t.expectGroupStart(),n.points.push.apply(n.points,t.matchCoordinates(e)),t.expectGroupEnd()),n},u._parseWkb=function(t,e){for(var n=new u,r=(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.readUInt32()),i=0;i<r;i++)n.points.push(a.parse(t,e));return n},u._parseTwkb=function(t,e){var n=new u;if(n.hasZ=e.hasZ,n.hasM=e.hasM,!e.isEmpty)for(var r=new s(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),i=t.readVarInt(),o=0;o<i;o++)n.points.push(s._readTwkbPoint(t,e,r));return n},u._parseGeoJSON=function(t){var e=new u;0<t.coordinates.length&&(e.hasZ=2<t.coordinates[0].length);for(var n=0;n<t.coordinates.length;n++)e.points.push(s._parseGeoJSON({coordinates:t.coordinates[n]}));return e},u.prototype.toWkt=function(){if(0===this.points.length)return this._getWktType(o.wkt.MultiPoint,!0);for(var t=this._getWktType(o.wkt.MultiPoint,!1)+"(",e=0;e<this.points.length;e++)t+=this._getWktCoordinate(this.points[e])+",";return t=t.slice(0,-1),t+=")"},u.prototype.toWkb=function(){var t=new l(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,o.wkb.MultiPoint),t.writeUInt32LE(this.points.length);for(var e=0;e<this.points.length;e++)t.writeBuffer(this.points[e].toWkb({srid:this.srid}));return t.buffer},u.prototype.toTwkb=function(){var t=new l(0,!0),e=a.getTwkbPrecision(5,0,0),n=0===this.points.length;if(this._writeTwkbHeader(t,o.wkb.MultiPoint,e,n),0<this.points.length){t.writeVarInt(this.points.length);for(var r=new s(0,0,0,0),i=0;i<this.points.length;i++)this.points[i]._writeTwkbPoint(t,e,r)}return t.buffer},u.prototype._getWkbSize=function(){var t=16;return this.hasZ&&(t+=8),this.hasM&&(t+=8),9+this.points.length*(t+=5)},u.prototype.toGeoJSON=function(t){var e=a.prototype.toGeoJSON.call(this,t);e.type=o.geoJSON.MultiPoint,e.coordinates=[];for(var n=0;n<this.points.length;n++)e.coordinates.push(this.points[n].toGeoJSON().coordinates);return e}},{"./binarywriter":146,"./geometry":147,"./point":153,"./types":155,util:142}],152:[function(t,e,n){e.exports=g;var e=t("util"),s=t("./types"),l=t("./geometry"),p=t("./point"),d=t("./polygon"),u=t("./binarywriter");function g(t){l.call(this),this.polygons=t||[],0<this.polygons.length&&(this.hasZ=this.polygons[0].hasZ,this.hasM=this.polygons[0].hasM)}e.inherits(g,l),g.Z=function(t){t=new g(t);return t.hasZ=!0,t},g.M=function(t){t=new g(t);return t.hasM=!0,t},g.ZM=function(t){t=new g(t);return t.hasZ=!0,t.hasM=!0,t},g._parseWkt=function(t,e){var n=new g;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,!t.isMatch(["EMPTY"])){t.expectGroupStart();do{t.expectGroupStart();var r=[],i=[];for(t.expectGroupStart(),r.push.apply(r,t.matchCoordinates(e)),t.expectGroupEnd();t.isMatch([","]);)t.expectGroupStart(),i.push(t.matchCoordinates(e)),t.expectGroupEnd()}while(n.polygons.push(new d(r,i)),t.expectGroupEnd(),t.isMatch([","]));t.expectGroupEnd()}return n},g._parseWkb=function(t,e){for(var n=new g,r=(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.readUInt32()),i=0;i<r;i++)n.polygons.push(l.parse(t,e));return n},g._parseTwkb=function(t,e){var n=new g;if(n.hasZ=e.hasZ,n.hasM=e.hasM,!e.isEmpty)for(var r=new p(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),i=t.readVarInt(),o=0;o<i;o++){for(var a=new d,s=(a.hasZ=e.hasZ,a.hasM=e.hasM,t.readVarInt()),l=t.readVarInt(),u=0;u<l;u++)a.exteriorRing.push(p._readTwkbPoint(t,e,r));for(u=1;u<s;u++){for(var c=[],h=t.readVarInt(),f=0;f<h;f++)c.push(p._readTwkbPoint(t,e,r));a.interiorRings.push(c)}n.polygons.push(a)}return n},g._parseGeoJSON=function(t){var e=new g;0<t.coordinates.length&&0<t.coordinates[0].length&&0<t.coordinates[0][0].length&&(e.hasZ=2<t.coordinates[0][0][0].length);for(var n=0;n<t.coordinates.length;n++)e.polygons.push(d._parseGeoJSON({coordinates:t.coordinates[n]}));return e},g.prototype.toWkt=function(){if(0===this.polygons.length)return this._getWktType(s.wkt.MultiPolygon,!0);for(var t=this._getWktType(s.wkt.MultiPolygon,!1)+"(",e=0;e<this.polygons.length;e++)t+=this.polygons[e]._toInnerWkt()+",";return t=t.slice(0,-1),t+=")"},g.prototype.toWkb=function(){var t=new u(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,s.wkb.MultiPolygon),t.writeUInt32LE(this.polygons.length);for(var e=0;e<this.polygons.length;e++)t.writeBuffer(this.polygons[e].toWkb({srid:this.srid}));return t.buffer},g.prototype.toTwkb=function(){var t=new u(0,!0),e=l.getTwkbPrecision(5,0,0),n=0===this.polygons.length;if(this._writeTwkbHeader(t,s.wkb.MultiPolygon,e,n),0<this.polygons.length){t.writeVarInt(this.polygons.length);for(var r=new p(0,0,0,0),i=0;i<this.polygons.length;i++){t.writeVarInt(1+this.polygons[i].interiorRings.length),t.writeVarInt(this.polygons[i].exteriorRing.length);for(var o=0;o<this.polygons[i].exteriorRing.length;o++)this.polygons[i].exteriorRing[o]._writeTwkbPoint(t,e,r);for(o=0;o<this.polygons[i].interiorRings.length;o++){t.writeVarInt(this.polygons[i].interiorRings[o].length);for(var a=0;a<this.polygons[i].interiorRings[o].length;a++)this.polygons[i].interiorRings[o][a]._writeTwkbPoint(t,e,r)}}}return t.buffer},g.prototype._getWkbSize=function(){for(var t=9,e=0;e<this.polygons.length;e++)t+=this.polygons[e]._getWkbSize();return t},g.prototype.toGeoJSON=function(t){var e=l.prototype.toGeoJSON.call(this,t);e.type=s.geoJSON.MultiPolygon,e.coordinates=[];for(var n=0;n<this.polygons.length;n++)e.coordinates.push(this.polygons[n].toGeoJSON().coordinates);return e}},{"./binarywriter":146,"./geometry":147,"./point":153,"./polygon":154,"./types":155,util:142}],153:[function(t,e,n){e.exports=s;var e=t("util"),i=t("./geometry"),r=t("./types"),o=t("./binarywriter"),a=t("./zigzag.js");function s(t,e,n,r){i.call(this),this.x=t,this.y=e,this.z=n,this.m=r,this.hasZ=void 0!==this.z,this.hasM=void 0!==this.m}e.inherits(s,i),s.Z=function(t,e,n){t=new s(t,e,n);return t.hasZ=!0,t},s.M=function(t,e,n){t=new s(t,e,void 0,n);return t.hasM=!0,t},s.ZM=function(t,e,n,r){t=new s(t,e,n,r);return t.hasZ=!0,t.hasM=!0,t},s._parseWkt=function(t,e){var n=new s;return n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"])||(t.expectGroupStart(),e=t.matchCoordinate(e),n.x=e.x,n.y=e.y,n.z=e.z,n.m=e.m,t.expectGroupEnd()),n},s._parseWkb=function(t,e){t=s._readWkbPoint(t,e);return t.srid=e.srid,t},s._readWkbPoint=function(t,e){return new s(t.readDouble(),t.readDouble(),e.hasZ?t.readDouble():void 0,e.hasM?t.readDouble():void 0)},s._parseTwkb=function(t,e){var n=new s;return n.hasZ=e.hasZ,n.hasM=e.hasM,e.isEmpty||(n.x=a.decode(t.readVarInt())/e.precisionFactor,n.y=a.decode(t.readVarInt())/e.precisionFactor,n.z=e.hasZ?a.decode(t.readVarInt())/e.zPrecisionFactor:void 0,n.m=e.hasM?a.decode(t.readVarInt())/e.mPrecisionFactor:void 0),n},s._readTwkbPoint=function(t,e,n){return n.x+=a.decode(t.readVarInt())/e.precisionFactor,n.y+=a.decode(t.readVarInt())/e.precisionFactor,e.hasZ&&(n.z+=a.decode(t.readVarInt())/e.zPrecisionFactor),e.hasM&&(n.m+=a.decode(t.readVarInt())/e.mPrecisionFactor),new s(n.x,n.y,n.z,n.m)},s._parseGeoJSON=function(t){return s._readGeoJSONPoint(t.coordinates)},s._readGeoJSONPoint=function(t){return 0===t.length?new s:2<t.length?new s(t[0],t[1],t[2]):new s(t[0],t[1])},s.prototype.toWkt=function(){return void 0===this.x&&void 0===this.y&&void 0===this.z&&void 0===this.m?this._getWktType(r.wkt.Point,!0):this._getWktType(r.wkt.Point,!1)+"("+this._getWktCoordinate(this)+")"},s.prototype.toWkb=function(t){var e=new o(this._getWkbSize());return e.writeInt8(1),this._writeWkbType(e,r.wkb.Point,t),void 0===this.x&&void 0===this.y?(e.writeDoubleLE(NaN),e.writeDoubleLE(NaN),this.hasZ&&e.writeDoubleLE(NaN),this.hasM&&e.writeDoubleLE(NaN)):this._writeWkbPoint(e),e.buffer},s.prototype._writeWkbPoint=function(t){t.writeDoubleLE(this.x),t.writeDoubleLE(this.y),this.hasZ&&t.writeDoubleLE(this.z),this.hasM&&t.writeDoubleLE(this.m)},s.prototype.toTwkb=function(){var t=new o(0,!0),e=i.getTwkbPrecision(5,0,0),n=void 0===this.x&&void 0===this.y;return this._writeTwkbHeader(t,r.wkb.Point,e,n),n||this._writeTwkbPoint(t,e,new s(0,0,0,0)),t.buffer},s.prototype._writeTwkbPoint=function(t,e,n){var r=this.x*e.xyFactor,i=this.y*e.xyFactor,o=this.z*e.zFactor,e=this.m*e.mFactor;t.writeVarInt(a.encode(r-n.x)),t.writeVarInt(a.encode(i-n.y)),this.hasZ&&t.writeVarInt(a.encode(o-n.z)),this.hasM&&t.writeVarInt(a.encode(e-n.m)),n.x=r,n.y=i,n.z=o,n.m=e},s.prototype._getWkbSize=function(){var t=21;return this.hasZ&&(t+=8),this.hasM&&(t+=8),t},s.prototype.toGeoJSON=function(t){t=i.prototype.toGeoJSON.call(this,t);return t.type=r.geoJSON.Point,void 0===this.x&&void 0===this.y?t.coordinates=[]:void 0!==this.z?t.coordinates=[this.x,this.y,this.z]:t.coordinates=[this.x,this.y],t}},{"./binarywriter":146,"./geometry":147,"./types":155,"./zigzag.js":158,util:142}],154:[function(t,e,n){e.exports=h;var e=t("util"),s=t("./geometry"),l=t("./types"),c=t("./point"),a=t("./binarywriter");function h(t,e){s.call(this),this.exteriorRing=t||[],this.interiorRings=e||[],0<this.exteriorRing.length&&(this.hasZ=this.exteriorRing[0].hasZ,this.hasM=this.exteriorRing[0].hasM)}e.inherits(h,s),h.Z=function(t,e){t=new h(t,e);return t.hasZ=!0,t},h.M=function(t,e){t=new h(t,e);return t.hasM=!0,t},h.ZM=function(t,e){t=new h(t,e);return t.hasZ=!0,t.hasM=!0,t},h._parseWkt=function(t,e){var n=new h;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,!t.isMatch(["EMPTY"])){for(t.expectGroupStart(),t.expectGroupStart(),n.exteriorRing.push.apply(n.exteriorRing,t.matchCoordinates(e)),t.expectGroupEnd();t.isMatch([","]);)t.expectGroupStart(),n.interiorRings.push(t.matchCoordinates(e)),t.expectGroupEnd();t.expectGroupEnd()}return n},h._parseWkb=function(t,e){var n=new h,r=(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.readUInt32());if(0<r){for(var i=t.readUInt32(),o=0;o<i;o++)n.exteriorRing.push(c._readWkbPoint(t,e));for(o=1;o<r;o++){for(var a=[],s=t.readUInt32(),l=0;l<s;l++)a.push(c._readWkbPoint(t,e));n.interiorRings.push(a)}}return n},h._parseTwkb=function(t,e){var n=new h;if(n.hasZ=e.hasZ,n.hasM=e.hasM,!e.isEmpty){for(var r=new c(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),i=t.readVarInt(),o=t.readVarInt(),a=0;a<o;a++)n.exteriorRing.push(c._readTwkbPoint(t,e,r));for(a=1;a<i;a++){for(var s=[],l=t.readVarInt(),u=0;u<l;u++)s.push(c._readTwkbPoint(t,e,r));n.interiorRings.push(s)}}return n},h._parseGeoJSON=function(t){var e=new h;0<t.coordinates.length&&0<t.coordinates[0].length&&(e.hasZ=2<t.coordinates[0][0].length);for(var n=0;n<t.coordinates.length;n++){0<n&&e.interiorRings.push([]);for(var r=0;r<t.coordinates[n].length;r++)(0===n?e.exteriorRing:e.interiorRings[n-1]).push(c._readGeoJSONPoint(t.coordinates[n][r]))}return e},h.prototype.toWkt=function(){return 0===this.exteriorRing.length?this._getWktType(l.wkt.Polygon,!0):this._getWktType(l.wkt.Polygon,!1)+this._toInnerWkt()},h.prototype._toInnerWkt=function(){for(var t="((",e=0;e<this.exteriorRing.length;e++)t+=this._getWktCoordinate(this.exteriorRing[e])+",";for(t=t.slice(0,-1),t+=")",e=0;e<this.interiorRings.length;e++){t+=",(";for(var n=0;n<this.interiorRings[e].length;n++)t+=this._getWktCoordinate(this.interiorRings[e][n])+",";t=t.slice(0,-1),t+=")"}return t+=")"},h.prototype.toWkb=function(t){var e=new a(this._getWkbSize());e.writeInt8(1),this._writeWkbType(e,l.wkb.Polygon,t),0<this.exteriorRing.length?(e.writeUInt32LE(1+this.interiorRings.length),e.writeUInt32LE(this.exteriorRing.length)):e.writeUInt32LE(0);for(var n=0;n<this.exteriorRing.length;n++)this.exteriorRing[n]._writeWkbPoint(e);for(n=0;n<this.interiorRings.length;n++){e.writeUInt32LE(this.interiorRings[n].length);for(var r=0;r<this.interiorRings[n].length;r++)this.interiorRings[n][r]._writeWkbPoint(e)}return e.buffer},h.prototype.toTwkb=function(){var t=new a(0,!0),e=s.getTwkbPrecision(5,0,0),n=0===this.exteriorRing.length;if(this._writeTwkbHeader(t,l.wkb.Polygon,e,n),0<this.exteriorRing.length){t.writeVarInt(1+this.interiorRings.length),t.writeVarInt(this.exteriorRing.length);for(var r=new c(0,0,0,0),i=0;i<this.exteriorRing.length;i++)this.exteriorRing[i]._writeTwkbPoint(t,e,r);for(i=0;i<this.interiorRings.length;i++){t.writeVarInt(this.interiorRings[i].length);for(var o=0;o<this.interiorRings[i].length;o++)this.interiorRings[i][o]._writeTwkbPoint(t,e,r)}}return t.buffer},h.prototype._getWkbSize=function(){var t=16,e=(this.hasZ&&(t+=8),this.hasM&&(t+=8),9);0<this.exteriorRing.length&&(e+=4+this.exteriorRing.length*t);for(var n=0;n<this.interiorRings.length;n++)e+=4+this.interiorRings[n].length*t;return e},h.prototype.toGeoJSON=function(t){var e=s.prototype.toGeoJSON.call(this,t);if(e.type=l.geoJSON.Polygon,e.coordinates=[],0<this.exteriorRing.length){for(var n=[],r=0;r<this.exteriorRing.length;r++)this.hasZ?n.push([this.exteriorRing[r].x,this.exteriorRing[r].y,this.exteriorRing[r].z]):n.push([this.exteriorRing[r].x,this.exteriorRing[r].y]);e.coordinates.push(n)}for(var i=0;i<this.interiorRings.length;i++){for(var o=[],a=0;a<this.interiorRings[i].length;a++)this.hasZ?o.push([this.interiorRings[i][a].x,this.interiorRings[i][a].y,this.interiorRings[i][a].z]):o.push([this.interiorRings[i][a].x,this.interiorRings[i][a].y]);e.coordinates.push(o)}return e}},{"./binarywriter":146,"./geometry":147,"./point":153,"./types":155,util:142}],155:[function(t,e,n){e.exports={wkt:{Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION"},wkb:{Point:1,LineString:2,Polygon:3,MultiPoint:4,MultiLineString:5,MultiPolygon:6,GeometryCollection:7},geoJSON:{Point:"Point",LineString:"LineString",Polygon:"Polygon",MultiPoint:"MultiPoint",MultiLineString:"MultiLineString",MultiPolygon:"MultiPolygon",GeometryCollection:"GeometryCollection"}}},{}],156:[function(t,e,n){e.exports=o;var r=t("./types"),i=t("./point");function o(t){this.value=t,this.position=0}o.prototype.match=function(t){this.skipWhitespaces();for(var e=0;e<t.length;e++)if(0===this.value.substring(this.position).indexOf(t[e]))return this.position+=t[e].length,t[e];return null},o.prototype.matchRegex=function(t){this.skipWhitespaces();for(var e=0;e<t.length;e++){var n=this.value.substring(this.position).match(t[e]);if(n)return this.position+=n[0].length,n}return null},o.prototype.isMatch=function(t){this.skipWhitespaces();for(var e=0;e<t.length;e++)if(0===this.value.substring(this.position).indexOf(t[e]))return this.position+=t[e].length,!0;return!1},o.prototype.matchType=function(){var t=this.match([r.wkt.Point,r.wkt.LineString,r.wkt.Polygon,r.wkt.MultiPoint,r.wkt.MultiLineString,r.wkt.MultiPolygon,r.wkt.GeometryCollection]);if(t)return t;throw new Error("Expected geometry type")},o.prototype.matchDimension=function(){switch(this.match(["ZM","Z","M"])){case"ZM":return{hasZ:!0,hasM:!0};case"Z":return{hasZ:!0,hasM:!1};case"M":return{hasZ:!1,hasM:!0};default:return{hasZ:!1,hasM:!1}}},o.prototype.expectGroupStart=function(){if(!this.isMatch(["("]))throw new Error("Expected group start")},o.prototype.expectGroupEnd=function(){if(!this.isMatch([")"]))throw new Error("Expected group end")},o.prototype.matchCoordinate=function(t){var e=t.hasZ&&t.hasM?this.matchRegex([/^(-?\d+\.?\d*)\s+(-?\d+\.?\d*)\s+(-?\d+\.?\d*)\s+(-?\d+\.?\d*)/]):t.hasZ||t.hasM?this.matchRegex([/^(-?\d+\.?\d*)\s+(-?\d+\.?\d*)\s+(-?\d+\.?\d*)/]):this.matchRegex([/^(-?\d+\.?\d*)\s+(-?\d+\.?\d*)/]);if(e)return t.hasZ&&t.hasM?new i(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])):t.hasZ?new i(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])):t.hasM?new i(parseFloat(e[1]),parseFloat(e[2]),void 0,parseFloat(e[3])):new i(parseFloat(e[1]),parseFloat(e[2]));throw new Error("Expected coordinates")},o.prototype.matchCoordinates=function(t){var e=[];do{var n=this.isMatch(["("])}while(e.push(this.matchCoordinate(t)),n&&this.expectGroupEnd(),this.isMatch([","]));return e},o.prototype.skipWhitespaces=function(){for(;this.position<this.value.length&&" "===this.value[this.position];)this.position++}},{"./point":153,"./types":155}],157:[function(t,e,n){n.Types=t("./types"),n.Geometry=t("./geometry"),n.Point=t("./point"),n.LineString=t("./linestring"),n.Polygon=t("./polygon"),n.MultiPoint=t("./multipoint"),n.MultiLineString=t("./multilinestring"),n.MultiPolygon=t("./multipolygon"),n.GeometryCollection=t("./geometrycollection")},{"./geometry":147,"./geometrycollection":148,"./linestring":149,"./multilinestring":150,"./multipoint":151,"./multipolygon":152,"./point":153,"./polygon":154,"./types":155}],158:[function(t,e,n){e.exports={encode:function(t){return t<<1^t>>31},decode:function(t){return t>>1^-(1&t)}}},{}],159:[function(t,e,n){e.exports=function(){for(var t={},e=0;e<arguments.length;e++){var n,r=arguments[e];for(n in r)r.hasOwnProperty(n)&&(t[n]=r[n])}return t}},{}],160:[function(t,e,n){e.exports=function(t){return L.mapbox.accessToken="pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXFhYTA2bTMyeW44ZG0ybXBkMHkifQ.gUGbDOPUN1v1fTs5SeOR4A","geojson.io"===t?(L.mapbox.config.FORCE_HTTPS=!0,{client_id:"62c753fd0faf18392d85",gatekeeper_url:"https://geojsonioauth.herokuapp.com"}):(L.mapbox.config.HTTP_URL="http://a.tiles.mapbox.com/v4",L.mapbox.config.HTTPS_URL="https://a.tiles.mapbox.com/v4",L.mapbox.config.FORCE_HTTPS=!0,L.mapbox.config.REQUIRE_ACCESS_TOKEN=!0,{GithubAPI:null,client_id:"bb7bbe70bd1f707125bc",gatekeeper_url:"https://localhostauth.herokuapp.com"})}},{}],161:[function(t,e,n){e.exports=function(t){"undefined"!=typeof console&&console&&console.log&&(console.log("%c⚛ geojson.io api ⚛","font-family:monospace;font-size:20px;color:darkblue;"),console.log("%cfrom here, you can customize geojson.io to your liking by mucking around with the internals","font-family:monospace;font-size:14px;color:darkblue;"),console.log("%chere's what's available ↓","color:blue;"),console.log(""),console.log("%c- window.api.map: the leaflet map object","font-weight:bold;"),console.log("%O",t.map),console.log("%c- window.api.mapLayer: the leaflet mapLayer object","font-weight:bold;"),console.log("%O",t.mapLayer),console.log("%c- window.api.drawControl: the leaflet.draw control","font-weight:bold;"),console.log("%O",t.drawControl),console.log(""),console.log("%c- window.api.data: the data model","font-weight:bold;"),console.log("%O",t.data),console.log(""),console.log("%cExample:","font-weight:bold;"),console.log(""),console.log("%c  window.api.map.setView([38, -78], 5);","color:green;"),console.log(""),console.log('%c  window.api.data.mergeFeatures([{ type: "Feature", properties: {}, geometry: { type: "Point", coordinates: [0, 0] } }]);',"color:green;"),window.api={map:t.map,mapLayer:t.mapLayer,drawControl:t.drawControl,data:t.data},d3.rebind(window.api,t.dispatch,"on"))}},{}],162:[function(t,e,n){var i=t("clone"),a=t("xtend"),h=t("../config.js")(location.hostname),s={gist:t("../source/gist"),github:t("../source/github"),local:t("../source/local")};function l(){return{map:{type:"FeatureCollection",features:[]},dirty:!1,source:null,meta:null,type:"local"}}e.exports=function(o){var r=l();function u(t){var e,n;for(e in t.files)if(n=t.files[e].content,-1!==e.indexOf(".geojson")&&n)return e;for(e in t.files)if(n=t.files[e].content,-1!==e.indexOf(".json")&&n)return e}var c={hasFeatures:function(){return!!(r.map&&r.map.features&&r.map.features.length)},set:function(t,e){for(var n in t)r[n]="object"==typeof t[n]?i(t[n],!1):t[n];return!1!==t.dirty&&(c.dirty=!0),o.dispatch.change({obj:t,source:e}),c},clear:function(){c.set(l())}};return c.mergeFeatures=function(t,e){return r.map.features=(r.map.features||[]).concat(t.map(function(t){for(var e=t.properties,n=Object.keys(e),r=n.length,i=0;i<r;i++){var o=n[i],a=e[o];t.properties[o]=(o=a,a=void 0,(a=parseFloat(o)).toString()===o?a:o)}return t})),c.set({map:r.map},e)},c.get=function(t){return r[t]},c.all=function(){return i(r,!1)},c.fetch=function(t,i){switch(t.id.split(":")[0]){case"gist":var e=t.id.split(":")[1].split("/")[1];s.gist.load(e,o,function(t,n){var e,r;return t||void 0===(e=u(n))?i(t,n):!0!==(r=n.files[e]).truncated?i(t,a(n,{file:r.filename,content:JSON.parse(r.content)})):void s.gist.loadRaw(r.raw_url,o,function(t,e){return t?i(t):i(t,a(n,{file:r.filename,content:JSON.parse(e)}))})});break;case"github":var e=t.id.split("/"),r={user:e[0].split(":")[1],repo:e[1],branch:e[3],path:(e.slice(4)||[]).join("/")};s.github.load(r,o,function(t,n){return t?i(t):s.github.loadRaw(r,n.sha,o,function(t,e){try{return i(t,a(n,{content:JSON.parse(e)}))}catch(t){return location.hash="",i(t)}})})}},c.parse=function(t,e){var n,r,i=h.GithubAPI||"https://github.com/",o=(t.files&&(t.type="gist"),(t.length?t[t.length-1]:t).type);switch(o=t.commit?"commit":o){case"commit":c.set({source:t.content});break;case"local":c.set({type:"local",map:t.content,path:t.path});break;case"blob":a=t[0].login,n=t[1].name,r=t[2].name,s=t.slice(3).map(function(t){return t.path}).join("/"),c.set({type:"github",source:t,meta:{login:a,repo:n,branch:r,name:t.path},path:s,route:"github:"+[a,n,"blob",r,s].join("/"),url:[i,a,n,"blob",r,s].join("/")}),t.content&&c.set({map:t.content});break;case"file":a=(l=t.html_url.split("/"))[3],n=l[4],r=l[6],c.set({type:"github",source:t,meta:{login:a,repo:n,branch:r,name:t.name,sha:t.sha},map:t.content,path:t.path,route:"github:"+[a,n,"blob",r,t.path].join("/"),url:t.html_url});break;case"gist":var a,s=[a=t.owner&&t.owner.login||"anonymous",t.id].join("/"),l=u(t);try{t.files[l].content&&c.set({map:JSON.parse(t.files[l].content)})}catch(t){console.error(t)}c.set({type:"gist",source:t,meta:{login:a,name:l},path:s,route:"gist:"+s,url:t.html_url})}},c.save=function(t){var e=o.data.get("type");("github"===e?s.github:"gist"!==e&&"local"===e&&o.data.path?s.local:s.gist).save(o,t)},c}},{"../config.js":160,"../source/gist":179,"../source/github":180,"../source/local":181,clone:10,xtend:159}],163:[function(t,e,n){var s=t("qs-hash"),l=t("../lib/zoomextent"),u=t("../ui/flash");e.exports=function(i){function o(t,e){i.container.select(".map").classed("loading",!1);var n;if(t){try{n=t.message||JSON.parse(t.responseText).message.replace(/(http:\/\/\S*)/g,'<a href="$&">$&</a>')}catch(t){n="Sorry, an error occurred."}return u(i.container,n)}i.data.parse(e),s.stringQs(location.hash.substring(1)).map&&2!=i.map.getZoom()&&!i.map.getCenter().equals(new L.LatLng(20,0))||l(i)}function a(t){d3.json(t).header("Accept","application/vnd.geo+json").on("load",function(t){i.data.set({map:t}),location.hash="",l(i)}).on("error",function(){return u(i.container,"Could not load external file. External files must be served with CORS and be valid GeoJSON.")}).get()}return function(t){if(t.id||t.data){var e=d3.event?s.stringQs(d3.event.oldURL.split("#")[1]).id:i.data.get("route");if(t.data){var n=t.data.match(/^(data\:[\w\-]+\/[\w\-]+\,?)/);if(n)if("data:application/json,"==n[0]){var r=t.data.replace(n[0],"");try{i.data.set({map:JSON.parse(r)}),location.hash="",l(i)}catch(t){return void u(i.container,"Could not parse JSON")}}else"data:text/x-url,"==n[0]&&a(t.data.replace(n[0],""))}else t.id!==e&&(i.container.select(".map").classed("loading",!0),i.data.fetch(t,o))}}}},{"../lib/zoomextent":175,"../ui/flash":185,"qs-hash":89}],164:[function(t,e,n){var r=t("../lib/zoomextent"),i=t("qs-hash");e.exports=function(t){d3.select(window).on("unload",function(){if("local"===t.data.get("type")&&t.data.hasFeatures())try{t.storage.set("recover",t.data.all())}catch(t){}else t.storage.remove("recover")}),t.dispatch.on("change",function(){"local"!==t.data.get("type")&&t.storage.remove("recover")});var e=i.stringQs(location.hash.split("#")[1]||"");"#new"===location.hash||e.id||e.data||((e=t.storage.get("recover"))&&confirm("recover your map from the last time you edited?")?(t.data.set(e),setTimeout(function(){r(t)},100)):t.storage.remove("recover"))}},{"../lib/zoomextent":175,"qs-hash":89}],165:[function(t,e,n){var a=t("../config.js")(location.hostname);e.exports=function(o){var t={};return t.details=function(e){var t=a.GithubAPI?a.GithubAPI+"/api/v3/repos/":"https://api.github.com/repos/",n=o.storage.get("github_repo_details"),r=o.data.get("meta"),i=r.login,r=r.repo;n&&n.login===i&&n.repo===r&&n.when>+new Date-36e5?e(null,n.data):(o.storage.remove("github_repo_details"),d3.json(t+[i,r].join("/")).header("Authorization","token "+o.storage.get("github_token")).on("load",function(t){o.storage.set("github_repo_details",{when:+new Date,data:t}),o.storage.set("github_repo",t),e(null,t)}).on("error",function(t){o.storage.remove("github_repo_details"),e(new Error(t))}).get())},t}},{"../config.js":160}],166:[function(t,e,n){var o=t("qs-hash"),a=t("xtend");e.exports=function(i){var t={};function e(){var t,e=d3.event.oldURL.split("#")[1]||"",n=d3.event.newURL.split("#")[1]||"",r=o.stringQs(e),n=o.stringQs(n);0!==(t=e).indexOf("gist")&&0!==t.indexOf("github")&&isNaN(parseInt(t,10))?n.id!==r.id&&i.dispatch.route(n):(t=e,isNaN(parseInt(t,10))?(r=t.split(":"),location.hash="#id="+(0===r[1].indexOf("/")?[r[0],r[1].substring(1)].join(":"):t)):location.hash="#id=gist:/"+t)}function n(){var t=r(),e=(e=r(),a(e,{id:i.data.get("route")}));e.id&&t.id!==e.id&&(location.hash="#"+o.qsString(e))}function r(){return o.stringQs(window.location.hash.substring(1))}return t.on=function(){return d3.select(window).on("hashchange.router",e),i.dispatch.on("change.route",n),i.dispatch.route(r()),t},t.off=function(){return d3.select(window).on("hashchange.router",null),t},t}},{"qs-hash":89,xtend:159}],167:[function(t,e,n){var i=t("../config.js")(location.hostname);e.exports=function(n){var t,r={};return r.details=function(e){if(!n.storage.get("github_token"))return e(new Error("not logged in"));var t=n.storage.get("github_user_details");t&&t.when>+new Date-36e5?e(null,t.data):(n.storage.remove("github_user_details"),t=i.GithubAPI?i.GithubAPI+"/api/v3":"https://api.github.com",d3.json(t+"/user").header("Authorization","token "+n.storage.get("github_token")).on("load",function(t){n.storage.set("github_user_details",{when:+new Date,data:t}),n.storage.set("github_user",t),e(null,t)}).on("error",function(){r.logout(),n.storage.remove("github_user_details"),e(new Error("not logged in"))}).get())},r.signXHR=function(t){return r.token()?t.header("Authorization","token "+r.token()):t},r.authenticate=function(){window.location.href=(i.GithubAPI||"https://github.com")+"/login/oauth/authorize?client_id="+i.client_id+"&scope=gist,repo"},r.token=function(t){return n.storage.get("github_token")},r.logout=function(){n.storage.remove("github_token")},r.login=function(){n.storage.remove("github_token")},window.location.search&&0===window.location.search.indexOf("?code")&&(t=window.location.search.replace(/\?{0,1}code=([^\#\&]+).*$/g,"$1"),d3.select(".map").classed("loading",!0),d3.json(i.gatekeeper_url+"/authenticate/"+t).on("load",function(t){d3.select(".map").classed("loading",!1),t.token&&(window.localStorage.github_token=t.token),-1!==window.location.href.indexOf("?code")&&(window.location.href=window.location.href.replace(/\?code=.*$/,""))}).on("error",function(){d3.select(".map").classed("loading",!1),alert("Authentication with GitHub failed")}).get()),r}},{"../config.js":160}],168:[function(t,e,n){var r,i=t("./ui"),o=t("./ui/map"),a=t("./core/data"),s=t("./core/loader"),l=t("./core/router"),u=t("./core/recovery"),c=t("./core/repo"),h=t("./core/user"),f=t("./core/api"),t=t("store"),t=((r={}).dispatch=d3.dispatch("change","route"),r.storage=t,r.map=o(r),r.data=a(r),r.dispatch.on("route",s(r)),r.repo=c(r),r.router=l(r),r.user=h(r),r),o=i(t).write;d3.select(".geojsonio").call(o),t.recovery=u(t),t.router.on(),f(t)},{"./core/api":161,"./core/data":162,"./core/loader":163,"./core/recovery":164,"./core/repo":165,"./core/router":166,"./core/user":167,"./ui":182,"./ui/map":187,store:104}],169:[function(t,e,n){var i=t("qs-hash");t("leaflet-hash"),L.Hash.prototype.parseHash=function(t){var e,n,t=(i.stringQs(t.substring(1)).map||"").split("/");return 3==t.length&&(e=parseInt(t[0],10),n=parseFloat(t[1]),t=parseFloat(t[2]),!(isNaN(e)||isNaN(n)||isNaN(t))&&{center:new L.LatLng(n,t),zoom:e})},L.Hash.prototype.formatHash=function(t){var e=i.stringQs(location.hash.substring(1)),n=t.getCenter(),t=t.getZoom(),r=Math.max(0,Math.ceil(Math.log(t)/Math.LN2));return e.map=[t,n.lat.toFixed(r),n.lng.toFixed(r)].join("/"),"#"+i.qsString(e)}},{"leaflet-hash":62,"qs-hash":89}],170:[function(t,u,e){!function(r){var i=t("escape-html"),o=t("geojson-random"),e=t("geojson-extent"),n=t("geojson-flatten"),a=t("polyline"),s=t("wkx"),l=t("../lib/zoomextent");u.exports.adduserlayer=function(t,e,n){e=i(e),n=i(n),e=L.tileLayer(e,{maxZoom:t.map.getMaxZoom()});t.layerControl?(t.map.addLayer(e),t.layerControl.addOverlay(e,n)):(t.layerControl=L.control.layers(null,{},{position:"bottomright",collapsed:!1}).addTo(t.map).addOverlay(e,n),t.map.addLayer(e))},u.exports.zoomextent=function(t){l(t)},u.exports.clear=function(t){t.data.clear()},u.exports.random=function(t,e,n){t.data.mergeFeatures(o(e,n).features,"meta")},u.exports.bboxify=function(t){t.data.set({map:e.bboxify(t.data.get("map"))})},u.exports.flatten=function(t){t.data.set({map:n(t.data.get("map"))})},u.exports.polyline=function(t){var e=prompt("Enter your polyline");try{var n=a.toGeoJSON(e);t.data.set({map:n})}catch(t){alert("Sorry, we were unable to decode that polyline")}},u.exports.wkxBase64=function(t){var e=prompt("Enter your Base64 encoded WKB/EWKB");try{var n=s.Geometry.parse(r.from(e,"base64"));t.data.set({map:n.toGeoJSON()}),l(t)}catch(t){console.error(t),alert("Sorry, we were unable to decode that Base64 encoded WKX data")}},u.exports.wkxHex=function(t){var e=prompt("Enter your Hex encoded WKB/EWKB");try{var n=s.Geometry.parse(r.from(e,"hex"));t.data.set({map:n.toGeoJSON()}),l(t)}catch(t){console.error(t),alert("Sorry, we were unable to decode that Hex encoded WKX data")}},u.exports.wkxString=function(t){var e=prompt("Enter your WKT/EWKT String");try{var n=s.Geometry.parse(e);t.data.set({map:n.toGeoJSON()}),l(t)}catch(t){console.error(t),alert("Sorry, we were unable to decode that WKT data")}}}.call(this,t("buffer").Buffer)},{"../lib/zoomextent":175,buffer:9,"escape-html":19,"geojson-extent":25,"geojson-flatten":26,"geojson-random":28,polyline:86,wkx:157}],171:[function(t,e,n){e.exports=function(r){return function(t){var e=d3.select(t.popup._contentNode);e.selectAll(".cancel").on("click",function(){r.map.closePopup(t.popup)}),e.selectAll(".save").on("click",function(){var n={};e.select("table.marker-properties").selectAll("tr").each(function(){var t,e;d3.select(this).selectAll("input")[0][0].value&&(n[d3.select(this).selectAll("input")[0][0].value]=(t=d3.select(this).selectAll("input")[0][1].value,(e=parseFloat(t)).toString()===t?e:t))}),t.popup._source.feature.properties=n,r.data.set({map:r.mapLayer.toGeoJSON()},"popup"),r.map.closePopup(t.popup)}),e.selectAll(".add").on("click",function(){var t=e.select("table.marker-properties tbody").append("tr");t.append("th").append("input").attr("type","text"),t.append("td").append("input").attr("type","text")}),e.selectAll(".delete-invert").on("click",function(){t.popup._source&&r.mapLayer.hasLayer(t.popup._source)&&(r.mapLayer.removeLayer(t.popup._source),r.data.set({map:r.mapLayer.toGeoJSON()},"popup"))})}}},{}],172:[function(t,e,n){var c=t("topojson"),h=t("togeojson"),f=t("gtfs2geojson"),p=t("csv2geojson"),d=t("osmtogeojson"),g=t("polytogeojson"),l=t("geojson-normalize");function u(t,e){try{var n=new FileReader;n.readAsText(t),n.onload=function(t){t.target&&t.target.result?e(null,t.target.result):e({message:"Dropped file could not be loaded"})},n.onerror=function(t){e({message:"Dropped file was unreadable"})}}catch(t){e({message:"Dropped file was unreadable"})}}function m(t,n,r){var e=function(t,e){var n=t.name?t.name.toLowerCase():"";function r(t){return-1!==n.indexOf(t)}if("application/vnd.google-earth.kml+xml"===t.type||r(".kml"))return"kml";if(r(".gpx"))return"gpx";if(r(".geojson")||r(".json")||r(".topojson"))return"geojson";if("text/csv"===t.type||r(".csv")||r(".tsv")||r(".dsv"))return"dsv";if(r(".xml")||r(".osm"))return"xml";if(r(".poly"))return"poly";if(e&&-1!=e.indexOf("shape_id,shape_pt_lat,shape_pt_lon"))return"gtfs"}(t,n);if(!e)return(t.name?t.name.toLowerCase():"").split("."),r({message:"Could not detect file type"});if("kml"===e){t=u(n);if(!t)return r({message:"Invalid KML file: not valid XML"});t.getElementsByTagName("NetworkLink").length&&(i={message:"The KML file you uploaded included NetworkLinks: some content may not display. Please export and upload KML without NetworkLinks for optimal performance"}),r(null,h.kml(t),i)}else if("xml"===e){var i,t=u(n);if(!t)return r({message:"Invalid XML file: not valid XML"});(i=d.toGeojson(t)).features.forEach(function(t){t.properties=t.properties.tags}),r(null,i)}else if("gpx"===e)r(null,h.gpx(u(n)));else if("geojson"===e)try{var o=JSON.parse(n);if(o&&"Topology"===o.type&&o.objects){var a,s={type:"FeatureCollection",features:[]};for(a in o.objects){var l=c.feature(o,o.objects[a]);l.features?s.features=s.features.concat(l.features):s.features=s.features.concat([l])}return r(null,s)}return r(null,o)}catch(t){alert("Invalid JSON file: "+t)}else if("dsv"===e)p.csv2geojson(n,{delimiter:"auto"},function(t,e){return t?r({type:"geocode",result:e,raw:n}):r(null,e)});else if("gtfs"===e)try{return r(null,f(n))}catch(t){return r({message:"Invalid GTFS file"})}else"poly"===e&&r(null,g(n));function u(t){return(new DOMParser).parseFromString(t,"text/xml")}}e.exports.readDrop=function(s){return function(){var r=[],i=[];if(!(d3.event.dataTransfer&&d3.event.dataTransfer&&d3.event.dataTransfer.files&&d3.event.dataTransfer.files.length))return s({message:"No files were dropped"});d3.event.stopPropagation(),d3.event.preventDefault();var o=d3.event.dataTransfer.files.length;function a(t,e,n){if(!e.length&&t.length)return s(t[0],null,n);s(null,{type:"FeatureCollection",features:e.reduce(function(t,e){return t=(e=l(e))?t.concat(e.features):t},[])},n)}[].forEach.call(d3.event.dataTransfer.files,function(n){u(n,function(t,e){t?(i.push(t),--o||a(i,r)):m(n,e,function(t,e,n){t&&i.push(t),e&&r.push(e),n&&r.push(n),--o||a(i,r,n)})})})}},e.exports.readAsText=u,e.exports.readFile=m},{csv2geojson:11,"geojson-normalize":27,gtfs2geojson:33,osmtogeojson:64,polytogeojson:87,togeojson:106,topojson:"topojson"}],173:[function(t,e,n){e.exports=function(t,e,n){e instanceof L.Marker?(n=n.isValid()?t.getBoundsZoom(n)+2:10,t.setView(e.getLatLng(),n)):"getBounds"in e&&e.getBounds().isValid()&&t.fitBounds(e.getBounds())}},{}],174:[function(t,e,n){var s=t("geojsonhint");e.exports=function(a){return function(e,t){var n=s.hint(e.getValue());if(e.clearGutter("error"),n instanceof Error)return i=n.message,(r=i.match(/line (\d+)/))&&r[1]&&(e.clearGutter("error"),e.setGutterMarker(parseInt(r[1],10)-1,"error",o(i))),a({class:"icon-circle-blank",title:"invalid JSON",message:"invalid JSON"});if(n.length)return r=n,e.clearGutter("error"),r.forEach(function(t){e.setGutterMarker(t.line,"error",o(t.message))}),a({class:"icon-circle-blank",title:"invalid GeoJSON",message:"invalid GeoJSON"});var r,i=0===t.from.ch&&0===t.from.line&&"paste"==t.origin,n=JSON.parse(e.getValue());try{return a(null,n,i)}catch(t){return a({class:"icon-circle-blank",title:"invalid GeoJSON",message:"invalid GeoJSON"})}function o(t){return d3.select(document.createElement("div")).attr("class","error-marker").attr("message",t).node()}}}},{geojsonhint:32}],175:[function(t,e,n){e.exports=function(t){var e=t.mapLayer.getBounds();e.isValid()&&t.map.fitBounds(e)}},{}],176:[function(t,e,n){!function(r){var i=t("marked");e.exports=function(t){var e=r("PGgyPkhlbHA8L2gyPgoKPHA+TmV3IGhlcmU/IDxzdHJvbmc+Z2VvanNvbi5pbzwvc3Ryb25nPiBpcyBhIHF1aWNrLCBzaW1wbGUgdG9vbCBmb3IgY3JlYXRpbmcsCnZpZXdpbmcsIGFuZCBzaGFyaW5nIG1hcHMuIGdlb2pzb24uaW8gaXMgbmFtZWQgYWZ0ZXIgPGEgaHJlZj0naHR0cDovL2dlb2pzb24ub3JnLycgdGFyZ2V0PSdfYmxhbmsnPkdlb0pTT048L2E+LAphbiBvcGVuIHNvdXJjZSBkYXRhIGZvcm1hdCwgYW5kIGl0IHN1cHBvcnRzIEdlb0pTT04gaW4gYWxsIHdheXMgLSBidXQgYWxzbwphY2NlcHRzIEtNTCwgR1BYLCBDU1YsIEdURlMsIFRvcG9KU09OLCBhbmQgb3RoZXIgZm9ybWF0cy48L3A+Cgo8cD5OZWVkIGV4dHJhIGhlbHAgb3Igc2VlIGEgYnVnPyA8YSB0YXJnZXQ9J19ibGFuaycgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL21hcGJveC9nZW9qc29uLmlvL2lzc3Vlcz9zdGF0ZT1vcGVuJz5PcGVuIGFuIGlzc3VlCiAgICBvbiBnZW9qc29uLmlvJ3MgaXNzdWUgdHJhY2tlci48L2E+Cgo8aDM+SSd2ZSBnb3QgZGF0YTwvaDM+Cgo8cD5JZiB5b3UgaGF2ZSBkYXRhLCBsaWtlIGEgS01MLCBHZW9KU09OLCBvciBDU1YgZmlsZSwganVzdCBkcmFnICZhbXA7IGRyb3AKaXQgb250byB0aGUgcGFnZSBvciBjbGljayAnT3BlbicgYW5kICdGaWxlJyAtIHlvdXIgZGF0YSBzaG91bGQgYXBwZWFyIG9uCnRoZSBtYXAhPC9wPgoKPGgzPkkgd2FudCB0byBkcmF3IGZlYXR1cmVzPC9oMz4KCjxwPkNsaWNrIHRoZSBkcmF3aW5nIHRvb2xzIG9uIHRoZSBsZWZ0LWhhbmQgc2lkZSB0byBkcmF3IHBvaW50cywgcG9seWdvbnMsCmxpbmVzIGFuZCByZWN0YW5nbGVzLiBBZnRlciB5b3UncmUgZG9uZSBkcmF3aW5nIHRoZSBzaGFwZXMsIHlvdSBjYW4gYWRkCmluZm9ybWF0aW9uIHRvIGVhY2ggZmVhdHVyZSBieSBjbGlja2luZyBvbiBpdCwgZWRpdGluZyB0aGUgZmVhdHVyZSdzIHByb3BlcnRpZXMsCmFuZCBjbGlja2luZyAnU2F2ZScuPC9wPgoKPHA+UHJvcGVydGllcyBpbiBHZW9KU09OIGFyZSBzdG9yZWQgYXMgJ2tleSB2YWx1ZSBwYWlycycgLSBzbywgZm9yIGluc3RhbmNlLAppZiB5b3Ugd2FudGVkIHRvIGFkZCBhIG5hbWUgdG8gZWFjaCBmZWF0dXJlLCB0eXBlICduYW1lJyBpbiB0aGUgZmlyc3QgdGFibGUKZmllbGQsIGFuZCB0aGUgbmFtZSBvZiB0aGUgZmVhdHVyZSBpbiB0aGUgc2Vjb25kLjwvcD4KCjxoMz5JIHdhbnQgdG8gdXNlIG15IG1hcCBldmVyeXdoZXJlPC9oMz4KCjxwPllvdSBjYW4gc2hhcmUgbWFwcyBpbiBxdWl0ZSBhIGZldyB3YXlzISBJZiB5b3Ugc2F2ZSB5b3VyIG1hcCBoZXJlLCB0aGUgVVJMCm9mIHRoaXMgcGFnZSB3aWxsIHVwZGF0ZSBhbmQgeW91IGNhbiBsaW5rIHNlbmQgZnJpZW5kcyB0aGUgbGluayB0byBzaGFyZQp0aGUgbWFwLCBvciB5b3UgY2FuIGNsaWNrICdEb3dubG9hZCcgdG8gZ3JhYiB0aGUgcmF3IEdlb0pTT04gZGF0YSBhbmQgdXNlCml0IGluIG90aGVyIHNvZnR3YXJlLCBsaWtlIFRpbGVNaWxsIG9yIExlYWZsZXQuPC9wPgoKPGgzPkknbSBhIGNvZGVyPC9oMz4KCjxwPjxhIGhyZWY9JyNnZW9qc29uLWlvLWFwaSc+Z2VvanNvbi5pbyBoYXMgYW4gYXJyYXkgb2YgY2xpIHRvb2xzPC9hPgp0aGF0IG1ha2UgaXQgZWFzeSB0byBnbyBmcm9tIGEgR2VvSlNPTiBmaWxlIG9uIHlvdXIgY29tcHV0ZXIgdG8gZ2VvanNvbi5pby4KCjxoMz5Qcm90aXBzPzwvaDM+Cgo8dWw+CiAgICA8bGk+PHN0cm9uZz5jbWQrczwvc3Ryb25nPjogc2F2ZSBtYXAgdG8gZ2l0aHViIGdpc3RzCiAgICA8bGk+PHN0cm9uZz5jbWQrYTwvc3Ryb25nPjogZG93bmxvYWQgbWFwIGFzIGdlb2pzb24KICAgIDxsaT48c3Ryb25nPmFycm93IGtleXM8L3N0cm9uZz46IG5hdmlnYXRlIHRoZSBtYXAKPC91bD4KCjxoMz5Qcml2YWN5ICZhbXA7IExpY2Vuc2UgSXNzdWVzPC9oMz4KCjx1bD4KICAgIDxsaT48c3Ryb25nPkNsaWNraW5nIHNhdmU8L3N0cm9uZz4gYnkgZGVmYXVsdCBzYXZlcyB0byBhIHByaXZhdGUKICAgIEdpdEh1YiBHaXN0IC0gc28gaXQgd2lsbCBvbmx5IGJlIGFjY2Vzc2libGUgdG8gcGVvcGxlIHlvdSBzaGFyZSB0aGUgVVJMCiAgICB3aXRoLCBhbmQgY3JlYXRpbmcgaXQgd29uJ3QgYXBwZWFyIGluIHlvdXIgR2l0SHViIHRpbWVsaW5lLgogICAgPGxpPjxzdHJvbmc+VGhlIGRhdGEgeW91IGNyZWF0ZSBhbmQgbW9kaWZ5IGluIGdlb2pzb24uaW88L3N0cm9uZz4gZG9lc24ndAogICAgYWNxdWlyZSBhbnkgYWRkaXRpb25hbCBsaWNlbnNlOiBpZiBpdCdzIHNlY3JldCBhbmQgY29weXJpZ2h0ZWQsIGl0IHdpbGwgcmVtYWluCiAgICB0aGF0IHdheSAtIGl0IGRvZXNuJ3QgaGF2ZSB0byBiZSBwdWJsaWMgb3Igb3BlbiBzb3VyY2UuCjwvdWw+Cg==","base64")+"<br><hr><br>"+i("## Geojson.io API\nYou can interact with geojson.io programmatically in two ways:\n\n* [URL parameters](#url-api)\n* [Browser console](#console-api)\n* [Protips](#protips)\n\n## URL API\nYou can do a few interesting things with just URLs and geojson.io. Here are the\ncurrent URL formats.\n\n### `map`\n\nOpen the map at a specific location. The argument is numbers separated by `/`\nin the form `zoom/latitude/longitude`.\n\n#### Example:\n\nhttp://geojson.io/#map=2/20.0/0.0\n\n\n### `data=data:application/json,`\n\nOpen the map and load a chunk of [GeoJSON](http://geojson.org/) data from a\nURL segment directly onto the map. The GeoJSON data should be encoded\nas per `encodeURIComponent(JSON.stringify(geojson_data))`.\n\n#### Example:\n\nhttp://geojson.io/#data=data:application/json,%7B%22type%22%3A%22LineString%22%2C%22coordinates%22%3A%5B%5B0%2C0%5D%2C%5B10%2C10%5D%5D%7D\n\n\n### `data=data:text/x-url,`\n\nLoad GeoJSON data from a URL on the internet onto the map. The URL must\nrefer directly to a resource that is:\n\n* Freely accessible (not behind a password)\n* Supports [CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)\n* Is valid GeoJSON\n\nThe URL should be encoded as per `encodeURIComponent(url)`.\n\n#### Example:\n\nhttp://geojson.io/#data=data:text/x-url,http%3A%2F%2Fapi.tiles.mapbox.com%2Fv3%2Ftmcw.map-gdv4cswo%2Fmarkers.geojson\n\n\n### `id=gist:`\n\nLoad GeoJSON data from a [GitHub Gist](https://gist.github.com/), given an argument\nin the form of `login/gistid`. The Gist can be public or private, and must\ncontain a file with a `.geojson` extension that is valid GeoJSON.\n\n#### Example:\n\nhttp://geojson.io/#id=gist:tmcw/e9a29ad54dbaa83dee08&map=8/39.198/-76.981\n\n\n### `id=github:`\n\nLoad a file from a GitHub repository. You must have access to the file, and\nit must be valid GeoJSON.\n\nThe url is in the form:\n\n    login/repository/blob/branch/filepath\n\n#### Example:\n\nhttp://geojson.io/#id=github:benbalter/dc-wifi-social/blob/master/bars.geojson&map=14/38.9140/-77.0302\n\n## Console API\n\n[Pop open your browser console](http://debugbrowser.com/) and see the beautiful\nexamples: geojson.io has started to expose a subset of its inner workings for\nyou to mess around with:\n\n\n### `window.api.map`\n\nThe [Leaflet](http://leafletjs.com/) map that you see and use on the site. See\nthe [Leaflet API](http://leafletjs.com/reference.html) for all the things you\ncan do with it.\n\nFor instance, you could add another map layer:\n\n```js\nwindow.api.map.addLayer(L.tileLayer('http://tile.stamen.com/watercolor/{z}/{x}/{y}.jpg'))\n```\n\n### `window.api.data`\n\nThe data model. See the [code to get an idea of how it works](https://github.com/mapbox/geojson.io/blob/gh-pages/src/core/data.js#L48-L90) -\nyou'll want to use stuff like `data.set({ map: { .. your geojson map information .. })`\nand `data.get('map')` and `data.mergeFeatures([arrayoffeatures])` to do your\ndirty business.\n\n## `window.api.mapLayer`\n\nThis is the Leaflet featureGroup that gets filled with features as you draw\nthem. You can operate on this directly to do advanced stuff like\nselecting a feature with its id:\n\n```js\nvar layers = [];\nwindow.api.mapLayer.eachLayer(l => { layers.push(l); });\nlayers.find(l => l.feature.id == 'a').openPopup();\n```\n\nThat example uses [arrow functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)\nwhich are supported in Chrome & Firefox.\n\n## `window.api.drawControl`\n\nExposes the [Leaflet.Draw](https://github.com/Leaflet/Leaflet.draw) control\ninstance in the console.\n\n## `window.api.on(event, fn)`\n\nExposes d3 events, including `change`.\n\n## Protips\n\nTo include `turf` from [turf](https://github.com/turfjs/turf) so you can manipulate features\nwith its GIS features, run this in the CLI, which will download the script and evaluate it.\n\n```js\nfetch('https://npmcdn.com/@turf/turf@3.1.1/turf.js').then(t => t.text()).then(eval)\n```\n");function n(t){t.html("").append("div").attr("class","pad2 prose").html(e)}return n.off=function(){},n}}.call(this,t("buffer").Buffer)},{buffer:9,marked:63}],177:[function(t,e,n){var i=t("../lib/validate"),o=t("../lib/zoomextent"),a=t("../ui/saver.js");e.exports=function(r){function t(){return a(r),!1}function e(t){var t=t.html("").append("textarea"),e=CodeMirror.fromTextArea(t.node(),{mode:"application/json",matchBrackets:!0,tabSize:2,gutters:["error"],theme:"eclipse",autofocus:window===window.top,keyMap:"tabSpace",lineNumbers:!0});e.on("change",i(function(t,e,n){t||(r.data.set({map:e},"json"),n&&o(r))})),r.dispatch.on("change.json",function(t){"json"!==t.source&&(t=e.getScrollInfo(),e.setValue(JSON.stringify(r.data.get("map"),null,2)),e.scrollTo(t.left,t.top))}),e.setValue(JSON.stringify(r.data.get("map"),null,2))}return CodeMirror.keyMap.tabSpace={Tab:function(t){var e=new Array(t.getOption("indentUnit")+1).join(" ");t.replaceSelection(e,"end","+input")},"Ctrl-S":t,"Cmd-S":t,fallthrough:["default"]},e.off=function(){r.dispatch.on("change.json",null)},e}},{"../lib/validate":174,"../lib/zoomextent":175,"../ui/saver.js":191}],178:[function(t,e,n){var o=t("d3-metatable")(d3),a=t("../lib/smartzoom.js");e.exports=function(i){function t(e){function n(){var t=i.data.get("map");t&&(t.geometry||t.features&&t.features.length)?(t=t.geometry?[t.properties]:t.features.map(r),e.select(".blank-banner").remove(),e.data([t]).call(o().on("change",function(t,e){var n=i.data.get("map");n.geometry?n.properties=t:n.features[e].properties=t,i.data.set("map",n)}).on("rowfocus",function(t,e){var n=i.mapLayer.getBounds(),r=0;i.mapLayer.eachLayer(function(t){e===r++&&a(i.map,t,n)})}))):e.html("").append("div").attr("class","blank-banner center").text("no features")}function r(t){return t.properties}e.html(""),i.dispatch.on("change.table",function(t){n()}),n()}return t.off=function(){i.dispatch.on("change.table",null)},t}},{"../lib/smartzoom.js":173,"d3-metatable":12}],179:[function(t,e,n){var t=t("../config.js")(location.hostname),h=t.GithubAPI?t.GithubAPI+"/api/v3":"https://api.github.com";e.exports.save=function(a,s){var t=a.data.get("source"),l=a.data.get("meta"),u=l&&l.name||"map.geojson",c=a.data.get("map");t&&t.description,t&&t.public;a.user.details(function(t,e){var n="POST",r=a.data.get("source"),i={},o=h+"/gists";!t&&e&&e.login&&l&&r&&r.id&&l.login&&e.login===l.login?(o+="/"+r.id,n="PATCH"):!t&&r&&r.id&&(o+="/"+r.id+"/forks"),i[u]={content:JSON.stringify(c,null,2)},a.user.signXHR(d3.json(o)).on("load",function(t){t.type="gist",s(null,t)}).on("error",function(t){var e;try{e=JSON.parse(t.responseText).message.replace(/(http:\/\/\S*)/g,'<a href="$&">$&</a>')}catch(t){e="Sorry, an error occurred"}s(e)}).send(n,JSON.stringify({files:i}))})},e.exports.saveBlocks=function(t,e){d3.json(h+"/gists").on("load",function(t){e(null,t)}).on("error",function(t){t=JSON.parse(t.responseText).message.replace(/(http:\/\/\S*)/g,'<a href="$&">$&</a>');e(t)}).send("POST",JSON.stringify({description:"via:geojson.io",public:!1,files:{"index.html":{content:"<!DOCTYPE html>\n<html>\n<head>\n  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />\n  <style>\n  body { margin:0; padding:0; }\n  #map { position:absolute; top:0; bottom:0; width:100%; }\n  .marker-properties {\n    border-collapse:collapse;\n    font-size:11px;\n    border:1px solid #eee;\n    margin:0;\n}\n.marker-properties th {\n    white-space:nowrap;\n    border:1px solid #eee;\n    padding:5px 10px;\n}\n.marker-properties td {\n    border:1px solid #eee;\n    padding:5px 10px;\n}\n.marker-properties tr:last-child td,\n.marker-properties tr:last-child th {\n    border-bottom:none;\n}\n.marker-properties tr:nth-child(even) th,\n.marker-properties tr:nth-child(even) td {\n    background-color:#f7f7f7;\n}\n  </style>\n  <script src='//api.tiles.mapbox.com/mapbox.js/v2.2.2/mapbox.js'><\/script>\n  <script src='//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js' ><\/script>\n  <link href='//api.tiles.mapbox.com/mapbox.js/v2.2.2/mapbox.css' rel='stylesheet' />\n</head>\n<body>\n<div id='map'></div>\n<script type='text/javascript'>\nL.mapbox.accessToken = 'pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXFhYTA2bTMyeW44ZG0ybXBkMHkifQ.gUGbDOPUN1v1fTs5SeOR4A';\nvar map = L.mapbox.map('map');\n\nL.mapbox.tileLayer('mapbox.streets').addTo(map);\n\n$.getJSON('map.geojson', function(geojson) {\n    var geojsonLayer = L.mapbox.featureLayer(geojson).addTo(map);\n    var bounds = geojsonLayer.getBounds();\n    if (bounds.isValid()) {\n        map.fitBounds(geojsonLayer.getBounds());\n    } else {\n        map.setView([0, 0], 2);\n    }\n    geojsonLayer.eachLayer(function(l) {\n        showProperties(l);\n    });\n});\n\nfunction showProperties(l) {\n    var properties = l.toGeoJSON().properties;\n    var table = document.createElement('table');\n    table.setAttribute('class', 'marker-properties display')\n    for (var key in properties) {\n        var tr = createTableRows(key, properties[key]);\n        table.appendChild(tr);\n    }\n    if (table) l.bindPopup(table);\n}\n\nfunction createTableRows(key, value) {\n    var tr = document.createElement('tr');\n    var th = document.createElement('th');\n    var td = document.createElement('td');\n    key = document.createTextNode(key);\n    value = document.createTextNode(value);\n    th.appendChild(key);\n    td.appendChild(value);\n    tr.appendChild(th);\n    tr.appendChild(td);\n    return tr\n}\n\n<\/script>\n</body>\n</html>\n"},"map.geojson":{content:JSON.stringify(t)}}}))},e.exports.load=function(t,e,n){var r=h+"/gists/";e.user.signXHR(d3.json(r+t)).on("load",function(t){n(null,t)}).on("error",function(t){n(t,null)}).get()},e.exports.loadRaw=function(t,e,n){e.user.signXHR(d3.text(t)).on("load",function(t){n(null,t)}).on("error",function(t){n(t,null)}).get()}},{"../config.js":160}],180:[function(t,e,n){e.exports.save=function(a,s){var l=a.data.get("source"),u=a.data.get("meta"),c=a.data.get("newpath"),h=u&&u.name||"map.geojson",f=a.data.get("map");if(-1!==navigator.appVersion.indexOf("MSIE 9")||!window.XMLHttpRequest)return alert("Sorry, saving and sharing is not supported in IE9 and lower. Please use a modern browser to enjoy the full featureset of geojson.io");if(!localStorage.github_token)return alert("You need to log in with GitHub to commit changes");a.repo.details(function(t,e){var n="POST",r={};if(!t&&e.permissions.push){if(!(t=a.commitMessage||prompt("Commit message:")))return;var i=l.url,n="PUT",o={message:t,branch:u.branch,content:btoa(encodeURIComponent(JSON.stringify(f,null,2)).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode("0x"+e)}))};c&&(o.path=c,a.data.set({newpath:null})),l.sha&&(o.sha=l.sha)}else i=p+"/gists",r[h]={content:JSON.stringify(f,null,2)},o={files:r};a.user.signXHR(d3.json(i)).on("load",function(t){s(null,t)}).on("error",function(t){var e;try{e=JSON.parse(t.responseText).message.replace(/(http:\/\/\S*)/g,'<a href="$&">$&</a>')}catch(t){e="Sorry, an error occurred."}s(e)}).send(n,JSON.stringify(o))})},e.exports.load=function(t,e,n){e.user.signXHR(d3.json(function(t){return p+"/repos/"+t.user+"/"+t.repo+"/contents/"+t.path+"?ref="+t.branch}(t))).on("load",function(t){n(null,t)}).on("error",function(t){n(t,null)}).get()},e.exports.loadRaw=function(t,e,n,r){n.user.signXHR(d3.text(function(t,e){return p+"/repos/"+t.user+"/"+t.repo+"/git/blobs/"+e}(t,e))).on("load",function(t){r(null,t)}).on("error",function(t){r(t,null)}).header("Accept","application/vnd.github.raw").get()};var e=t("../config.js")(location.hostname),p=e.GithubAPI?e.GithubAPI+"/api/v3":"https://api.github.com"},{"../config.js":160}],181:[function(t,e,n){e.exports.save=function(t,n){var r=t.data.get("path"),i=t.data.get("map"),t=JSON.stringify(i,null,2);fs.writeFile(r,t,function(t,e){n(null,{type:"local",path:r,content:i})})}},{}],182:[function(t,e,n){var o=t("./ui/mode_buttons"),a=t("./ui/file_bar"),s=t("./ui/dnd"),l=t("./ui/user"),u=t("./ui/layer_switch");e.exports=function(r){function i(t){t=t.append("div").attr("class","container");t.append("div").attr("class","map").call(r.map).call(u(r));return r.container=t}return{read:i,write:function(t){var t=i(t),e=(n=t.append("div").attr("class","right")).append("div").attr("class","top"),n=(e.append("button").attr("class","collapse-button").attr("title","Collapse").on("click",function(){d3.select("body").classed("fullscreen",!d3.select("body").classed("fullscreen"));var t=d3.select("body").classed("fullscreen");d3.select(this).select(".icon").classed("icon-caret-up",!t).classed("icon-caret-down",t),r.map.invalidateSize()}).append("class","span").attr("class","icon icon-caret-up"),n.append("div").attr("class","pane"));e.append("div").attr("class","user fr pad1 deemphasize").call(l(r)),e.append("div").attr("class","buttons").call(o(r,n)),t.append("div").attr("class","file-bar").call(a(r)),s(r)}}}},{"./ui/dnd":183,"./ui/file_bar":184,"./ui/layer_switch":186,"./ui/mode_buttons":190,"./ui/user":193}],183:[function(t,e,n){var i=t("../lib/readfile.js").readDrop,o=t("./flash.js"),a=t("../lib/zoomextent");e.exports=function(r){function t(){d3.event.stopPropagation(),d3.event.preventDefault(),d3.event.dataTransfer.dropEffect="copy",d3.select("body").classed("dragover",!0)}d3.select("body").attr("dropzone","copy").on("drop.import",i(function(t,e,n){t&&t.message&&o(r.container,t.message).classed("error","true"),e&&e.features&&(r.data.mergeFeatures(e.features),n?o(r.container,n.message):o(r.container,"Imported "+e.features.length+" features.").classed("success","true"),a(r)),d3.select("body").classed("dragover",!1)})).on("dragenter.import",t).on("dragleave.import",function(){d3.event.stopPropagation(),d3.event.preventDefault(),d3.event.dataTransfer.dropEffect="copy",d3.select("body").classed("dragover",!1)}).on("dragover.import",t)}},{"../lib/readfile.js":172,"../lib/zoomextent":175,"./flash.js":185}],184:[function(t,e,n){var r=t("shp-write"),i=t("clone"),o=t("geojson2dsv"),a=t("topojson"),s=t("filesaver.js"),p=t("tokml"),d=t("@mapbox/github-file-browser"),g=t("@mapbox/gist-map-browser"),m=t("geojson-normalize"),y=t("wellknown"),b=t("./share"),v=t("./modal.js"),w=t("./flash"),_=t("../lib/zoomextent"),x=t("../lib/readfile"),k=t("../lib/meta.js"),S=t("../ui/saver.js"),E=t("../config.js")(location.hostname);e.exports=function(l){var t="undefined"!=typeof ArrayBuffer,u=/a\.tiles\.mapbox.com/.test(L.mapbox.config.HTTP_URL),c=!!E.GithubAPI,h=c?E.GithubAPI+"/api/v3":"https://api.github.com",f=[{title:"GeoJSON",action:function(){d3.event&&d3.event.preventDefault();var t=JSON.stringify(l.data.get("map")),e=l.data.get("meta");s(new Blob([t],{type:"text/plain;charset=utf-8"}),e&&e.name||"map.geojson")}},{title:"TopoJSON",action:function(){var t=JSON.stringify(a.topology({collection:i(l.data.get("map"))},{"property-transform":e}));s(new Blob([t],{type:"text/plain;charset=utf-8"}),"map.topojson")}},{title:"CSV",action:function(){d3.event&&d3.event.preventDefault();var t=o(l.data.get("map"));s(new Blob([t],{type:"text/plain;charset=utf-8"}),"points.csv")}},{title:"KML",action:function(){d3.event&&d3.event.preventDefault();var t=p(l.data.get("map"));l.data.get("meta");s(new Blob([t],{type:"text/plain;charset=utf-8"}),"map.kml")}},{title:"WKT",action:function(){d3.event&&d3.event.preventDefault();var t=l.data.get("map").features;0!==t.length&&(t=t.map(y.stringify).join("\n"),l.data.get("meta"),s(new Blob([t],{type:"text/plain;charset=utf-8"}),"map.wkt"))}}];function e(t,e,n){return t[e]=n,!0}return t&&f.push({title:"Shapefile",action:function(){d3.event&&d3.event.preventDefault();d3.select(".map").classed("loading",!0);try{r.download(l.data.get("map"))}finally{d3.select(".map").classed("loading",!1)}}}),function(t){var r,i,e=[{title:"保存",action:u||c?n:function(){},children:f},{title:"新建",action:function(){window.open(window.location.origin+window.location.pathname+"#new")}},{title:"元数据",action:function(){},children:[{title:"Add map layer",alt:"Add a custom tile layer",action:function(){var t,e=prompt("Layer URL \n(http://tile.stamen.com/watercolor/{z}/{x}/{y}.jpg)");null!==e&&null!==(t=prompt("Layer name"))&&k.adduserlayer(l,e,t)}},{title:"Zoom to features",alt:"Zoom to the extent of all features",action:function(){k.zoomextent(l)}},{title:"Clear",alt:"Delete all features from the map",action:function(){confirm("Are you sure you want to delete all features from this map?")&&k.clear(l)}},{title:"Random: Points",alt:"Add random points to your map",action:function(){var t=prompt("Number of points (default: 100)");null!==t&&(t=parseInt(t,10),isNaN(t)&&(t=100),k.random(l,t,"point"))}},{title:"Add bboxes",alt:"Add bounding box members to all applicable GeoJSON objects",action:function(){k.bboxify(l)}},{title:"Flatten Multi Features",alt:"Flatten MultiPolygons, MultiLines, and GeometryCollections into simple geometries",action:function(){k.flatten(l)}},{title:"Load encoded polyline",alt:"Decode and show an encoded polyline. Precision 5 is supported.",action:function(){k.polyline(l)}},{title:"Load WKB Base64 Encoded String",alt:"Decode and show WKX data",action:function(){k.wkxBase64(l)}},{title:"Load WKB Hex Encoded String",alt:"Decode and show WKX data",action:function(){k.wkxHex(l)}},{title:"Load WKT String",alt:"Decode and show WKX data",action:function(){k.wkxString(l)}}]}];u||c?(e.unshift({title:"打开",children:[{title:"文件",alt:"GeoJSON, TopoJSON, GTFS, KML, CSV, GPX and OSM XML supported",action:a},{title:"GitHub",alt:"GeoJSON files in GitHub Repositories",authenticated:!0,action:function(){if(!l.user.token())return w(l.container,"You must authenticate to use this API.");var r=v(d3.select("div.geojsonio"));r.select(".m").attr("class","modal-splash modal col6"),r.select(".content").append("div").attr("class","header pad2 fillD").append("h1").text("GitHub"),d(l.user.token(),!1,h).open().onclick(function(n){if(n&&n.length){var t=n[n.length-1];if(!t.path)throw new Error("last is invalid: "+JSON.stringify(t));if(!t.path.match(/\.(geo)?json/i))return alert("only GeoJSON files are supported from GitHub");"blob"===t.type&&d.request("/repos/"+n[1].full_name+"/git/blobs/"+t.sha,function(t,e){n.content=JSON.parse(decodeURIComponent(Array.prototype.map.call(atob(e[0].content),function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""))),l.data.parse(n),_(l),r.close()})}}).appendTo(r.select(".content").append("div").attr("class","repos pad2").node())}},{title:"Gist",alt:"GeoJSON files in GitHub Gists",authenticated:!0,action:function(){if(!l.user.token())return w(l.container,"You must authenticate to use this API.");var e=v(d3.select("div.geojsonio"));e.select(".m").attr("class","modal-splash modal col6"),g(l.user.token(),h).open().onclick(function(t){l.data.parse(t),_(l),e.close()}).appendTo(e.select(".content").append("div").attr("class","repos pad2").node())}}]}),e[1].children.unshift({title:"GitHub",alt:"GeoJSON files in GitHub Repositories",authenticated:!0,action:function(){if(!l.user.token())return w(l.container,"You must authenticate to use this API.");var o=v(d3.select("div.geojsonio"));o.select(".m").attr("class","modal-splash modal col6"),o.select(".content").append("div").attr("class","header pad2 fillD").append("h1").text("GitHub"),d(l.user.token(),!0,h).open().onclick(function(t){var e,n,r,i;t&&t.length&&("new"===(e=t[t.length-1]).type?(i=prompt("New file name"))?((n=t.slice(3)).pop(),n.push({path:i}),r=n.map(function(t){return t.path}).join("/"),l.data.set({source:{url:h+"/repos/"+t[0].login+"/"+t[1].name+"/contents/"+r+"?ref="+t[2].name},type:"github",meta:{branch:t[2].name,login:t[0].login,repo:t[1].name}}),l.data.set({newpath:r+i}),o.close(),S(l)):o.close():"blob"===e.type&&(r=(n=t.slice(3)).map(function(t){return t.path}).join("/"),l.data.set({source:{url:h+"/repos/"+t[0].login+"/"+t[1].name+"/contents/"+r+"?ref="+t[2].name,sha:e.sha},type:"github",meta:{branch:t[2].name,login:t[0].login,repo:t[1].name}}),o.close(),S(l)))}).appendTo(o.select(".content").append("div").attr("class","repos pad2").node())}},{title:"Gist",alt:"GeoJSON files in GitHub Gists",authenticated:!0,action:function(){d3.event&&d3.event.preventDefault();l.data.set({type:"gist"}),S(l)}}),u&&e.splice(3,0,{title:"分享",action:function(){l.container.call(b(l))}})):e.unshift({title:"打开",alt:"CSV, GTFS, KML, GPX, and other filetypes",action:a});var o=(e=t.append("div").attr("class","inline").selectAll("div.item").data(e).enter().append("div").attr("class","item")).append("a").attr("class","parent").on("click",function(t){t.action&&t.action.apply(this,t)}).text(function(t){return" "+t.title}),e=(e.each(function(t){var e;t.children&&d3.select(this).append("div").attr("class","children").call((e=t.children,function(t){t.selectAll("a").data(e).enter().append("a").attr("title",function(t){if("File"==t.title||"GitHub"==t.title||"Gist"==t.title||"Add map layer"==t.title||"Zoom to features"==t.title||"Clear"==t.title||"Random: Points"==t.title||"Add bboxes"==t.title||"Flatten Multi Features"==t.title)return t.alt}).text(function(t){return t.title}).on("click",function(t){t.action.apply(this,t)})}))}),t.append("div").attr("class","name"));function n(){d3.event&&d3.event.preventDefault(),S(l)}function a(){var t=d3.select("body").append("input").attr("type","file").style("visibility","hidden").style("position","absolute").style("height","0").on("change",function(){var n=this.files;n&&n[0]&&(x.readAsText(n[0],function(t,e){x.readFile(n[0],e,s),n[0].path&&l.data.set({path:n[0].path})}),t.remove())});t.node().click()}function s(t,e,n){(e=m(e))&&(l.data.mergeFeatures(e.features),n?w(l.container,n.message):w(l.container,"Imported "+e.features.length+" features.").classed("success","true"),_(l))}(u||c)&&(r=e.append("a").attr("target","_blank").attr("class","icon-file-alt"),i=e.append("span").attr("class","filename").text("未保存")),l.dispatch.on("change.filebar",function(t){var t=t.obj,e=t.type,n=t.path;(u||c)&&i.text(n||"未保存").classed("deemphasize",l.data.dirty);(u||c)&&r.attr("href",t.url).attr("class",function(t){return"github"==t?"icon-github":"gist"==t?"icon-github-alt":"icon-file-alt"}(e));!function(t){o.filter(function(t){return"Save"===t.title}).select("span.title").text(t)}("github"==e?"Commit":"Save")}),d3.select(document).call(d3.keybinding("file_bar").on("⌘+o",function(){a(),d3.event.preventDefault()}).on("⌘+s",n))}}},{"../config.js":160,"../lib/meta.js":170,"../lib/readfile":172,"../lib/zoomextent":175,"../ui/saver.js":191,"./flash":185,"./modal.js":189,"./share":192,"@mapbox/gist-map-browser":2,"@mapbox/github-file-browser":3,clone:10,"filesaver.js":21,"geojson-normalize":27,geojson2dsv:31,"shp-write":92,tokml:107,topojson:"topojson",wellknown:143}],185:[function(t,e,n){var r=t("./message");e.exports=function(t,e){"use strict";var n=r(t);e&&n.select(".content").html(e);return setTimeout(function(){n.transition().style("opacity",0).remove()},5e3),n}},{"./message":188}],186:[function(t,e,n){e.exports=function(o){return function(t){function e(n){var t=this instanceof d3.selection?this.node():this;i.classed("active",function(){return t===this}),r.forEach(function(t){var e=n instanceof d3.selection?n.datum():n;t.layer==e.layer?o.map.addLayer(e.layer):o.map.hasLayer(t.layer)&&o.map.removeLayer(t.layer)})}var r=/a\.tiles\.mapbox.com/.test(L.mapbox.config.HTTP_URL)?[{title:"高德地图",layer:L.tileLayer.chinaProvider("GaoDe.Normal.Map",{maxZoom:18,minZoom:3})},{title:"高德卫星地图",layer:L.tileLayer.chinaProvider("GaoDe.Satellite.Map",{maxZoom:18,minZoom:3})},{title:"智图地图",layer:L.tileLayer.chinaProvider("Geoq.Normal.Map",{maxZoom:18,minZoom:3})},{title:"天地图",layer:L.tileLayer.chinaProvider("TianDiTu.Normal.Map",{maxZoom:18,minZoom:3})},{title:"谷歌地图",layer:L.tileLayer.chinaProvider("Google.Normal.Map",{maxZoom:18,minZoom:3})},{title:"夜间灯光",layer:L.tileLayer("https://map1.vis.earthdata.nasa.gov/wmts-webmerc/VIIRS_CityLights_2012/default/{time}/{tilematrixset}{maxZoom}/{z}/{y}/{x}.{format}",{bounds:[[-85.0511287776,-179.999999975],[85.0511287776,179.999999975]],minZoom:1,maxZoom:8,format:"jpg",time:"",tilematrixset:"GoogleMapsCompatible_Level"})}]:[{title:"Mapbox",layer:L.mapbox.tileLayer("mapbox.osm-bright")},{title:"Mapbox Outdoors",layer:L.mapbox.tileLayer("mapbox.mapbox-outdoors")},{title:"Satellite",layer:L.mapbox.tileLayer("mapbox.satellite-full")}],i=t.append("div").attr("class","layer-switch").selectAll("button").data(r).enter().append("button").attr("class","pad0x").on("click",e).text(function(t){return t.title});i.filter(function(t,e){return 0===e}).call(e)}}},{}],187:[function(t,e,n){t("qs-hash"),t("../lib/custom_hash.js");for(var r=t("../lib/popup"),u=t("escape-html"),c=t("leaflet-geodesy"),i=t("geojson-rewind"),h=!1,f=!0,o=t("../../data/maki.json"),p="",a=0;a<o.length;a++)p+='<option value="'+o[a].icon+'">';function s(t,e){e.clearLayers(),L.geoJson(t,{style:L.mapbox.simplestyle.style,pointToLayer:function(t,e){return t.properties||(t.properties={}),L.mapbox.marker.style(t,e)}}).eachLayer(function(t){(function(t){var e,n=JSON.parse(JSON.stringify(t.toGeoJSON().properties)),r="",i="",o={};for(e in n){var a=u(e);"object"==typeof n[e]?o[a]=u(JSON.stringify(n[e])):o[a]=u(n[e])}if(o){for(var s in Object.keys(o).length||(o={"":""}),t.feature&&t.feature.geometry&&h&&("Point"!==t.feature.geometry.type&&"MultiPoint"!==t.feature.geometry.type||("marker-color"in o||(r+='<tr class="style-row"><th><input type="text" value="marker-color"'+(h?"":" readonly")+' /></th><td><input type="color" value="#7E7E7E"'+(h?"":" readonly")+" /></td></tr>"),"marker-size"in o||(r+='<tr class="style-row"><th><input type="text" value="marker-size"'+(h?"":" readonly")+' /></th><td><input type="text" list="marker-size" value="medium"'+(h?"":" readonly")+' /><datalist id="marker-size"><option value="small"><option value="medium"><option value="large"></datalist></td></tr>'),"marker-symbol"in o||(r+='<tr class="style-row"><th><input type="text" value="marker-symbol"'+(h?"":" readonly")+' /></th><td><input type="text" list="marker-symbol" value=""'+(h?"":" readonly")+' /><datalist id="marker-symbol">'+p+"</datalist></td></tr>")),"LineString"!==t.feature.geometry.type&&"MultiLineString"!==t.feature.geometry.type&&"Polygon"!==t.feature.geometry.type&&"MultiPolygon"!==t.feature.geometry.type||("stroke"in o||(r+='<tr class="style-row"><th><input type="text" value="stroke"'+(h?"":" readonly")+' /></th><td><input type="color" value="#555555"'+(h?"":" readonly")+" /></td></tr>"),"stroke-width"in o||(r+='<tr class="style-row"><th><input type="text" value="stroke-width"'+(h?"":" readonly")+' /></th><td><input type="number" min="0" step="0.1" value="2"'+(h?"":" readonly")+" /></td></tr>"),"stroke-opacity"in o||(r+='<tr class="style-row"><th><input type="text" value="stroke-opacity"'+(h?"":" readonly")+' /></th><td><input type="number" min="0" max="1" step="0.1" value="1"'+(h?"":" readonly")+" /></td></tr>")),"Polygon"!==t.feature.geometry.type&&"MultiPolygon"!==t.feature.geometry.type||("fill"in o||(r+='<tr class="style-row"><th><input type="text" value="fill"'+(h?"":" readonly")+' /></th><td><input type="color" value="#555555"'+(h?"":" readonly")+" /></td></tr>"),"fill-opacity"in o||(r+='<tr class="style-row"><th><input type="text" value="fill-opacity"'+(h?"":" readonly")+' /></th><td><input type="number" min="0" max="1" step="0.1" value="0.5"'+(h?"":" readonly")+" /></td></tr>"))),o)r+="marker-color"!=s&&"stroke"!=s&&"fill"!=s||!h?"marker-size"==s&&h?'<tr class="style-row"><th><input type="text" value="'+s+'"'+(h?"":" readonly")+' /></th><td><input type="text" list="marker-size" value="'+o[s]+'"'+(h?"":" readonly")+' /><datalist id="marker-size"><option value="small"><option value="medium"><option value="large"></datalist></td></tr>':"marker-symbol"==s&&h?'<tr class="style-row"><th><input type="text" value="'+s+'"'+(h?"":" readonly")+' /></th><td><input type="text" list="marker-symbol" value="'+o[s]+'"'+(h?"":" readonly")+' /><datalist id="marker-symbol">'+p+"</datalist></td></tr>":"stroke-width"==s&&h?'<tr class="style-row"><th><input type="text" value="'+s+'"'+(h?"":" readonly")+' /></th><td><input type="number" min="0" step="0.1" value="'+o[s]+'"'+(h?"":" readonly")+" /></td></tr>":"stroke-opacity"!=s&&"fill-opacity"!=s||!h?'<tr><th><input type="text" value="'+s+'"'+(h?"":" readonly")+' /></th><td><input type="text" value="'+o[s]+'"'+(h?"":" readonly")+" /></td></tr>":'<tr class="style-row"><th><input type="text" value="'+s+'"'+(h?"":" readonly")+' /></th><td><input type="number" min="0" max="1" step="0.1" value="'+o[s]+'"'+(h?"":" readonly")+" /></td></tr>":'<tr class="style-row"><th><input type="text" value="'+s+'"'+(h?"":" readonly")+' /></th><td><input type="color" value="'+o[s]+'"'+(h?"":" readonly")+" /></td></tr>";t.feature&&t.feature.geometry&&(i+='<table class="metadata">',"LineString"===t.feature.geometry.type?(l=d3.pairs(t.feature.geometry.coordinates).reduce(function(t,e){return t+L.latLng(e[0][1],e[0][0]).distanceTo(L.latLng(e[1][1],e[1][0]))},0),i+="<tr><td>Meters</td><td>"+l.toFixed(2)+"</td></tr><tr><td>Kilometers</td><td>"+(l/1e3).toFixed(2)+"</td></tr><tr><td>Feet</td><td>"+(l/.3048).toFixed(2)+"</td></tr><tr><td>Yards</td><td>"+(l/.9144).toFixed(2)+"</td></tr><tr><td>Miles</td><td>"+(l/1609.34).toFixed(2)+"</td></tr>"):"Point"===t.feature.geometry.type?i+="<tr><td>Latitude </td><td>"+t.feature.geometry.coordinates[1].toFixed(4)+"</td></tr><tr><td>Longitude</td><td>"+t.feature.geometry.coordinates[0].toFixed(4)+"</td></tr>":"Polygon"===t.feature.geometry.type&&(i+="<tr><td>Sq. Meters</td><td>"+c.area(t).toFixed(2)+"</td></tr><tr><td>Sq. Kilometers</td><td>"+(c.area(t)/1e6).toFixed(2)+"</td></tr><tr><td>Sq. Feet</td><td>"+(c.area(t)/.092903).toFixed(2)+"</td></tr><tr><td>Acres</td><td>"+(c.area(t)/4046.86).toFixed(2)+"</td></tr><tr><td>Sq. Miles</td><td>"+(c.area(t)/2589990).toFixed(2)+"</td></tr>"),i+="</table>");var l='<div class="pad1 tabs-ui clearfix col12"><div class="tab col12"><input class="hide" type="radio" id="properties" name="tab-group" checked="true"><label class="keyline-top keyline-right tab-toggle pad0 pin-bottomleft z10 center col6" for="properties">Properties</label><div class="space-bottom1 col12 content"><table class="space-bottom0 marker-properties">'+r+"</table>"+(h?'<div class="add-row-button add fl col3"><span class="icon-plus"> Add row</div><div class="fl text-right col9"><input type="checkbox" id="show-style" name="show-style" value="true" checked><label for="show-style">Show style properties</label></div>':"")+'</div></div><div class="space-bottom2 tab col12"><input class="hide" type="radio" id="info" name="tab-group"><label class="keyline-top tab-toggle pad0 pin-bottomright z10 center col6" for="info">Info</label><div class="space-bottom1 col12 content"><div class="marker-info">'+i+" </div></div></div></div>"+(h?'<div class="clearfix col12 pad1 keyline-top"><div class="pill col6"><button class="save col6 major">Save</button> <button class="minor col6 cancel">Cancel</button></div><button class="col6 text-right pad0 delete-invert"><span class="icon-remove-sign"></span> Delete feature</button></div>':"");t.bindPopup(L.popup({closeButton:!1,maxWidth:500,maxHeight:400,autoPanPadding:[5,45],className:"geojsonio-feature"},t).setContent(l)),t.on("popupopen",function(t){!1===f&&(d3.select("#show-style").property("checked",!1),d3.selectAll(".style-row").style("display","none")),d3.select("#show-style").on("click",function(){this.checked?(f=!0,d3.selectAll(".style-row").style("display","")):(f=!1,d3.selectAll(".style-row").style("display","none"))})})}})(t),t.addTo(e)})}e.exports=function(n,t){return h=!t,function(t){function e(){var e,t=n.mapLayer.toGeoJSON();s(i(t),n.mapLayer),n.data.set({map:(t=n.mapLayer,e=[],t.eachLayer(function(t){"toGeoJSON"in t&&e.push(t.toGeoJSON())}),{type:"FeatureCollection",features:e})},"map")}n.map=L.mapbox.map(t.node(),null).setView([20,0],2).addControl(L.mapbox.geocoderControl("mapbox.places",{position:"topright"})),L.control.scale().setPosition("bottomright").addTo(n.map),n.map.zoomControl.setPosition("topright"),L.hash(n.map),n.mapLayer=L.featureGroup().addTo(n.map),h&&(n.drawControl=new L.Control.Draw({position:"topright",edit:{featureGroup:n.mapLayer},draw:{circle:!1,polyline:{metric:"en-us"!==navigator.language&&"en-US"!==navigator.language},polygon:{metric:"en-us"!==navigator.language&&"en-US"!==navigator.language},marker:{icon:L.mapbox.marker.icon({})}}}).addTo(n.map),n.map.on("draw:edited",e).on("draw:deleted",e)),n.map.on("draw:created",function(t){n.mapLayer.addLayer(t.layer),e()}).on("popupopen",r(n)),n.map.attributionControl.setPrefix('<a target="_blank" href="http://tmcw.wufoo.com/forms/z7x4m1/">Feedback</a> | <a target="_blank" href="http://geojson.io/about.html">About</a>'),n.dispatch.on("change.map",function(){s(n.data.get("map"),n.mapLayer)})}}},{"../../data/maki.json":1,"../lib/custom_hash.js":169,"../lib/popup":171,"escape-html":19,"geojson-rewind":29,"leaflet-geodesy":61,"qs-hash":89}],188:[function(t,e,n){e.exports=function(t){"use strict";t.select("div.message").remove();var e=t.append("div").attr("class","message pad1");return e.append("a").attr("class","icon-remove fr").on("click",function(){e.remove()}),e.append("div").attr("class","content"),e.style("opacity",0).transition().duration(200).style("opacity",1),e.close=function(){e.transition().duration(200).style("opacity",0).remove(),e.transition().duration(200).style("top","0px")},e}},{}],189:[function(t,e,n){e.exports=function(t,e){var n=t.select("div.modal"),r=n.empty(),i=(n.transition().duration(200).style("opacity",0).remove(),t.append("div").attr("class","shaded").style("opacity",0)),o=(i.close=function(){i.transition().duration(200).style("opacity",0).remove(),a.transition().duration(200).style("top","0px"),o.off()},d3.keybinding("modal").on("⌫",i.close).on("⎋",i.close)),a=(d3.select(document).call(o),i.append("div").attr("class","modal fillL col6"));return i.on("click.remove-modal",function(){d3.event.target!==this||e||i.close()}),a.append("button").attr("class","close").on("click",function(){e||i.close()}).append("div").attr("class","icon close"),a.append("div").attr("class","content"),r?(i.transition().style("opacity",1),a.style("top","0px").transition().duration(200).style("top","40px")):i.style("opacity",1),i}},{}],190:[function(t,e,n){var a=t("../panel/table"),s=t("../panel/json"),l=t("../panel/help");e.exports=function(i,o){return function(t){var n=null,e=[{icon:"code",title:" JSON",alt:"JSON Source",behavior:s},{icon:"table",title:" Table",alt:"Edit feature properties in a table",behavior:a},{icon:"question",title:" Help",alt:"Help",behavior:l}],r=t.selectAll("button").data(e,function(t){return t.icon}),t=r.enter().append("button").attr("title",function(t){return t.alt}).on("click",function(e){r.classed("active",function(t){return e.icon==t.icon}),n&&n.off();n=e.behavior(i),o.call(n)});t.append("span").attr("class",function(t){return"icon-"+t.icon}),t.append("span").text(function(t){return t.title}),d3.select(r.node()).trigger("click")}}},{"../panel/help":176,"../panel/json":177,"../panel/table":178}],191:[function(t,e,n){var a=t("./flash");e.exports=function(o){function n(t,e){if(t)return a(o.container,t.toString());var n,r,i,t=o.data.get("type");"gist"===t||"gist"===e.type?(n="Changes to this map saved to Gist: ",r=e.html_url,i=e.id):"github"===t?(n="Changes committed to GitHub: ",r=e.commit.html_url,i=e.commit.sha.substring(0,10)):n="Changes saved to disk.",a(o.container,n+(r?'<a href="'+r+'">'+i+"</a>":"")),o.container.select(".map").classed("loading",!1),o.data.parse(e)}d3.event&&d3.event.preventDefault();o.data.get("meta");var t=o.data.get("map"),t=t&&t.geometry||t.features&&t.features.length,e=o.data.get("type");if(!t)return a(o.container,"Add a feature to the map to save it");o.container.select(".map").classed("loading",!0),"github"===e?o.repo.details(function(t,e){!t&&e.permissions.push?(t=prompt("Commit Message"))?(o.commitMessage=t,o.data.save(n)):o.container.select(".map").classed("loading",!1):o.data.save(n)}):o.data.save(n)}},{"./flash":185}],192:[function(t,e,n){var r=t("../source/gist"),i=t("./modal");e.exports=function(e){return function(t){r.saveBlocks(e.data.get("map"),function(t,e){var n=i(d3.select("div.geojsonio")),n=(n.select(".m").attr("class","modal-splash modal col6"),n.select(".content"));n.append("div").attr("class","header pad2 fillD").append("h1").text("Share"),t||!e?n.append("div").attr("class","pad2").text("Could not share: an error occurred: "+t):((t=n.append("div").attr("class","pad2")).append("input").style("width","100%").property("value","http://bl.ocks.org/d/"+e.id),t.append("p").text("URL to the full-screen map in that embed"))})}}},{"../source/gist":179,"./modal":189}],193:[function(t,e,n){e.exports=function(a){return/a\.tiles\.mapbox\.com/.test(L.mapbox.config.HTTP_URL)||t("../config.js")(location.hostname).GithubAPI?function(t){var n=t.append("a").attr("target","_blank"),r=(t.append("span").text(" | "),t.append("a").attr("href","#"));function e(){r.text("login").on("click",i),n.text("anon").attr("href","#").on("click",function(){d3.event.preventDefault()})}function i(){d3.event.preventDefault(),a.user.authenticate()}function o(){d3.event.preventDefault(),a.user.logout(),e()}e(),a.user.token()&&a.user.details(function(t,e){t||(n.text(e.login),n.attr("href",e.html_url),n.on("click",null),r.text("logout").on("click",o))})}:function(){}}},{"../config.js":160}],topojson:[function(t,e,n){e=e.exports=t("./topojson");e.topology=t("./lib/topojson/topology"),e.simplify=t("./lib/topojson/simplify"),e.clockwise=t("./lib/topojson/clockwise"),e.filter=t("./lib/topojson/filter"),e.prune=t("./lib/topojson/prune"),e.bind=t("./lib/topojson/bind"),e.stitch=t("./lib/topojson/stitch"),e.scale=t("./lib/topojson/scale")},{"./lib/topojson/bind":108,"./lib/topojson/clockwise":111,"./lib/topojson/filter":115,"./lib/topojson/prune":119,"./lib/topojson/scale":121,"./lib/topojson/simplify":122,"./lib/topojson/stitch":124,"./lib/topojson/topology":125,"./topojson":137}]},{},[168]);
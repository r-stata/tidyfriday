!function(){"use strict";var M=CodeMirror.Pos,C="http://www.w3.org/2000/svg";function p(t,e){this.mv=t,this.type=e,this.classes="left"==e?{chunk:"CodeMirror-diff-l-chunk",start:"CodeMirror-diff-l-chunk-start",end:"CodeMirror-diff-l-chunk-end",insert:"CodeMirror-diff-l-inserted",del:"CodeMirror-diff-l-deleted",connect:"CodeMirror-diff-l-connect"}:{chunk:"CodeMirror-diff-r-chunk",start:"CodeMirror-diff-r-chunk-start",end:"CodeMirror-diff-r-chunk-end",insert:"CodeMirror-diff-r-inserted",del:"CodeMirror-diff-r-deleted",connect:"CodeMirror-diff-r-connect"}}function a(t,e){var r,o,i,n,l,f,d,c,a,s,u,h,g;return!t.diffOutOfDate&&(!t.lockScroll||(r=+new Date,g=e==DIFF_INSERT?(h=t.edit,t.orig):(h=t.orig,t.edit),h.state.scrollSetBy==t&&(h.state.scrollSetAt||0)+50>r?void 0:(o=.5*(i=h.getScrollInfo()).clientHeight,i=i.top+o,n=h.lineAtHeight(i,"local"),u=t.diff,l=n,f=e==DIFF_INSERT,F(u,function(t,e,r,o){var i=f?r:t,n=f?o:e;null==c&&(l<i?(c=r,s=t):l<n&&(c=o,s=e)),n<=l?(d=o,a=e):i<=l&&(d=r,a=t)}),n={edit:{before:d,after:c},orig:{before:a,after:s}},u=v(h,e==DIFF_INSERT?n.edit:n.orig),h=v(g,e==DIFF_INSERT?n.orig:n.edit),e=(i-u.top)/(u.bot-u.top),g.scrollTo(null,h.top-o+e*(h.bot-h.top)),g.state.scrollSetAt=r,g.state.scrollSetBy=t,1)))}function v(t,e){var r=e.after;return null==r&&(r=t.lastLine()+1),{top:t.heightAtLine(e.before||0,"local"),bot:t.heightAtLine(r,"local")}}function s(t,e,r){(t.lockScroll=e)&&0!=r&&a(t,DIFF_INSERT)&&m(t),t.lockButton.innerHTML=e?"⇛⇚":"⇛&nbsp;&nbsp;⇚"}function u(n,l,f,d,c){var a=n.getViewport();n.operation(function(){if(f.from==f.to||20<a.from-f.to||20<f.from-a.to){for(var t=n,e=f.marked,r=c,o=0;o<e.length;++o){var i=e[o];i instanceof CodeMirror.TextMarker?i.clear():(t.removeLineClass(i,"background",r.chunk),t.removeLineClass(i,"background",r.start),t.removeLineClass(i,"background",r.end))}e.length=0,h(n,l,d,f.marked,a.from,a.to,c),f.from=a.from,f.to=a.to}else a.from<f.from&&(h(n,l,d,f.marked,a.from,f.from,c),f.from=a.from),a.to>f.to&&(h(n,l,d,f.marked,f.to,a.to,c),f.to=a.to)})}function h(l,t,e,f,d,c,a){var r=M(0,0),o=M(d,0),i=l.clipPos(M(c-1)),n=e==DIFF_DELETE?a.del:a.insert;function s(t,e){for(var r=Math.max(d,t),o=Math.min(c,e),i=r;i<o;++i){var n=l.addLineClass(i,"background",a.chunk);i==t&&l.addLineClass(n,"background",a.start),i==e-1&&l.addLineClass(n,"background",a.end),f.push(n)}t==e&&r==e&&o==e&&(r?f.push(l.addLineClass(r-1,"background",a.end)):f.push(l.addLineClass(r,"background",a.start)))}for(var u,h=0,g=0;g<t.length;++g){var p,v,C,m=t[g],k=m[0],m=m[1];k==DIFF_EQUAL?(v=r.line+(b(t,g)?0:1),O(r,m),v<(p=r.line+(I(t,g)?1:0))&&(g&&s(h,v),h=p)):k==e&&(v=O(r,m,!0),p=r,m=0<((k=o).line-p.line||k.ch-p.ch)?k:p,k=v,C=((C=i).line-k.line||C.ch-k.ch)<0?C:k,k=C,(u=m).line==k.line&&u.ch==k.ch||f.push(l.markText(m,C,{className:n})),r=v)}h<=r.line&&s(h,r.line+1)}function m(a){a.svg&&(t(a.svg),s=a.gap.offsetWidth,w(a.svg,"width",s,"height",a.gap.offsetHeight)),t(a.copyButtons);var s,u="left"==a.type,h=a.edit.getViewport(),g=a.orig.getViewport(),p=a.edit.getScrollInfo().top,v=a.orig.getScrollInfo().top;F(a.diff,function(t,e,r,o){var i,n,l,f,d,c;r>=h.to||o<h.from||t>=g.to||e<g.from||(i=d=a.orig.heightAtLine(t,"local")-v,a.svg&&(n=a.edit.heightAtLine(r,"local")-p,u&&(f=d,d=n,n=f),l=a.orig.heightAtLine(e,"local")-v,c=a.edit.heightAtLine(o,"local")-p,u&&(f=l,l=c,c=f),f=" C "+s/2+" "+n+" "+s/2+" "+d+" "+(s+2)+" "+d,d=" C "+s/2+" "+l+" "+s/2+" "+c+" -1 "+c,w(a.svg.appendChild(document.createElementNS(C,"path")),"d","M -1 "+n+f+" L "+(s+2)+" "+l+d+" z","class",a.classes.connect)),(c=a.copyButtons.appendChild(D("div","left"==a.type?"⇝":"⇜","CodeMirror-diff-copy"))).title="Revert chunk",c.chunk={topEdit:r,botEdit:o,topOrig:t,botOrig:e},c.style.top=i+"px")})}p.prototype={constructor:p,init:function(t,e,r){function o(){n.diffOutOfDate&&(n.diff=g(n.orig.getValue(),n.edit.getValue()),n.diffOutOfDate=!1),u(n.edit,n.diff,f,DIFF_INSERT,n.classes),u(n.orig,n.diff,d,DIFF_DELETE,n.classes),m(n)}function i(t){clearTimeout(l),l=setTimeout(o,1==t?250:100)}var n,l,f,d,c;this.edit=this.mv.edit,this.orig=CodeMirror(t,L({value:e,readOnly:!0},L(r))),this.diff=g(e,r.value),this.diffOutOfDate=!1,this.forceUpdate=(f={from:0,to:0,marked:[]},d={from:0,to:0,marked:[]},(n=this).edit.on("change",function(){n.diffOutOfDate||(n.diffOutOfDate=!0,f.from=f.to=d.from=d.to=0),i(!0)}),n.edit.on("viewportChange",i),n.orig.on("viewportChange",i),o(),o),s(this,!0,!1),(c=this).edit.on("scroll",function(){a(c,DIFF_INSERT)&&m(c)}),c.orig.on("scroll",function(){a(c,DIFF_DELETE)&&m(c)})}};var k=CodeMirror.MergeView=function(t,e){if(!(this instanceof k))return new k(t,e);function r(){s&&m(s),u&&m(u)}var o,i,n=e.origLeft,l=null==e.origRight?e.orig:e.origRight,f=null!=n,d=null!=l,c=1+(f?1:0)+(d?1:0),a=[],s=this.left=null,u=this.right=null,f=(f&&(s=this.left=new p(this,"left"),o=D("div",null,"CodeMirror-diff-pane"),a.push(o),a.push(E(s))),D("div",null,"CodeMirror-diff-pane")),h=(a.push(f),d&&(u=this.right=new p(this,"right"),a.push(E(u)),i=D("div",null,"CodeMirror-diff-pane"),a.push(i)),a.push(D("div",null,null,"height: 0; clear: both;")),this.wrap=t.appendChild(D("div",a,"CodeMirror-diff CodeMirror-diff-"+c+"pane"))),g=(this.edit=CodeMirror(f,L(e)),s&&s.init(o,n,e),u&&u.init(i,l,e),CodeMirror.on(window,"resize",r),setInterval(function(){for(var t=h.parentNode;t&&t!=document.body;t=t.parentNode);t||(clearInterval(g),CodeMirror.off(window,"resize",r))},5e3))};function E(r){var t=r.lockButton=D("div",null,"CodeMirror-diff-scrolllock"),e=(t.title="Toggle locked scrolling",D("div",[t],"CodeMirror-diff-scrolllock-wrap")),t=(CodeMirror.on(t,"click",function(){s(r,!r.lockScroll)}),r.copyButtons=D("div",null,"CodeMirror-diff-copybuttons-"+r.type),CodeMirror.on(r.copyButtons,"click",function(t){var e,t=t.target||t.srcElement;t.chunk&&(e=r,t=t.chunk,e.diffOutOfDate||e.edit.replaceRange(e.orig.getRange(M(t.topOrig,0),M(t.botOrig,0)),M(t.topEdit,0),M(t.botEdit,0)))}),[r.copyButtons,e]),e=document.createElementNS&&document.createElementNS(C,"svg");return e&&!e.createSVGRect&&(e=null),(r.svg=e)&&t.push(e),r.gap=D("div",t,"CodeMirror-diff-gap")}k.prototype={constuctor:k,editor:function(){return this.edit},rightOriginal:function(){return this.right&&this.right.orig},leftOriginal:function(){return this.left&&this.left.orig}};var n=new diff_match_patch;function g(t,e){var r=n.diff_main(t,e);n.diff_cleanupSemantic(r);for(var o=0;o<r.length;++o){var i=r[o];i[1]?o&&r[o-1][0]==i[0]&&(r.splice(o--,1),r[o][1]+=i[1]):r.splice(o--,1)}return r}function F(t,e){for(var r=0,o=0,i=M(0,0),n=M(0,0),l=0;l<t.length;++l){var f,d,c,a,s=t[l],u=s[0];u==DIFF_EQUAL?(d=b(t,l)?0:1,f=i.line+d,d=n.line+d,O(i,s[1],null,n),a=I(t,l)?1:0,c=i.line+a,a=n.line+a,f<c&&(l&&e(o,d,r,f),r=c,o=a)):O(u==DIFF_INSERT?i:n,s[1])}(r<=i.line||o<=n.line)&&e(o,n.line+1,r,i.line+1)}function I(t,e){var r;return e==t.length-1||1!=(r=t[e+1][1]).length&&10==r.charCodeAt(0)&&(e==t.length-2||1<(r=t[e+2][1]).length&&10==r.charCodeAt(0))}function b(t,e){var r;return 0==e||10==(r=t[e-1][1]).charCodeAt(r.length-1)&&(1==e||10==(r=t[e-2][1]).charCodeAt(r.length-1))}function D(t,e,r,o){var i=document.createElement(t);if(r&&(i.className=r),o&&(i.style.cssText=o),"string"==typeof e)i.appendChild(document.createTextNode(e));else if(e)for(var n=0;n<e.length;++n)i.appendChild(e[n]);return i}function t(t){for(var e=t.childNodes.length;0<e;--e)t.removeChild(t.firstChild)}function w(t){for(var e=1;e<arguments.length;e+=2)t.setAttribute(arguments[e],arguments[e+1])}function L(t,e){for(var r in e=e||{},t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function O(t,e,r,o){for(var i=r?M(t.line,t.ch):t,n=0;;){var l=e.indexOf("\n",n);if(-1==l)break;++i.line,o&&++o.line,n=l+1}return i.ch=(n?0:i.ch)+(e.length-n),o&&(o.ch=(n?0:o.ch)+(e.length-n)),i}}();
!function(){var g=CodeMirror.Pos;function i(l,c,e,t){var f,u;this.atOccurrence=!1,this.doc=l,null==t&&"string"==typeof c&&(t=!1),e=e?l.clipPos(e):g(0,0),this.pos={from:e,to:e},"string"!=typeof c?(c.global||(c=new RegExp(c.source,c.ignoreCase?"ig":"g")),this.matches=function(e,t){if(e){c.lastIndex=0;for(var n=l.getLine(t.line).slice(0,t.ch),i=0;;){c.lastIndex=i;var r=c.exec(n);if(!r)break;if(s=(o=r).index,(i=o.index+(o[0].length||1))==n.length)break}(h=o&&o[0].length||0)||(0==s&&0==n.length?o=void 0:s!=l.getLine(t.line).length&&h++)}else{c.lastIndex=t.ch;var o,s,n=l.getLine(t.line),h=(o=c.exec(n))&&o[0].length||0;(s=o&&o.index)+h==n.length||h||(h=1)}if(o&&h)return{from:g(t.line,s),to:g(t.line,s+h),match:o}}):(t&&(c=c.toLowerCase()),f=t?function(e){return e.toLowerCase()}:function(e){return e},1==(u=c.split("\n")).length?c.length?this.matches=function(e,t){var n,i=f(l.getLine(t.line)),r=c.length;if(e?t.ch>=r&&-1!=(n=i.lastIndexOf(c,t.ch-r)):-1!=(n=i.indexOf(c,t.ch)))return{from:g(t.line,n),to:g(t.line,n+r)}}:this.matches=function(){}:this.matches=function(e,t){var n=t.line,i=e?u.length-1:0,r=u[i],o=f(l.getLine(n)),s=e?o.indexOf(r)+r.length:o.lastIndexOf(r);if(!(e?s>=t.ch||s!=r.length:s<=t.ch||s!=o.length-r.length))for(;;){if(e?!n:n==l.lineCount()-1)return;var h,c,o=f(l.getLine(n+=e?-1:1)),r=u[e?--i:++i];if(!(0<i&&i<u.length-1))return c=e?o.lastIndexOf(r):o.indexOf(r)+r.length,(e?c!=o.length-r.length:c!=r.length)?void 0:(h=g(t.line,s),c=g(n,c),{from:e?c:h,to:e?h:c});if(o!=r)return}})}i.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){var t=this,n=this.doc.clipPos(e?this.pos.from:this.pos.to);function i(e){e=g(e,0);return t.pos={from:e,to:e},t.atOccurrence=!1}for(;;){if(this.pos=this.matches(e,n))return this.pos.from&&this.pos.to||console.log(this.matches,this.pos),this.atOccurrence=!0,this.pos.match||!0;if(e){if(!n.line)return i(0);n=g(n.line-1,this.doc.getLine(n.line-1).length)}else{var r=this.doc.lineCount();if(n.line==r-1)return i(r);n=g(n.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(e){this.atOccurrence&&(e=CodeMirror.splitLines(e),this.doc.replaceRange(e,this.pos.from,this.pos.to),this.pos.to=g(this.pos.from.line+e.length-1,e[e.length-1].length+(1==e.length?this.pos.from.ch:0)))}},CodeMirror.defineExtension("getSearchCursor",function(e,t,n){return new i(this.doc,e,t,n)}),CodeMirror.defineDocExtension("getSearchCursor",function(e,t,n){return new i(this,e,t,n)})}();
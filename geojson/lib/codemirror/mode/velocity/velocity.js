CodeMirror.defineMode("velocity",function(){function e(e){for(var r={},t=e.split(" "),n=0;n<t.length;++n)r[t[n]]=!0;return r}var a=e("#end #else #break #stop #[[ #]] #{end} #{else} #{break} #{stop}"),i=e("#if #elseif #foreach #set #include #parse #macro #define #evaluate #{if} #{elseif} #{foreach} #{set} #{include} #{parse} #{macro} #{define} #{evaluate}"),f=e("$foreach.count $foreach.hasNext $foreach.first $foreach.last $foreach.topmost $foreach.parent $velocityCount"),u=/[+\-*&%=<>!?:\/|]/;function s(e,r,t){return(r.tokenize=t)(e,r)}function c(e,r){var o,t=r.beforeParams,n=(r.beforeParams=!1,e.next());return'"'!=n&&"'"!=n||!r.inParams?/[\[\]{}\(\),;\.]/.test(n)?("("==n&&t?r.inParams=!0:")"==n&&(r.inParams=!1),null):/\d/.test(n)?(e.eatWhile(/[\w\.]/),"number"):"#"==n&&e.eat("*")?s(e,r,l):"#"==n&&e.match(/ *\[ *\[/)?s(e,r,m):"#"==n&&e.eat("#")?(e.skipToEnd(),"comment"):"$"==n?(e.eatWhile(/[\w\d\$_\.{}]/),f&&f.propertyIsEnumerable(e.current().toLowerCase())?"keyword":(r.beforeParams=!0,"builtin")):u.test(n)?(e.eatWhile(u),"operator"):(e.eatWhile(/[\w\$_{}]/),t=e.current().toLowerCase(),a&&a.propertyIsEnumerable(t)?"keyword":i&&i.propertyIsEnumerable(t)||e.current().match(/^#[a-z0-9_]+ *$/i)&&"("==e.peek()?(r.beforeParams=!0,"keyword"):null):s(e,r,(o=n,function(e,r){for(var t,n=!1,a=!1;null!=(t=e.next());){if(t==o&&!n){a=!0;break}n=!n&&"\\"==t}return a&&(r.tokenize=c),"string"}))}function l(e,r){for(var t,n=!1;t=e.next();){if("#"==t&&n){r.tokenize=c;break}n="*"==t}return"comment"}function m(e,r){for(var t,n=0;t=e.next();){if("#"==t&&2==n){r.tokenize=c;break}"]"==t?n++:" "!=t&&(n=0)}return"meta"}return{startState:function(){return{tokenize:c,beforeParams:!1,inParams:!1}},token:function(e,r){return e.eatSpace()?null:r.tokenize(e,r)}}}),CodeMirror.defineMIME("text/velocity","velocity");
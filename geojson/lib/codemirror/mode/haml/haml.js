!function(){"use strict";CodeMirror.defineMode("haml",function(e){var r=CodeMirror.getMode(e,{name:"htmlmixed"}),n=CodeMirror.getMode(e,"ruby");function i(n){return function(e,t){return e.peek()==n&&1==t.rubyState.tokenize.length?(e.next(),t.tokenize=a,"closeAttributeTag"):o(e,t)}}function o(e,t){return e.match("-#")?(e.skipToEnd(),"comment"):n.token(e,t.rubyState)}function a(e,t){var n=e.peek();if("comment"==t.previousToken.style&&t.indented>t.previousToken.indented)return e.skipToEnd(),"commentLine";if(t.startOfLine){if("!"==n&&e.match("!!"))return e.skipToEnd(),"tag";if(e.match(/^%[\w:#\.]+=/))return t.tokenize=o,"hamlTag";if(e.match(/^%[\w:]+/))return"hamlTag";if("/"==n)return e.skipToEnd(),"comment"}if((t.startOfLine||"hamlTag"==t.previousToken.style)&&("#"==n||"."==n))return e.match(/[\w-#\.]*/),"hamlAttribute";if(t.startOfLine&&!e.match("--\x3e",!1)&&("="==n||"-"==n))return t.tokenize=o,null;if("hamlTag"==t.previousToken.style||"closeAttributeTag"==t.previousToken.style||"hamlAttribute"==t.previousToken.style){if("("==n)return t.tokenize=i(")"),null;if("{"==n)return t.tokenize=i("}"),null}return r.token(e,t.htmlState)}return{startState:function(){return{htmlState:r.startState(),rubyState:n.startState(),indented:0,previousToken:{style:null,indented:0},tokenize:a}},copyState:function(e){return{htmlState:CodeMirror.copyState(r,e.htmlState),rubyState:CodeMirror.copyState(n,e.rubyState),indented:e.indented,previousToken:e.previousToken,tokenize:e.tokenize}},token:function(e,t){var n,r;return e.sol()&&(t.indented=e.indentation(),t.startOfLine=!0),e.eatSpace()?null:(n=t.tokenize(e,t),t.startOfLine=!1,n&&"commentLine"!=n&&(t.previousToken={style:n,indented:t.indented}),e.eol()&&t.tokenize==o&&(e.backUp(1),r=e.peek(),e.next(),r&&","!=r&&(t.tokenize=a)),"hamlTag"==n?n="tag":"commentLine"==n?n="comment":"hamlAttribute"==n?n="attribute":"closeAttributeTag"==n&&(n=null),n)},indent:function(e){return e.indented}}},"htmlmixed","ruby"),CodeMirror.defineMIME("text/x-haml","haml")}();
CodeMirror.defineMode("coffeescript",function(i){var c="error";function e(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}var o=new RegExp("^[\\+\\-\\*/%&|\\^~<>!?]"),f=new RegExp("^[\\(\\)\\[\\]\\{\\},:`=;\\.]"),a=new RegExp("^((->)|(=>)|(\\+\\+)|(\\+\\=)|(\\-\\-)|(\\-\\=)|(\\*\\*)|(\\*\\=)|(\\/\\/)|(\\/\\=)|(==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//))"),s=new RegExp("^((\\.\\.)|(\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),u=new RegExp("^((\\.\\.\\.)|(//=)|(>>=)|(<<=)|(\\*\\*=))"),p=new RegExp("^[_A-Za-z$][_A-Za-z$0-9]*"),l=new RegExp("^(@|this.)[_A-Za-z$][_A-Za-z$0-9]*"),d=e(["and","or","not","is","isnt","in","instanceof","typeof"]),h=e((m=["for","while","loop","if","unless","else","switch","try","catch","finally","class"]).concat(["break","by","continue","debugger","delete","do","in","of","new","return","then","this","throw","when","until"])),m=e(m),k=new RegExp("^('{3}|\"{3}|['\"])"),g=new RegExp("^(/{3}|/)"),x=e(["Infinity","NaN","undefined","null","true","false","on","off","yes","no"]);function b(e,t){if(e.sol()){var n=t.scopes[0].offset;if(e.eatSpace())return n<(r=e.indentation())?"indent":r<n?"dedent":null;0<n&&v(e,t)}if(e.eatSpace())return null;var r=e.peek();if(e.match("####"))return e.skipToEnd(),"comment";if(e.match("###"))return t.tokenize=w,t.tokenize(e,t);if("#"===r)return e.skipToEnd(),"comment";if(e.match(/^-?[0-9\.]/,!1)){n=!1;if(e.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)&&(n=!0),e.match(/^-?\d+\.\d*/)&&(n=!0),n=e.match(/^-?\.\d+/)?!0:n)return"."==e.peek()&&e.backUp(1),"number";r=!1;if(e.match(/^-?0x[0-9a-f]+/i)&&(r=!0),e.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)&&(r=!0),r=e.match(/^-?0(?![\dx])/i)?!0:r)return"number"}if(e.match(k))return t.tokenize=z(e.current(),"string"),t.tokenize(e,t);if(e.match(g)){if("/"!=e.current()||e.match(/^.*\//,!1))return t.tokenize=z(e.current(),"string-2"),t.tokenize(e,t);e.backUp(1)}return e.match(u)||e.match(s)?"punctuation":e.match(a)||e.match(o)||e.match(d)?"operator":e.match(f)?"punctuation":e.match(x)?"atom":e.match(h)?"keyword":e.match(p)?"variable":e.match(l)?"property":(e.next(),c)}function z(n,r){var o=1==n.length;return function(e,t){for(;!e.eol();)if(e.eatWhile(/[^'"\/\\]/),e.eat("\\")){if(e.next(),o&&e.eol())return r}else{if(e.match(n))return t.tokenize=b,r;e.eat(/['"\/]/)}return o&&(i.mode.singleLineStringErrors?r=c:t.tokenize=b),r}}function w(e,t){for(;!e.eol();){if(e.eatWhile(/[^#]/),e.match("###")){t.tokenize=b;break}e.eatWhile("#")}return"comment"}function y(e,t,n){var r=0;if("coffee"===(n=n||"coffee")){for(var o=0;o<t.scopes.length;o++)if("coffee"===t.scopes[o].type){r=t.scopes[o].offset+i.indentUnit;break}}else r=e.column()+e.current().length;t.scopes.unshift({offset:r,type:n})}function v(e,t){if(1!=t.scopes.length)if("coffee"===t.scopes[0].type){for(var n=e.indentation(),r=-1,o=0;o<t.scopes.length;++o)if(n===t.scopes[o].offset){r=o;break}if(-1===r)return 1;for(;t.scopes[0].offset!==n;)t.scopes.shift()}else t.scopes.shift()}return{startState:function(e){return{tokenize:b,scopes:[{offset:e||0,type:"coffee"}],lastToken:null,lambda:!1,dedent:0}},token:function(e,t){var n=function(e,t){var n=t.tokenize(e,t),r=e.current();if("."===r)return n=t.tokenize(e,t),r=e.current(),"variable"===n?"variable":c;"return"===r&&(t.dedent+=1),("->"!==r&&"=>"!==r||t.lambda||"coffee"!=t.scopes[0].type||""!==e.peek())&&"indent"!==n||y(e,t);var o="[({".indexOf(r);return-1!==o&&y(e,t,"])}".slice(o,o+1)),m.exec(r)&&y(e,t),"then"==r&&v(e,t),"dedent"===n&&v(e,t)||-1!=="])}".indexOf(r)&&v(e,t)?c:(0<t.dedent&&e.eol()&&"coffee"==t.scopes[0].type&&(1<t.scopes.length&&t.scopes.shift(),--t.dedent),n)}(e,t);return t.lastToken={style:n,content:e.current()},e.eol()&&e.lambda&&(t.lambda=!1),n},indent:function(e){return e.tokenize!=b?0:e.scopes[0].offset},lineComment:"#"}}),CodeMirror.defineMIME("text/x-coffeescript","coffeescript");
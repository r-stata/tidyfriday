!function(){"use strict";function we(){var P=/[\d]/,D=[/\w/,/[^\w\s]/],j=[/\S/];function e(e,t){for(var r=[],o=e;o<e+t;o++)r.push(String.fromCharCode(o));return r}var t,r=e(65,26),o=e(97,26),n=e(48,10),a="~`!@#$%^&*()_-+=[{}]\\|/?.,<>:;\"'".split(""),W=["Left","Right","Up","Down","Space","Backspace","Esc","Home","End","PageUp","PageDown","Enter"],_=[].concat(r,o,n,["<",">"]),H=[].concat(r,o,n,["-",'"']);function F(e,t){return t>=e.firstLine()&&t<=e.lastLine()}function m(e){return/^[a-z]$/.test(e)}function h(e){return/^[A-Z]$/.test(e)}function J(e){return/^\s*$/.test(e)}function w(e,t){for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return!1}function V(){var a=100,s=-1,c=0,l=0,u=new Array(a);return{cachedCursor:void 0,add:function(o,e,t){var r=u[s%a];function n(e){var t=++s%a,r=u[t];r&&r.clear(),u[t]=o.setBookmark(e)}r&&(!(r=r.find())||S(r,e))||n(e),n(t),(l=(c=s)-a+1)<0&&(l=0)},move:function(e,t){c<(s+=t)?s=c:s<l&&(s=l);var r=u[(a+s)%a];if(r&&!r.find()){var o,n=0<t?1:-1,i=e.getCursor();do{if((r=u[(a+(s+=n))%a])&&(o=r.find())&&!S(i,o))break}while(s<c&&l<s)}return r}}}function q(){return{macroKeyBuffer:[],latestRegister:void 0,inReplay:!1,lastInsertModeChanges:{changes:[],expectCursorActivityForChange:!1},enteredMacroMode:void 0,isMacroPlaying:!1,toggle:function(e,t){this.enteredMacroMode?(this.enteredMacroMode(),this.enteredMacroMode=void 0):(this.latestRegister=t,this.enteredMacroMode=e.openDialog("(recording)["+t+"]",null,{bottom:!0}))}}}function y(){return t=t||{searchQuery:null,searchIsReversed:!1,jumpList:V(),macroModeState:q(),lastChararacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new U({})}}function M(e){return e.vimState||(e.vimState={inputState:new v,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1}),e.vimState}function v(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null}function i(e,t){this.clear(),e&&this.set(e,t)}function U(e){this.registers=e,this.unamedRegister=e['"']=new i}o={buildKeyMap:function(){},getRegisterController:function(){return y().registerController},clearVimGlobalState_:function(){t=null},getVimGlobalState_:function(){return t},InsertModeKey:ve,map:function(e,t){g.map(e,t)},defineEx:function(e,t,r){if(0!==e.indexOf(t))throw new Error('(Vim.defineEx) "'+t+'" is not a prefix of "'+e+'", command not registered');de[e]=r,g.commandMap_[t]={name:e,shortName:t,type:"api"}},maybeInitState:function(e){M(e)},handleKey:function(e,t){var r,o,n=M(e),i=y().macroModeState;if(i.enteredMacroMode&&"q"==t)k.exitMacroRecordMode(),n.inputState=new v;else if("<Esc>"==t)n.inputState=new v,n.visualMode&&T(e,n);else if(n.visualMode&&S(e.getCursor("head"),e.getCursor("anchor"))&&T(e,n),n.visualMode||S(e.getCursor("head"),e.getCursor("anchor"))||(n.visualMode=!0,n.visualLine=!1),r="0"!=t||"0"==t&&0===n.inputState.getRepeat()?d.matchCommand(t,Me,n):r)if("keyToKey"==r.type)for(var a=0;a<r.toKeys.length;a++)this.handleKey(e,r.toKeys[a]);else i.enteredMacroMode&&(o=t,(i=i).isMacroPlaying||i.macroKeyBuffer.push(o)),d.processCommand(e,n,r);else P.test(t)&&n.inputState.pushRepeatDigit(t)}},v.prototype.pushRepeatDigit=function(e){this.operator?this.motionRepeat=this.motionRepeat.concat(e):this.prefixRepeat=this.prefixRepeat.concat(e)},v.prototype.getRepeat=function(){var e=0;return(0<this.prefixRepeat.length||0<this.motionRepeat.length)&&(e=1,0<this.prefixRepeat.length&&(e*=parseInt(this.prefixRepeat.join(""),10)),0<this.motionRepeat.length&&(e*=parseInt(this.motionRepeat.join(""),10))),e},i.prototype={set:function(e,t){this.text=e,this.linewise=!!t},append:function(e,t){t||this.linewise?(this.text+="\n"+e,this.linewise=!0):this.text+=e},clear:function(){this.text="",this.linewise=!1},toString:function(){return this.text}},U.prototype={pushText:function(e,t,r,o){o&&"\n"==r.charAt(0)&&(r=r.slice(1)+"\n");var n=this.isValidRegister(e)?this.getRegister(e):null;if(n)h(e)?(n.append(r,o),this.unamedRegister.append(r,o)):(n.set(r,o),this.unamedRegister.set(r,o));else{switch(t){case"yank":this.registers[0]=new i(r,o);break;case"delete":case"change":-1==r.indexOf("\n")?this.registers["-"]=new i(r,o):(this.shiftNumericRegisters_(),this.registers[1]=new i(r,o))}this.unamedRegister.set(r,o)}},setRegisterText:function(e,t,r){this.getRegister(e).set(t,r)},getRegister:function(e){return this.isValidRegister(e)?(e=e.toLowerCase(),this.registers[e]||(this.registers[e]=new i),this.registers[e]):this.unamedRegister},isValidRegister:function(e){return e&&w(e,H)},shiftNumericRegisters_:function(){for(var e=9;2<=e;e--)this.registers[e]=this.getRegister(""+(e-1))}};var d={matchCommand:function(e,t,r){for(var o=r.inputState,n=o.keyBuffer.concat(e),i=0;i<t.length;i++){var a=t[i];if(function(e,t){for(var r=0;r<e.length;r++)if(e[r]!=t[r]&&"character"!=t[r])return;return 1}(n,a.keys)){if(n.length<a.keys.length)return o.keyBuffer.push(e),null;if(!o.operator||"action"!=a.type){if("character"==a.keys[n.length-1]&&(o.selectedCharacter=n[n.length-1],1<o.selectedCharacter.length))switch(o.selectedCharacter){case"<CR>":o.selectedCharacter="\n";break;case"<Space>":o.selectedCharacter=" ";break;default:continue}return o.keyBuffer=[],a}}}return o.keyBuffer=[],null},processCommand:function(e,t,r){switch(t.inputState.repeatOverride=r.repeatOverride,r.type){case"motion":this.processMotion(e,t,r);break;case"operator":this.processOperator(e,t,r);break;case"operatorMotion":this.processOperatorMotion(e,t,r);break;case"action":this.processAction(e,t,r);break;case"search":this.processSearch(e,t,r);break;case"ex":case"keyToEx":this.processEx(e,t,r)}},processMotion:function(e,t,r){t.inputState.motion=r.motion,t.inputState.motionArgs=s(r.motionArgs),this.evalInput(e,t)},processOperator:function(e,t,r){var o=t.inputState;if(o.operator){if(o.operator==r.operator)return o.motion="expandToLine",o.motionArgs={linewise:!0},void this.evalInput(e,t);t.inputState=new v}o.operator=r.operator,o.operatorArgs=s(r.operatorArgs),t.visualMode&&this.evalInput(e,t)},processOperatorMotion:function(e,t,r){var o=t.visualMode,n=s(r.operatorMotionArgs);n&&o&&n.visualLine&&(t.visualLine=!0),this.processOperator(e,t,r),o||this.processMotion(e,t,r)},processAction:function(e,t,r){var o=t.inputState,n=o.getRepeat(),i=!!n,a=s(r.actionArgs)||{};o.selectedCharacter&&(a.selectedCharacter=o.selectedCharacter),r.operator&&this.processOperator(e,t,r),r.motion&&this.processMotion(e,t,r),(r.motion||r.operator)&&this.evalInput(e,t),a.repeat=n||1,a.repeatIsExplicit=i,a.registerName=o.registerName,t.inputState=new v,t.lastMotion=null,r.isEdit&&this.recordLastEdit(t,o,r),k[r.action](e,a,t)},processSearch:function(n,o,i){if(n.getSearchCursor){var a=i.searchArgs.forward,e=(E(n).setReversed(!a),a?"/":"?"),s=E(n).getQuery(),c=n.getScrollInfo();switch(i.searchArgs.querySrc){case"prompt":K(n,{onClose:function(e){n.scrollTo(c.left,c.top),u(e,!0,!0)},prefix:e,desc:se,onKeyUp:function(e,t){var r;try{r=O(n,t,!0,!0)}catch(e){}r?n.scrollIntoView(le(n,!a,r),30):(ue(n),n.scrollTo(c.left,c.top))},onKeyDown:function(e,t,r){var o=CodeMirror.keyName(e);"Esc"!=o&&"Ctrl-C"!=o&&"Ctrl-["!=o||(O(n,s),ue(n),n.scrollTo(c.left,c.top),CodeMirror.e_stop(e),r(),n.focus())}});break;case"wordUnderCursor":var t,r=p(n,!1,0,!1,!0),l=!0;r||(r=p(n,!1,0,!1,!1),l=!1),r&&(t=n.getLine(r.start.line).substring(r.start.ch,r.end.ch),t=l?"\\b"+t+"\\b":t.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1"),y().jumpList.cachedCursor=n.getCursor(),n.setCursor(r.start),u(t,!0,!1))}}function u(t,e,r){try{O(n,t,e,r)}catch(e){return void I(n,"Invalid regex: "+t)}d.processMotion(n,o,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:i.searchArgs.toJumplist}})}},processEx:function(n,e,t){function r(e){g.processCommand(n,e)}function o(e,t,r){var o=CodeMirror.keyName(e);"Esc"!=o&&"Ctrl-C"!=o&&"Ctrl-["!=o||(CodeMirror.e_stop(e),r(),n.focus())}"keyToEx"==t.type?g.processCommand(n,t.exArgs.input):e.visualMode?K(n,{onClose:r,prefix:":",value:"'<,'>",onKeyDown:o}):K(n,{onClose:r,prefix:":",onKeyDown:o})},evalInput:function(e,t){var r=t.inputState,o=r.motion,n=r.motionArgs||{},i=r.operator,a=r.operatorArgs||{},s=r.registerName,c=e.getCursor("head"),l=e.getCursor("anchor"),u=x(c),p=x(u);if(i&&this.recordLastEdit(t,r),0<(h=void 0!==r.repeatOverride?r.repeatOverride:r.getRepeat())&&n.explicitRepeat?n.repeatIsExplicit=!0:(n.noRepeat||!n.explicitRepeat&&0===h)&&(n.repeatIsExplicit=!(h=1)),r.selectedCharacter&&(n.selectedCharacter=a.selectedCharacter=r.selectedCharacter),n.repeat=h,t.inputState=new v,o){r=C[o](e,n,t);if(t.lastMotion=C[o],!r)return;n.toJumplist&&((m=(o=y().jumpList).cachedCursor)?(G(e,m,r),delete o.cachedCursor):G(e,p,r)),m=(m=r instanceof Array?(u=r[0],r[1]):r)||{ch:u.ch,line:u.line},t.visualMode?(L(l,c)&&(S(l,m)||L(m,l))?l.ch+=1:L(c,l)&&(S(l,m)||L(l,m))&&--l.ch,c=m,t.visualLine&&(L(l,c)?(l.ch=0,c.ch=b(e,c.line)):(c.ch=0,l.ch=b(e,l.line))),e.setSelection(l,c),R(e,t,"<",L(l,c)?l:c),R(e,t,">",L(l,c)?c:l)):i||(m=A(e,m),e.setCursor(m.line,m.ch))}if(i){var m,o=!1,h=(t.lastMotion=null,a.repeat=h,t.visualMode&&(u=l,m=c,n.inclusive=!0),L(m,u)&&(r=u,u=m,m=r,o=!0),!n.inclusive||t.visualMode&&o||m.ch++,n.linewise||t.visualMode&&t.visualLine);if(h)l=m,u.ch=0,l.ch=0,l.line++;else if(n.forward){var c=e,r=u,d=m;if(r=c.getRange(r,d),/\n\s*$/.test(r)){var f=r.split("\n");f.pop();for(var g=f.pop();0<f.length&&g&&J(g);g=f.pop())d.line--,d.ch=0;g?(d.line--,d.ch=b(c,d.line)):d.ch=0}}a.registerName=s,a.linewise=h,$[i](e,a,t,u,m,p),t.visualMode&&T(e,t),a.enterInsertMode&&k.enterInsertMode(e,{},t)}},recordLastEdit:function(e,t,r){var o=y().macroModeState;o.inReplay||(e.lastEditInputState=t,e.lastEditActionCommand=r,o.lastInsertModeChanges.changes=[],o.lastInsertModeChanges.expectCursorActivityForChange=!1)}},C={moveToTopLine:function(e,t){t=pe(e).top+t.repeat-1;return{line:t,ch:u(e.getLine(t))}},moveToMiddleLine:function(e){var t=pe(e),t=Math.floor(.5*(t.top+t.bottom));return{line:t,ch:u(e.getLine(t))}},moveToBottomLine:function(e,t){t=pe(e).bottom-t.repeat+1;return{line:t,ch:u(e.getLine(t))}},expandToLine:function(e,t){return{line:e.getCursor().line+t.repeat-1,ch:1/0}},findNext:function(e,t){var r,o=E(e),n=o.getQuery();if(n)return r=!t.forward,r=o.isReversed()?!r:r,ce(e,n),le(e,r,n,t.repeat)},goToMark:function(e,t,r){r=r.marks[t.selectedCharacter];return r?r.find():null},jumpToMark:function(e,t,r){for(var o=e.getCursor(),n=0;n<t.repeat;n++){var i,a,s,c,l=o;for(i in r.marks)m(i)&&(a=r.marks[i].find(),(t.forward?L(a,l):L(l,a))||t.linewise&&a.line==l.line||(s=S(l,o),c=t.forward?Z(l,a,o):Z(o,a,l),(s||c)&&(o=a)))}return t.linewise&&(o.ch=u(e.getLine(o.line))),o},moveByCharacters:function(e,t){var e=e.getCursor(),r=t.repeat,t=t.forward?e.ch+r:e.ch-r;return{line:e.line,ch:t}},moveByLines:function(e,t,r){var o=e.getCursor(),n=o.ch;switch(r.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:n=r.lastHPos;break;default:r.lastHPos=n}var i=t.repeat+(t.repeatOffset||0),o=t.forward?o.line+i:o.line-i;return o<e.firstLine()||o>e.lastLine()?null:(t.toFirstChar&&(n=u(e.getLine(o)),r.lastHPos=n),r.lastHSPos=e.charCoords({line:o,ch:n},"div").left,{line:o,ch:n})},moveByDisplayLines:function(e,t,r){var o=e.getCursor();switch(r.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:r.lastHSPos=e.charCoords(o,"div").left}var n=t.repeat,n=e.findPosV(o,t.forward?n:-n,"line",r.lastHSPos);return n.hitSide&&(n=t.forward?(t={top:e.charCoords(n,"div").top+8,left:r.lastHSPos},e.coordsChar(t,"div")):((t=e.charCoords({line:e.firstLine(),ch:0},"div")).left=r.lastHSPos,e.coordsChar(t,"div"))),r.lastHPos=n.ch,n},moveByPage:function(e,t){var r=e.getCursor(),o=t.repeat,t=(e.moveV(t.forward?o:-o,"page"),e.getCursor());return e.setCursor(r),t},moveByParagraph:function(e,t){for(var r=e.getCursor().line,o=t.repeat,n=t.forward?1:-1,i=0;i<o&&!(!t.forward&&r===e.firstLine()||t.forward&&r==e.lastLine());i++)for(r+=n;r!==e.firstLine()&&r!=e.lastLine()&&e.getLine(r);)r+=n;return{line:r,ch:0}},moveByScroll:function(e,t,r){var o=e.getScrollInfo(),n=null,i=(i=t.repeat)||o.clientHeight/(2*e.defaultTextHeight()),a=e.charCoords(e.getCursor(),"local");return t.repeat=i,(n=C.moveByDisplayLines(e,t,r))?(i=e.charCoords(n,"local"),e.scrollTo(null,o.top+i.top-a.top),n):null},moveByWords:function(e,t){var r=e,o=t.repeat,n=!!t.forward,e=!!t.wordEnd,i=!!t.bigWord,a=r.getCursor(),t=x(a),s=[];(n&&!e||!n&&e)&&o++;for(var c=!(n&&e),l=0;l<o;l++){var u=function(e,t,r,o,n){var i=t.line,a=t.ch,s=e.getLine(i),c=r?1:-1,l=o?j:D;if(n&&""==s){if(i+=c,s=e.getLine(i),!F(e,i))return null;a=r?0:s.length}for(;;){if(n&&""==s)return{from:0,to:0,line:i};for(var u=0<c?s.length:-1,p=u,m=u;a!=u;){for(var h=!1,d=0;d<l.length&&!h;++d)if(l[d].test(s.charAt(a))){for(p=a;a!=u&&l[d].test(s.charAt(a));)a+=c;if(h=p!=(m=a),p!=t.ch||i!=t.line||m!=p+c)return{from:Math.min(p,m+1),to:Math.max(p,m),line:i}}h||(a+=c)}if(!F(e,i+=c))return null;s=e.getLine(i),a=0<c?0:s.length}throw new Error("The impossible happened.")}(r,a,n,i,c);if(!u){var p=b(r,r.lastLine());s.push(n?{line:r.lastLine(),from:p,to:p}:{line:0,from:0,to:0});break}s.push(u),a={line:u.line,ch:n?u.to-1:u.from}}var m=s.length!=o,h=s[0],d=s.pop();return n&&!e?{line:(d=m||h.from==t.ch&&h.line==t.line?d:s.pop()).line,ch:d.from}:n&&e?{line:d.line,ch:d.to-1}:!n&&e?{line:(d=m||h.to==t.ch&&h.line==t.line?d:s.pop()).line,ch:d.to}:{line:d.line,ch:d.from}},moveTillCharacter:function(e,t){var r=te(e,t.repeat,t.forward,t.selectedCharacter),o=t.forward?-1:1;return Y(o,t),r?(r.ch+=o,r):e.getCursor()},moveToCharacter:function(e,t){var r=t.repeat;return Y(0,t),te(e,r,t.forward,t.selectedCharacter)||e.getCursor()},moveToSymbol:function(e,t){return function(e,t,r,o){var n=e.getCursor(),i=r?1:-1,a=r?e.lineCount():-1,s=n.ch,c=n.line,l=e.getLine(c),u={lineText:l,nextCh:l.charAt(s),lastCh:null,index:s,symb:o,reverseSymb:(r?{")":"(","}":"{"}:{"(":")","{":"}"})[o],forward:r,depth:0,curMoveThrough:!1},l=X[o];if(l){var p,s=ee[l].init,m=ee[l].isComplete;for(s&&s(u);c!==a&&t;)u.index+=i,u.nextCh=u.lineText.charAt(u.index),u.nextCh||(c+=i,u.lineText=e.getLine(c)||"",0<i?u.index=0:(p=u.lineText.length,u.index=0<p?p-1:0),u.nextCh=u.lineText.charAt(u.index)),m(u)&&(n.line=c,n.ch=u.index,t--);if(u.nextCh||u.curMoveThrough)return{line:c,ch:u.index}}return n}(e,t.repeat,t.forward,t.selectedCharacter)||e.getCursor()},moveToColumn:function(e,t,r){var t=t.repeat;return r.lastHPos=t-1,r.lastHSPos=e.charCoords(e.getCursor(),"div").left,r=t,e=(t=e).getCursor().line,A(t,{line:e,ch:r-1})},moveToEol:function(e,t,r){var o=e.getCursor(),o=(r.lastHPos=1/0,{line:o.line+t.repeat-1,ch:1/0}),t=e.clipPos(o);return t.ch--,r.lastHSPos=e.charCoords(t,"div").left,o},moveToFirstNonWhiteSpaceCharacter:function(e){var t=e.getCursor();return{line:t.line,ch:u(e.getLine(t.line))}},moveToMatchedSymbol:function(e){var t=e.getCursor(),r=t.line,o=t.ch,n=e.getLine(r),i=f(e.getTokenAt(t).type);do{var a=n.charAt(o++);if(a&&-1!="()[]{}".indexOf(a))if(f(e.getTokenAt({line:r,ch:o}).type)<=i)break}while(a);return a?re(e,{line:r,ch:o-1},a):t},moveToStartOfLine:function(e){return{line:e.getCursor().line,ch:0}},moveToLineOrEdgeOfDocument:function(e,t){var r=t.forward?e.lastLine():e.firstLine();return{line:r=t.repeatIsExplicit?t.repeat-e.getOption("firstLineNumber"):r,ch:u(e.getLine(r))}},textObjectManipulation:function(e,t){var r=t.selectedCharacter,t=!t.textObjectInner;return z[r]?[(r=z[r](e,t)).start,r.end]:null},repeatLastCharacterSearch:function(e,t){var r=y().lastChararacterSearch,o=t.repeat,n=t.forward===r.forward,i=(r.increment?1:0)*(n?-1:1),o=(e.moveH(-i,"char"),te(e,o,t.inclusive=n,r.selectedCharacter));return o?(o.ch+=i,o):(e.moveH(i,"char"),e.getCursor())}},$={change:function(e,t,r,o,n){y().registerController.pushText(t.registerName,"change",e.getRange(o,n),t.linewise),t.linewise?(o.ch=u(e.getLine(o.line)),e.replaceRange("\n",o,n)):(J(t=e.getRange(o,n))||(t=/\s+$/.exec(t))&&(n=c(n,0,-t[0].length)),e.replaceRange("",o,n)),e.setCursor(o)},delete:function(e,t,r,o,n){t.linewise&&n.line>e.lastLine()&&o.line>e.firstLine()&&(o.line--,o.ch=b(e,o.line)),y().registerController.pushText(t.registerName,"delete",e.getRange(o,n),t.linewise),e.replaceRange("",o,n),t.linewise?e.setCursor(C.moveToFirstNonWhiteSpaceCharacter(e)):e.setCursor(o)},indent:function(e,t,r,o,n){var i=o.line,a=n.line,s=r.visualMode?t.repeat:1;t.linewise&&a--;for(var c=i;c<=a;c++)for(var l=0;l<s;l++)e.indentLine(c,t.indentRight);e.setCursor(o),e.setCursor(C.moveToFirstNonWhiteSpaceCharacter(e))},swapcase:function(e,t,r,o,n,i){for(var a=e.getRange(o,n),s="",c=0;c<a.length;c++){var l=a.charAt(c);s+=h(l)?l.toLowerCase():l.toUpperCase()}e.replaceRange(s,o,n),e.setCursor(i)},yank:function(e,t,r,o,n,i){y().registerController.pushText(t.registerName,"yank",e.getRange(o,n),t.linewise),e.setCursor(i)}},k={jumpListWalk:function(e,t,r){r.visualMode||(r=t.repeat,t=t.forward,r=(r=(t=y().jumpList.move(e,t?r:-r))?t.find():void 0)||e.getCursor(),e.setCursor(r))},scrollToCursor:function(e,t){var r=e.getCursor().line,r=e.charCoords({line:r,ch:0},"local"),o=e.getScrollInfo().clientHeight,n=r.top,i=r.bottom-n;switch(t.position){case"center":n=n-o/2+i;break;case"bottom":n=n-o+1.4*i;break;case"top":n+=.4*i}e.scrollTo(null,n)},replayMacro:function(e,t){for(var r=t.selectedCharacter,o=t.repeat,n=y().macroModeState,i=function(e,t){var r,o,n=y().registerController.getRegister(t).toString(),i=e.macroKeyBuffer;fe(e);for(;null!==(r=/<\w+-.+?>|<\w+>|./.exec(n))&&(o=r[0],n=n.substring(r.index+o.length),i.push(o),n););return i}(n,r="@"==r?n.latestRegister:r);o--;){u=l=c=s=a=void 0;var a=e,s=n,c=i;s.isMacroPlaying=!0;for(var l=0,u=c.length;l<u;l++)CodeMirror.Vim.handleKey(a,c[l]);s.isMacroPlaying=!1}},exitMacroRecordMode:function(){var e=y().macroModeState,t=(e.toggle(),e.latestRegister),e=e.macroKeyBuffer;e=e.join(""),y().registerController.setRegisterText(t,e)},enterMacroRecordMode:function(e,t){var r=y().macroModeState,t=t.selectedCharacter;r.toggle(e,t),fe(r)},enterInsertMode:function(e,t,r){r.insertMode=!0,r.insertModeRepeat=t&&t.repeat||1;var o,r=t?t.insertAt:null;"eol"==r?(o={line:(o=e.getCursor()).line,ch:b(e,o.line)},e.setCursor(o)):"charAfter"==r?e.setCursor(c(e.getCursor(),0,1)):"firstNonBlank"==r&&e.setCursor(C.moveToFirstNonWhiteSpaceCharacter(e)),e.setOption("keyMap","vim-insert"),t&&t.replace?(e.toggleOverwrite(!0),e.setOption("keyMap","vim-replace")):e.setOption("keyMap","vim-insert"),y().macroModeState.inReplay||(e.on("change",ge),e.on("cursorActivity",ye),CodeMirror.on(e.getInputField(),"keydown",Ce))},toggleVisualMode:function(e,t,r){var o,n=t.repeat,i=e.getCursor();r.visualMode?(i=e.getCursor("anchor"),o=e.getCursor("head"),!r.visualLine&&t.linewise?(r.visualLine=!0,i.ch=L(i,o)?0:b(e,i.line),o.ch=L(i,o)?b(e,o.line):0,e.setSelection(i,o)):r.visualLine&&!t.linewise?r.visualLine=!1:T(e,r)):(r.visualMode=!0,r.visualLine=!!t.linewise,o=r.visualLine?(i.ch=0,A(e,{line:i.line+n-1,ch:b(e,i.line)},!0)):A(e,{line:i.line,ch:i.ch+n},!0),t.repeatIsExplicit||r.visualLine?e.setSelection(i,o):(e.setCursor(o),e.setSelection(o,i))),R(e,r,"<",L(i,o)?i:o),R(e,r,">",L(i,o)?o:i)},joinLines:function(n,e,t){t.visualMode?(i=n.getCursor("anchor"),(a=n.getCursor("head")).ch=b(n,a.line)-1):(t=Math.max(e.repeat,2),i=n.getCursor(),a=A(n,{line:i.line+t-1,ch:1/0}));var i,a,s=0;n.operation(function(){for(var e=i.line;e<a.line;e++){s=b(n,i.line);var t={line:i.line+1,ch:b(n,i.line+1)},r=(r=n.getRange(i,t)).replace(/\n\s*/g," ");n.replaceRange(r,i,t)}var o={line:i.line,ch:s};n.setCursor(o)})},newLineAndEnterInsertMode:function(e,t,r){var o=e.getCursor();o.line!==e.firstLine()||t.after?(o.line=t.after?o.line:o.line-1,o.ch=b(e,o.line),e.setCursor(o),(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(e)):(e.replaceRange("\n",{line:e.firstLine(),ch:0}),e.setCursor(e.firstLine(),0)),this.enterInsertMode(e,{repeat:t.repeat},r)},paste:function(e,t){var r=e.getCursor(),o=y().registerController.getRegister(t.registerName);if(o.text){for(var n="",i=0;i<t.repeat;i++)n+=o.text;var a,s=o.linewise;s?t.after?(n="\n"+n.slice(0,n.length-1),r.ch=b(e,r.line)):r.ch=0:r.ch+=t.after?1:0,e.replaceRange(n,r),s=s&&t.after?{line:r.line+1,ch:u(e.getLine(r.line+1))}:s&&!t.after?{line:r.line,ch:u(e.getLine(r.line))}:!s&&t.after?(a=e.indexFromPos(r),e.posFromIndex(a+n.length-1)):(a=e.indexFromPos(r),e.posFromIndex(a+n.length)),e.setCursor(s)}},undo:function(e,t){e.operation(function(){Q(e,CodeMirror.commands.undo,t.repeat)(),e.setCursor(e.getCursor("anchor"))})},redo:function(e,t){Q(e,CodeMirror.commands.redo,t.repeat)()},setRegister:function(e,t,r){r.inputState.registerName=t.selectedCharacter},setMark:function(e,t,r){R(e,r,t.selectedCharacter,e.getCursor())},replace:function(e,t,r){var o,n=t.selectedCharacter,i=e.getCursor(),a=r.visualMode?(i=e.getCursor("start"),a=e.getCursor("end"),e.clipPos({line:a.line,ch:a.ch+1})):(o=e.getLine(i.line),(t=i.ch+t.repeat)>o.length&&(t=o.length),{line:i.line,ch:t});"\n"==n?(r.visualMode||e.replaceRange("",i,a),(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(e)):(o=(o=e.getRange(i,a)).replace(/[^\n]/g,n),e.replaceRange(o,i,a),r.visualMode?(e.setCursor(i),T(e,r)):e.setCursor(c(a,0,-1)))},incrementNumberToken:function(e,t){for(var r,o,n,i,a,s,c=e.getCursor(),l=e.getLine(c.line),u=/-?\d+/g;null!==(r=u.exec(l))&&(i=r[0],n=(o=r.index)+i.length,!(c.ch<n)););!t.backtrack&&n<=c.ch||i&&(s=t.increase?1:-1,s=parseInt(i)+s*t.repeat,t={ch:o,line:c.line},a={ch:n,line:c.line},s=s.toString(),e.replaceRange(s,t,a),e.setCursor({line:c.line,ch:o+s.length-1}))},repeatLastEdit:function(e,t,r){var o;r.lastEditInputState&&((o=t.repeat)&&t.repeatIsExplicit?r.lastEditInputState.repeatOverride=o:o=r.lastEditInputState.repeatOverride||o,ke(e,r,o,!1))}},z={w:function(e,t){return p(e,t,0,!1)},W:function(e,t){return p(e,t,0,!0)},"{":function(e,t){return oe(e,"}",t)},"(":function(e,t){return oe(e,")",t)},"[":function(e,t){return oe(e,"]",t)},"'":function(e,t){return ne(e,"'",t)},'"':function(e,t){return ne(e,'"',t)}};function A(e,t,r){var o=Math.min(Math.max(e.firstLine(),t.line),e.lastLine()),e=b(e,o)-1,e=r?1+e:e;return{line:o,ch:Math.min(Math.max(0,t.ch),e)}}function s(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r}function c(e,t,r){return{line:e.line+t,ch:e.ch+r}}function Q(t,r,o){return function(){for(var e=0;e<o;e++)r(t)}}function x(e){return{line:e.line,ch:e.ch}}function S(e,t){return e.ch==t.ch&&e.line==t.line}function L(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function Z(e,t,r){e=L(e,t),t=L(t,r);return e&&t}function b(e,t){return e.getLine(t).length}function T(e,t){t.visualMode=!1,t.visualLine=!1;var t=e.getCursor("anchor"),r=e.getCursor("head");S(t,r)||e.setCursor(A(e,r))}function u(e){var t;return e?-1==(t=e.search(/\S/))?e.length:t:0}function p(e,t,r,o,n){var i,a=e.getCursor(),e=e.getLine(a.line),s=a.ch,c=e.substring(s),n=n?c.search(/\w/):c.search(/\S/);return-1==n?null:(c=e.substring(s+=n),n=e.substring(0,s),s=(i=s)+(o=o?/^\S+/:/\w/.test(e.charAt(s))?/^\w+/:/^[^\w\s]+/).exec(c)[0].length,c=n.split("").reverse().join(""),(n=o.exec(c))&&(i-=n[0].length),t&&(0<(o=e.substring(s).match(/^\s*/)[0].length)?s+=o:(n=c.length-i,i-=c.substring(n).match(/^\s*/)[0].length)),{start:{line:a.line,ch:i},end:{line:a.line,ch:s}})}function G(e,t,r){S(t,r)||y().jumpList.add(e,t,r)}function Y(e,t){var r=y();r.lastChararacterSearch.increment=e,r.lastChararacterSearch.forward=t.forward,r.lastChararacterSearch.selectedCharacter=t.selectedCharacter}var X={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},ee={bracket:{isComplete:function(e){if(e.nextCh===e.symb){if(e.depth++,1<=e.depth)return!0}else e.nextCh===e.reverseSymb&&e.depth--;return!1}},section:{init:function(e){e.curMoveThrough=!0,e.symb=(e.forward?"]":"[")===e.symb?"{":"}"},isComplete:function(e){return 0===e.index&&e.nextCh===e.symb}},comment:{isComplete:function(e){var t="*"===e.lastCh&&"/"===e.nextCh;return e.lastCh=e.nextCh,t}},method:{init:function(e){e.symb="m"===e.symb?"{":"}",e.reverseSymb="{"===e.symb?"}":"{"},isComplete:function(e){return e.nextCh===e.symb}},preprocess:{init:function(e){e.index=0},isComplete:function(e){if("#"===e.nextCh){var t=e.lineText.match(/#(\w+)/)[1];if("endif"===t){if(e.forward&&0===e.depth)return!0;e.depth++}else if("if"===t){if(!e.forward&&0===e.depth)return!0;e.depth--}if("else"===t&&0===e.depth)return!0}return!1}}};function te(e,t,r,o){for(var n,i=e.getCursor(),a=i.ch,s=0;s<t;s++){if(-1==(n=function(e,t,r,o,n){var i;o?-1==(i=t.indexOf(r,e+1))||n||--i:-1==(i=t.lastIndexOf(r,e-1))||n||(i+=1);return i}(a,e.getLine(i.line),o,r,!0)))return null;a=n}return{line:e.getCursor().line,ch:n}}function R(e,t,r,o){w(r,_)&&(t.marks[r]&&t.marks[r].clear(),t.marks[r]=e.setBookmark(o))}function f(e){return"string"===e||"comment"===e?1:0}function re(e,t,r){var o=t.line,n=t.ch;r=r||e.getLine(o).charAt(n);var i=f(e.getTokenAt({line:o,ch:n+1}).type),a={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{"}[r];if(!a)return t;for(var s,c={"(":1,"{":1,"[":1}[r]||-1,l=1===c?e.lineCount():-1,u=1,p=r,m=n,h=e.getLine(o);o!==l&&0<u;)m+=c,(p=h.charAt(m))||(o+=c,h=e.getLine(o)||"",m=!(0<c)&&0<(s=h.length)?s-1:0,p=h.charAt(m)),f(e.getTokenAt({line:o,ch:m+1}).type)<=i&&(p===r?u++:p===a&&u--);return p?{line:o,ch:m}:t}function oe(e,t,r){var o=e.getCursor(),o=re(e,o,t),t=re(e,o);return t.ch+=r?1:0,o.ch+=r?0:1,{start:t,end:o}}function ne(e,t,r){var o,n,i,a,s=e.getCursor(),c=e.getLine(s.line).split(""),e=c.indexOf(t);if(s.ch<e?s.ch=e:e<s.ch&&c[s.ch]==t&&(n=s.ch,--s.ch),c[s.ch]!=t||n)for(i=s.ch;-1<i&&!o;i--)c[i]==t&&(o=i+1);else o=s.ch+1;if(o&&!n)for(i=o,a=c.length;i<a&&!n;i++)c[i]==t&&(n=i);return o&&n?(r&&(--o,++n),{start:{line:s.line,ch:o},end:{line:s.line,ch:n}}):{start:s,end:s}}function ie(){}function E(e){e=M(e);return e.searchState_||(e.searchState_=new ie)}function ae(e){for(var t=!1,r=[],o=0;o<e.length;o++){var n=e.charAt(o);t||"/"!=n||r.push(o),t="\\"==n}return r}function I(e,t){e.openConfirm?e.openConfirm('<span style="color: red">'+t+'</span> <button type="button">OK</button>',function(){},{bottom:!0}):alert(t)}ie.prototype={getQuery:function(){return y().query},setQuery:function(e){y().query=e},getOverlay:function(){return this.searchOverlay},setOverlay:function(e){this.searchOverlay=e},isReversed:function(){return y().isReversed},setReversed:function(e){y().isReversed=e}};var se="(Javascript regexp)";function K(e,t){var r,o,n,i=(t.prefix||"")+" "+(t.desc||"");r=t.prefix,o=t.desc,n="",r&&(n+='<span style="font-family: monospace">'+r+"</span>"),n+='<input type="text"/> <span style="color: #888">',n=o?(n+='<span style="color: #888">')+o+"</span>":n;r=e,o=n,e=i,n=t.onClose,i=t,r.openDialog?r.openDialog(o,n,{bottom:!0,value:i.value,onKeyDown:i.onKeyDown,onKeyUp:i.onKeyUp}):n(prompt(e,""))}function O(e,t,r,o){if(t){var n,i,a=E(e),s=(r=!!r,o=!!o,(t=t)instanceof RegExp?t:((s=ae(t)).length?(n=t.substring(0,s[0]),i=-1!=t.substring(s[0]).indexOf("i")):n=t,n?(o&&(r=/^[^A-Z]*$/.test(n)),new RegExp(n,r||i?"i":void 0)):null));if(s)return ce(e,s),function(e,t){if(e instanceof RegExp&&t instanceof RegExp){for(var r=["global","multiline","ignoreCase","source"],o=0;o<r.length;o++){var n=r[o];if(e[n]!==t[n])return}return 1}}(s,a.getQuery())||a.setQuery(s),s}}function ce(e,t){var r,o,n=E(e).getOverlay();n&&t==n.query||(n&&e.removeOverlay(n),"^"==(r=t).source.charAt(0)&&(o=!0),n={token:function(e){if(o&&!e.sol())e.skipToEnd();else{var t=e.match(r,!1);if(t){if(0==t[0].length)e.next();else{if(!e.sol()&&(e.backUp(1),!r.exec(e.next()+t[0])))return e.next(),null;e.match(r)}return"searching"}for(;!e.eol()&&(e.next(),!e.match(r,!1)););}},query:r},e.addOverlay(n),E(e).setOverlay(n))}function le(n,i,a,s){return void 0===s&&(s=1),n.operation(function(){for(var e=n.getCursor(),t=n.getSearchCursor(a,e),r=0;r<s;r++){var o=t.find(i);if(!(o=0==r&&o&&S(t.from(),e)?t.find(i):o)&&!(t=n.getSearchCursor(a,i?{line:n.lastLine()}:{line:n.firstLine(),ch:0})).find(i))return}return t.from()})}function ue(e){e.removeOverlay(E(e).getOverlay()),E(e).setOverlay(null)}function pe(e){var t=e.getScrollInfo(),r=e.coordsChar({left:0,top:6+t.top},"local"),t=t.clientHeight-10+t.top,e=e.coordsChar({left:0,top:t},"local");return{top:r.line,bottom:e.line}}var me=[{name:"map",type:"builtIn"},{name:"write",shortName:"w",type:"builtIn"},{name:"undo",shortName:"u",type:"builtIn"},{name:"redo",shortName:"red",type:"builtIn"},{name:"sort",shortName:"sor",type:"builtIn"},{name:"substitute",shortName:"s",type:"builtIn"},{name:"nohlsearch",shortName:"noh",type:"builtIn"},{name:"delmarks",shortName:"delm",type:"builtin"}];function l(e){for(var t,r,o=[];e&&null!==(r=/<\w+-.+?>|<\w+>|./.exec(e));)t=r[0],e=e.substring(r.index+t.length),o.push(t);return o}(we.ExCommandDispatcher=function(){this.buildCommandMap_()}).prototype={processCommand:function(t,e){var r,o=M(t),o=(o.visualMode&&T(t,o),new CodeMirror.StringStream(e)),n={};n.input=e;try{this.parseInput_(t,o,n)}catch(e){return void I(t,e)}if(n.commandName){var i=this.matchCommand_(n.commandName);if(i){if(r=i.name,this.parseCommandArgs_(o,n,i),"exToKey"==i.type){for(var a=0;a<i.toKeys.length;a++)CodeMirror.Vim.handleKey(t,i.toKeys[a]);return}if("exToEx"==i.type)return void this.processCommand(t,i.toInput)}}else void 0!==n.line&&(r="move");if(r)try{de[r](t,n)}catch(e){I(t,e)}else I(t,'Not an editor command ":'+e+'"')},parseInput_:function(e,t,r){t.eatWhile(":"),t.eat("%")?(r.line=e.firstLine(),r.lineEnd=e.lastLine()):(r.line=this.parseLineSpec_(e,t),void 0!==r.line&&t.eat(",")&&(r.lineEnd=this.parseLineSpec_(e,t)));e=t.match(/^(\w+)/);return r.commandName=e?e[1]:t.match(/.*/)[0],r},parseLineSpec_:function(e,t){var r=t.match(/^(\d+)/);if(r)return parseInt(r[1],10)-1;switch(t.next()){case".":return e.getCursor().line;case"$":return e.lastLine();case"'":var o=M(e).marks[t.next()];if(o&&o.find())return o.find().line;throw new Error("Mark not set");default:return void t.backUp(1)}},parseCommandArgs_:function(e,t,r){e.eol()||(t.argString=e.match(/.*/)[0],e=r.argDelimiter||/\s+/,(r=((r=t.argString).trim?r.trim():r.replace(/^\s+|\s+$/g,"")).split(e)).length&&r[0]&&(t.args=r))},matchCommand_:function(e){for(var t=e.length;0<t;t--){var r=e.substring(0,t);if(this.commandMap_[r]){r=this.commandMap_[r];if(0===r.name.indexOf(e))return r}}return null},buildCommandMap_:function(){this.commandMap_={};for(var e=0;e<me.length;e++){var t=me[e],r=t.shortName||t.name;this.commandMap_[r]=t}},map:function(e,t){var r;":"!=e&&":"==e.charAt(0)?(r=e.substring(1),":"!=t&&":"==t.charAt(0)?this.commandMap_[r]={name:r,type:"exToEx",toInput:t.substring(1)}:this.commandMap_[r]={name:r,type:"exToKey",toKeys:l(t)}):":"!=t&&":"==t.charAt(0)?Me.unshift({keys:l(e),type:"keyToEx",exArgs:{input:t.substring(1)}}):Me.unshift({keys:l(e),type:"keyToKey",toKeys:l(t)})}};var he,de={map:function(e,t){var r=t.args;!r||r.length<2?e&&I(e,"Invalid mapping: "+t.input):g.map(r[0],r[1],e)},move:function(e,t){d.processCommand(e,M(e),{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:t.line+1})},sort:function(e,t){var n,i,r,a;if(t.argString){var o=new CodeMirror.StringStream(t.argString);if(o.eat("!")&&(n=!0),!o.eol()){if(!o.eatSpace())throw new Error("invalid arguments "+o.match(/.*/)[0]);var s=o.match(/[a-z]+/);if(s){s=s[0],i=-1!=s.indexOf("i"),r=-1!=s.indexOf("u");var c=-1!=s.indexOf("d")&&1,l=-1!=s.indexOf("x")&&1,s=-1!=s.indexOf("o")&&1;if(1<c+l+s)throw new Error("invalid arguments");a=(c?"decimal":l&&"hex")||s&&"octal"}if(o.eatSpace()&&o.match(/\/.*\//))throw new Error("patterns not supported")}}c=t.line||e.firstLine(),l=t.lineEnd||t.line||e.lastLine();if(c!=l){var s={line:c,ch:0},o={line:l,ch:b(e,l)},u=e.getRange(s,o).split("\n"),p="decimal"==a?/(-?)([\d]+)/:"hex"==a?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==a?/([0-7]+)/:null,m="decimal"==a?10:"hex"==a?16:"octal"==a?8:null,h=[],d=[];if(a)for(var f=0;f<u.length;f++)(p.exec(u[f])?h:d).push(u[f]);else d=u;if(h.sort(v),d.sort(v),u=n?h.concat(d):d.concat(h),r)for(var g,y=u,u=[],f=0;f<y.length;f++)y[f]!=g&&u.push(y[f]),g=y[f];e.replaceRange(u.join("\n"),s,o)}function v(e,t){n&&(r=e,e=t,t=r),i&&(e=e.toLowerCase(),t=t.toLowerCase());var r=a&&p.exec(e),o=a&&p.exec(t);return r?parseInt((r[1]+r[2]).toLowerCase(),m)-parseInt((o[1]+o[2]).toLowerCase(),m):e<t?-1:1}},substitute:function(t,e){if(!t.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var r=e.argString,o=ae(r);if(0!==o[0])I(t,"Substitutions should be of the form :s/pattern/replace/");else{var n=r.substring(o[0]+1,o[1]),i="",a=!1;if(o[1]&&(i=r.substring(o[1]+1,o[2])),o[2]&&(s=(r=r.substring(o[2]+1).split(" "))[0],l=parseInt(r[1])),s&&(-1!=s.indexOf("c")&&(a=!0,s.replace("c","")),n=n+"/"+s),n)try{O(t,n,!0,!0)}catch(e){return void I(t,"Invalid regex: "+n)}var o=E(t).getQuery(),r=(void 0!==e.line?e:t.getCursor()).line,s=e.lineEnd||r,n=(l&&(s=(r=s)+l-1),A(t,{line:r,ch:0})),e=t.getSearchCursor(o,n),c=t,l=a,u=r,p=s,m=e,h=o,d=i,f=!1,g=m.from();function y(){c.operation(function(){for(;!f;)v(),C();k()})}function v(){var e=c.getRange(m.from(),m.to()).replace(h,d);m.replace(e)}function C(){var e,t,r=m.findNext();f=!r||(r=m.from(),e=u,t=p,"number"!=typeof r&&(r=r.line),!(e instanceof Array?w(r,e):t?e<=r&&r<=t:r==e)||(c.scrollIntoView(m.from(),30),c.setSelection(m.from(),m.to()),g=m.from(),!1))}function k(e){e&&e(),c.focus(),g&&(c.setCursor(g),(e=M(c)).lastHPos=e.lastHSPos=g.ch)}if(C(),f)throw new Error("No matches for "+h.source);l?K(c,{prefix:"replace with <strong>"+d+"</strong> (y/n/a/q/l)",onKeyDown:function(e,t,r){switch(CodeMirror.e_stop(e),CodeMirror.keyName(e)){case"Y":v(),C();break;case"N":C();break;case"A":c.operation(y);break;case"L":v();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":k(r)}f&&k(r)}}):y()}},redo:CodeMirror.commands.redo,undo:CodeMirror.commands.undo,write:function(e){CodeMirror.commands.save?CodeMirror.commands.save(e):e.save()},nohlsearch:function(e){ue(e)},delmarks:function(e,t){if(t.argString&&t.argString.trim())for(var r=M(e),o=new CodeMirror.StringStream(t.argString.trim());!o.eol();){o.eatSpace();var n=o.pos;if(!o.match(/[a-zA-Z]/,!1))return void I(e,"Invalid argument: "+t.argString.substring(n));var i=o.next();if(o.match("-",!0)){if(!o.match(/[a-zA-Z]/,!1))return void I(e,"Invalid argument: "+t.argString.substring(n));var a=i,s=o.next();if(!(m(a)&&m(s)||h(a)&&h(s)))return void I(e,"Invalid argument: "+a+"-");var c=a.charCodeAt(0),l=s.charCodeAt(0);if(l<=c)return void I(e,"Invalid argument: "+t.argString.substring(n));for(var u=0;u<=l-c;u++){var p=String.fromCharCode(c+u);delete r.marks[p]}}else delete r.marks[i]}else I(e,"Argument required")}},g=new we.ExCommandDispatcher;function B(e,t){for(var r,o=0;o<e.length;o++){var n=e[o],i=(!t&&w(n,a)&&(n="'"+n+"'"),r=e[o],i=t,h(r)&&("Shift"==i?i=null:r=r.toLowerCase()),r=1<(r=(i={Enter:"CR",Backspace:"BS",Delete:"Del"}[r=i?i.charAt(0)+"-"+r:r])||r).length?"<"+r+">":r);he[t?t+"-"+n:n]=function(t){return function(e){CodeMirror.Vim.handleKey(e,t)}}(i)}}function N(e){var t=M(e),r=(t.insertMode=!1,y().macroModeState.inReplay);r||(e.off("change",ge),e.off("cursorActivity",ye),CodeMirror.off(e.getInputField(),"keydown",Ce)),!r&&1<t.insertModeRepeat&&(ke(e,t,t.insertModeRepeat-1,!0),t.lastEditInputState.repeatOverride=t.insertModeRepeat),delete t.insertModeRepeat,e.setCursor(e.getCursor().line,e.getCursor().ch-1,!0),e.setOption("keyMap","vim"),e.toggleOverwrite(!1)}function fe(e){e.isMacroPlaying||(e.macroKeyBuffer.length=0)}function ge(e,t){for(var r,o=y().macroModeState.lastInsertModeChanges;t;)o.expectCursorActivityForChange=!0,"+input"!=t.origin&&"paste"!=t.origin&&void 0!==t.origin||(r=t.text.join("\n"),o.changes.push(r)),t=t.next}function ye(){var e=y().macroModeState.lastInsertModeChanges;e.expectCursorActivityForChange?e.expectCursorActivityForChange=!1:e.changes=[]}function ve(e){this.keyName=e}function Ce(e){var t=y().macroModeState.lastInsertModeChanges,r=CodeMirror.keyName(e);-1==r.indexOf("Delete")&&-1==r.indexOf("Backspace")||CodeMirror.lookupKey(r,["vim-insert"],function(){return t.changes.push(new ve(r)),!0})}function ke(l,u,e,t){var p=y().macroModeState,r=(p.inReplay=!0,!!u.lastEditActionCommand),o=u.inputState;function n(){r?d.processAction(l,u,u.lastEditActionCommand):d.evalInput(l,u)}function i(e){if(0<p.lastInsertModeChanges.changes.length){e=u.lastEditActionCommand?e:1;var t=l,r=e,o=p.lastInsertModeChanges;function n(e){return"string"==typeof e?CodeMirror.commands[e](t):e(t),!0}for(var i=0;i<r;i++)for(var a=0;a<o.changes.length;a++){var s,c=o.changes[a];c instanceof ve?CodeMirror.lookupKey(c.keyName,["vim-insert"],n):(s=t.getCursor(),t.replaceRange(c,s,s))}}}if(u.inputState=u.lastEditInputState,r&&u.lastEditActionCommand.interlaceInsertRepeat)for(var a=0;a<e;a++)n(),i(1);else t||n(),i(e);u.inputState=o,u.insertMode&&!t&&N(l),p.inReplay=!1}return CodeMirror.keyMap.vim=(he={nofallthrough:!0,disableInput:!0,style:"fat-cursor"},B(r),B(r,"Shift"),B(r,"Ctrl"),B(a),B(a,"Ctrl"),B(n),B(n,"Ctrl"),B(W),B(W,"Ctrl"),he),CodeMirror.keyMap["vim-insert"]={Esc:N,"Ctrl-[":N,"Ctrl-C":N,"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(e){(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(e)},fallthrough:["default"]},CodeMirror.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"]},o}var Me=[{keys:["<Left>"],type:"keyToKey",toKeys:["h"]},{keys:["<Right>"],type:"keyToKey",toKeys:["l"]},{keys:["<Up>"],type:"keyToKey",toKeys:["k"]},{keys:["<Down>"],type:"keyToKey",toKeys:["j"]},{keys:["<Space>"],type:"keyToKey",toKeys:["l"]},{keys:["<BS>"],type:"keyToKey",toKeys:["h"]},{keys:["<C-Space>"],type:"keyToKey",toKeys:["W"]},{keys:["<C-BS>"],type:"keyToKey",toKeys:["B"]},{keys:["<S-Space>"],type:"keyToKey",toKeys:["w"]},{keys:["<S-BS>"],type:"keyToKey",toKeys:["b"]},{keys:["<C-n>"],type:"keyToKey",toKeys:["j"]},{keys:["<C-p>"],type:"keyToKey",toKeys:["k"]},{keys:["C-["],type:"keyToKey",toKeys:["<Esc>"]},{keys:["<C-c>"],type:"keyToKey",toKeys:["<Esc>"]},{keys:["s"],type:"keyToKey",toKeys:["c","l"]},{keys:["S"],type:"keyToKey",toKeys:["c","c"]},{keys:["<Home>"],type:"keyToKey",toKeys:["0"]},{keys:["<End>"],type:"keyToKey",toKeys:["$"]},{keys:["<PageUp>"],type:"keyToKey",toKeys:["<C-b>"]},{keys:["<PageDown>"],type:"keyToKey",toKeys:["<C-f>"]},{keys:["H"],type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["M"],type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["L"],type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["h"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:["l"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:["j"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:["k"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:["g","j"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:["g","k"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:["w"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:["W"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:["e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:["E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["b"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:["B"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:["g","e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:["g","E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["{"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:["}"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:["<C-f>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:["<C-b>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:["<C-d>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:["<C-u>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:["g","g"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["G"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["0"],type:"motion",motion:"moveToStartOfLine"},{keys:["^"],type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["+"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:["-"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:["_"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:["$"],type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:["%"],type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:["f","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:["F","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:["t","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:["T","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:[";"],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:[","],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:["'","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["`","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["]","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:["[","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:["]","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:["[","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:["]","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:["[","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:["|"],type:"motion",motion:"moveToColumn",motionArgs:{}},{keys:["d"],type:"operator",operator:"delete"},{keys:["y"],type:"operator",operator:"yank"},{keys:["c"],type:"operator",operator:"change",operatorArgs:{enterInsertMode:!0}},{keys:[">"],type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:["<"],type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:["g","~"],type:"operator",operator:"swapcase"},{keys:["n"],type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:["N"],type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:["x"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:["X"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:["D"],type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["Y"],type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["C"],type:"operatorMotion",operator:"change",operatorArgs:{enterInsertMode:!0},motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["~"],type:"operatorMotion",operator:"swapcase",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:["<C-i>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:["<C-o>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:["a"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"}},{keys:["A"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"}},{keys:["i"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"}},{keys:["I"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"}},{keys:["o"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0}},{keys:["O"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1}},{keys:["v"],type:"action",action:"toggleVisualMode"},{keys:["V"],type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:["J"],type:"action",action:"joinLines",isEdit:!0},{keys:["p"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:["P"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:["r","character"],type:"action",action:"replace",isEdit:!0},{keys:["@","character"],type:"action",action:"replayMacro"},{keys:["q","character"],type:"action",action:"enterMacroRecordMode"},{keys:["R"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:["u"],type:"action",action:"undo"},{keys:["<C-r>"],type:"action",action:"redo"},{keys:["m","character"],type:"action",action:"setMark"},{keys:['"',"character"],type:"action",action:"setRegister"},{keys:["z","z"],type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:["z","."],type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","t"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:["z","<CR>"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","-"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:["z","b"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["."],type:"action",action:"repeatLastEdit"},{keys:["<C-a>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:["<C-x>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:["a","character"],type:"motion",motion:"textObjectManipulation"},{keys:["i","character"],type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:["/"],type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:["?"],type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:["*"],type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:["#"],type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:[":"],type:"ex"}];CodeMirror.Vim=we()}();
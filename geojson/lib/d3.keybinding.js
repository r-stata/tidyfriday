d3.keybinding=function(n){var d=[];function o(){for(var e=0;e<d.length;e++){var n=d[e];!function(e,n){for(var o in e.event)if(n[o]!=e.event[o])return;return!e.capture==(n.eventPhase!==Event.CAPTURING_PHASE)}(n,d3.event)||n.callback()}}function t(){var e=d3.select(d3.event.target).node().tagName;"INPUT"!=e&&"SELECT"!=e&&"TEXTAREA"!=e&&o()}function i(e){return(e=e||d3.select(document)).on("keydown.capture"+n,o,!0),e.on("keydown.bubble"+n,t,!1),i}return i.off=function(e){return(e=e||d3.select(document)).on("keydown.capture"+n,null),e.on("keydown.bubble"+n,null),i},i.on=function(e,n,o){var t={event:{keyCode:0,shiftKey:!1,ctrlKey:!1,altKey:!1,metaKey:!1},capture:o,callback:n};e=e.toLowerCase().match(/(?:(?:[^+⇧⌃⌥⌘])+|[⇧⌃⌥⌘]|\+\+|^\+$)/g);for(var r=0;r<e.length;r++)"++"===e[r]&&(e[r]="+"),e[r]in d3.keybinding.modifierCodes?t.event[d3.keybinding.modifierProperties[d3.keybinding.modifierCodes[e[r]]]]=!0:e[r]in d3.keybinding.keyCodes&&(t.event.keyCode=d3.keybinding.keyCodes[e[r]]);return d.push(t),i},i},function(){d3.keybinding.modifierCodes={"⇧":16,shift:16,"⌃":17,ctrl:17,"⌥":18,alt:18,option:18,"⌘":91,meta:91,cmd:91,super:91,win:91},d3.keybinding.modifierProperties={16:"shiftKey",17:"ctrlKey",18:"altKey",91:"metaKey"},d3.keybinding.keyCodes={"⌫":8,backspace:8,"⇥":9,"⇆":9,tab:9,"↩":13,return:13,enter:13,"⌅":13,pause:19,"pause-break":19,"⇪":20,caps:20,"caps-lock":20,"⎋":27,escape:27,esc:27,space:32,"↖":33,pgup:33,"page-up":33,"↘":34,pgdown:34,"page-down":34,"⇟":35,end:35,"⇞":36,home:36,ins:45,insert:45,"⌦":46,del:46,delete:46,"←":37,left:37,"arrow-left":37,"↑":38,up:38,"arrow-up":38,"→":39,right:39,"arrow-right":39,"↓":40,down:40,"arrow-down":40,"*":106,star:106,asterisk:106,multiply:106,"+":107,plus:107,"-":109,subtract:109,";":186,semicolon:186,"=":187,equals:187,",":188,comma:188,dash:189,".":190,period:190,"full-stop":190,"/":191,slash:191,"forward-slash":191,"`":192,tick:192,"back-quote":192,"[":219,"open-bracket":219,"\\":220,"back-slash":220,"]":221,"close-bracket":221,"'":222,quote:222,apostrophe:222};for(var e=95,n=0;++e<106;)d3.keybinding.keyCodes["num-"+n]=e,++n;for(e=47,n=0;++e<58;)d3.keybinding.keyCodes[n]=e,++n;for(e=111,n=1;++e<136;)d3.keybinding.keyCodes["f"+n]=e,++n;for(e=64;++e<91;)d3.keybinding.keyCodes[String.fromCharCode(e).toLowerCase()]=e}();
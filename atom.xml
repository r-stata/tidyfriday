<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>微信公众号 RStata</title>
  
  <subtitle>一起来学习 R 语言和 Stata 吧！</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://tidyfriday.cn/"/>
  <updated>2024-08-11T17:19:26.466Z</updated>
  <id>https://tidyfriday.cn/</id>
  
  <author>
    <name>RStata</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>我的收藏夹（第三期）</title>
    <link href="https://tidyfriday.cn/posts/31989/"/>
    <id>https://tidyfriday.cn/posts/31989/</id>
    <published>2024-05-05T15:15:00.000Z</published>
    <updated>2024-08-11T17:19:26.466Z</updated>
    
    <content type="html"><![CDATA[<p>电脑里面收藏夹里面收藏了很多网页，但是经常懒得翻看，而且难以检索，所以整理下都放到这里。</p><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><ul><li><a href="https://curlconverter.com/r/">Convert curl to R</a></li><li><a href="https://libgen.gs/">Library Genesis：下载电子书</a></li><li><a href="https://www.pdfdrive.com/">PDF Drive - Search and download PDF files for free.：下载电子书</a></li><li><a href="http://datav.aliyun.com/portal/school/atlas/area_selector#&lat=33.50475906922609&lng=97.734375&zoom=4">DataV.GeoAtlas地理小工具系列</a></li><li><a href="https://www.jasondavies.com/wordcloud/?spiral=archimedean&scale=log">Word Cloud Generator</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2024-05-05%2015.31.10.png" alt=""></p><ul><li><a href="https://superuser.com/questions/280659/how-can-i-apply-a-watermark-on-every-page-of-a-pdf-file">How can I apply a watermark on every page of a PDF file?</a></li><li><a href="https://ghproxy.com/">GitHub Proxy 代理加速</a></li><li><a href="https://goalkicker.com/">Free Programming Books – GoalKicker.com</a></li></ul><h2 id="R-语言"><a href="#R-语言" class="headerlink" title="R 语言"></a>R 语言</h2><ul><li><a href="https://g2r.opifex.org/articles/examples.html#histogram-1">Examples • g2r</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2024-05-05%2015.22.33.png" alt=""></p><ul><li><a href="https://github.com/koenderks/rcityviews">R City Views：使用 R 语言绘制精美的城市地图</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505151906.png" alt=""></p><ul><li><a href="https://yihui.org/en/2023/02/manipulate-svg/">Manipulate SVG Plots with JavaScript in R Markdown</a></li><li><a href="https://github.com/heike/ggpcp">ggpcp: Generalized parallel coordinate plots with ggpcp</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505152008.png" alt=""></p><ul><li><a href="https://gis.stackexchange.com/questions/329110/removing-empty-polygon-from-sf-object-in-r">Removing empty polygon from sf object in R?</a></li><li><a href="https://www.garrickadenbuie.com/blog/setting-up-a-new-macbook-pro/index.html">Garrick Aden-Buie - Setting up a new MacBook Pro</a></li><li><a href="https://www.garrickadenbuie.com/blog/sharing-xaringan-slides/index.html">Garrick Aden-Buie - Sharing Your xaringan Slides</a></li><li><a href="https://github.com/behrman/ros">Regression and Other Stories - Tidyverse Examples</a></li><li><a href="https://cran.r-project.org/web/packages/PieGlyph/vignettes/PieGlyph.html">PieGlyph</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505153610.png" alt=""></p><ul><li><a href="https://www.ardata.fr/en/post/2023/04/03/flextable-grid/">FLEXTABLE FOR ‘GRID GRAPHICS’</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505153806.png" alt=""></p><ul><li><a href="https://juliasilge.com/blog/tidy-word-vectors/">Word Vectors with tidy data principles</a></li><li><a href="https://juliasilge.com/blog/horror-embeddings/">Use OpenAI text embeddings with #TidyTuesday horror movie descriptions | Julia Silge — 将 OpenAI 文本嵌入与#TidyTuesday恐怖电影描述结合使用 |朱莉娅·席尔格</a></li><li><a href="https://docs.ropensci.org/tesseract/articles/intro.html">Using the Tesseract OCR engine in R</a></li><li><a href="https://www.jumpingrivers.com/blog/r-clickable-wordcloud-javascript-shiny/">How to create a clickable world cloud with wordcloud2 and Shiny</a></li><li><a href="https://cidm-ph.github.io/ggmapinset/articles/ggmapinset.html">Getting started with ‘ggmapinset’ • ggmapinset</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505154206.png" alt=""></p><ul><li><a href="https://jokergoo.github.io/circlize_book/book/">Circular Visualization in R</a></li><li><a href="https://paulofelipe.github.io/tutorial_d3plusr/atributos.html#atributos">D3plusR 软件包简介</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2024-05-05%2015.46.17.png" alt=""></p><ul><li><a href="https://nrennie.rbind.io/blog/introducing-ggflowchart/">Introducing {ggflowchart}</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505154515.png" alt=""></p><ul><li><a href="https://datacornering.com/how-to-change-marker-shape-in-the-r-plot/">How to change marker shape in the R plot</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505154740.png" alt=""></p><ul><li><a href="https://github.com/hughjonesd/ggmagnify">ggmagnify creates a magnified inset of part of a ggplot object</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505154839.png" alt=""></p><ul><li><a href="https://hughjonesd.github.io/santoku/">santoku is a versatile cutting tool for R. It provides chop(), a replacement for base::cut().</a></li></ul><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">chop_n<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#&gt;  [1] [1, 6)  [1, 6)  [1, 6)  [1, 6)  [1, 6)  [6, 10] [6, 10] [6, 10] [6, 10]</span></span><br><span class="line"><span class="comment">#&gt; [10] [6, 10]</span></span><br><span class="line"><span class="comment">#&gt; Levels: [1, 6) [6, 10]</span></span><br></pre></td></tr></table></figure><ul><li><a href="https://github.com/nevrome/ggpointgrid">ggpointgrid: This package provides geoms to rearrange scatter-plot coordinates on regular grids while strictly avoiding over-plotting. The applications are similar to geom_jitter.</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505155351.png" alt=""></p><ul><li><a href="https://cran.r-project.org/web/packages/TidyDensity/vignettes/getting-started.html">Getting Started with TidyDensity</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505155751.png" alt=""></p><ul><li><a href="https://github.com/cran/cubble">The term spatio-temporal data can incorporate various spatial and temporal characteristics and different data may require different data structures for wrangling and analysis. The spatio-temporal data that cubble addresses are those collected at unique fixed locations, allowing for irregularity in the temporal dimension, such as the weather station data. This corresponds to the full space-time and sparse space-time layouts in the spacetime paper (Pebesma 2012):</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505160051.png" alt=""></p><ul><li><a href="https://bookdown.org/content/4253/#caution-work-in-progress">Applied longitudinal data analysis in brms and the tidyverse</a></li><li><a href="https://www.brodrigues.co/blog/2018-10-05-ggplot2_purrr_officer/">Exporting editable plots from R to Powerpoint: making ggplot2 purrr with officer</a></li><li><a href="https://hafen.github.io/trelliscopejs/articles/trelliscopejs.html">Introduction to trelliscopejs</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2024-05-05%2016.05.13.png" alt=""></p><ul><li><a href="https://github.com/MattCowgill/ggdirectlabel">The goal of ggdirectlabel is to make it easier to directly label ggplot2 charts rather than using legends.</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505160718.png" alt=""></p><ul><li><a href="https://www.econometrics-with-r.org/">Introduction to Econometrics with R</a></li><li><a href="https://github.com/long39ng/listviewerlite">long39ng/listviewerlite: View nested lists in R interactively using only HTML and CSS</a></li></ul><p><img src="https://github.com/long39ng/listviewerlite/raw/main/man/figures/preview.gif" alt=""></p><ul><li><a href="https://gis.stackexchange.com/questions/426506/clipping-polygon-based-on-a-line-to-get-a-polygon-in-r#:~:text=A%20nice%20approach%20to%20using%20a%20line,to%20split%20a%20polygon%20is%20lwgeom%3A%3Ast_split%20%28%29">Clipping polygon based on a line to get a polygon in R</a></li><li><a href="https://mtennekes.github.io/tmap4/index.html">tmap v4: a sneak peek</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505162042.png" alt=""></p><ul><li><a href="https://teunbrand.github.io/ggarrow/">Arrows for ggplot2 • ggarrow</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505162135.png" alt=""></p><ul><li><a href="https://github.com/R-CoderDotCom/econocharts">R-CoderDotCom/econocharts: Microeconomics/macroeconomics charts in ggplot2</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505162217.png" alt=""></p><ul><li><a href="https://www.tidymodels.org/learn/statistics/k-means/">K-means clustering with tidy data principles</a></li><li><a href="https://otexts.com/fpp3/">Forecasting: Principles and Practice (3rd ed)</a></li><li><a href="https://github.com/kbelisar/ggcorset">The ‘ggcorset’ package</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505162818.png" alt=""></p><ul><li><a href="https://bradleyboehmke.github.io/HOML/">Hands-On Machine Learning with R</a></li><li><a href="https://bookdown.org/kevin_davisross/bayesian-reasoning-and-methods/">An Introduction to Bayesian Reasoning and Methods</a></li><li><a href="https://www.amazon.com/Causal-Inference-Python-Applying-Industry/dp/1098140257?&linkCode=sl1&tag=kirkdborne-20&linkId=e95a328189feeda49c4430f0302c0e22&language=en_US&ref_=as_li_ss_tl">Causal Inference in Python: Applying Causal Inference in the Tech Industry 1st Edition</a></li><li><a href="https://masalmon.eu/2023/08/31/three-shorten/">R functions that shorten/filter stuff: less is more</a></li><li><a href="https://www.jottr.org/2023/06/26/dofuture/">%dofuture% - a Better foreach() Parallelization Operator than %dopar%</a></li></ul><h2 id="Stata"><a href="#Stata" class="headerlink" title="Stata"></a>Stata</h2><ul><li><p><a href="https://asjadnaqvi.github.io/stata-portfolio/tags/portfolio/">portfolio - StataViz by Asjad Naqvi</a></p></li><li><p><a href="https://medium.com/the-stata-guide/covid-19-visualizations-with-stata-part-3-heat-plots-e2ef5ac1160b">COVID-19 visualizations with Stata Part 3: Heatplots</a></p></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505152525.png" alt=""></p><ul><li><a href="https://medium.com/the-stata-guide/covid-19-visualizations-with-stata-part-10-stream-graphs-9d55db12318a">COVID-19 visualizations with Stata Part 10: Stream graphs Asjad Naqvi The Stata Guide</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505152618.png" alt=""></p><ul><li><a href="https://medium.com/the-stata-guide/stata-graphs-how-to-add-arrows-to-your-line-graphs-69c1c08949c7">Stata graphs: How to add arrows to your line graphs | by Asjad Naqvi | The Stata Guide | Medium</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505152659.png" alt=""></p><ul><li><a href="https://asjadnaqvi.medium.com/">Asjad Naqvi 的 Medium 主页</a></li><li><a href="https://github.com/asjadnaqvi/stata-splinefit">asjadnaqvi/stata-splinefit: A Stata package for spline interpolation between points</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505162525.png" alt=""></p><ul><li><a href="https://github.com/asjadnaqvi/stata-circlepack">asjadnaqvi/stata-circlepack: A Stata package for circle packing</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505163559.png" alt=""></p><ul><li><a href="https://github.com/asjadnaqvi/30DayMapChallenge2021">asjadnaqvi/30DayMapChallenge2021: My entries for the #30DayMapChallenge 2021 on Twitter</a></li></ul><h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><ul><li><a href="https://nivo.rocks/choropleth/">Choropleth chart | nivo</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2024-05-05%2015.21.28.png" alt=""></p><ul><li><a href="https://app.datawrapper.de/river/_/XqaQY">Smoking is more prevalent in Europe and the Western Pacific region</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2024-05-05%2015.30.22.png" alt=""></p><ul><li><a href="https://informationisbeautiful.net/visualizations/world-population/">World Population — Information is Beautiful</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505155351.png" alt=""></p><ul><li><a href="https://informationisbeautiful.net/beautifulnews/">Beautiful News</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2024-05-05%2015.58.58.png" alt=""></p><ul><li><a href="https://app.datawrapper.de/river/_/UpIHT">2015 年和 2020 年各地区的租金比较</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2024-05-05%2016.02.36.png" alt=""></p><ul><li><a href="https://observablehq.com/d/5b3c713e0c6d9741">Inequality in U.S. cities, 1980–2015</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2024-05-05%2016.18.22.png" alt=""></p><ul><li><a href="https://www.informationisbeautifulawards.com/showcase/6512-us-tornadoes-1950-2022">US Tornadoes, 1950-2022 — Information is Beautiful Awards</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20240505163817.png" alt=""></p><ul><li><a href="https://timqian.com/chart.xkcd/">Chart.xkcd | xkcd styled chart lib</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2024-05-05%2016.42.23.png" alt=""></p><h2 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h2><ul><li><a href="https://data.cnki.net/yearBook/single?id=N2015070200">中国区域经济统计年鉴</a></li><li><a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/HIDLTK">US COVID-19 Daily Cases with Basemap - Data</a></li><li><a href="https://data.humdata.org/dataset/kontur-population-dataset">Kontur Population: Global Population Density for 400m H3 Hexagons - Humanitarian Data Exchange — Kontur人口：400m H3六边形的全球人口密度 - 人道主义数据交换</a></li><li><a href="https://webapi.cninfo.com.cn/#/marketData">深证信数据服务平台 CNINFO Data Service</a></li><li><a href="https://github.com/aceimnorstuvwxz/toutiao-text-classfication-dataset">今日头条中文新闻（文本）分类数据集</a></li><li><a href="https://data.tpdc.ac.cn/zh-hans/data/49b22de9-5d85-44f2-a7d5-a1ccd17086d2">基于站点观测的中国1km土壤湿度日尺度数据集（2000-2020）</a></li><li><a href="https://sedac.ciesin.columbia.edu/data/sets/browse">哥伦比亚大学数据列表</a></li><li><a href="https://data.cnki.net/yearBook/single?id=N2023040036">中国交通年鉴</a></li><li><a href="https://figshare.com/category">Figshare - 为您所有的研究贡献力量 - 类别</a></li><li><a href="https://www.chinagazelle.cn/data/list">数据库|中国瞪羚独角兽</a></li></ul><h2 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h2><ul><li><a href="https://blog.csdn.net/qq_36631379/article/details/114283628?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-114283628-blog-126780436.pc_relevant_3mothn_strategy_and_data_recovery&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-114283628-blog-126780436.pc_relevant_3mothn_strategy_and_data_recovery&utm_relevant_index=1">解决 GitHub 图片不显示问题</a></li></ul><h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><ul><li><a href="https://geographicdata.science/book/intro.html">Geographic Data Science with Python</a></li><li><a href="https://pyoflife.com/category/books/#google_vignette">Python books</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;电脑里面收藏夹里面收藏了很多网页，但是经常懒得翻看，而且难以检索，所以整理下都放到这里。&lt;/p&gt;
&lt;h2 id=&quot;工具&quot;&gt;&lt;a href=&quot;#工具&quot; class=&quot;headerlink&quot; title=&quot;工具&quot;&gt;&lt;/a&gt;工具&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;htt
      
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>R 语言：如何为区县名称添加行政区划代码</title>
    <link href="https://tidyfriday.cn/posts/38638/"/>
    <id>https://tidyfriday.cn/posts/38638/</id>
    <published>2023-04-21T11:30:00.000Z</published>
    <updated>2023-04-21T15:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>在之前的课程「R 语言：如何整理 2022 年县域统计年鉴：caj 文件转 pdf、文本识别与数据清洗」中我们讲解了如何从 caj 文件中提取表格数据的方法，今天我们再来学习下如何根据区县名称匹配行政区划代码，另外在该过程中还可以检查区县名称的识别错误。最后我们再使用整理得到的数据绘制一幅区县地图。</p><p>首先我们使用上次课的代码处理“整理结果3.xlsx”：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 处理 “整理结果3.xlsx”</span></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">readxl<span class="operator">::</span>read_xlsx<span class="punctuation">(</span><span class="string">&quot;整理结果3.xlsx&quot;</span><span class="punctuation">,</span> col_names <span class="operator">=</span> <span class="built_in">LETTERS</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">12</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> df </span><br><span class="line">df <span class="operator">%&gt;%</span> </span><br><span class="line">  fill<span class="punctuation">(</span>A<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  dplyr<span class="operator">::</span>filter<span class="punctuation">(</span><span class="operator">!</span><span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>D<span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="built_in">is.na</span><span class="punctuation">(</span>E<span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="built_in">is.na</span><span class="punctuation">(</span><span class="built_in">F</span><span class="punctuation">)</span> </span><br><span class="line">                  <span class="operator">&amp;</span> <span class="built_in">is.na</span><span class="punctuation">(</span>G<span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="built_in">is.na</span><span class="punctuation">(</span>H<span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="built_in">is.na</span><span class="punctuation">(</span>I<span class="punctuation">)</span></span><br><span class="line">                  <span class="operator">&amp;</span> <span class="built_in">is.na</span><span class="punctuation">(</span>J<span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="built_in">is.na</span><span class="punctuation">(</span>K<span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="built_in">is.na</span><span class="punctuation">(</span>L<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>B <span class="operator">=</span> str_remove_all<span class="punctuation">(</span>B<span class="punctuation">,</span> <span class="string">&quot; &quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>B <span class="operator">=</span> str_remove_all<span class="punctuation">(</span>B<span class="punctuation">,</span> <span class="string">&quot;,&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         B <span class="operator">=</span> str_remove_all<span class="punctuation">(</span>B<span class="punctuation">,</span> <span class="string">&quot;-&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         B <span class="operator">=</span> str_remove_all<span class="punctuation">(</span>B<span class="punctuation">,</span> <span class="string">&quot;\\.&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         B <span class="operator">=</span> str_remove_all<span class="punctuation">(</span>B<span class="punctuation">,</span> <span class="string">&quot;~&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         B <span class="operator">=</span> str_remove_all<span class="punctuation">(</span>B<span class="punctuation">,</span> <span class="string">&quot;・&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         B <span class="operator">=</span> str_remove_all<span class="punctuation">(</span>B<span class="punctuation">,</span> <span class="string">&quot;，&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         B <span class="operator">=</span> str_remove_all<span class="punctuation">(</span>B<span class="punctuation">,</span> <span class="string">&quot;、&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  dplyr<span class="operator">::</span>filter<span class="punctuation">(</span><span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>B<span class="punctuation">)</span> <span class="operator">&amp;</span> B <span class="operator">!=</span> <span class="string">&quot;一、基本情况行政区域面积&quot;</span> <span class="operator">&amp;</span> B <span class="operator">!=</span> <span class="string">&quot;一基本情况行政区域面积&quot;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>B <span class="operator">=</span> if_else<span class="punctuation">(</span>B <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;提供住宿的民政服务机构床位数&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="string">&quot;提供住宿的民谢艮务机构床位数&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="string">&quot;提供住宿的民政0艮务机构床位数&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                     <span class="string">&quot;提供住宿的民政服务机构床位数&quot;</span><span class="punctuation">,</span> B<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         B <span class="operator">=</span> if_else<span class="punctuation">(</span>B <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;提供住宿的民呦艮务机构&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="string">&quot;提供住宿的民政^务机构&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="string">&quot;提供住宿的民斑艮务机构&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="string">&quot;提供住宿的民班艮务机构&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                     <span class="string">&quot;提供住宿的民政服务机构&quot;</span><span class="punctuation">,</span> B<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>z <span class="operator">=</span> if_else<span class="punctuation">(</span>B <span class="operator">==</span> <span class="string">&quot;指标&quot;</span><span class="punctuation">,</span> row.names<span class="punctuation">(</span>.<span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>z <span class="operator">=</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>z<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  fill<span class="punctuation">(</span>z<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  select<span class="punctuation">(</span><span class="operator">-</span>C<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  gather<span class="punctuation">(</span>D<span class="operator">:</span>L<span class="punctuation">,</span> key <span class="operator">=</span> <span class="string">&quot;variable&quot;</span><span class="punctuation">,</span> value <span class="operator">=</span> <span class="string">&quot;value&quot;</span><span class="punctuation">)</span>  <span class="operator">%&gt;%</span> </span><br><span class="line">  spread<span class="punctuation">(</span>B<span class="punctuation">,</span> value<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  select<span class="punctuation">(</span>z<span class="punctuation">,</span> A<span class="punctuation">,</span> 指标<span class="punctuation">,</span> everything<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  dplyr<span class="operator">::</span>filter<span class="punctuation">(</span><span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>指标<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  select<span class="punctuation">(</span><span class="operator">-</span>variable<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  type_convert<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  rename<span class="punctuation">(</span>省 <span class="operator">=</span> A<span class="punctuation">,</span> 县 <span class="operator">=</span> 指标<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  select<span class="punctuation">(</span>省<span class="punctuation">,</span> 县<span class="punctuation">,</span> 行政区域面积<span class="punctuation">,</span> 乡<span class="punctuation">,</span> 镇<span class="punctuation">,</span> 街道办事处<span class="punctuation">,</span> 户籍人口<span class="punctuation">,</span> </span><br><span class="line">         地区生产总值<span class="punctuation">,</span> 第一产业增加值<span class="punctuation">,</span> 第二产业增加值<span class="punctuation">,</span> 第三产业增加值<span class="punctuation">,</span> </span><br><span class="line">         地方一般公共预算收入<span class="punctuation">,</span> 地方一般公共预算支出<span class="punctuation">,</span> 住户存款余额<span class="punctuation">,</span> </span><br><span class="line">         年末金融机构各项贷款余额<span class="punctuation">,</span> 设施农业种植占地面积<span class="punctuation">,</span> 油料产量<span class="punctuation">,</span> </span><br><span class="line">         棉花产量<span class="punctuation">,</span> 规模以上工业企业<span class="punctuation">,</span> 固定电话用户<span class="punctuation">,</span> 普通中学在校学生<span class="punctuation">,</span> </span><br><span class="line">         小学在校学生<span class="punctuation">,</span> 医疗卫生机构床位<span class="punctuation">,</span> 提供住宿的民政服务机构<span class="punctuation">,</span> </span><br><span class="line">         提供住宿的民政服务机构床位数<span class="punctuation">)</span> <span class="operator">-&gt;</span> df4 </span><br><span class="line"></span><br><span class="line">df4 </span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt; # A tibble: 2,054 × 25</span></span><br><span class="line"><span class="comment">#&gt;    省     县     行政区域面积    乡    镇 街道办事处 户籍人口 地区生产总值</span></span><br><span class="line"><span class="comment">#&gt;    &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;</span></span><br><span class="line"><span class="comment">#&gt;  1 安徽省 肥东县         2182     6    12         NA    108.       8114070</span></span><br><span class="line"><span class="comment">#&gt;  2 安徽省 肥西县         1695     4     8         NA     85.6     10186781</span></span><br><span class="line"><span class="comment">#&gt;  3 安徽省 庐江县         2344    NA    17         NA    120        5471895</span></span><br><span class="line"><span class="comment">#&gt;  4 安徽省 巢湖市         2046    NA    12          5     85.4      5231019</span></span><br><span class="line"><span class="comment">#&gt;  5 安徽省 湾社区          650    NA     5         NA     35.4      3831248</span></span><br><span class="line"><span class="comment">#&gt;  6 安徽省 长丰县         1841     2    12         NA     81.1      7619440</span></span><br><span class="line"><span class="comment">#&gt;  7 安徽省 繁昌区          585    NA     6         NA     27.2      3641111</span></span><br><span class="line"><span class="comment">#&gt;  8 安徽省 南陵县         1264    NA     8         NA     54.3      3206882</span></span><br><span class="line"><span class="comment">#&gt;  9 安徽省 无为市         2022    NA    20         NA    119.       5770037</span></span><br><span class="line"><span class="comment">#&gt; 10 安徽省 怀远县         2192     1    17         NA    134.       3562589</span></span><br><span class="line"><span class="comment">#&gt; # ℹ 2,044 more rows</span></span><br><span class="line"><span class="comment">#&gt; # ℹ 17 more variables: 第一产业增加值 &lt;dbl&gt;, 第二产业增加值 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   第三产业增加值 &lt;dbl&gt;, 地方一般公共预算收入 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   地方一般公共预算支出 &lt;dbl&gt;, 住户存款余额 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   年末金融机构各项贷款余额 &lt;dbl&gt;, 设施农业种植占地面积 &lt;dbl&gt;, 油料产量 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   棉花产量 &lt;dbl&gt;, 规模以上工业企业 &lt;dbl&gt;, 固定电话用户 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   普通中学在校学生 &lt;dbl&gt;, 小学在校学生 &lt;dbl&gt;, 医疗卫生机构床位 &lt;dbl&gt;, …</span></span><br></pre></td></tr></table></figure><p>由于之前我分享的县域统计年鉴数据都是使用的 2020 年行政区划代码，所以这次我们也同样。</p><p>2020 年行政区划代码可以从地理矢量数据得到（为了方便绘制地图）：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>sf<span class="punctuation">)</span></span><br><span class="line">read_sf<span class="punctuation">(</span><span class="string">&quot;2020行政区划/县.shp&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> county </span><br><span class="line"><span class="comment"># 删除地理信息</span></span><br><span class="line">county <span class="operator">%&gt;%</span> </span><br><span class="line">  st_drop_geometry<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  select<span class="punctuation">(</span><span class="operator">-</span>contains<span class="punctuation">(</span><span class="string">&quot;类型&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> countydb </span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 省-县 的组合有无重复的</span></span><br><span class="line">countydb <span class="operator">%&gt;%</span> </span><br><span class="line">  group_by<span class="punctuation">(</span>省<span class="punctuation">,</span> 县<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>n <span class="operator">=</span> n<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  arrange<span class="punctuation">(</span>desc<span class="punctuation">(</span>n<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ungroup<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> countydb </span><br><span class="line"></span><br><span class="line"><span class="comment"># 这些重复的可能会影响下一步的匹配，所以先删除了</span></span><br><span class="line">countydb <span class="operator">%&gt;%</span> </span><br><span class="line">  filter<span class="punctuation">(</span>n <span class="operator">&lt;=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> countycode1 </span><br><span class="line">countycode1 </span><br><span class="line"><span class="comment">#&gt; # A tibble: 2,862 × 7</span></span><br><span class="line"><span class="comment">#&gt;    省     省代码 市     市代码 县     县代码     n</span></span><br><span class="line"><span class="comment">#&gt;    &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt;</span></span><br><span class="line"><span class="comment">#&gt;  1 安徽省 340000 安庆市 340800 大观区 340803     1</span></span><br><span class="line"><span class="comment">#&gt;  2 安徽省 340000 安庆市 340800 怀宁县 340822     1</span></span><br><span class="line"><span class="comment">#&gt;  3 安徽省 340000 安庆市 340800 潜山市 340882     1</span></span><br><span class="line"><span class="comment">#&gt;  4 安徽省 340000 安庆市 340800 宿松县 340826     1</span></span><br><span class="line"><span class="comment">#&gt;  5 安徽省 340000 安庆市 340800 太湖县 340825     1</span></span><br><span class="line"><span class="comment">#&gt;  6 安徽省 340000 安庆市 340800 桐城市 340881     1</span></span><br><span class="line"><span class="comment">#&gt;  7 安徽省 340000 安庆市 340800 望江县 340827     1</span></span><br><span class="line"><span class="comment">#&gt;  8 安徽省 340000 安庆市 340800 宜秀区 340811     1</span></span><br><span class="line"><span class="comment">#&gt;  9 安徽省 340000 安庆市 340800 迎江区 340802     1</span></span><br><span class="line"><span class="comment">#&gt; 10 安徽省 340000 安庆市 340800 岳西县 340828     1</span></span><br><span class="line"><span class="comment">#&gt; # ℹ 2,852 more rows</span></span><br></pre></td></tr></table></figure><p>首先匹配下看看能成功多少：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># tidylog 包的 join 族函数可以显示匹配效果：</span></span><br><span class="line">df4 <span class="operator">%&gt;%</span> </span><br><span class="line">  tidylog<span class="operator">::</span>left_join<span class="punctuation">(</span>countycode1<span class="punctuation">)</span> </span><br><span class="line"><span class="comment">#&gt; # A tibble: 2,054 × 30</span></span><br><span class="line"><span class="comment">#&gt;    省     县     行政区域面积    乡    镇 街道办事处 户籍人口 地区生产总值</span></span><br><span class="line"><span class="comment">#&gt;    &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;</span></span><br><span class="line"><span class="comment">#&gt;  1 安徽省 肥东县         2182     6    12         NA    108.       8114070</span></span><br><span class="line"><span class="comment">#&gt;  2 安徽省 肥西县         1695     4     8         NA     85.6     10186781</span></span><br><span class="line"><span class="comment">#&gt;  3 安徽省 庐江县         2344    NA    17         NA    120        5471895</span></span><br><span class="line"><span class="comment">#&gt;  4 安徽省 巢湖市         2046    NA    12          5     85.4      5231019</span></span><br><span class="line"><span class="comment">#&gt;  5 安徽省 湾社区          650    NA     5         NA     35.4      3831248</span></span><br><span class="line"><span class="comment">#&gt;  6 安徽省 长丰县         1841     2    12         NA     81.1      7619440</span></span><br><span class="line"><span class="comment">#&gt;  7 安徽省 繁昌区          585    NA     6         NA     27.2      3641111</span></span><br><span class="line"><span class="comment">#&gt;  8 安徽省 南陵县         1264    NA     8         NA     54.3      3206882</span></span><br><span class="line"><span class="comment">#&gt;  9 安徽省 无为市         2022    NA    20         NA    119.       5770037</span></span><br><span class="line"><span class="comment">#&gt; 10 安徽省 怀远县         2192     1    17         NA    134.       3562589</span></span><br><span class="line"><span class="comment">#&gt; # ℹ 2,044 more rows</span></span><br><span class="line"><span class="comment">#&gt; # ℹ 22 more variables: 第一产业增加值 &lt;dbl&gt;, 第二产业增加值 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   第三产业增加值 &lt;dbl&gt;, 地方一般公共预算收入 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   地方一般公共预算支出 &lt;dbl&gt;, 住户存款余额 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   年末金融机构各项贷款余额 &lt;dbl&gt;, 设施农业种植占地面积 &lt;dbl&gt;, 油料产量 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   棉花产量 &lt;dbl&gt;, 规模以上工业企业 &lt;dbl&gt;, 固定电话用户 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   普通中学在校学生 &lt;dbl&gt;, 小学在校学生 &lt;dbl&gt;, 医疗卫生机构床位 &lt;dbl&gt;, …</span></span><br></pre></td></tr></table></figure><p>查看匹配失败的：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看匹配失败的 </span></span><br><span class="line">df4 <span class="operator">%&gt;%</span> </span><br><span class="line">  tidylog<span class="operator">::</span>anti_join<span class="punctuation">(</span>countycode1<span class="punctuation">)</span> </span><br><span class="line"><span class="comment">#&gt; # A tibble: 168 × 25</span></span><br><span class="line"><span class="comment">#&gt;    省     县        行政区域面积    乡    镇 街道办事处 户籍人口 地区生产总值</span></span><br><span class="line"><span class="comment">#&gt;    &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;</span></span><br><span class="line"><span class="comment">#&gt;  1 安徽省 湾社区             650    NA     5         NA     35.4      3831248</span></span><br><span class="line"><span class="comment">#&gt;  2 安徽省 滩溪县            1982    NA    11         NA    114.       5407788</span></span><br><span class="line"><span class="comment">#&gt;  3 安徽省 板阳县            1473     1    15         NA     78.7      1882758</span></span><br><span class="line"><span class="comment">#&gt;  4 安徽省 夥县               857     3     5         NA      9.2       509979</span></span><br><span class="line"><span class="comment">#&gt;  5 安徽省 扬山县            1197    NA    13         NA    101.       2544835</span></span><br><span class="line"><span class="comment">#&gt;  6 重庆市 由日 忠县         2187     6    19          4     96.2      4885521</span></span><br><span class="line"><span class="comment">#&gt;  7 重庆市 新都区             497    NA     2          7     85.6     10001115</span></span><br><span class="line"><span class="comment">#&gt;  8 福建省 沙县区            1799     4     6          2     27.1      3544375</span></span><br><span class="line"><span class="comment">#&gt;  9 福建省 龙海区            1320     2    11          1     91.2     12657788</span></span><br><span class="line"><span class="comment">#&gt; 10 福建省 长泰区             900     1     4         NA     21.1      3752268</span></span><br><span class="line"><span class="comment">#&gt; # ℹ 158 more rows</span></span><br><span class="line"><span class="comment">#&gt; # ℹ 17 more variables: 第一产业增加值 &lt;dbl&gt;, 第二产业增加值 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   第三产业增加值 &lt;dbl&gt;, 地方一般公共预算收入 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   地方一般公共预算支出 &lt;dbl&gt;, 住户存款余额 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   年末金融机构各项贷款余额 &lt;dbl&gt;, 设施农业种植占地面积 &lt;dbl&gt;, 油料产量 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   棉花产量 &lt;dbl&gt;, 规模以上工业企业 &lt;dbl&gt;, 固定电话用户 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   普通中学在校学生 &lt;dbl&gt;, 小学在校学生 &lt;dbl&gt;, 医疗卫生机构床位 &lt;dbl&gt;, …</span></span><br></pre></td></tr></table></figure><p>可以看到很多是由于空格和杂乱字符导致的匹配失败，所以我们先去除：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">df4 <span class="operator">%&gt;%</span> </span><br><span class="line">  tidylog<span class="operator">::</span>mutate<span class="punctuation">(</span>县 <span class="operator">=</span> str_remove_all<span class="punctuation">(</span>县<span class="punctuation">,</span> <span class="string">&quot;[\\s;:]&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> df4 </span><br><span class="line">然后再匹配：</span><br><span class="line"></span><br><span class="line">df4 <span class="operator">%&gt;%</span> </span><br><span class="line">  tidylog<span class="operator">::</span>anti_join<span class="punctuation">(</span>countycode1<span class="punctuation">)</span> </span><br><span class="line"><span class="comment">#&gt; # A tibble: 83 × 25</span></span><br><span class="line"><span class="comment">#&gt;    省     县       行政区域面积    乡    镇 街道办事处 户籍人口 地区生产总值</span></span><br><span class="line"><span class="comment">#&gt;    &lt;chr&gt;  &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;</span></span><br><span class="line"><span class="comment">#&gt;  1 安徽省 湾社区            650    NA     5         NA     35.4      3831248</span></span><br><span class="line"><span class="comment">#&gt;  2 安徽省 滩溪县           1982    NA    11         NA    114.       5407788</span></span><br><span class="line"><span class="comment">#&gt;  3 安徽省 板阳县           1473     1    15         NA     78.7      1882758</span></span><br><span class="line"><span class="comment">#&gt;  4 安徽省 夥县              857     3     5         NA      9.2       509979</span></span><br><span class="line"><span class="comment">#&gt;  5 安徽省 扬山县           1197    NA    13         NA    101.       2544835</span></span><br><span class="line"><span class="comment">#&gt;  6 重庆市 由日忠县         2187     6    19          4     96.2      4885521</span></span><br><span class="line"><span class="comment">#&gt;  7 重庆市 新都区            497    NA     2          7     85.6     10001115</span></span><br><span class="line"><span class="comment">#&gt;  8 福建省 沙县区           1799     4     6          2     27.1      3544375</span></span><br><span class="line"><span class="comment">#&gt;  9 福建省 龙海区           1320     2    11          1     91.2     12657788</span></span><br><span class="line"><span class="comment">#&gt; 10 福建省 长泰区            900     1     4         NA     21.1      3752268</span></span><br><span class="line"><span class="comment">#&gt; # ℹ 73 more rows</span></span><br><span class="line"><span class="comment">#&gt; # ℹ 17 more variables: 第一产业增加值 &lt;dbl&gt;, 第二产业增加值 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   第三产业增加值 &lt;dbl&gt;, 地方一般公共预算收入 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   地方一般公共预算支出 &lt;dbl&gt;, 住户存款余额 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   年末金融机构各项贷款余额 &lt;dbl&gt;, 设施农业种植占地面积 &lt;dbl&gt;, 油料产量 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   棉花产量 &lt;dbl&gt;, 规模以上工业企业 &lt;dbl&gt;, 固定电话用户 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   普通中学在校学生 &lt;dbl&gt;, 小学在校学生 &lt;dbl&gt;, 医疗卫生机构床位 &lt;dbl&gt;, …</span></span><br></pre></td></tr></table></figure><p>可以看到这个时候匹配不成功的就不是很多了，下面我们需要结合百度和 countycode1.dta 来逐个检查修正：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">DT<span class="operator">::</span>datatable<span class="punctuation">(</span>countycode1<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421232906.png" alt=""></p><p>这里建议先保存成一个 xlsx 文件，然后在 Excel 里面进行更正：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">df4 <span class="operator">%&gt;%</span> </span><br><span class="line">  anti_join<span class="punctuation">(</span>countycode1<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  writexl<span class="operator">::</span>write_xlsx<span class="punctuation">(</span><span class="string">&quot;待修正.xlsx&quot;</span><span class="punctuation">)</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 待修正2.xlsx 是我手动调整之后得到的结果</span></span><br><span class="line">readxl<span class="operator">::</span>read_xlsx<span class="punctuation">(</span><span class="string">&quot;待修正2.xlsx&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> dftemp </span><br><span class="line"></span><br><span class="line">dftemp <span class="operator">%&gt;%</span> </span><br><span class="line">  tidylog<span class="operator">::</span>anti_join<span class="punctuation">(</span>countycode1<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#&gt; # A tibble: 0 × 25</span></span><br><span class="line"><span class="comment">#&gt; # ℹ 25 variables: 省 &lt;chr&gt;, 县 &lt;chr&gt;, 行政区域面积 &lt;dbl&gt;, 乡 &lt;dbl&gt;, 镇 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   街道办事处 &lt;dbl&gt;, 户籍人口 &lt;dbl&gt;, 地区生产总值 &lt;dbl&gt;, 第一产业增加值 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   第二产业增加值 &lt;dbl&gt;, 第三产业增加值 &lt;dbl&gt;, 地方一般公共预算收入 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   地方一般公共预算支出 &lt;dbl&gt;, 住户存款余额 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   年末金融机构各项贷款余额 &lt;dbl&gt;, 设施农业种植占地面积 &lt;dbl&gt;, 油料产量 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   棉花产量 &lt;dbl&gt;, 规模以上工业企业 &lt;dbl&gt;, 固定电话用户 &lt;dbl&gt;,</span></span><br><span class="line"><span class="comment">#&gt; #   普通中学在校学生 &lt;dbl&gt;, 小学在校学生 &lt;dbl&gt;, 医疗卫生机构床位 &lt;dbl&gt;, …</span></span><br></pre></td></tr></table></figure><p>这个时候就没有不匹配的了：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">df4 <span class="operator">%&gt;%</span> </span><br><span class="line">  anti_join<span class="punctuation">(</span></span><br><span class="line">    df4 <span class="operator">%&gt;%</span> </span><br><span class="line">      select<span class="punctuation">(</span>省<span class="punctuation">,</span> 县<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">      anti_join<span class="punctuation">(</span>countycode1<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  bind_rows<span class="punctuation">(</span>dftemp<span class="punctuation">)</span> <span class="operator">-&gt;</span> df5 </span><br><span class="line"></span><br><span class="line">df5 <span class="operator">%&gt;%</span> </span><br><span class="line">  tidylog<span class="operator">::</span>left_join<span class="punctuation">(</span>countycode1<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  select<span class="punctuation">(</span>省<span class="punctuation">,</span> 省代码<span class="punctuation">,</span> 市<span class="punctuation">,</span> 市代码<span class="punctuation">,</span> 县<span class="punctuation">,</span> 县代码<span class="punctuation">,</span> everything<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> df5 </span><br></pre></td></tr></table></figure><p>然后我们再对变量进行重命名（和之前年份的保持一致）：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">df5 <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>乡 <span class="operator">=</span> if_else<span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>乡<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> 乡<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         镇 <span class="operator">=</span> if_else<span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>镇<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> 镇<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>乡镇个数_个 <span class="operator">=</span> 乡 <span class="operator">+</span> 镇<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  rename<span class="punctuation">(</span></span><br><span class="line">    乡_个 <span class="operator">=</span> 乡<span class="punctuation">,</span> </span><br><span class="line">    镇_个 <span class="operator">=</span> 镇<span class="punctuation">,</span> </span><br><span class="line">    行政区域土地面积_平方公里 <span class="operator">=</span> 行政区域面积<span class="punctuation">,</span> </span><br><span class="line">    街道办事处个数_个 <span class="operator">=</span> 街道办事处<span class="punctuation">,</span> </span><br><span class="line">    户籍人口_人 <span class="operator">=</span> 户籍人口<span class="punctuation">,</span> </span><br><span class="line">    国内生产总值_万元 <span class="operator">=</span> 地区生产总值<span class="punctuation">,</span></span><br><span class="line">    第一产业增加值_万元 <span class="operator">=</span> 第一产业增加值<span class="punctuation">,</span></span><br><span class="line">    第二产业增加值_万元 <span class="operator">=</span> 第二产业增加值<span class="punctuation">,</span> </span><br><span class="line">    第三产业增加值_万元 <span class="operator">=</span> 第三产业增加值<span class="punctuation">,</span></span><br><span class="line">    一般公共预算收入_万元 <span class="operator">=</span> 地方一般公共预算收入<span class="punctuation">,</span></span><br><span class="line">    一般公共预算支出_万元 <span class="operator">=</span> 地方一般公共预算支出<span class="punctuation">,</span></span><br><span class="line">    住户储蓄存款余额_万元 <span class="operator">=</span> 住户存款余额<span class="punctuation">,</span> </span><br><span class="line">    年末各项贷款余额_万元 <span class="operator">=</span> 年末金融机构各项贷款余额<span class="punctuation">,</span> </span><br><span class="line">    设施农业占地面积_公顷 <span class="operator">=</span> 设施农业种植占地面积<span class="punctuation">,</span> </span><br><span class="line">    油料产量_吨 <span class="operator">=</span> 油料产量<span class="punctuation">,</span> </span><br><span class="line">    棉花产量_吨 <span class="operator">=</span> 棉花产量<span class="punctuation">,</span> </span><br><span class="line">    规模以上工业企业个数_个 <span class="operator">=</span> 规模以上工业企业<span class="punctuation">,</span> </span><br><span class="line">    固定电话用户_户 <span class="operator">=</span> 固定电话用户<span class="punctuation">,</span> </span><br><span class="line">    普通中学在校学生_人 <span class="operator">=</span> 普通中学在校学生<span class="punctuation">,</span> </span><br><span class="line">    小学在校学生数_人 <span class="operator">=</span> 小学在校学生<span class="punctuation">,</span> </span><br><span class="line">    医疗卫生机构床位_床 <span class="operator">=</span> 医疗卫生机构床位<span class="punctuation">,</span></span><br><span class="line">    提供住宿的社会工作机构_个 <span class="operator">=</span> 提供住宿的民政服务机构<span class="punctuation">,</span> </span><br><span class="line">    提供住宿的社会工作机构床位_床 <span class="operator">=</span> 提供住宿的民政服务机构床位数</span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">-&gt;</span> df6 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存成 xlsx</span></span><br><span class="line">df6 <span class="operator">%&gt;%</span> </span><br><span class="line">  writexl<span class="operator">::</span>write_xlsx<span class="punctuation">(</span><span class="string">&quot;2021年县市社会经济指标.xlsx&quot;</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure><p>最后如果你想把该数据和之前年份的合并起来，只需要使用 <code>bind_rows()</code> 合并即可。</p><p>最后我们再使用该数据绘制一幅区县地图。这里使用的数据是我之前编辑过的一份 shp 数据。可以用于绘制带九段线小地图的中国地图。</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggspatial<span class="punctuation">)</span></span><br><span class="line">read_sf<span class="punctuation">(</span><span class="string">&quot;chinacounty2020mini/chinacounty2020mini.shp&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> countymap </span><br><span class="line">read_sf<span class="punctuation">(</span><span class="string">&quot;chinacounty2020mini/chinacounty2020mini_line.shp&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> countyline </span><br><span class="line"></span><br><span class="line">countymap <span class="operator">%&gt;%</span> </span><br><span class="line">  filter<span class="punctuation">(</span><span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>objid<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> countymap </span><br></pre></td></tr></table></figure><p>以地区生产总值为例：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">df6 <span class="operator">%&gt;%</span> </span><br><span class="line">  select<span class="punctuation">(</span>县代码<span class="punctuation">,</span> 国内生产总值_万元<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>v <span class="operator">=</span> 国内生产总值_万元 <span class="operator">/</span> <span class="number">10000</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> df7 </span><br></pre></td></tr></table></figure><p>缺失值使用所在市、所在省的均值填补，实在无法填补的设定为 -1：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">countymap <span class="operator">%&gt;%</span> </span><br><span class="line">  left_join<span class="punctuation">(</span>df7<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  group_by<span class="punctuation">(</span>省<span class="punctuation">,</span> 省代码<span class="punctuation">,</span> 市<span class="punctuation">,</span> 市代码<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>mean1 <span class="operator">=</span> mean<span class="punctuation">(</span>v<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         v <span class="operator">=</span> if_else<span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>v<span class="punctuation">)</span><span class="punctuation">,</span> mean1<span class="punctuation">,</span> v<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ungroup<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  group_by<span class="punctuation">(</span>省<span class="punctuation">,</span> 省代码<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>mean2 <span class="operator">=</span> mean<span class="punctuation">(</span>v<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         v <span class="operator">=</span> if_else<span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>v<span class="punctuation">)</span><span class="punctuation">,</span> mean2<span class="punctuation">,</span> v<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ungroup<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>v <span class="operator">=</span> if_else<span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>v<span class="punctuation">)</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> v<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> df8 </span><br></pre></td></tr></table></figure><p>下面我们将绘制两种地图，一种是使用连续变量绘制，另一种是使用分类变量绘制，为此，我们对地区生产总值变量进行分组：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># v 的范围</span></span><br><span class="line"><span class="built_in">range</span><span class="punctuation">(</span>df8<span class="operator">$</span>v<span class="punctuation">)</span> </span><br><span class="line"><span class="comment">#&gt; [1]   -1.00 4748.06</span></span><br><span class="line">quantile<span class="punctuation">(</span>df8<span class="operator">$</span>v<span class="punctuation">,</span> seq<span class="punctuation">(</span>from <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> to <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> <span class="built_in">length</span> <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  `[`<span class="punctuation">(</span><span class="number">2</span><span class="operator">:</span><span class="number">7</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  <span class="built_in">round</span><span class="punctuation">(</span>digits <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> cuts</span><br><span class="line"></span><br><span class="line">df8 <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>group <span class="operator">=</span> cut<span class="punctuation">(</span>v<span class="punctuation">,</span> breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> cuts<span class="punctuation">,</span> <span class="number">5000</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">                     include.lowest <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span></span><br><span class="line">                     labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;无数据&quot;</span><span class="punctuation">,</span> <span class="string">&quot;0 ~ 65.35&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="string">&quot;65.35 ~ 109.36&quot;</span><span class="punctuation">,</span> <span class="string">&quot;109.36 ~ 154.74&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="string">&quot;154.74 ~ 229.96&quot;</span><span class="punctuation">,</span> <span class="string">&quot;229.96 ~ 328.96&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="string">&quot;328.96 ~ 521.38&quot;</span><span class="punctuation">,</span> <span class="string">&quot;&gt; 521.38&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span>  <span class="operator">-&gt;</span> df9 </span><br></pre></td></tr></table></figure><p>countyline 变量还需要再处理下：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">countyline <span class="operator">%&gt;%</span> </span><br><span class="line">  tail<span class="punctuation">(</span>n <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  select<span class="punctuation">(</span><span class="built_in">class</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  filter<span class="punctuation">(</span><span class="built_in">class</span> <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;九段线&quot;</span><span class="punctuation">,</span> <span class="string">&quot;海岸线&quot;</span><span class="punctuation">,</span> <span class="string">&quot;小地图框格&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> countyline </span><br></pre></td></tr></table></figure><p>连续变量的绘制：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 绘制连续变量</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df9<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_sf<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> v<span class="punctuation">)</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">0.001</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_sf<span class="punctuation">(</span>data <span class="operator">=</span> countyline<span class="punctuation">,</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">          show.legend <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span></span><br><span class="line">    <span class="string">&quot;九段线&quot;</span> <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;海岸线&quot;</span> <span class="operator">=</span> <span class="string">&quot;#0055AA&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;小地图框格&quot;</span><span class="operator">=</span> <span class="string">&quot;black&quot;</span></span><br><span class="line">  <span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  scale_linewidth_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span></span><br><span class="line">    <span class="string">&quot;九段线&quot;</span> <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;海岸线&quot;</span> <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;小地图框格&quot;</span><span class="operator">=</span> <span class="number">0.2</span></span><br><span class="line">  <span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  scale_fill_viridis_c<span class="punctuation">(</span>option <span class="operator">=</span> <span class="string">&quot;A&quot;</span><span class="punctuation">,</span> trans <span class="operator">=</span> <span class="string">&quot;log10&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  annotation_scale<span class="punctuation">(</span></span><br><span class="line">    width_hint <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span></span><br><span class="line">    text_family <span class="operator">=</span> cnfont </span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  annotation_north_arrow<span class="punctuation">(</span></span><br><span class="line">    location <span class="operator">=</span> <span class="string">&quot;tr&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    which_north <span class="operator">=</span> <span class="string">&quot;false&quot;</span><span class="punctuation">,</span></span><br><span class="line">    pad_x <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    pad_y <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    style <span class="operator">=</span> north_arrow_nautical<span class="punctuation">(</span></span><br><span class="line">      text_family <span class="operator">=</span> cnfont</span><br><span class="line">    <span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  guides<span class="punctuation">(</span>fill <span class="operator">=</span> guide_colorbar<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;地区生产总值（亿元）&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme_ipsum<span class="punctuation">(</span>base_family <span class="operator">=</span> cnfont<span class="punctuation">,</span> grid <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text.y <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.12</span><span class="punctuation">,</span> <span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        plot.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;2021 年中国各县地区生产总值（亿元）&quot;</span><span class="punctuation">,</span></span><br><span class="line">       subtitle <span class="operator">=</span> <span class="string">&quot;数据整理 &amp; 绘制：微信公众号 RStata&quot;</span><span class="punctuation">,</span></span><br><span class="line">       caption <span class="operator">=</span> <span class="string">&quot;数据来源：2022 年中国县域统计年鉴&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> p </span><br><span class="line"></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;pic1.png&quot;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span> device <span class="operator">=</span> png<span class="punctuation">)</span> </span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/1670/93141c85-6d06-4e0c-ac0d-4d4e6f69929a.png" alt=""></p><p>分类变量的绘制：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 绘制分类变量</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df9<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_sf<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> group<span class="punctuation">)</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">0.001</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_sf<span class="punctuation">(</span>data <span class="operator">=</span> countyline<span class="punctuation">,</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">          show.legend <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span></span><br><span class="line">    <span class="string">&quot;九段线&quot;</span> <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;海岸线&quot;</span> <span class="operator">=</span> <span class="string">&quot;#0055AA&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;小地图框格&quot;</span><span class="operator">=</span> <span class="string">&quot;black&quot;</span></span><br><span class="line">  <span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  scale_linewidth_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span></span><br><span class="line">    <span class="string">&quot;九段线&quot;</span> <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;海岸线&quot;</span> <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;小地图框格&quot;</span><span class="operator">=</span> <span class="number">0.2</span></span><br><span class="line">  <span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  scale_fill_viridis_d<span class="punctuation">(</span>option <span class="operator">=</span> <span class="string">&quot;A&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  annotation_scale<span class="punctuation">(</span></span><br><span class="line">    width_hint <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span></span><br><span class="line">    text_family <span class="operator">=</span> cnfont </span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  annotation_north_arrow<span class="punctuation">(</span></span><br><span class="line">    location <span class="operator">=</span> <span class="string">&quot;tr&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    which_north <span class="operator">=</span> <span class="string">&quot;false&quot;</span><span class="punctuation">,</span></span><br><span class="line">    pad_x <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    pad_y <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    style <span class="operator">=</span> north_arrow_nautical<span class="punctuation">(</span></span><br><span class="line">      text_family <span class="operator">=</span> cnfont</span><br><span class="line">    <span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  guides<span class="punctuation">(</span>fill <span class="operator">=</span> guide_legend<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;地区生产总值（亿元）&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             ncol <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme_ipsum<span class="punctuation">(</span>base_family <span class="operator">=</span> cnfont<span class="punctuation">,</span> grid <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.text.y <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        legend.position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.15</span><span class="punctuation">,</span> <span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        plot.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;2021 年中国各县地区生产总值（亿元）&quot;</span><span class="punctuation">,</span></span><br><span class="line">       subtitle <span class="operator">=</span> <span class="string">&quot;数据整理 &amp; 绘制：微信公众号 RStata&quot;</span><span class="punctuation">,</span></span><br><span class="line">       caption <span class="operator">=</span> <span class="string">&quot;数据来源：2022 年中国县域统计年鉴&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> p </span><br><span class="line"></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;pic2.png&quot;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span> device <span class="operator">=</span> png<span class="punctuation">)</span> </span><br></pre></td></tr></table></figure><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421233046.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在之前的课程「R 语言：如何整理 2022 年县域统计年鉴：caj 文件转 pdf、文本识别与数据清洗」中我们讲解了如何从 caj 文件中提取表格数据的方法，今天我们再来学习下如何根据区县名称匹配行政区划代码，另外在该过程中还可以检查区县名称的识别错误。最后我们再使用整理得
      
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>2000～2022 年中国县域统计年鉴的数据</title>
    <link href="https://tidyfriday.cn/posts/41662/"/>
    <id>https://tidyfriday.cn/posts/41662/</id>
    <published>2023-04-21T11:25:00.000Z</published>
    <updated>2023-04-21T15:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>之前给大家分享过 2000～2021 年中国县域统计年鉴的数据，2000～2021 年中国县域统计年鉴里面的数据实际上是 1999～2020 年的，包含乡镇卷和县市卷，乡镇卷里面的数据不全，使用价值不大，所以仅仅整理了县市社会经济指标：</p><ol><li>1999~2020年县市社会经济指标.xlsx</li><li>1999~2020年县市社会经济指标.dta</li></ol><blockquote><p>需要注意县域统计年鉴并不包含市辖区的数据，仅仅包含大概 2000 多个县的数据。</p></blockquote><p>最近又给大家分享了 2022 年县域统计年鉴的原始数据和整理课程：</p><ol><li>如何整理 2022 年县域统计年鉴：caj 文件转 pdf、文本识别与数据清洗：<a href="https://rstata.duanshu.com/#/brief/course/59fbd94072c844d985f0f4fcdbd4c40e">https://rstata.duanshu.com/#/brief/course/59fbd94072c844d985f0f4fcdbd4c40e</a> </li><li>Stata：如何为区县名称添加行政区划代码：<a href="https://rstata.duanshu.com/#/brief/course/ff44f63581e94d58bdee05c6998a5a6c">https://rstata.duanshu.com/#/brief/course/ff44f63581e94d58bdee05c6998a5a6c</a></li></ol><p>按照上面两个课程的整理方法即可得到 2022 年县域统计年鉴中的县市社会经济指标数据了，然后把处理得到的数据和 <code>1999~2020年县市社会经济指标.dta</code> append 起来即可得到 1999～2021 年的面板数据了。</p><h2 id="数据概况"><a href="#数据概况" class="headerlink" title="数据概况"></a>数据概况</h2><ol><li>时间范围：1999～2021 年；</li><li>变量数：67；</li><li>面板格式。</li></ol><p>下面选择 2020 年 <code>户籍人口_人</code>、<code>一般公共预算收入_万元</code> 和 <code>一般公共预算支出_万元</code> 三个变量进行绘图展示：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421232725.png" alt="2020 年中国各区县（含县级市）年末户籍人口"></p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421232743.png" alt="2020 年中国各区县（含县级市）一般公共预算收入"></p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421232755.png" alt="2020 年中国各区县（含县级市）一般公共预算支出"></p><blockquote><p>上图中部分缺失值使用了该县所处省份的均值进行了填补。该数据里面并没有市辖区的数据（市辖区的数据在城市统计年鉴中），数据里面的区是之前的县改的。</p></blockquote><p>很久之前就出过一个直播课程讲解如何整理县域统计年鉴数据：</p><blockquote><p>县域统计年鉴是如何整理的？Stata 和 R 齐上阵！：<a href="https://rstata.duanshu.com/#/brief/course/ce084094d5ac4a9cbd5fd61960545f47">https://rstata.duanshu.com/#/brief/course/ce084094d5ac4a9cbd5fd61960545f47</a></p></blockquote><p>这一次为了方便大家进行数据核对，还在附件中提供了处理过程和原始数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421232706.png" alt=""></p><p>大家在使用过程中遇到的问题可以和原始数据比对下看看是处理的问题还是原始数据就有问题。</p><h2 id="行政区划代码"><a href="#行政区划代码" class="headerlink" title="行政区划代码"></a>行政区划代码</h2><p>为了方便使用，我把数据中的行政区划（省、省代码、市、市代码、县、县代码）统一到了 2020 年，不过有一些县早已撤销或者合并到其他区县，这些县使用其被撤销年份的行政区划代码，例如：</p><ul><li>南汇区：2008 年区划代码</li><li>畹町市：1998 年区划代码</li><li>陶乐县：2002 年区划代码</li><li>长岛县：2019 年区划代码</li><li>吴县：2000 年区划代码</li><li>江浦县：2001 年区划代码</li></ul><p>所以上面的地图也是使用县代码变量和县级地图数据合并绘制的，相关代码也可以从附件中找到。</p><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>为了跨年份连接数据，我把不同年份相似的指标（可能统计口径不完全一样）重命名成一样的名称，对于细致的研究请注意自行修正这种问题；</li><li>由于各年的统计指标并不完全一致，有些指标只有部分年份有，所以缺失严重；</li><li>为了方便大家使用，我给数据添加了省、省代码、市、市代码，使用的是 2020 年中国各省市区县行政区划代码，不过有部分县级市已经取消合并了，使用的是 早年的行政区划代码，如上文所述。</li><li>另外统计年鉴并不是没有错的，实际上包含了很多数据错误和错字！所以大家使用的适合如果发现可错误或者不合理的数据，很可能是统计年鉴的错误，并非整理的错误（当然整理错误也可能有），替换成缺失值即可。</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;之前给大家分享过 2000～2021 年中国县域统计年鉴的数据，2000～2021 年中国县域统计年鉴里面的数据实际上是 1999～2020 年的，包含乡镇卷和县市卷，乡镇卷里面的数据不全，使用价值不大，所以仅仅整理了县市社会经济指标：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;1999~
      
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>使用 Stata 进行数据可视化：绘图案例合集（一）</title>
    <link href="https://tidyfriday.cn/posts/32009/"/>
    <id>https://tidyfriday.cn/posts/32009/</id>
    <published>2023-04-21T11:21:00.000Z</published>
    <updated>2023-04-21T15:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>在过去几年中，我在公众号里面分享了很多使用 Stata 绘图的案例，为了方便大家学习和查阅，我把从这些案例中精选了 40 个汇编成了一本小册子：「使用 Stata 进行数据可视化：绘图案例合集（一）」</p><p>该册子一共包含了 40 个 Stata 的绘图案例：</p><ol><li>Stata 绘制柱状图中的位置调整</li><li>Stata 绘图展示欧洲各国领导人在任时间</li><li>Stata：使用 joyplot 绘制峰峦图</li><li>使用 Stata 绘制中国省级地图 </li><li>使用 Stata 绘制中国市级地图 </li><li>使用 Stata 绘制中国县级地图 </li><li>图说第七次全国人口普查</li><li>图说人口普查：地区人口与性别结构</li><li>我们分析了 65.8 万个村名，找到了中国地名的秘密</li><li>使用 Stata 绘制太极八卦图</li><li>使用 Stata 绘制散点连接图</li><li>使用 Stata 绘制人口金字塔</li><li>使用 Stata 绘制两个时期的变量取值对比图</li><li>使用 Stata 绘制股票交易价量图</li><li>使用 Stata 绘制堆叠柱状图</li><li>如何使用 Stata 绘制空间网络图？ </li><li>如何使用 Stata 绘制莫兰散点图、在散点图上添加文本标签以及避免文本标签重叠？</li><li>如何使用 Stata 绘制相关系数热力图？</li><li>如何使用 Stata 绘制一幅彩色的照片？给你的图表添加一个冰墩墩！</li><li>如何使用 Stata 绘制不等宽柱状图</li><li>使用 Stata 绘图展示 2021 年俄罗斯与各国（地区）间的进出口额</li><li>使用 Stata 提取一大堆文本文件中的词频并绘图展示</li><li>使用Stata爬取冬奥会奖牌榜数据并绘图展示</li><li>如何删除 Stata 箱线图中的离群值？</li><li>核密度曲线相关绘图技巧</li><li>msize 选项和 barbsize 选项之间的关系图</li><li>1998 ~ 2013 年每年各种专利类型的申请数量和专利总数量的绘图展示</li><li>1980 ~ 2017 年美国经历的各种自然灾害的累积损失</li><li>rankplot：使用 Stata 绘制排名比对图</li><li>RGB 与 HEX 颜色代码的相互转换</li><li>Stata 绘图中循环的使用、xtline 用法深入解析以及填充地图的绘制——以新冠疫情数据分析为例</li><li>Stata 内置的调色板</li><li>Stata 如何创建不重叠标签的散点图 or 将散点标签统一放置在图的右侧并和散点连接起来？</li><li>Stata 如何合并多幅图表？合并的图表如何共用一个图例？</li><li>Stata 如何绘制带误差棒和文本注释的柱状图</li><li>Stata 中各种平滑方法的比较</li><li>Stata：如何绘制并列柱状图 + 线图？以上市公司绿色专利数量数据为例</li><li>Stata 马科维茨有效前沿的实现</li><li>如何使用 Stata 处理第七次人口普查年鉴数据</li><li>使用 Stata 分析全国人大代表数据</li></ol><blockquote><p>多数内容带课程讲解，感兴趣的小伙伴可以到平台上观看学习（点击文末的阅读原文即可跳转）： </p><p><a href="https://rstata.duanshu.com/#/brief/course/5cc858d3b49e47b99fc9b9f41828da81">https://rstata.duanshu.com/#/brief/course/5cc858d3b49e47b99fc9b9f41828da81</a></p></blockquote><p>为了方便大家翻阅和学习，大家也可以私信我预定打印纸质版（限培训班会员预定）：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421232219.png" alt=""></p><p>其他的讲义材料还有这些：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421231937.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在过去几年中，我在公众号里面分享了很多使用 Stata 绘图的案例，为了方便大家学习和查阅，我把从这些案例中精选了 40 个汇编成了一本小册子：「使用 Stata 进行数据可视化：绘图案例合集（一）」&lt;/p&gt;
&lt;p&gt;该册子一共包含了 40 个 Stata 的绘图案例：&lt;/p
      
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>R 语言地理计算应用与地理数据可视化案例合集</title>
    <link href="https://tidyfriday.cn/posts/17671/"/>
    <id>https://tidyfriday.cn/posts/17671/</id>
    <published>2023-04-21T11:20:00.000Z</published>
    <updated>2023-04-21T15:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>在过去几年中，我在公众号里面分享了很多使用 R 语言进行地理计算和地理数据可视化的案例，为了方便大家学习和查阅，我把从这些案例中精选了 36 个汇编成了一本小册子：「R 语言地理计算应用与地理数据可视化案例合集」</p><p>该册子一共包含了 36 个 R 语言地理计算与地理数据可视化的案例：</p><ol><li>使用 R 语言进行地理编码</li><li>中国各省市碳排放量是如何计算的？R 语言栅格数据转面板数据</li><li>使用 R 语言绘制夜间灯光地图</li><li>QGIS &amp; R 语言：如何从地图图片上提取数据并重新绘图？（使用 QGIS 进行地图配准）</li><li>R语言地理计算的应用：泰森多边形面积、周长与质心距离计算</li><li>从广州南站到珠江新城怎么走</li><li>大城市发展的有多快</li><li>哪些县与省界接触？工企业距离省界的距离？｜空间拓扑关 系与地理距离计算</li><li>气象数据是如何处理的？以降水量为例</li><li>如何根据经纬度判断该地点所处的省市区县</li><li>如何绘制一幅漂亮的路网地图？网页文本提取、地理编码与可视化</li><li>如何绘制一幅圆滚滚的世界地图</li><li>如何绘制以太平洋为中心的世界地图</li><li>如何计算每个城市或区县距离最近省会城市和距离其所在省的省会城市距离</li><li>如何将栅格数据处理成面板数据或时间序列数据？以 PM2.5 浓度数据处理为例</li><li>如何判断工企业在南方还是北方</li><li>如何使用 R 语言绘制双变量填充中国地图</li><li>如何使用 R 语言计算各省份质心到秦岭淮河线的纬度差距离</li><li>使用 highcharter 绘制世界地图</li><li>使用 R 语言操作地理矢量数据</li><li>使用 R 语言绘图展示 2020 年中国各省市地区生产总值</li><li>使用 R 语言绘图展示中国土地覆盖类型分布和各省市区县耕地占比分布</li><li>使用 R 语言计算各个省市区县的经纬度范围</li><li>使用 R 语言计算各省市区县河流密度——基于1-100万公众版基础地理信息数据</li><li>使用 R 语言计算秦岭——淮河线两侧的省市区县</li><li>使用 R 语言爬取宗教活动场所基本信息</li><li>使用 R 语言处理 netCDF 格式的数据（一）</li><li>使用 R 语言处理 netCDF 格式的数据（二）</li><li>相邻城市共同边界附近的工企与共同边界的距离计算 &amp; 绘图展示</li><li>行政区划矢量数据是如何制作的？使用 R 语言处理全国基础地理信息数据</li><li>已知某个地点的经纬度，如何判断其是在北方还是南方</li><li>中国各城市间的交通距离是如何解析的？——以各城市与上海的驾车交通路线规划为例</li><li>GEOJSON 数据的应用案例 &amp; 带九段线小地图的中国地图 GEOJSON 数据</li><li>R 语言：百度地图迁徙大数据爬取与可视化</li><li>R 语言计算 NDVI 时序数据变异系数栅格</li><li>Stata 和 R 语言绘图中如何快速的使用调色板</li></ol><blockquote><p>多数内容带课程讲解，感兴趣的小伙伴可以到平台上观看学习（点击文末的阅读原文即可跳转）： </p><p><a href="https://rstata.duanshu.com/#/brief/course/5dee5f29f36344f3be82aca0a20820bd">https://rstata.duanshu.com/#/brief/course/5dee5f29f36344f3be82aca0a20820bd</a></p></blockquote><p>为了方便大家翻阅和学习，大家也可以私信我预定打印纸质版（限培训班会员预定）：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421232045.png" alt=""></p><p>其他的讲义材料还有这些：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421231937.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在过去几年中，我在公众号里面分享了很多使用 R 语言进行地理计算和地理数据可视化的案例，为了方便大家学习和查阅，我把从这些案例中精选了 36 个汇编成了一本小册子：「R 语言地理计算应用与地理数据可视化案例合集」&lt;/p&gt;
&lt;p&gt;该册子一共包含了 36 个 R 语言地理计算与
      
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>Stata 编程案例合集（一）</title>
    <link href="https://tidyfriday.cn/posts/13387/"/>
    <id>https://tidyfriday.cn/posts/13387/</id>
    <published>2023-04-21T11:18:00.000Z</published>
    <updated>2023-04-21T15:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>在过去几年中，我在公众号里面分享了很多使用 Stata 编程解决问题的案例，为了方便大家学习和查阅，我把从这些案例中精选了 38 个汇编成了一本小册子：「使用 Stata 进行数据处理：编程案例合集（一）」</p><p>该册子一共包含了 38 个 Stata 编程的案例：</p><ol><li>使用 Stata 进行地理编码</li><li>使用 Stata 调用百度翻译接口</li><li>县域统计年鉴是如何被整理好的——以 2016 年为例</li><li>城市统计年鉴是如何整理的？使用 R 语言和 Stata</li><li>工企和污染数据是如何匹配的？使用 Stata 完成整个过程</li><li>工企数据库与海关数据库的匹配</li><li>海关编码国别（地区）代码表爬取</li><li>排污权交易机制是否提高了企业全要素生产率</li><li>政治等级与区域经济发展：来自中国空间断点回归的证据</li><li>如何仿照 Brandt 方法把工企数据匹配成面板？</li><li>如何将从 Wind 数据库下载的数据转换成面板</li><li>如何使用 Stata 统计历年各省市区县的金融机构数量</li><li>如何用 Stata 编程计算行业的多样化集聚程度</li><li>使用 Stata 编程计算工企专利知识宽度</li><li>使用 Stata 爬取 VINSIGHT 网站上的沪深 300 VIX 和上证 50 VIX 数据</li><li>使用 Stata 爬取处理 XML 数据</li><li>使用 Stata 提取一大堆文本文件中的词频并绘图展示</li><li>使用 Stata 寻找分布中密度为最大密度一半的 X</li><li>使用 Stata 进行绿色专利筛选</li><li>已知每个公司的注册地，如何生成公司是否注册在同一个城市的零一矩阵？</li><li>estout 的使用</li><li>Mac：从 Stata 创建桌面通知</li><li>R 语言和 Stata 中的数据转换（透视、长宽数据转换）</li><li>R语言 &amp; Stata：如何对字符串变量实现分组求和和分组累加？</li><li>spatwmat-命令的报错如何解决？</li><li>Stata 观测值重新对照</li><li>Stata 爬取上市公司高管人物特征和高管简历</li><li>Stata 如何导出多元 Logistic 回归的结果？</li><li>Stata 如何计算与某个企业位于同一地区、不同行业的其他企业某个变量的均值？</li><li>Stata 如何生成一个新变量，这个变量的值是另外一个变量中所有独一无二的值</li><li>Stata 中的行计算</li><li>Stata 中的中文模糊匹配——以工企数据和境外投资名录数据匹配为例</li><li>Stata 中如何对称填充矩阵？</li><li>Stata 中如何正确地进行多对多匹配？</li><li>Stata 中怎么删除至少有三个缺失值的变量们？</li><li>Stata：如何根据自己的需求编程输出代码结果到 word 文档？以 rdrandinf 命令为例</li><li>Stata：一次性实现变量的 9 种正态变换</li><li>Stata 如何进行加权累加？</li></ol><blockquote><p>多数内容带课程讲解，感兴趣的小伙伴可以到平台上观看学习（点击文末的阅读原文即可跳转）： </p><p><a href="https://rstata.duanshu.com/#/brief/course/39341829401b45b99e93ee566ed902c8">https://rstata.duanshu.com/#/brief/course/39341829401b45b99e93ee566ed902c8</a> </p></blockquote><p>为了方便大家翻阅和学习，大家也可以私信我预定打印纸质版（限培训班会员预定）：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421231920.png" alt=""></p><p>其他的讲义材料还有这些：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421231937.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在过去几年中，我在公众号里面分享了很多使用 Stata 编程解决问题的案例，为了方便大家学习和查阅，我把从这些案例中精选了 38 个汇编成了一本小册子：「使用 Stata 进行数据处理：编程案例合集（一）」&lt;/p&gt;
&lt;p&gt;该册子一共包含了 38 个 Stata 编程的案例：
      
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>1998～2014 年工企海关匹配结果</title>
    <link href="https://tidyfriday.cn/posts/20729/"/>
    <id>https://tidyfriday.cn/posts/20729/</id>
    <published>2023-04-21T11:14:00.000Z</published>
    <updated>2023-04-21T15:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>前不久给大家分享过工企地理位置信息数据和海关地理位置信息数据：</p><ol><li>工企地理位置：<a href="https://mp.weixin.qq.com/s/uI1wuAKNLf4i3cFUCY9Pyg">1998～2014 年工业企业数据库地理位置数据（含经纬度、所处省市区县、南北方属性以及距离秦岭淮河线的距离）</a></li><li>海关地理位置：<a href="https://mp.weixin.qq.com/s/6puOs1kmo3n55iUE1wO6DA">2000～2016 年海关地理信息数据（含经纬度及其所处的省市区县）</a></li></ol><p>今天我们分享一份工企与海关数据的匹配结果，借鉴相关文献，工企与海关的匹配可以分为下面 5 个步骤：</p><ol><li>清洗工企数据库里面的企业名称、邮政编码和固定电话变量（等下要用这三个变量进行匹配）；</li><li>清洗海关数据库里面的企业名称、邮编和电话变量；</li><li>在工企数据库里面生成一个 ID 变量用以在匹配过程中识别每个观测值，然后只保留企业名称、邮政编码和固定电话、年份、ID 几个变量（这样可以避免因为数据过大导致匹配过程过慢）；</li><li>对海关数据库进行汇总（例如只需要每个公司每年的进出口额的话）；</li><li>匹配海关和工企数据然后再根据 ID 变量把工企数据库的其它变量也合并进来。</li></ol><p>关于这五个步骤的代码实现，可以学习我们之前推出的 Stata 课程：「如何匹配海关和工企数据？」：</p><blockquote><p>如何匹配中国工业企业数据库和海关数据库？以 2013 年为例：<a href="https://rstata.duanshu.com/#/brief/course/5463b8d7afcb438ca1e537fa76c1a45d">https://rstata.duanshu.com/#/brief/course/5463b8d7afcb438ca1e537fa76c1a45d</a></p></blockquote><p>这次分享的数据包含下面两种版本的：</p><ol><li>先把海关数据汇总成每个公司的进出口额数据，然后和工企数据匹配的结果数据（下面称为汇总版本，其观测值是一个个的公司）；</li><li>直接把海关数据和工企数据进行匹配（下面称为完整版本，其观测值是一条条的商品）。</li></ol><p>两个版本的结果数据使用的匹配方法是一样的，但是由于细微的差异，结果也有细微的差异，下表展示的是匹配效果。<code>工企数据库中的工企数量</code> 列展示的是匹配使用的工企数据库的每年样本数；<code>汇总版本涉及的工企数量</code> 列展示的是汇总版本匹配结果中涉及的工企数量，最后一列是匹配率（汇总版本涉及的工企数量 / 工企数据库中的工企数量）：</p><table><thead><tr><th align="center">年份</th><th align="center">工企数据库中的工企数量</th><th align="center">汇总版本涉及的工企数量</th><th align="center">匹配率</th></tr></thead><tbody><tr><td align="center">2000</td><td align="center">162872</td><td align="center">22310</td><td align="center">13.7%</td></tr><tr><td align="center">2001</td><td align="center">171254</td><td align="center">26446</td><td align="center">15.4%</td></tr><tr><td align="center">2002</td><td align="center">181542</td><td align="center">29943</td><td align="center">16.5%</td></tr><tr><td align="center">2003</td><td align="center">196206</td><td align="center">34096</td><td align="center">17.4%</td></tr><tr><td align="center">2004</td><td align="center">279011</td><td align="center">52966</td><td align="center">19.0%</td></tr><tr><td align="center">2005</td><td align="center">270023</td><td align="center">53475</td><td align="center">19.8%</td></tr><tr><td align="center">2006</td><td align="center">301930</td><td align="center">61467</td><td align="center">20.4%</td></tr><tr><td align="center">2007</td><td align="center">336732</td><td align="center">89237</td><td align="center">26.5%</td></tr><tr><td align="center">2008</td><td align="center">412212</td><td align="center">73364</td><td align="center">17.8%</td></tr><tr><td align="center">2009</td><td align="center">366130</td><td align="center">64562</td><td align="center">17.6%</td></tr><tr><td align="center">2010</td><td align="center">442539</td><td align="center">77420</td><td align="center">17.5%</td></tr><tr><td align="center">2011</td><td align="center">302593</td><td align="center">59789</td><td align="center">19.8%</td></tr><tr><td align="center">2012</td><td align="center">324604</td><td align="center">79824</td><td align="center">24.6%</td></tr><tr><td align="center">2013</td><td align="center">344875</td><td align="center">83893</td><td align="center">24.3%</td></tr><tr><td align="center">2014</td><td align="center">309138</td><td align="center">60068</td><td align="center">19.4%</td></tr></tbody></table><p>下图会更直观：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/image_20210614133739.png" alt=""></p><p>如果大家想自行匹配的话，可以使用文初提到的两个数据，然后参考课程匹配。</p><p>为了更好的确认匹配数据的可靠性，我们计算了每年平均各个公司的进口额和出口额，如下图所示：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/image_20210614135945.png" alt=""></p><p>感觉连续性还不错！</p><p>另外这两份数据都非常大，已经拆分成了逐年的数据，可以直接使用 append 进行合并（Stata），数据格式是也是仅提供供 Stata 读取的 dta 格式。</p><p>关于汇总版如何合并成面板数据，可以参考这个课程：</p><blockquote><p>如何仿照 Brandt 方法把工企数据匹配成面板？：<a href="https://rstata.duanshu.com/#/brief/course/a3e155a19934433ab90913f1547b8300">https://rstata.duanshu.com/#/brief/course/a3e155a19934433ab90913f1547b8300</a></p></blockquote><p>此次分享的数据还有一份：ID 对照表。提供这份数据的原因在于很多小伙伴的电脑内存不大，没法读取完整版本的结果（很多年份的完整版本有 20多 GB），另外也提供了一份分拆的海关数据（很多年份的完整版本有 20 多 GB，这样把每个年份的也都拆分成小文件更方便大家操作）。</p><p>尽管如此，还是担心大家的电脑无法读取这份大数据，所以我还提供了一份完整版的小文件分拆版（每个文件不到 2GB）。</p><p>下面再展示下部分的数据预览：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2021-05-29%20%E4%B8%8A%E5%8D%8811.03.19_20210529110323.png" alt="2007 年工企与海关匹配完整版"></p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2021-05-29%20%E4%B8%8A%E5%8D%8811.04.16_20210529110421.png" alt="2006 年工企与海关匹配汇总版"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前不久给大家分享过工企地理位置信息数据和海关地理位置信息数据：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;工企地理位置：&lt;a href=&quot;https://mp.weixin.qq.com/s/uI1wuAKNLf4i3cFUCY9Pyg&quot;&gt;1998～2014 年工业企业数据库地理位置数据（
      
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>R 语言绘图案例合集（一）</title>
    <link href="https://tidyfriday.cn/posts/21258/"/>
    <id>https://tidyfriday.cn/posts/21258/</id>
    <published>2023-04-21T11:14:00.000Z</published>
    <updated>2023-04-21T15:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>在过去几年中，我在公众号里面分享了很多使用 R 语言绘图的案例，为了方便大家学习和查阅，我把从这些案例中精选了 35 个汇编成了一本小册子：「使用 R 语言进行数据可视化：绘图案例合集（一）」</p><p>该册子一共包含了 35 个 R 语言绘图的案例：</p><ol><li>ggplot2 绘图中关于图例的一些技巧</li><li>使用 R 语言绘制桑基图的一些方法</li><li>使用R语言分析全国人大代表数据</li><li>从原始数据到动态图表 —— 在 R 中完成所有操作</li><li>如何使用 R 语言绘制双坐标轴堆叠面积图？</li><li>当你说机会不大的时候，你想表达什么？</li><li>浏览器和操作系统份额 </li><li>你最常用哪个表情？在 ggplot2 图表上添加动图</li><li>Stata 和 R 语言绘图中如何快速的使用调色板</li><li>如何通过储蓄让自己退休后的资产达到 250 万？</li><li>如何使用 R 语言绘制相关系数热力图？交互式的更好？</li><li>使用 R 语言和 Stata 制作一张装饰画～</li><li>使用 R 语言制作城市印象明信片</li><li>使用云雨图展现数据分布</li><li>使用 sparkline 绘制迷你图</li><li>探索其它的 ggplot2 图层</li><li>Mac 上 R 语言绘图中的中文问题</li><li>mdthemes：在 ggplot2 绘图中应用 Markdown 语法</li><li>R 语言绘图展示欧洲各国领导人在任时间</li><li>R 语言绘图中如何添加特殊符号文本？</li><li>R 语言里面的日期环境设置和绘图中日期的显示</li><li>使用 highcharter 绘制交互式词云图</li><li>如何使用 R 语言绘制交互式柱状图？</li><li>如何使用 R 语言绘制水球图？</li><li>如何在 highcharter 绘制的图表上添加标注</li><li>使用 highcharter 绘制交互式饼图和环形图</li><li>使用 highcharter 绘制交互式气泡填充图和圆堆积图</li><li>使用 R 语言绘制交互式面积图</li><li>使用 R 语言绘制交互式席位分摊图</li><li>使用 R 语言绘制径向条形图</li><li>使用 streamgrapher 和 highcharter 绘制溪流图：世界各国新冠肺炎发展趋势</li><li>使用 RMarkdown 制作幻灯片</li><li>使用 robservable 绘制动态图表展示中国各省新冠疫情确诊人数动态变化</li><li>图说二〇二〇年全国姓名报告</li><li>全国历年人口状况数据整理和绘图</li></ol><blockquote><p>多数内容带课程讲解，感兴趣的小伙伴可以到平台上观看学习（点击文末的阅读原文即可跳转）： </p><p><a href="https://rstata.duanshu.com/#/brief/course/7ae88332ac7845e2a1f78551d394e611">https://rstata.duanshu.com/#/brief/course/7ae88332ac7845e2a1f78551d394e611</a> </p></blockquote><p>更多精美图表的绘制欢迎购买 RStata 会员学习：</p><p><img src="https://files.mdnice.com/user/1670/558330ce-d641-4c47-b508-856fa7cbbab1.png" alt=""></p><p>为了方便大家翻阅和学习，大家也可以私信我预定打印纸质版（限培训班会员预定）：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421231714.png" alt=""></p><p>其他的讲义材料还有这些：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421231937.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在过去几年中，我在公众号里面分享了很多使用 R 语言绘图的案例，为了方便大家学习和查阅，我把从这些案例中精选了 35 个汇编成了一本小册子：「使用 R 语言进行数据可视化：绘图案例合集（一）」&lt;/p&gt;
&lt;p&gt;该册子一共包含了 35 个 R 语言绘图的案例：&lt;/p&gt;
&lt;ol&gt;
      
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>Stata：如何为区县名称添加行政区划代码</title>
    <link href="https://tidyfriday.cn/posts/42578/"/>
    <id>https://tidyfriday.cn/posts/42578/</id>
    <published>2023-04-21T11:14:00.000Z</published>
    <updated>2023-04-21T15:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>在之前的课程「如何整理 2022 年县域统计年鉴：caj 文件转 pdf、文本识别与数据清洗」中我们讲解了如何从 caj 文件中提取表格数据的方法，今天我们再来学习下如何根据区县名称匹配行政区划代码，另外在该过程中还可以检查区县名称的识别错误。最后我们再使用整理得到的数据绘制一幅区县地图。</p><p>首先我们使用上次课的代码处理“整理结果3.xlsx”：</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">&quot;~/Desktop/Stata：如何为区县名称添加行政区划代码&quot;</span> </span><br><span class="line"><span class="comment">*- 处理 “整理结果3.xlsx”</span></span><br><span class="line">import excel using <span class="string">&quot;整理结果3.xlsx&quot;</span>, <span class="keyword">clear</span> </span><br><span class="line">carryforward A, <span class="keyword">replace</span> </span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">if</span> <span class="built_in">missing</span>(<span class="keyword">D</span>) &amp; <span class="built_in">missing</span>(<span class="keyword">E</span>) &amp; <span class="built_in">missing</span>(F) <span class="comment">///</span></span><br><span class="line">    &amp; <span class="built_in">missing</span>(<span class="keyword">G</span>) &amp; <span class="built_in">missing</span>(<span class="keyword">H</span>) &amp; <span class="built_in">missing</span>(I) <span class="comment">///</span></span><br><span class="line">    &amp; <span class="built_in">missing</span>(J) &amp; <span class="built_in">missing</span>(K) &amp; <span class="built_in">missing</span>(<span class="keyword">L</span>)</span><br><span class="line"><span class="keyword">replace</span> B = <span class="built_in">subinstr</span>(B, <span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> B = <span class="built_in">subinstr</span>(B, <span class="string">&quot;,&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> B = <span class="built_in">subinstr</span>(B, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> B = <span class="built_in">subinstr</span>(B, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> B = <span class="built_in">subinstr</span>(B, <span class="string">&quot;~&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> B = <span class="built_in">subinstr</span>(B, <span class="string">&quot;・&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> B = <span class="built_in">subinstr</span>(B, <span class="string">&quot;，&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> B = <span class="built_in">subinstr</span>(B, <span class="string">&quot;、&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">if</span> B == <span class="string">&quot;&quot;</span> | B == <span class="string">&quot;一、基本情况行政区域面积&quot;</span> | B == <span class="string">&quot;一基本情况行政区域面积&quot;</span></span><br><span class="line"><span class="keyword">replace</span> B = <span class="string">&quot;提供住宿的民政服务机构床位数&quot;</span> <span class="keyword">if</span> <span class="comment">///</span></span><br><span class="line">    <span class="built_in">inlist</span>(B, <span class="string">&quot;提供住宿的民政0艮务机构床位数&quot;</span>, <span class="comment">///</span></span><br><span class="line">            <span class="string">&quot;提供住宿的民政服务机构床位数&quot;</span>, <span class="comment">///</span></span><br><span class="line">            <span class="string">&quot;提供住宿的民谢艮务机构床位数&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">replace</span> B = <span class="string">&quot;提供住宿的民政服务机构&quot;</span> <span class="keyword">if</span> <span class="comment">///</span></span><br><span class="line">    <span class="built_in">inlist</span>(B, <span class="string">&quot;提供住宿的民呦艮务机构&quot;</span>, <span class="comment">///</span></span><br><span class="line">            <span class="string">&quot;提供住宿的民政^务机构&quot;</span>, <span class="comment">///</span></span><br><span class="line">            <span class="string">&quot;提供住宿的民斑艮务机构&quot;</span>, <span class="comment">///</span></span><br><span class="line">            <span class="string">&quot;提供住宿的民班艮务机构&quot;</span>)</span><br><span class="line"><span class="keyword">drop</span> C </span><br><span class="line"><span class="keyword">gen</span> z = _n <span class="keyword">if</span> B == <span class="string">&quot;指标&quot;</span></span><br><span class="line"><span class="keyword">order</span> z </span><br><span class="line">carryforward z, <span class="keyword">replace</span></span><br><span class="line">gather <span class="keyword">D</span> - <span class="keyword">L</span> </span><br><span class="line">spread B value </span><br><span class="line"><span class="keyword">order</span> z A 指标 </span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">if</span> <span class="built_in">missing</span>(指标) </span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">var</span> </span><br><span class="line"><span class="keyword">destring</span>, <span class="keyword">replace</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">*- 删除辅助变量 z</span></span><br><span class="line"><span class="keyword">drop</span> z </span><br><span class="line"></span><br><span class="line"><span class="keyword">ren</span> A 省</span><br><span class="line"><span class="keyword">ren</span> 指标 县</span><br><span class="line"><span class="keyword">order</span> 省 县 行政区域面积 乡 镇 街道办事处 户籍人口 <span class="comment">///</span></span><br><span class="line">    地区生产总值 第一产业增加值 第二产业增加值 第三产业增加值 <span class="comment">///</span></span><br><span class="line">    地方一般公共预算收入 地方一般公共预算支出 住户存款余额 <span class="comment">///</span></span><br><span class="line">    年末金融机构各项贷款余额 设施农业种植占地面积 油料产量 <span class="comment">///</span></span><br><span class="line">    棉花产量 规模以上工业企业 固定电话用户 普通中学在校学生 <span class="comment">///</span></span><br><span class="line">    小学在校学生 医疗卫生机构床位 提供住宿的民政服务机构 <span class="comment">///</span></span><br><span class="line">    提供住宿的民政服务机构床位数</span><br><span class="line"></span><br><span class="line"><span class="comment">*- 紧凑数据</span></span><br><span class="line"><span class="keyword">foreach</span> i of <span class="keyword">varlist</span> _all &#123;</span><br><span class="line">    <span class="keyword">cap</span> <span class="keyword">format</span> <span class="symbol">`i&#x27;</span> %10s</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">save</span> data4, <span class="keyword">replace</span> </span><br></pre></td></tr></table></figure><p>由于之前我分享的县域统计年鉴数据都是使用的 2020 年行政区划代码，所以这次我们也同样。</p><p>2020 年行政区划代码可以从地理矢量数据得到（为了方便绘制地图）：</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="comment">*- 由于之前的县域数据都是使用的 2020 年行政区划代码，所以这次我们依然使用 2020 的：</span></span><br><span class="line">shp2dta using <span class="string">&quot;2020行政区划/县.shp&quot;</span>, database(countydb) coordinates(countycoord) <span class="keyword">replace</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> countydb, <span class="keyword">clear</span> </span><br><span class="line"><span class="keyword">keep</span> 省 省代码 市 市代码 县 县代码 </span><br><span class="line"><span class="keyword">order</span> 省 省代码 市 市代码 县 县代码 </span><br><span class="line"><span class="comment">*- 查看 省-县 的组合有无重复的</span></span><br><span class="line"><span class="keyword">duplicates</span> tag 省 县, <span class="keyword">gen</span>(tags) </span><br><span class="line"><span class="keyword">gsort</span> -tags </span><br><span class="line"></span><br><span class="line"><span class="comment">*- 这些重复的可能会影响下一步的匹配，所以先删除了</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">if</span> tags &gt; 0 </span><br><span class="line"><span class="keyword">drop</span> tags</span><br><span class="line"><span class="keyword">save</span> countycode1, <span class="keyword">replace</span> </span><br></pre></td></tr></table></figure><p>首先匹配下看看能成功多少：</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> data4, <span class="keyword">clear</span> </span><br><span class="line"><span class="keyword">merge</span> 1:1 省 县 using countycode1 </span><br><span class="line"></span><br><span class="line"><span class="comment">*&gt; Result                      Number of obs</span></span><br><span class="line"><span class="comment">*&gt; -----------------------------------------</span></span><br><span class="line"><span class="comment">*&gt; Not matched                         1,116</span></span><br><span class="line"><span class="comment">*&gt;     from master                       171  (_merge==1)</span></span><br><span class="line"><span class="comment">*&gt;     from using                        945  (_merge==2)</span></span><br><span class="line"><span class="comment">*&gt; </span></span><br><span class="line"><span class="comment">*&gt; Matched                             1,917  (_merge==3)</span></span><br><span class="line"><span class="comment">*&gt; -----------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*- 检查没有匹配成功的</span></span><br><span class="line"><span class="keyword">keep</span> <span class="keyword">if</span> _m == 1 </span><br></pre></td></tr></table></figure><p>可以看到很多是由于空格和杂乱字符导致的匹配失败，所以我们先去除：</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> data4, <span class="keyword">clear</span> </span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="built_in">subinstr</span>(县, <span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="built_in">subinstr</span>(县, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="built_in">subinstr</span>(县, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"></span><br><span class="line"><span class="keyword">merge</span> 1:1 省 县 using countycode1 </span><br><span class="line"><span class="keyword">keep</span> <span class="keyword">if</span> _m == 1</span><br><span class="line"></span><br><span class="line"><span class="comment">*&gt; Result                      Number of obs</span></span><br><span class="line"><span class="comment">*&gt; -----------------------------------------</span></span><br><span class="line"><span class="comment">*&gt; Not matched                           946</span></span><br><span class="line"><span class="comment">*&gt;     from master                        86  (_merge==1)</span></span><br><span class="line"><span class="comment">*&gt;     from using                        860  (_merge==2)</span></span><br><span class="line"><span class="comment">*&gt; </span></span><br><span class="line"><span class="comment">*&gt; Matched                             2,002  (_merge==3)</span></span><br><span class="line"><span class="comment">*&gt; -----------------------------------------</span></span><br></pre></td></tr></table></figure><p>可以看到这个时候匹配不成功的（<code>_merge==1</code>）就不是很多了，下面我们需要结合百度和 countycode1.dta 来逐个检查修正：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421232906.png" alt=""></p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="comment">*- 然后就要一个个修改了</span></span><br><span class="line"><span class="keyword">replace</span> 省 = <span class="string">&quot;江苏省&quot;</span> <span class="keyword">if</span> 县 == <span class="string">&quot;浦口区&quot;</span></span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="string">&quot;勐腊县&quot;</span> <span class="keyword">if</span> 县 == <span class="string">&quot;^腊县&quot;</span></span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="string">&quot;勐海县&quot;</span> <span class="keyword">if</span> 县 == <span class="string">&quot;劭海县&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*- 此处省略部分代码，详情可以参考附件中的 main.do </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="string">&quot;湟源县&quot;</span> <span class="keyword">if</span> 县 == <span class="string">&quot;潼源县&quot;</span></span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="string">&quot;大箐山县&quot;</span> <span class="keyword">if</span> 县 == <span class="string">&quot;大箸山县&quot;</span></span><br></pre></td></tr></table></figure><p>然后重新匹配试试：</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="comment">*- 重新匹配试试</span></span><br><span class="line"><span class="keyword">use</span> data4, <span class="keyword">clear</span> </span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="built_in">subinstr</span>(县, <span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="built_in">subinstr</span>(县, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="built_in">subinstr</span>(县, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;&quot;</span>, .)</span><br><span class="line"><span class="keyword">replace</span> 省 = <span class="string">&quot;江苏省&quot;</span> <span class="keyword">if</span> 县 == <span class="string">&quot;浦口区&quot;</span></span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="string">&quot;勐腊县&quot;</span> <span class="keyword">if</span> 县 == <span class="string">&quot;^腊县&quot;</span></span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="string">&quot;勐海县&quot;</span> <span class="keyword">if</span> 县 == <span class="string">&quot;劭海县&quot;</span></span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="string">&quot;双江拉祜族佤族布朗族傣族自治县&quot;</span> <span class="keyword">if</span> 县 == <span class="string">&quot;双江拉祜族值族布朗族傣族自治县&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*- 此处省略部分代码，详情可以参考附件中的 main.do </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">replace</span> 县 = <span class="string">&quot;大箐山县&quot;</span> <span class="keyword">if</span> 县 == <span class="string">&quot;大箸山县&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">merge</span> 1:1 省 县 using countycode1 </span><br><span class="line"><span class="keyword">order</span> 省 省代码 市 市代码 县 县代码 </span><br><span class="line"><span class="keyword">keep</span> <span class="keyword">if</span> _m == 3</span><br><span class="line"><span class="keyword">drop</span> _m </span><br><span class="line"><span class="keyword">destring</span> 县代码, <span class="keyword">replace</span> </span><br><span class="line"><span class="keyword">save</span> data5, <span class="keyword">replace</span> </span><br></pre></td></tr></table></figure><p>然后我们再对变量进行重命名（和之前年份的保持一致）：</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> data5, <span class="keyword">clear</span> </span><br><span class="line"><span class="keyword">gen</span> 年份 = 2021 </span><br><span class="line"><span class="keyword">replace</span> 乡 = 0 <span class="keyword">if</span> <span class="built_in">missing</span>(乡)</span><br><span class="line"><span class="keyword">replace</span> 镇 = 0 <span class="keyword">if</span> <span class="built_in">missing</span>(镇)</span><br><span class="line"><span class="keyword">gen</span> 乡镇个数_个 = 乡 + 镇</span><br><span class="line"><span class="keyword">ren</span> 乡 乡_个</span><br><span class="line"><span class="keyword">ren</span> 镇 镇_个</span><br><span class="line"><span class="keyword">ren</span> 行政区域面积 行政区域土地面积_平方公里</span><br><span class="line"><span class="keyword">ren</span> 街道办事处 街道办事处个数_个</span><br><span class="line"><span class="keyword">ren</span> 户籍人口 户籍人口_人</span><br><span class="line"><span class="keyword">ren</span> 地区生产总值 国内生产总值_万元</span><br><span class="line"><span class="keyword">ren</span> 第一产业增加值 第一产业增加值_万元</span><br><span class="line"><span class="keyword">ren</span> 第二产业增加值 第二产业增加值_万元</span><br><span class="line"><span class="keyword">ren</span> 第三产业增加值 第三产业增加值_万元</span><br><span class="line"><span class="keyword">ren</span> 地方一般公共预算收入 一般公共预算收入_万元</span><br><span class="line"><span class="keyword">ren</span> 地方一般公共预算支出 一般公共预算支出_万元</span><br><span class="line"><span class="keyword">ren</span> 住户存款余额 住户储蓄存款余额_万元</span><br><span class="line"><span class="keyword">ren</span> 年末金融机构各项贷款余额 年末各项贷款余额_万元</span><br><span class="line"><span class="keyword">ren</span> 设施农业种植占地面积 设施农业占地面积_公顷</span><br><span class="line"><span class="keyword">ren</span> 油料产量 油料产量_吨</span><br><span class="line"><span class="keyword">ren</span> 棉花产量 棉花产量_吨</span><br><span class="line"><span class="keyword">ren</span> 规模以上工业企业 规模以上工业企业个数_个</span><br><span class="line"><span class="keyword">ren</span> 固定电话用户 固定电话用户_户</span><br><span class="line"><span class="keyword">ren</span> 普通中学在校学生 普通中学在校学生_人</span><br><span class="line"><span class="keyword">ren</span> 小学在校学生 小学在校学生数_人</span><br><span class="line"><span class="keyword">ren</span> 医疗卫生机构床位 医疗卫生机构床位_床</span><br><span class="line"><span class="keyword">ren</span> 提供住宿的民政服务机构 提供住宿的社会工作机构_个</span><br><span class="line"><span class="keyword">ren</span> 提供住宿的民政服务机构床位数 提供住宿的社会工作机构床位_床</span><br><span class="line"><span class="keyword">label</span> data <span class="string">&quot;整理：微信公众号 RStata&quot;</span></span><br><span class="line"><span class="keyword">save</span> <span class="string">&quot;2021年县市社会经济指标.dta&quot;</span>, <span class="keyword">replace</span> </span><br></pre></td></tr></table></figure><p>最后如果你想把该数据和之前年份的合并起来，只需要 use 之前年份的数据，然后 <code>append using &quot;2021年县市社会经济指标.dta&quot;</code> 即可。</p><p>最后我们再使用该数据绘制一幅区县地图：</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="comment">*- 把 “2021年县市社会经济指标.dta” 文件放到 “使用Stata绘制中国县级地图（版本2020mini）” 文件夹里面：</span></span><br><span class="line"><span class="keyword">cd</span> <span class="string">&quot;使用Stata绘制中国县级地图（版本2020mini）&quot;</span></span><br><span class="line"><span class="keyword">use</span> chinacounty2020mini_db.dta, <span class="keyword">clear</span> </span><br><span class="line"><span class="keyword">destring</span> 县代码, <span class="keyword">replace</span> </span><br><span class="line"><span class="keyword">merge</span> 1:1 省 省代码 市 市代码 县 县代码 using 2021年县市社会经济指标.dta</span><br><span class="line"></span><br><span class="line"><span class="keyword">replace</span> 国内生产总值_万元 = 国内生产总值_万元/10000</span><br><span class="line"></span><br><span class="line"><span class="comment">*- 市辖区的值使用该城市的平均值代替</span></span><br><span class="line"><span class="keyword">bysort</span> 省 省代码 市 市代码: <span class="keyword">egen</span> <span class="keyword">mean</span> = <span class="keyword">mean</span>(国内生产总值_万元)</span><br><span class="line"><span class="keyword">replace</span> 国内生产总值_万元 = <span class="keyword">mean</span> <span class="keyword">if</span> <span class="built_in">missing</span>(国内生产总值_万元) </span><br><span class="line"></span><br><span class="line"><span class="comment">*- 仍然缺失的使用该省的均值代替</span></span><br><span class="line"><span class="keyword">bysort</span> 省 省代码 : <span class="keyword">egen</span> mean2 = <span class="keyword">mean</span>(国内生产总值_万元)</span><br><span class="line"><span class="keyword">replace</span> 国内生产总值_万元 = mean2 <span class="keyword">if</span> <span class="built_in">missing</span>(国内生产总值_万元) </span><br><span class="line"></span><br><span class="line"><span class="comment">*- 仍然缺失的替换成 -1 </span></span><br><span class="line"><span class="keyword">replace</span> 国内生产总值_万元 = -1 <span class="keyword">if</span> <span class="built_in">missing</span>(国内生产总值_万元) </span><br><span class="line"></span><br><span class="line"><span class="comment">*- 绘图</span></span><br><span class="line"><span class="comment">*- 农林牧渔业人口占比 </span></span><br><span class="line">nicecut 国内生产总值_万元, <span class="keyword">n</span>(8) unit(亿元) </span><br><span class="line">grmap 国内生产总值_万元 using chinacounty2020mini_coord.dta, <span class="comment">/// </span></span><br><span class="line">    id(ID) osize(vvthin ...) ocolor(white ...) <span class="comment">/// </span></span><br><span class="line">    clmethod(custom) clbreaks(`<span class="built_in">r</span>(cutpoints)&#x27;) <span class="comment">/// </span></span><br><span class="line">    fcolor(gray <span class="string">&quot;255 198 196&quot;</span> <span class="string">&quot;244 163 168&quot;</span> <span class="string">&quot;227 129 145&quot;</span> <span class="comment">/// </span></span><br><span class="line">        <span class="string">&quot;204 96 125&quot;</span> <span class="string">&quot;173 70 108&quot;</span> <span class="string">&quot;139 48 88&quot;</span> <span class="string">&quot;103 32 68&quot;</span>) <span class="comment">/// </span></span><br><span class="line">    graphr(margin(medium)) <span class="comment">/// </span></span><br><span class="line">    leg(<span class="keyword">order</span>(`<span class="built_in">r</span>(legorder)&#x27;)) <span class="comment">/// </span></span><br><span class="line">    <span class="keyword">line</span>(data(chinaprov2020mini_line_coord2.dta) <span class="keyword">by</span>(group) <span class="comment">/// </span></span><br><span class="line">        size(vvthin *1 *0.5 *0.5 *0.5) pattern(solid ...) <span class="comment">/// </span></span><br><span class="line">        select(<span class="keyword">drop</span> <span class="keyword">if</span> <span class="built_in">inlist</span>(group, 4, 7)) <span class="comment">///</span></span><br><span class="line">        color(gs20 <span class="comment">/// 省界颜色 </span></span><br><span class="line">              black <span class="comment">/// 国界线颜色 </span></span><br><span class="line">              <span class="string">&quot;0 85 170&quot;</span> <span class="comment">/// 海岸线颜色 </span></span><br><span class="line">              black <span class="comment">/// 小地图框格颜色</span></span><br><span class="line">              black <span class="comment">/// 比例尺和指北针颜色</span></span><br><span class="line">              )) <span class="comment">/// </span></span><br><span class="line">    polygon(data(polygon2) fcolor(black) <span class="comment">///</span></span><br><span class="line">        osize(vvthin)) <span class="comment">///</span></span><br><span class="line">    <span class="keyword">label</span>(data(chinacounty2020mini_label2) x(X) <span class="built_in">y</span>(Y) <span class="keyword">label</span>(cname) <span class="built_in">length</span>(20) size(*0.8)) <span class="comment">///</span></span><br><span class="line">    ti(<span class="string">&quot;2021 年中国各县地区生产总值&quot;</span>) <span class="comment">/// </span></span><br><span class="line">    subti(<span class="string">&quot;数据整理 &amp; 绘制：微信公众号 RStata&quot;</span>) <span class="comment">///</span></span><br><span class="line">    caption(<span class="string">&quot;数据来源：2022 年中国县域统计年鉴&quot;</span>, size(*0.8))</span><br><span class="line"></span><br><span class="line"><span class="keyword">gr</span> export <span class="string">&quot;2021年中国各县地区生产总值.png&quot;</span>, <span class="keyword">replace</span> width(2400) </span><br></pre></td></tr></table></figure><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230421232921.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在之前的课程「如何整理 2022 年县域统计年鉴：caj 文件转 pdf、文本识别与数据清洗」中我们讲解了如何从 caj 文件中提取表格数据的方法，今天我们再来学习下如何根据区县名称匹配行政区划代码，另外在该过程中还可以检查区县名称的识别错误。最后我们再使用整理得到的数据绘
      
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>我的收藏夹（第二期）</title>
    <link href="https://tidyfriday.cn/posts/42273/"/>
    <id>https://tidyfriday.cn/posts/42273/</id>
    <published>2022-12-18T14:52:00.000Z</published>
    <updated>2023-04-21T15:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>电脑里面收藏夹里面收藏了很多网页，但是经常懒得翻看，而且难以检索，所以整理下都放到这里。</p><span id="more"></span><h2 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h2><ul><li><a href="https://mhdb.mh.sinica.edu.tw/foodprice/result2.php?allYear=1&AreaIDSelect1=ZL&AreaNextSelect1=all&AreaIDSelect2=ZL&AreaNextSelect2=all&Grain1=R1&Grain2=WO&chart=2&ifContrast=none">清代糧價資料庫</a></li><li><a href="https://zenodo.org/record/5210928#.Y8eTrewzbao">The 30 m annual land cover datasets and its dynamics in China from 1990 to 2020</a></li><li><a href="https://zenodo.org/record/6449937#.Y8eT2ewzbap">ChinaHighPM10: Big Data Seamless 1 km Ground-level PM10 Dataset for China</a></li><li><a href="https://zenodo.org/record/6622056#.Y8eT1Owzbap">ChinaHighNO2: Big Data Seamless 1 km Ground-level NO2 Dataset for China</a></li><li><a href="https://zenodo.org/record/4009308#.Y8eT2-xBzap">Full-coverage 1 km daily ambient PM2.5 and O3 concentrations of China in 2005-2017 based on multi-variable random forest model</a></li><li><a href="https://zenodo.org/record/6398971#.Y8eT3uxBzar">ChinaHighPM2.5: Big Data Seamless 1 km Ground-level PM2.5 Dataset for China</a></li><li><a href="https://news.ceic.ac.cn/index.html?time=1663771472">中国地震台网</a></li><li><a href="https://download.cbdb.inindex.com/login.html">中国历代人物传记资料库</a></li><li><a href="https://www.semanticscholar.org/paper/An-extended-time-series-(2000%E2%80%932018)-of-global-light-Chen-Yu/2b9e31fd0340e205f372c539282397e591070d01">An extended time series (2000–2018) of global NPP-VIIRS-like nighttime light data from a cross-sensor calibration</a></li><li><a href="https://kgo.ckcest.cn/kgo/list?dbId=4004&word=&shortName=ALL&page=16&order=1">资源检索 - 中国工程科技知识中心</a></li><li><a href="https://kgo.ckcest.cn/kgo/detail/4004/dw_dataset/C96E345D62900001E02A155F5982D160.html">排污许可证企业信息数据集（2017-2021）</a></li><li><a href="https://ourworldindata.org/carbon-pricing">Which countries have put a price on carbon?</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118150102.png" alt=""></p><ul><li><a href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/">Natural Earth » 1:10m Cultural Vectors - Free vector and raster map data at 1:10m, 1:50m, and 1:110m scales</a></li><li><a href="https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_data/csse_covid_19_daily_reports">COVID-19 全球数据</a></li><li><a href="https://ourworldindata.org/covid-sources-comparison">COVID-19 deaths and cases: how do sources compare?</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/1223442.png" alt=""></p><ul><li><a href="https://github.com/owid/covid-19-data">COVID-19 Dataset by Our World in Data</a></li><li><a href="https://github.com/FutureSharks/financial-data">FutureSharks/financial-data: Intraday 1 minute pricing data for S&amp;P 500, NIKKEI 225, DAX 30 and more</a></li></ul><h2 id="书籍"><a href="#书籍" class="headerlink" title="书籍"></a>书籍</h2><ul><li><a href="https://r-spatial.org/book/">Spatial Data Science with applications in R</a></li><li><a href="https://geobgu.xyz/r/">使用 R 进行空间数据编程简介</a></li><li><a href="https://www.bigbookofr.com/index.html">Big Book of R</a>：各种 R 语言数据汇总</li><li><a href="https://www.paulamoraga.com/book-geospatial/">Geospatial Health Data: Modeling and Visualization with R-INLA and Shiny</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118144351.png" alt=""></p><ul><li><a href="https://flowingdata.com/2021/08/13/maps-of-racial-population-change/">Maps of racial population change</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118145514.png" alt=""></p><ul><li><p><a href="https://www.tmwr.org/#">Tidy Modeling with R</a></p></li><li><p><a href="https://smltar.com/">Supervised Machine Learning for Text Analysis in R</a></p></li><li><p><a href="https://bookdown.org/max/FES/">Feature Engineering and Selection: A Practical Approach for Predictive Modelsv</a></p></li><li><p><a href="https://www.tidytextmining.com/">Text Mining with R</a></p></li><li><p><a href="https://github.com/edzer/sdsr">edzer/sdsr: Spatial Data Science, with applications in R</a></p></li><li><p><a href="https://r-spatial.org/book/">Spatial Data Science</a></p></li><li><p><a href="https://moderndive.com/">Statistical Inference via Data Science</a></p></li><li><p><a href="https://plotly-r.com/">Interactive web-based data visualization with R, plotly, and shiny</a></p></li><li><p><a href="http://132.72.155.230:3838/r/">R 空间数据编程简介</a></p></li><li><p><a href="https://tmieno2.github.io/R-as-GIS-for-Economists/">R as GIS for Economists</a></p></li><li><p><a href="https://ryo-n7.github.io/2020-05-14-webscrape-soccer-data-with-R/">Intro to {polite} Web Scraping of Soccer Data with R!</a></p></li><li><p><a href="https://mgimond.github.io/Spatial/index.html">Intro to GIS and Spatial Analysis</a></p></li></ul><h2 id="R-语言"><a href="#R-语言" class="headerlink" title="R 语言"></a>R 语言</h2><ul><li><a href="https://github.com/erikgahner/awesome-ggplot2">awesome-ggplot2: A curated list of awesome ggplot2 tutorials, packages etc.</a>：ggplot2 的一些教程、包等。</li><li><a href="https://github.com/mattflor/chorddiag">mattflor/chorddiag: R interface to D3 chord diagrams</a>：基于 D3.js 绘制和弦图的 R 包</li></ul><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># devtools::install_github(&quot;mattflor/chorddiag&quot;)</span></span><br><span class="line">library<span class="punctuation">(</span>chorddiag<span class="punctuation">)</span></span><br><span class="line">m <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">11975</span><span class="punctuation">,</span>  <span class="number">5871</span><span class="punctuation">,</span> <span class="number">8916</span><span class="punctuation">,</span> <span class="number">2868</span><span class="punctuation">,</span></span><br><span class="line">              <span class="number">1951</span><span class="punctuation">,</span> <span class="number">10048</span><span class="punctuation">,</span> <span class="number">2060</span><span class="punctuation">,</span> <span class="number">6171</span><span class="punctuation">,</span></span><br><span class="line">              <span class="number">8010</span><span class="punctuation">,</span> <span class="number">16145</span><span class="punctuation">,</span> <span class="number">8090</span><span class="punctuation">,</span> <span class="number">8045</span><span class="punctuation">,</span></span><br><span class="line">              <span class="number">1013</span><span class="punctuation">,</span>   <span class="number">990</span><span class="punctuation">,</span>  <span class="number">940</span><span class="punctuation">,</span> <span class="number">6907</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            byrow <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span></span><br><span class="line">            nrow <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">haircolors <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;black&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blonde&quot;</span><span class="punctuation">,</span> <span class="string">&quot;brown&quot;</span><span class="punctuation">,</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dimnames</span><span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>have <span class="operator">=</span> haircolors<span class="punctuation">,</span></span><br><span class="line">                    prefer <span class="operator">=</span> haircolors<span class="punctuation">)</span></span><br><span class="line">m</span><br><span class="line">groupColors <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#000000&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#FFDD89&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#957244&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#F26223&quot;</span><span class="punctuation">)</span></span><br><span class="line">chorddiag<span class="punctuation">(</span>m<span class="punctuation">,</span> groupColors <span class="operator">=</span> groupColors<span class="punctuation">,</span> groupnamePadding <span class="operator">=</span> <span class="number">20</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/pic57878979.png" alt=""></p><ul><li><a href="https://github.com/jmcastagnetto/ggplot2_themes_in_github">jmcastagnetto/ggplot2_themes_in_github: A generated list of repos containing themes/styles for ggplot2</a>：ggplot2 的绘图主题列表。</li><li><a href="https://damianobaldan.github.io/riverconn_tutorial/">Tutorial to create igraph objects from spatial data and calculate fragmentation indices with riverconn</a>：从空间数据创建 igraph 对象并使用 riverconn 计算碎片指数的教程</li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20221218151533.png" alt=""></p><ul><li><a href="https://github.com/r-lib/pillar">r-lib/pillar: Format columns with colour</a></li><li><a href="https://r-spatial.org//r/2022/09/13/zarr.html">Reading Zarr files with R package stars</a></li><li><a href="https://github.com/doehm/cropcircles">Crop an image into a circle with a transparent background.</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118145014.png" alt=""></p><ul><li><a href="https://github.com/dieghernan/tidyterra">tidyterra: tidyverse and ggplot2 methods for terra spatial objects</a></li><li><a href="https://github.com/rCarto/spikemap">rCarto/spikemap: Maps made of spikes</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118145255.png" alt=""></p><ul><li><a href="https://github.com/wenyalintw/Google-Patents-Scraper">wenyalintw/Google-Patents-Scraper：自动下载所有在 Google Patents 上找到的搜索结果及其专利家族的 PDF 文件。</a></li><li><a href="https://neal.fun/size-of-space/">The Size of Space</a></li><li><a href="https://www.brodrigues.co/blog/2018-10-05-ggplot2_purrr_officer/">Exporting editable plots from R to Powerpoint: making ggplot2 purrr with officer</a></li><li><a href="https://www.tidymodels.org/learn/statistics/k-means/">K-means clustering with tidy data principles</a></li><li><a href="https://github.com/igjit/nrc">igjit/nrc: A toy R compiler in R</a></li><li><a href="https://www.r-graph-gallery.com/">The R Graph Gallery – Help and inspiration for R charts</a></li><li><a href="https://github.com/yonicd/shinycarbon">yonicd/shinycarbon</a></li><li><a href="https://github.com/stemangiola/tidyHeatmap">stemangiola/tidyHeatmap: Draw heatmap simply using a tidy data frame</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118152126.png" alt=""></p><ul><li><p><a href="https://github.com/fmmattioni/downloadthis">fmmattioni/downloadthis: Implement Download Buttons in RMarkdown 💾</a></p></li><li><p><a href="https://codingclubuc3m.rbind.io/post/2020-03-03/">Displaying time series with R</a></p></li><li><p><a href="https://github.com/rCarto/osrm">rCarto / osrm：OpenStreetMap的最短路径和行驶时间</a></p></li><li><p><a href="https://www.data-imaginist.com/2019/gganimate-has-transitioned-to-a-state-of-release/">gganimate has transitioned to a state of release</a></p></li></ul><p><img src="https://d33wubrfki0l68.cloudfront.net/f8ef24ce8c786f79fc1e65ea28b71f534cc77dd9/11319/post/2019-01-02-gganimate-has-transitioned-to-a-state-of-release_files/figure-html/unnamed-chunk-6-1.gif" alt=""></p><ul><li><p><a href="https://github.com/JoshOBrien/rasterDT/">JoshOBrien/rasterDT: fast alternatives to raster package functions.</a></p></li><li><p><a href="https://github.com/isciences/exactextractr">exactextractr is an R package that quickly and accurately summarizes raster values over polygonal areas.</a></p></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118220527.png" alt=""></p><ul><li><a href="https://github.com/coolbutuseless/ggthreed">ggthreed - 3d geoms and stats for ggplot2</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118220609.png" alt=""></p><ul><li><a href="https://www.business-science.io/time-series/2020/03/18/time-series-machine-learning.html">Time Series Machine Learning (and Feature Engineering) in R</a></li><li><a href="https://github.com/brodieG/ggbg">ggbg - Assorted Ggplot Extensions</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118220810.png" alt=""></p><ul><li><a href="https://github.com/coolbutuseless/devoutsvg">coolbutuseless/devoutsvg: Bespoke SVG graphics output device with pattern fill support</a></li><li><a href="https://cran.r-project.org/web/packages/cartography/vignettes/cartography.html">cartography</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118220911.png" alt=""></p><ul><li><a href="https://joshuacook.netlify.app/post/tidygraph-oncotree/">OncoTree Tidygraph | Joshua Cook</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118221056.png" alt=""></p><ul><li><a href="https://github.com/dr-harper/ggmapstyles">dr-harper/ggmapstyles: 🗺️ An R package to easily style ggmap basemaps with over 20,000 designs from Snazzy Maps</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118221358.png" alt=""></p><ul><li><a href="https://github.com/hrbrmstr/imago">hrbrmstr/imago: 🗺Hacky World Map GeoJSON Based on the Imago Projection</a></li><li><a href="https://github.com/benjaminguinaudeau/tidyweb">Use tidy data principles to interact with HTML files!</a></li><li><a href="https://coolbutuseless.github.io/package/ggpattern/articles/geom-gallery-geometry.html#geom-map-pattern-">Geom Gallery - Geometry-based Patterns • ggpattern</a></li><li><a href="https://github.com/delabj/ggCyberPunk">delabj/ggCyberPunk: Working on creating a similar cyberpunk geom for ggplot</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118222308.png" alt=""></p><ul><li><a href="https://github.com/sharlagelfand/ggcute">sharlagelfand/ggcute: Cute things for ggplot2.</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118222356.png" alt=""></p><ul><li><a href="https://github.com/giocomai/ganttrify">giocomai/ganttrify: Create beautiful Gantt charts with ggplot2</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118222616.png" alt=""></p><ul><li><a href="https://github.com/mdsumner/plusraster">mdsumner/plusraster: A sandbox for me to learn ggplot2 and bring GDAL lazy data read to a geom</a></li><li><a href="https://github.com/statsmaths/ggmaptile">statsmaths/ggmaptile: Add Map Images from a Tile Server with ggplot2</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118222729.png" alt=""></p><ul><li><a href="https://docs.ropensci.org/baRcodeR/">Label Creation for Tracking and Collecting Data from Biological Samples • rOpenSci: baRcodeR</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118223030.png" alt=""></p><ul><li><a href="https://www.tidyverse.org/blog/2020/04/dplyr-1-0-0-rowwise/">dplyr 1.0.0: working within rows</a></li><li><a href="https://github.com/rileytwo/daRkStudio">rileytwo/daRkStudio: daRkStudio. Dark RStudio theme</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118223700.png" alt=""></p><ul><li><a href="https://www.jumpingrivers.com/blog/r-knitr-markdown-png-pdf-graphics/">Setting the Graphics Device in a RMarkdown Document - Jumping Rivers</a></li></ul><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">knitr<span class="operator">::</span>opts_chunk<span class="operator">$</span>set<span class="punctuation">(</span>dev <span class="operator">=</span> <span class="string">&quot;cairo_pdf&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><ul><li><a href="https://www.data-imaginist.com/2019/the-ggforce-awakens-again/">The ggforce Awakens (again)</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118224148.png" alt=""></p><ul><li><a href="https://cran.r-project.org/web/packages/gghighlight/vignettes/gghighlight.html">Introduction to gghighlight</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118224227.png" alt=""></p><ul><li><a href="https://github.com/IndrajeetPatil/ggstatsplot">IndrajeetPatil/ggstatsplot: Enhancing <code>ggplot2</code> plots with statistical analysis 📊🎨📣</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118224309.png" alt=""></p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118224324.png" alt=""></p><ul><li><a href="https://github.com/plotly/rasterly">plotly/rasterly: Rapidly generate raster images from large datasets in R &amp; Plotly</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118224437.png" alt=""></p><ul><li><a href="https://github.com/datagistips/geosparklines">datagistips/geosparklines: An R Package to put SparkLines on a Map</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118224505.png" alt=""></p><ul><li><a href="https://www.jumpingrivers.com/blog/r-graphics-cairo-png-pdf-saving/">Saving R Graphics across OSs - Jumping Rivers</a></li><li><a href="https://jakubnowosad.com/whyr_webinar004/#1">Recent changes in R spatial and how to be ready for them</a></li><li><a href="https://docs.ropensci.org/stplanr/">Sustainable Transport Planning • rOpenSci: stplanr</a></li><li><a href="https://docs.ropensci.org/stplanr/articles/stplanr-od.html">Origin-destination data with stplanr • rOpenSci: stplanr</a></li><li><a href="https://www.tylermw.com/a-step-by-step-guide-to-making-3d-maps-with-satellite-imagery-in-r/">A Step-by-Step Guide to Making 3D Maps with Satellite Imagery in R</a></li><li><a href="https://colinfay.me/node-r-package/">How to Write an R Package Wrapping a NodeJS Module - Colin Fay</a></li><li><a href="https://tidyfun.github.io/tidyfun/">Tools for Tidy Functional Data • tidyfun</a></li><li><a href="https://www.business-science.io/code-tools/2020/06/29/introducing-modeltime.html">Introducing Modeltime: Tidy Time Series Forecasting using Tidymodels</a></li><li><a href="https://github.com/SebKrantz/collapse">SebKrantz/collapse: Advanced and Fast Data Transformation in R</a></li><li><a href="http://r.iresmi.net/2020/05/26/polygons-to-hexagons/">多边形到六边形– r.iresmi.net</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118232317.png" alt=""></p><h2 id="效率工具"><a href="#效率工具" class="headerlink" title="效率工具"></a>效率工具</h2><ul><li><p><a href="http://tmtheme-editor.herokuapp.com/#!/editor/theme/FrontEndDelight">TmTheme Editor</a>：Sublime Text 的主题文件编辑器，也可以用来生成 RStudio 的。</p></li><li><p><a href="https://tidyfriday.cn/colorpicker/">在线传图识色，自动识别图片色彩，提取图片主色调</a></p></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/pic345690.png" alt=""></p><ul><li><a href="https://neal.fun/baby-map/">Baby Map</a>：实时展示每时每刻哪些国家有孩子出生。</li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/pic89786.png" alt=""></p><ul><li><a href="https://curlconverter.com/r/">Convert curl to R</a></li><li><a href="https://shields.io/">Shields.io: Quality metadata badges for open source projects</a></li><li><a href="https://chenjunan.top/detail/Detail?id=24">DataGrip破解安装激活最新教程（附破解工具及激活码）</a></li><li><a href="https://albert-rapp.de/posts/ggplot2-tips/15_alternative_paired_bars/15_alternative_paired_bars.html">Alternatives to paired bar charts</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118150325.png" alt=""></p><ul><li><a href="https://www.piliang.tech/geocoding-amap">地理编码 (高德) 地址转经纬度 - 批量工具网</a></li><li><a href="https://convertio.co/zh/">Convertio — 文件转换器</a></li><li><a href="https://libgen.gs/">Library Genesis+</a></li><li><a href="https://www.pdfdrive.com/">PDF Drive - Search and download PDF files for free.</a></li><li><a href="https://waifu2x.udp.jp/">提高图片分辨率</a></li><li><a href="https://graphhopper.com/maps/?point=32.892676%2C115.809_%E9%98%9C%E9%98%B3%E5%B8%82%2C+%E5%AE%89%E5%BE%BD%E7%9C%81%2C+%E4%B8%AD%E5%9B%BD&point=22.323619%2C114.158226&profile=bike&layer=OpenStreetMap">Driving Directions - GraphHopper Maps</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118225044.png" alt=""></p><ul><li><a href="https://www.garrickadenbuie.com/blog/shrtcts/">Make A Shortcut for Anything in RStudio with shrtcts</a></li><li><a href="https://www.analyzecore.com/2020/05/04/the-spread-of-covid-19-across-countries-visualization-with-r/">Worldwide COVID-19 spread visualization with R – AnalyzeCore by Sergey Bryl’ – data is beautiful, data is a story</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118225436.png" alt=""></p><ul><li><a href="https://github.com/djnavarro/voronoise">djnavarro/voronoise: Makes Artwork From Voronoi Tesselations</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20230118225658.png" alt=""></p><ul><li><a href="https://github.com/ecohealthalliance/fasterize">ecohealthalliance/fasterize: High performance raster conversion for modern spatial data 🚀🌏▦</a></li></ul><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul><li><a href="https://blog.csdn.net/qq_36631249/article/details/123423500">dbsake 恢复 Mysql 数据</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;电脑里面收藏夹里面收藏了很多网页，但是经常懒得翻看，而且难以检索，所以整理下都放到这里。&lt;/p&gt;
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>我的收藏夹（第一期）</title>
    <link href="https://tidyfriday.cn/posts/31852/"/>
    <id>https://tidyfriday.cn/posts/31852/</id>
    <published>2022-08-28T14:29:00.000Z</published>
    <updated>2022-09-03T15:22:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>电脑里面收藏夹里面收藏了很多网页，但是经常懒得翻看，而且难以检索，所以整理下都放到这里。</p><span id="more"></span><h2 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h2><ul><li><a href="https://data.tpdc.ac.cn/zh-hans/">国家青藏高原科学数据中心</a></li></ul><p>里面有很多非常好的地理、环境数据，例如平台上 <a href="https://rstata.duanshu.com/#/brief/course/46a01bdd4b144a1a811b6d2828a844f1">1984～2020 年中国各省市区县夜间灯光面板数据</a> 的原始栅格数据就是从这里下载的：<a href="https://data.tpdc.ac.cn/zh-hans/data/e755f1ba-9cd1-4e43-98ca-cd081b5a0b3e/?q=%E5%A4%9C%E9%97%B4%E7%81%AF%E5%85%89">中国长时间序列逐年人造夜间灯光数据集（1984-2020）</a></p><ul><li><a href="https://www.hydrosheds.org/about">HydroSHEDS data products</a>：全球水文数据集（流域、河网、湖泊等） </li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220828145842.png" alt=""></p><p>该数据是免费下载的，介绍可以参考这个推文：<a href="https://www.sohu.com/a/473136116_121123812">干货分享 | 全球水文数据集（流域、河网、湖泊等） </a></p><ul><li><p><a href="https://data.tpdc.ac.cn/zh-hans/data/b8c448ab-9c50-43fe-9b5d-2a5888658fe6/">全球逐日0.05°时空连续地表温度数据集（2002-2020）</a></p></li><li><p><a href="https://eogdata.mines.edu/products/vnl/">EOG 夜间灯光日度和月度数据下载</a></p></li><li><p><a href="https://data.tpdc.ac.cn/zh-hans/data/a9cd4a09-51a9-433b-9540-0376c6134cf6/?q=%E9%99%8D%E6%B0%B4%E9%87%8F">2021-2100年中国1km分辨率多情景多模式逐月降水量数据集</a></p></li><li><p><a href="https://db.cger.nies.go.jp/dataset/ODIAC/DL_odiac2020b.html">来自化石燃料燃烧、水泥生产和气体燃烧的CO2排放</a></p></li><li><p><a href="http://www.cbirc.gov.cn/cn/view/pages/ItemList.html?itemPId=923&itemId=931&itemUrl=zhengwuxinxi/xingzhengchufa.html&itemName=%E8%A1%8C%E6%94%BF%E5%A4%84%E7%BD%9A">中国银行保险监督管理委员会行政处罚数据</a></p></li><li><p><a href="https://data.tpdc.ac.cn/zh-hans/data/daa58689-a6d2-46cf-90fc-b73014ecef9d/">中国近地表日气温数据集（1979-2018）</a></p></li><li><p><a href="https://data.tpdc.ac.cn/zh-hans/data/faae7605-a0f2-4d18-b28f-5cee413766a2/?q=%E9%99%8D%E6%B0%B4%E9%87%8F">中国1km分辨率逐月降水量数据集（1901-2020）</a></p></li><li><p><a href="https://www.nature.com/articles/s41597-022-01240-6">1997-2017年中国市县级时空能源消耗与效率数据集</a></p></li><li><p><a href="https://covid19datahub.io/articles/data.html">COVID-19 全球数据下载</a></p></li><li><p><a href="https://www.nature.com/articles/s41597-022-01300-x#Sec15">Global gridded GDP data set consistent with the shared socioeconomic pathways</a></p></li><li><p><a href="https://www.nature.com/articles/s41597-022-01362-x">China industrial environmental database 1998–2015</a></p></li><li><p><a href="https://db.cger.nies.go.jp/dataset/ODIAC/DL_odiac2020b.html">CO2 emissions from fossil fuel combustion, cement production and gas flaring</a></p></li><li><p><a href="https://www.nature.com/articles/s41597-022-01300-x">Global gridded GDP data set consistent with the shared socioeconomic pathways</a></p></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220903185433.png" alt="Spatial distribution of GDP in 2005 at spatial resolutions of 1 km (a) and 0.25 arc-degrees (b). The units are 2005 PPP USD per cell."></p><ul><li><p><a href="https://www.nature.com/articles/s41597-022-01240-6">City- and county-level spatio-temporal energy consumption and efficiency datasets for China from 1997 to 2017</a></p></li><li><p><a href="https://www.nature.com/articles/s41597-022-01168-x#Sec15">Vectorized rooftop area data for 90 cities in China</a></p></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220903190157.png" alt=""></p><ul><li><p><a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/2PEPLH">农业生物多样性指数网格数据集</a></p></li><li><p><a href="https://github.com/earthlab/firedpy">全球各国每日火灾周界数据集</a></p></li><li><p><a href="https://www.nature.com/articles/s41597-022-01572-3">国家级火灾周界数据集 (2001–2021) | 科学数据</a></p></li><li><p><a href="https://www.nature.com/articles/s41597-022-01493-1">全球干旱指数和潜在蒸散数据库第 3 版 | 科学数据</a></p></li></ul><h2 id="书籍"><a href="#书籍" class="headerlink" title="书籍"></a>书籍</h2><ul><li><p><a href="https://www.econometrics-with-r.org/">Introduction to Econometrics with R</a>：一本介绍 R 语言中常见计量经济学模型实现方法的书。</p></li><li><p><a href="https://github.com/paezha/spatial-analysis-r">An Introduction to Spatial Data Analysis and Statistics: A Course in R</a>：地理数据分析与统计导论</p></li><li><p><a href="https://bookdown.org/xiangyun/msg/">现代统计图形：Modern Statistical Graphics</a></p></li><li><p><a href="https://geocompr.robinlovelace.net/index.html">Geocomputation with R</a>：使用 R 语言进行地理计算（平台上的 R 语言地理计算系列课程就是根据这本书开设的）</p></li><li><p><a href="https://bookdown.org/mcwimberly/gdswr-book/">Geospatial Data Science With R: Applications in Environmental Geography</a>：使用 R 的地理空间数据科学：在环境地理学中的应用 </p></li></ul><h2 id="R-语言"><a href="#R-语言" class="headerlink" title="R 语言"></a>R 语言</h2><ul><li><p><a href="https://github.com/exaexa/scattermore">exaexa/scattermore: very fast scatterplots for R</a>：R 语言中快速绘制散点图的方法，据作者描述，是基础方法的 20 倍速度。</p></li><li><p><a href="https://mages.github.io/googleVis/articles/googleVis_examples.html">googleVis examples • googleVis</a>：googleVis 包的使用案例，一个用以绘制交互式图表的 R 包。</p></li><li><p><a href="https://r-spatial.org//r/2022/04/12/sftime-1.html">The sftime Package</a>：处理含有时间维度的空间矢量数据。</p></li><li><p><a href="https://mran.microsoft.com/snapshot/2017-12-11/web/packages/ggCompNet/vignettes/examples-from-paper.html">Network Visualization Examples with the ggplot2 Package</a>：使用 ggplot2 进行网络可视化的例子。</p></li><li><p><a href="https://github.com/coolbutuseless/facetious">facetious: Home to some alternate facetting for ggplot2</a></p></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220828154751.png" alt=""></p><ul><li><a href="https://github.com/coolbutuseless/ggsvg">ggsvg - Use SVG as points in ggplot</a>：把 svg 图片作为 ggplot2 绘图中的散点</li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220828155258.png" alt=""></p><ul><li><p><a href="https://www.programmingwithr.com/simple-easy-beginners-web-scraping-in-r-with-ralger/">Simple Easy Beginners Web Scraping in R with {ralger} · Programming with R</a>：使用 ralger 进行网络数据爬取。</p></li><li><p><a href="https://cran.r-project.org/web/packages/ggbraid/index.html">ggbraid: Braid Ribbons in ‘ggplot2’</a></p></li><li><p><a href="https://cran.r-project.org/web/packages/ztable/index.html">ztable: Zebra-Striped Tables in LaTeX and HTML Formats</a></p></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220903185610.png" alt=""></p><ul><li><p><a href="https://www.r-bloggers.com/2019/06/extracting-the-data-from-static-images-of-graphs-with-magick/">Extracting the Data from Static Images of Graphs with magick</a></p></li><li><p><a href="https://yjunechoe.github.io/ggtrace-rstudioconf2022/#/title-slide">Cracking open ggplot internals with {ggtrace}</a></p></li><li><p><a href="https://www.r-bloggers.com/2022/06/find-the-maximum-value-by-group-in-r/">Find the Maximum Value by Group in R</a></p></li><li><p><a href="https://www.garrickadenbuie.com/blog/process-profile-picture-magick/">Process Profile Pictures with magick</a></p></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220903190355.png" alt=""></p><ul><li><p><a href="https://github.com/eliocamp/ggdatasaver">ggdatasaver: Automatically save data associated with a ‘ggplot2’ plot</a></p></li><li><p><a href="https://github.com/ikashnitsky/compare-pop-eu-us">compare-pop-eu-us: Compare population age structures of Europe NUTS-3 regions and the US counties using ternary colour-coding</a></p></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220903190659.png" alt=""></p><ul><li><a href="https://github.com/kevinsblake/NatParksPalettes">NatParksPalettes: Color palette package inspired by National Parks</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220903193415.png" alt=""></p><ul><li><p><a href="https://github.com/yutannihilation/string2path/">string2path: An experimental R package to convert string to path</a></p></li><li><p><a href="https://github.com/mdhall272/ggarchery">ggarchery: Flexible segment geoms with arrows for ggplot2</a></p></li></ul><h2 id="效率工具"><a href="#效率工具" class="headerlink" title="效率工具"></a>效率工具</h2><ul><li><a href="https://blog.luckly-mjw.cn/tool-show/m3u8-downloader/index.html">m3u8 视频在线提取工具</a>：可以自动根据 m3u8 文件链接下载视频文件。</li></ul><h2 id="Stata"><a href="#Stata" class="headerlink" title="Stata"></a>Stata</h2><ul><li><a href="https://gitee.com/tidyfriday/30DayMapChallenge2021">30DayMapChallenge2021</a>：使用 Stata 绘制的一些精美图表</li></ul><h2 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h2><ul><li><a href="https://github.com/Buernia/Tiejili">铁蒺藜体 Tiejili</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220828154542.png" alt=""></p><ul><li><a href="https://github.com/Buernia/Zhudou-Sans">煮豆黑体 Zhudou Sans</a></li></ul><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220828155659.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;电脑里面收藏夹里面收藏了很多网页，但是经常懒得翻看，而且难以检索，所以整理下都放到这里。&lt;/p&gt;
    
    </summary>
    
    
      <category term="收藏夹" scheme="https://tidyfriday.cn/categories/%E6%94%B6%E8%97%8F%E5%A4%B9/"/>
    
    
      <category term="Favorites" scheme="https://tidyfriday.cn/tags/Favorites/"/>
    
  </entry>
  
  <entry>
    <title>Stata 和 R 语言绘图中如何快速的使用调色板？</title>
    <link href="https://tidyfriday.cn/posts/18040/"/>
    <id>https://tidyfriday.cn/posts/18040/</id>
    <published>2022-08-27T12:29:00.000Z</published>
    <updated>2022-08-25T23:58:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>今天给大家推荐一个我每次绘图都在使用的调色应用！</p><blockquote><p><a href="https://tidyfriday.cn/colors/">https://tidyfriday.cn/colors/</a></p></blockquote><p>建议加入到电脑的收藏夹里面！</p><p>这个应用是根据 ColorBrewer 网站修改之后部署到我的服务器上的，特别适合 R 语言和 Stata 用户使用，另外还增加了不少颜色选择，使用起来非常方便。</p><span id="more"></span><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826074817.png" alt=""></p><h2 id="颜色数量的选择"><a href="#颜色数量的选择" class="headerlink" title="颜色数量的选择"></a>颜色数量的选择</h2><p>在左上角有个 Number of data classes，可以下拉选择所需要的颜色数量，不同的调色板最大可选择的颜色数量可能是不同的：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826074944.png" alt=""></p><p>只有少数调色板可以选择 16、34、51 种颜色，例如 scico1 和 scico2 系列的。</p><h2 id="调色板类别的选择"><a href="#调色板类别的选择" class="headerlink" title="调色板类别的选择"></a>调色板类别的选择</h2><p>比起 ColorBrewer，我增加了很多调色板：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075009.png" alt=""></p><p>其中只有第一行的 sequential、diverging 和 qualitative 三个是 ColorBrewer 的调色板，其他的都是我增加的，其中 ggsci 和 scico 两个是我最常用的，是两个 R 包的名字，例如 scico 包的调色板有这些：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">scico<span class="operator">::</span>scico_palette_show<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075047.png" alt=""></p><p>使用这个网页应用可以快速预览这些调色板的配色效果。例如之前的夜间灯光地图使用的就是 lajolla 调色板：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075106.png" alt=""></p><p>平台上这个色系的预览效果：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075124.png" alt=""></p><h2 id="使用选定的色系"><a href="#使用选定的色系" class="headerlink" title="使用选定的色系"></a>使用选定的色系</h2><p>这个应用特别针对 Stata 和 R 语言的用户进行了设计。例如对于 Stata 用户，经常需要一系列的 RGB 颜色，可以这样设置：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075157.png" alt=""></p><blockquote><p>点击 RStata 就可以展开这个窗口了。</p></blockquote><p>Stata 通常使用 RGB 颜色，所以这里需要选择 RGB，然后点击 RStata 拉出结果窗口就可以复制这些颜色值了。</p><p>例如在数据分享 <a href="https://rstata.duanshu.com/#/brief/course/14509f96e1f1459a824610d5e9c65f18">中债国债到期收益率期限结构 （截止 2021 年 9 月 20 日）</a> 数据中有这么一幅图：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075241.png" alt=""></p><p>这幅图需要很多颜色来表示不同的线条，就可以使用这个网页应用进行颜色选择，例如我们选择 tidyquant 里面的 10-class Light 调色板：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075256.png" alt=""></p><p>这 10 种颜色的值分别是：”44 62 80” “227 26 28” “24 188 156” “204 190 147” “166 206 227” “31 120 180” “178 223 138” “251 154 153” “253 191 111” “255 127 0”，在 Stata 中可以这样使用：</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="string">&quot;中债国债到期收益率数据(截止2021年9月20日).dta&quot;</span>, <span class="keyword">clear</span> </span><br><span class="line"><span class="keyword">line</span> rate1m rate3m rate6m rate1y rate2y <span class="comment">///</span></span><br><span class="line">rate3y rate5y rate7y rate10y rate20y date, <span class="comment">///</span></span><br><span class="line">xlabel(#6, ang(20)) xti(<span class="string">&quot;日期&quot;</span>) yti(<span class="string">&quot;国债收益率&quot;</span>) <span class="comment">///</span></span><br><span class="line">leg(<span class="keyword">order</span>(1 <span class="string">&quot;1 月期&quot;</span> <span class="comment">///</span></span><br><span class="line">2 <span class="string">&quot;3 月期&quot;</span> <span class="comment">///</span></span><br><span class="line">3 <span class="string">&quot;6 月期&quot;</span> <span class="comment">///</span></span><br><span class="line">4 <span class="string">&quot;1 年期&quot;</span> <span class="comment">///</span></span><br><span class="line">5 <span class="string">&quot;2 年期&quot;</span> <span class="comment">///</span></span><br><span class="line">6 <span class="string">&quot;3 年期&quot;</span> <span class="comment">///</span></span><br><span class="line">7 <span class="string">&quot;5 年期&quot;</span> <span class="comment">///</span></span><br><span class="line">8 <span class="string">&quot;7 年期&quot;</span> <span class="comment">///</span></span><br><span class="line">9 <span class="string">&quot;10 年期&quot;</span> <span class="comment">///</span></span><br><span class="line">10 <span class="string">&quot;20 年期&quot;</span>) pos(1) ring(0) col(3)) <span class="comment">///</span></span><br><span class="line">lc(<span class="string">&quot;44 62 80&quot;</span> <span class="string">&quot;227 26 28&quot;</span> <span class="string">&quot;24 188 156&quot;</span> <span class="string">&quot;204 190 147&quot;</span> <span class="string">&quot;166 206 227&quot;</span> <span class="string">&quot;31 120 180&quot;</span> <span class="string">&quot;178 223 138&quot;</span> <span class="string">&quot;251 154 153&quot;</span> <span class="string">&quot;253 191 111&quot;</span> <span class="string">&quot;255 127 0&quot;</span>) lp(solid ...) <span class="comment">///</span></span><br><span class="line">ti(<span class="string">&quot;中债国债到期收益率期限结构&quot;</span>) <span class="comment">///</span></span><br><span class="line">subti(<span class="string">&quot;爬取 &amp; 整理：微信公众号 RStata&quot;</span>) <span class="comment">///</span></span><br><span class="line">caption(<span class="string">&quot;数据来源：中国债券信息网&lt;https://yield.chinabond.com.cn/cbweb-mn&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">gr</span> export <span class="string">&quot;中债国债到期收益率期限结构.png&quot;</span>, <span class="keyword">replace</span> width(1200) </span><br></pre></td></tr></table></figure><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075332.png" alt=""></p><p>也就是直接把 10 中颜色的 RGB 值拷贝到 lc() 选项里面就可以了。</p><p>如果你是 R 语言用户，建议使用 HEX 颜色值，这个之后把 RGB 改成 HEX 即可：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075351.png" alt=""></p><p>R 语言的绘图代码如下：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 字体设置</span></span><br><span class="line">library<span class="punctuation">(</span>showtext<span class="punctuation">)</span> </span><br><span class="line">showtext_auto<span class="punctuation">(</span>enable <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> </span><br><span class="line">font_add<span class="punctuation">(</span><span class="string">&quot;songti&quot;</span><span class="punctuation">,</span> regular <span class="operator">=</span> <span class="string">&quot;song.otf&quot;</span><span class="punctuation">)</span></span><br><span class="line">cnfont <span class="operator">&lt;-</span> <span class="string">&quot;songti&quot;</span> </span><br><span class="line">library<span class="punctuation">(</span>hrbrthemes<span class="punctuation">)</span></span><br><span class="line">theme_set<span class="punctuation">(</span> </span><br><span class="line">  theme_ipsum<span class="punctuation">(</span>base_family <span class="operator">=</span> cnfont<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">    theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          axis.text.y <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          axis.line.x <span class="operator">=</span> element_line<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          axis.line.y <span class="operator">=</span> element_line<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          panel.grid.minor <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          axis.ticks.length <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">1.5</span><span class="punctuation">,</span> <span class="string">&quot;mm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          axis.ticks.x <span class="operator">=</span> element_line<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          axis.ticks.y <span class="operator">=</span> element_line<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>linetype <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          plot.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">haven<span class="operator">::</span>read_dta<span class="punctuation">(</span><span class="string">&quot;中债国债到期收益率数据(截止2021年9月20日).dta&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> df </span><br><span class="line"></span><br><span class="line">df <span class="operator">%&gt;%</span> </span><br><span class="line">  select<span class="punctuation">(</span>date<span class="punctuation">,</span> rate1m<span class="punctuation">,</span> rate3m<span class="punctuation">,</span> rate6m<span class="punctuation">,</span> </span><br><span class="line">         rate1y<span class="punctuation">,</span> rate2y<span class="punctuation">,</span> rate3y<span class="punctuation">,</span> </span><br><span class="line">         rate5y<span class="punctuation">,</span> rate7y<span class="punctuation">,</span> rate10y<span class="punctuation">,</span> </span><br><span class="line">         rate20y<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  gather<span class="punctuation">(</span><span class="operator">-</span>date<span class="punctuation">,</span> key <span class="operator">=</span> <span class="string">&quot;key&quot;</span><span class="punctuation">,</span> value <span class="operator">=</span> <span class="string">&quot;value&quot;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>key <span class="operator">=</span> factor<span class="punctuation">(</span>key<span class="punctuation">,</span> </span><br><span class="line">                      levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;rate1m&quot;</span><span class="punctuation">,</span> <span class="string">&quot;rate3m&quot;</span><span class="punctuation">,</span> <span class="string">&quot;rate6m&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                                 <span class="string">&quot;rate1y&quot;</span><span class="punctuation">,</span> <span class="string">&quot;rate2y&quot;</span><span class="punctuation">,</span> <span class="string">&quot;rate3y&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                                 <span class="string">&quot;rate5y&quot;</span><span class="punctuation">,</span> <span class="string">&quot;rate7y&quot;</span><span class="punctuation">,</span> <span class="string">&quot;rate10y&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                                 <span class="string">&quot;rate20y&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                      labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;1 月期&quot;</span><span class="punctuation">,</span> <span class="string">&quot;3 月期&quot;</span><span class="punctuation">,</span> <span class="string">&quot;6 月期&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                 <span class="string">&quot;1 年期&quot;</span><span class="punctuation">,</span> <span class="string">&quot;2 年期&quot;</span><span class="punctuation">,</span> <span class="string">&quot;3 年期&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                 <span class="string">&quot;5 年期&quot;</span><span class="punctuation">,</span> <span class="string">&quot;7 年期&quot;</span><span class="punctuation">,</span> <span class="string">&quot;10 年期&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                 <span class="string">&quot;20 年期&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> value<span class="punctuation">,</span> color <span class="operator">=</span> key<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_line<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#2c3e50&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#e31a1c&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#18bc9c&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#ccbe93&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#a6cee3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#1f78b4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#b2df8a&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#fb9a99&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#fdbf6f&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#ff7f00&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.8</span><span class="punctuation">,</span> <span class="number">0.8</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  guides<span class="punctuation">(</span>color <span class="operator">=</span> guide_legend<span class="punctuation">(</span>nrow <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> byrow <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  scale_x_date<span class="punctuation">(</span>labels <span class="operator">=</span> scales<span class="operator">::</span>date_format<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">               breaks <span class="operator">=</span> scales<span class="operator">::</span>date_breaks<span class="punctuation">(</span>width <span class="operator">=</span> <span class="string">&quot;2 years&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;中债国债到期收益率期限结构&quot;</span><span class="punctuation">,</span></span><br><span class="line">       subtitle <span class="operator">=</span> <span class="string">&quot;爬取 &amp; 整理：微信公众号 RStata&quot;</span><span class="punctuation">,</span></span><br><span class="line">       caption <span class="operator">=</span> <span class="string">&quot;数据来源：中国债券信息网&lt;https://yield.chinabond.com.cn/cbweb-mn&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">       color <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&quot;日期&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;国债收益率&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;中债国债到期收益率期限结构2.png&quot;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> device <span class="operator">=</span> png<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075428.png" alt=""></p><p>也就是直接把 HEX 颜色值直接复制粘贴到 <code>scale_color_manual()</code> 里面即可！是不是也很方便。</p><h2 id="在绘制地图中使用"><a href="#在绘制地图中使用" class="headerlink" title="在绘制地图中使用"></a>在绘制地图中使用</h2><p>例如在 Stata 绘制地图中使用，下面的案例展示了如何使用 Stata 绘图展示 2019 年中国各省市地区生产总值：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075456.png" alt=""></p><p>这里使用的是 ggsci2 中的 10-class teal_material：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075510.png" alt=""></p><p>完整的 Stata 绘图代码如下：</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">import delimited using <span class="string">&quot;2020年中国各省市地区生产总值.csv&quot;</span>, <span class="keyword">clear</span> encoding(utf8)</span><br><span class="line"><span class="keyword">gen</span> prov = <span class="built_in">substr</span>(省份, 1, 6)</span><br><span class="line"><span class="keyword">save</span> 2020年中国各省市地区生产总值, <span class="keyword">replace</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> chinaprov2019mini_db.dta, <span class="keyword">clear</span> </span><br><span class="line"><span class="keyword">gen</span> prov = <span class="built_in">substr</span>(省, 1, 6)</span><br><span class="line"><span class="keyword">merge</span> 1:1 prov using 2020年中国各省市地区生产总值</span><br><span class="line"><span class="keyword">replace</span> 地区生产总值 = -1 <span class="keyword">if</span> <span class="built_in">missing</span>(地区生产总值)</span><br><span class="line">grmap 地区生产总值 using chinaprov2019mini_coord.dta, <span class="comment">///</span></span><br><span class="line">id(ID) osize(vvthin ...) ocolor(white ...) <span class="comment">///</span></span><br><span class="line">clmethod(custom) clbreaks(-1 0 20000 40000 60000 80000 120000) <span class="comment">///</span></span><br><span class="line">fcolor(gray <span class="string">&quot;224 242 241&quot;</span> <span class="string">&quot;178 223 219&quot;</span> <span class="string">&quot;128 203 196&quot;</span> <span class="string">&quot;77 182 172&quot;</span> <span class="string">&quot;38 166 154&quot;</span>) <span class="comment">///</span></span><br><span class="line">leg(<span class="keyword">order</span>(2 <span class="string">&quot;无数据&quot;</span> 3 <span class="string">&quot;&lt; 2 万亿元&quot;</span> 4 <span class="string">&quot;2～4 万亿元&quot;</span> 5 <span class="string">&quot;4～6 万亿元&quot;</span> 6 <span class="string">&quot;6～8 万亿元&quot;</span> 7 <span class="string">&quot;&gt; 8 万亿元&quot;</span>)) <span class="comment">///</span></span><br><span class="line">graphr(margin(medium)) <span class="comment">///</span></span><br><span class="line"><span class="keyword">line</span>(data(chinaprov2019mini_line_coord3.dta) <span class="comment">///</span></span><br><span class="line"><span class="comment">/// 去除秦岭淮河线(4)、胡焕庸线(7)</span></span><br><span class="line">select(<span class="keyword">keep</span> <span class="keyword">if</span> <span class="built_in">inlist</span>(group, 1, 2, 3, 5, 6)) <span class="comment">///</span></span><br><span class="line"><span class="keyword">by</span>(group) size(vvthin *1 *0.5 *0.5 *0.5) <span class="comment">///</span></span><br><span class="line">pattern(solid ...) <span class="comment">///</span></span><br><span class="line">color(white <span class="comment">/// 省界颜色</span></span><br><span class="line">  black <span class="comment">/// 国界线颜色</span></span><br><span class="line">  <span class="string">&quot;0 85 170&quot;</span> <span class="comment">/// 海岸线颜色</span></span><br><span class="line">  black <span class="comment">/// 小地图框格颜色</span></span><br><span class="line">  black <span class="comment">/// 比例尺和指北针颜色</span></span><br><span class="line">  )) <span class="comment">///</span></span><br><span class="line">polygon(data(polygon3) fcolor(black) <span class="comment">///</span></span><br><span class="line">osize(vvthin)) <span class="comment">///</span></span><br><span class="line"><span class="keyword">label</span>(data(chinaprov2019mini_label3) x(X) <span class="built_in">y</span>(Y) <span class="keyword">label</span>(cname) <span class="built_in">length</span>(20) size(*0.8)) <span class="comment">///</span></span><br><span class="line">ti(<span class="string">&quot;2019 年中国各省市地区生产总值&quot;</span>) <span class="comment">///</span></span><br><span class="line">subti(<span class="string">&quot;绘制：微信公众号 RStata&quot;</span>) <span class="comment">///</span></span><br><span class="line">caption(<span class="string">&quot;数据来源：各地统计局&quot;</span>, size(*0.8))</span><br><span class="line"><span class="keyword">gr</span> export pic3.png, <span class="keyword">replace</span> width(1200)</span><br></pre></td></tr></table></figure><p>上面代码中的 fcolor() 就是使用这个网页应用生成的。</p><p>R 语言绘制地图的案例上面就有了：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826075106.png" alt=""></p><p>这个图的绘制方法可以学习课程：「<a href="https://rstata.duanshu.com/#/course/a430bddc4100426fb4dfeeec38c994d9">使用 R 语言绘制中国夜间灯光地图</a>」</p><h2 id="下载附件"><a href="#下载附件" class="headerlink" title="下载附件"></a>下载附件</h2><ul><li><a href="https://rstata.duanshu.com/#/brief/course/e0e1626ab8294910878b5095c8e02f37">Stata 和 R 语言绘图中如何快速的使用调色板？</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天给大家推荐一个我每次绘图都在使用的调色应用！&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://tidyfriday.cn/colors/&quot;&gt;https://tidyfriday.cn/colors/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;建议加入到电脑的收藏夹里面！&lt;/p&gt;
&lt;p&gt;这个应用是根据 ColorBrewer 网站修改之后部署到我的服务器上的，特别适合 R 语言和 Stata 用户使用，另外还增加了不少颜色选择，使用起来非常方便。&lt;/p&gt;
    
    </summary>
    
    
      <category term="问答" scheme="https://tidyfriday.cn/categories/%E9%97%AE%E7%AD%94/"/>
    
    
      <category term="Data" scheme="https://tidyfriday.cn/tags/Data/"/>
    
  </entry>
  
  <entry>
    <title>专利数据匹配服务</title>
    <link href="https://tidyfriday.cn/posts/38703/"/>
    <id>https://tidyfriday.cn/posts/38703/</id>
    <published>2022-08-26T12:29:00.000Z</published>
    <updated>2022-09-03T10:44:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>专利申请量可以反应一家公司的创新能力，之前给大家分享过工企和专利的匹配结果，不过由于版权的原因，暂时还不打算把专利数据公开分享给大家，不过经常有小伙伴询问是否能帮忙匹配，最近尝试了下，感觉还是可行的，因此特推出专利数据匹配服务，收费如下：</p><span id="more"></span><p>RStata 标准数据服务之专利数据匹配服务来啦！<strong>就是您提供一些公司的名称，然后我们帮您使用公司名称从专利数据库里面匹配筛选专利，另外还可以进一步进行绿色专利筛选、专利知识宽度计算！</strong></p><p>专利申请量可以反映一家公司的创新能力，之前给大家分享过工企和专利的匹配结果，不过由于完整的专利数据库非常庞大，难以处理，所以暂时还不打算把专利数据公开分享，不过经常有小伙伴询问是否能帮忙匹配，最近尝试了下，感觉还是可行的，因此特推出专利数据匹配服务，收费如下：</p><ol><li>该服务仅面向 RStata 会员；</li><li>每 10 万个公司名称匹配收费 300 元，低于 10 万个公司名称也是 300 元（300 元起步）；</li><li>专利知识宽度计算：每 10 万个公司名称收费 100 元，低于 10 万个公司名称也是 100 元（100 元起步）；</li><li>绿色专利筛选：每 10 万个公司名称收费 100 元，低于 10 万个公司名称也是 100 元（100 元起步）；</li><li>这里的数量是指匹配使用的数量，而非匹配成功的数量；</li><li>时间范围限制在 1985～2017 年，之后年份的专利数据不够全，就不再提供匹配了。</li></ol><p>例如您有 20 万家公司想要匹配专利数据，就是 2 * 300 = 600 元，如果还需要计算专利知识宽度，需要再增加 2 * 100 = 200 元，合计 800 元。</p><p>注意：不使用模糊匹配，而是去除企业名称中无用的关键词进行精确匹配，例如“有限公司”、“有限责任公司”、“股份有限公司”这样的字眼。之所以这样做，大家可以学习这个课程了解：</p><ol><li><strong>Stata 中的中文模糊匹配——以 2014 年工企数据和境外投资名录数据匹配为例</strong>：<a href="https://rstata.duanshu.com/#/brief/course/d4fb816566244662ab6359fa848f1f1e">https://rstata.duanshu.com/#/brief/course/d4fb816566244662ab6359fa848f1f1e</a></li><li><strong>R 语言中的中文模糊匹配——以工企数据和境外投资名录数据匹配为例</strong>：R 语言中的中文模糊匹配——以工企数据和境外投资名录数据匹配为例</li></ol><p>另外平台上已有的专利相关数据有：</p><ol><li>工企专利匹配结果：<a href="https://rstata.duanshu.com/#/brief/course/6a7afa444a194b59830a648017bbbbff">https://rstata.duanshu.com/#/brief/course/6a7afa444a194b59830a648017bbbbff</a></li><li>工企绿色专利匹配结果：<a href="https://rstata.duanshu.com/#/brief/course/04f4aea3b97e42289e990e1ced0081bc">https://rstata.duanshu.com/#/brief/course/04f4aea3b97e42289e990e1ced0081bc</a></li><li>上市公司与专利匹配结果：<a href="https://rstata.duanshu.com/#/brief/course/b16959c334104e93b8e172a51e28a142">https://rstata.duanshu.com/#/brief/course/b16959c334104e93b8e172a51e28a142</a></li><li>瞪羚企业、独角兽和科技型初创企业数据与专利数据库匹配结果：<a href="https://rstata.duanshu.com/#/brief/course/b6e3783ad1534c5a97544fc457ffb54e">https://rstata.duanshu.com/#/brief/course/b6e3783ad1534c5a97544fc457ffb54e</a></li><li>工企专利知识宽度计算结果：<a href="https://rstata.duanshu.com/#/brief/course/86ed4bed3ea449a4b42d82125b64d154">https://rstata.duanshu.com/#/brief/course/86ed4bed3ea449a4b42d82125b64d154</a></li><li>工企 + 海关 + 专利：<a href="https://rstata.duanshu.com/#/brief/course/a0341db950fb406bae4c17367f282bb5">https://rstata.duanshu.com/#/brief/course/a0341db950fb406bae4c17367f282bb5</a></li><li>工企 + 污染 + 专利：<a href="https://rstata.duanshu.com/#/brief/course/809beadfffdf4bf3a6e434f914abb5d9">https://rstata.duanshu.com/#/brief/course/809beadfffdf4bf3a6e434f914abb5d9</a></li></ol><p>相关课程：</p><ol><li>使用 Stata 进行绿色专利的筛选：<a href="https://rstata.duanshu.com/#/brief/course/2fd6838527754c94a3f5ccb0e3ba7be1">https://rstata.duanshu.com/#/brief/course/2fd6838527754c94a3f5ccb0e3ba7be1</a></li><li>使用 R 语言爬取处理 WIPO 绿色专利分类数据：<a href="https://rstata.duanshu.com/#/brief/course/6edd7ed2f3284915b2c916ead3fbfd10">https://rstata.duanshu.com/#/brief/course/6edd7ed2f3284915b2c916ead3fbfd10</a></li><li>使用 Stata 编程计算企业专利知识宽度：<a href="https://rstata.duanshu.com/#/brief/course/7a0978798b6244779e13401ee68f3761">https://rstata.duanshu.com/#/brief/course/7a0978798b6244779e13401ee68f3761</a></li></ol><p>更多相关课程敬请期待～</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;专利申请量可以反应一家公司的创新能力，之前给大家分享过工企和专利的匹配结果，不过由于版权的原因，暂时还不打算把专利数据公开分享给大家，不过经常有小伙伴询问是否能帮忙匹配，最近尝试了下，感觉还是可行的，因此特推出专利数据匹配服务，收费如下：&lt;/p&gt;
    
    </summary>
    
    
      <category term="数据、代码定制" scheme="https://tidyfriday.cn/categories/%E6%95%B0%E6%8D%AE%E3%80%81%E4%BB%A3%E7%A0%81%E5%AE%9A%E5%88%B6/"/>
    
    
      <category term="Stata" scheme="https://tidyfriday.cn/tags/Stata/"/>
    
  </entry>
  
  <entry>
    <title>中国各省市区县分年、分月、逐日日照时数面板数据</title>
    <link href="https://tidyfriday.cn/posts/34685/"/>
    <id>https://tidyfriday.cn/posts/34685/</id>
    <published>2022-08-26T07:29:00.000Z</published>
    <updated>2022-08-25T23:37:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>之前给大家分享过一份 1960～2020 年中国各省市区县的日照时数数据，很多其他公众号、经管之家的数据贩卖者也都迅速的搬运到他们那里了。很多小伙伴还使用了这份数据发布了论文，结果很理想。最近根据大家的反馈，对这份数据进行了重新处理，主要是进行了如下调整：</p><span id="more"></span><ol><li>之前的数据是使用 2019 年行政区划进行插值处理得到，这次更新的数据使用的是 2020 年的行政区划数据进行处理；</li><li>之前的数据使用的插值网格是覆盖中国的 500x500 网格，不够精细，这次处理使用的是 0.1˚x0.1˚ 分辨率的网格，也就是每个格点长宽都是 0.1˚（纬度/经度），更加精细；</li><li>之前的数据插值后直接分区域平均得到省市区县的数据，部分区县由于面积太小，没有包含任何格点导致数据缺失。此次重新处理则是先把插值得到的网格数据构建成栅格数据数据，然后再分区域汇总，不再有缺失问题了；</li><li>之前的城市和省份数据是通过平均区县的数据得到的，不够准确，这一次的数据中，省份和城市的数据也是直接从栅格数据分区域汇总得到的；</li><li>为了避免过度平滑的问题，进行插值的时候仅仅使用每个格点附近的 5 个站点数据；</li><li>考虑到过早年份的数据可能用处不大，为了节省处理时间，这次仅仅处理了 1980～2020 年的数据。</li></ol><p>简而言之，这次的数据是首先把气象站点的数据插值成 0.1˚x0.1˚ 分辨率的网格数据，然后把网格数据转换成栅格数据再分区域平均得到各省市区县的年度、月度和日度数据。</p><p>以 2020 年 6 月 1 日日照时数的处理为例，首先是该天所有气象站点的日照时数数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826072439.png" alt=""></p><p>使用 IDW 法插值成 0.1˚x0.1˚ 分辨率的网格数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826072611.png" alt=""></p><p>把插值得到的网格数据转换成栅格数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826072634.png" alt=""></p><p>栅格数据分区域汇总就可以得到省市区县的数据了，例如区县的：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826072656.png" alt=""></p><p>按照上面的处理思路循环处理 1980年1月1日～2020年12月31日的数据即可得到 1980～2020 年中国各省市区县分年、分月、逐日的日照时数数据了，为了方便大家的使用，我把数据保存成了 xslx 格式的：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826072714.png" alt=""></p><p>每份数据都包含各级行政区划代码，方便大家和其他数据集进行匹配，作为参考，下图展示了 2020 年中国各区县日照时数数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826072739.png" alt=""></p><p>2020 年 6 月 1 日各城市日日照时数数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826072757.png" alt=""></p><p>2020 年 6 月各省份日照时数：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826072818.png" alt=""></p><p>由于这次处理过程中生成了栅格数据，所以附件中也有每天的栅格数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826072634.png" alt=""></p><p>最后的这个图展示了 1980～2020 年中国各省市年日照时数的变化：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826072844.png" alt=""></p><p>从图上可以看到，符合东南少而西北多，从东南向西北增加的特点。百度百科上的介绍如下：</p><ol><li>秦岭淮河以北和青藏、云南高原东坡以西的高原地区年平均日照时数都在2200 小时以上。</li><li>青岛、兰州一线，即北纬 36°以北地区，除了东北的北部和东部以外，日照时数都在 2600 小时以上。</li><li>锡林浩特、呼和浩特、 银川、西宁、拉萨一线以西北的内陆地区，年平均日照时数普遍在 3000 小时以上，是中国日照最多的地区，其中局部地区甚至可以达到 3300～3500 小时以上。</li><li>淮河、秦岭以南，青藏和云南高原东坡以东的地区，年平均日照时数多在 2000 小时以下，是我国少日照地区。其中四川盆地、贵州大部分地区是少日照的中心地区，年平均日照时数不到 1400 小时。该中心地区中四川盆地西坡、川东南、黔西北、鄂西南交界地区年平均日照时数更在1200 小时以下，有些地方甚至不足1000 小时。</li><li>中国日照最少的台站就出现在四川盆地西部和滇东北地区。</li></ol><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>由于日照时数可能受到地形、植被、水文、人类活动等因素的影响，因此使用上文所说的方法计算得到的各区域均值可能与实际值有所偏差。</p><h2 id="处理方法"><a href="#处理方法" class="headerlink" title="处理方法"></a>处理方法</h2><p>之前的老版本数据有处理方法讲解：</p><p><a href="https://rstata.duanshu.com/#/brief/course/b808f5ecaf434905aaa853b1679ad5d9">气象数据是如何被整理好的——以平均降水量为例</a></p><p>新版数据的处理方法讲解课程敬请期待！</p><h2 id="下载数据"><a href="#下载数据" class="headerlink" title="下载数据"></a>下载数据</h2><ul><li><a href="https://rstata.duanshu.com/#/course/902eed7983b44313b490649e574ce4fd">中国各省、各市、各区县分年、分月、逐日日照时数面板数据（1980 ～ 2020 年）</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前给大家分享过一份 1960～2020 年中国各省市区县的日照时数数据，很多其他公众号、经管之家的数据贩卖者也都迅速的搬运到他们那里了。很多小伙伴还使用了这份数据发布了论文，结果很理想。最近根据大家的反馈，对这份数据进行了重新处理，主要是进行了如下调整：&lt;/p&gt;
    
    </summary>
    
    
      <category term="数据分享" scheme="https://tidyfriday.cn/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E4%BA%AB/"/>
    
    
      <category term="Data" scheme="https://tidyfriday.cn/tags/Data/"/>
    
  </entry>
  
  <entry>
    <title>中国各省市区县分年、分月、逐日降水量面板数据</title>
    <link href="https://tidyfriday.cn/posts/8866/"/>
    <id>https://tidyfriday.cn/posts/8866/</id>
    <published>2022-08-19T08:29:00.000Z</published>
    <updated>2022-08-25T23:46:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>之前给大家分享过一份 1951～2020 年中国各省市区县的降水量数据，很多其他公众号、经管之家的数据贩卖者也都迅速的搬运到他们那里了。很多小伙伴还使用了这份数据发布了论文，结果很理想。最近根据大家的反馈，对这份数据进行了重新处理，主要是进行了如下调整：</p><span id="more"></span><ol><li>之前的数据是使用 2019 年行政区划进行插值处理得到，这次更新的数据使用的是 2020 年的行政区划数据进行处理；</li><li>之前的数据使用的插值网格是覆盖中国的 500x500 网格，不够精细，这次处理使用的是 0.1˚x0.1˚ 分辨率的网格，也就是每个格点长宽都是 0.1˚（纬度/经度），更加精细；</li><li>之前的数据插值后直接分区域平均得到省市区县的数据，部分区县由于面积太小，没有包含任何格点导致数据缺失。此次重新处理则是先把插值得到的网格数据构建成栅格数据数据，然后再分区域汇总，不再有缺失问题了；</li><li>之前的城市和省份数据是通过平均区县的数据得到的，不够准确，这一次的数据中，省份和城市的数据也是直接从栅格数据分区域汇总得到的；</li><li>为了避免过度平滑的问题，进行插值的时候仅仅使用每个格点附近的 5 个站点数据；</li><li>考虑到过早年份的数据可能用处不大，为了节省处理时间，这次仅仅处理了 1980～2020 年的数据。</li><li>简而言之，这次的数据是首先把气象站点的数据插值成 0.1˚x0.1˚ 分辨率的网格数据，然后把网格数据转换成栅格数据再分区域平均得到各省市区县的年度、月度和日度数据。</li></ol><p>以 2020 年 6 月 1 日降水量的处理为例，首先是该天所有气象站点的降水量数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826073900.png" alt=""></p><p>使用 IDW 法插值成 0.1˚x0.1˚ 分辨率的网格数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826073918.png" alt=""></p><p>把插值得到的网格数据转换成栅格数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826073947.png" alt=""></p><p>栅格数据分区域汇总就可以得到省市区县的数据了，例如区县的：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826074003.png" alt=""></p><p>按照上面的处理思路循环处理 1980年1月1日～2020年12月31日的数据即可得到 1980～2020 年中国各省市区县分年、分月、逐日的累计降水量数据了，为了方便大家的使用，我把数据保存成了 xslx 格式的：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826074018.png" alt=""></p><p>每份数据都包含各级行政区划代码，方便大家和其他数据集进行匹配，作为参考，下图展示了 2020 年中国各区县平均降水量数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826074033.png" alt=""></p><p>2020 年 6 月 1 日各城市平均降水量数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826074046.png" alt=""></p><p>2020 年 6 月各省份累计降水量：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826074100.png" alt=""></p><p>由于这次处理过程中生成了栅格数据，所以附件中也有每天的栅格数据：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826073947.png" alt=""></p><p>最后的这个图展示了 1980～2020 年中国各省市年累计降水量的变化：</p><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/20220826074122.png" alt=""></p><p>从图上可以看到，符合南方雨水多，北方雨水少的特点。</p><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>由于降水量可能受到地形、植被、水文、人类活动等因素的影响，因此使用上文所说的方法计算得到的各区域均值可能与实际值有所偏差。</p><h2 id="处理方法"><a href="#处理方法" class="headerlink" title="处理方法"></a>处理方法</h2><p>之前的老版本数据有处理方法讲解：</p><p><a href="https://rstata.duanshu.com/#/brief/course/b808f5ecaf434905aaa853b1679ad5d9">气象数据是如何被整理好的——以平均降水量为例</a></p><p>新版数据的处理方法最近会推出课程讲解，敬请期待！</p><h2 id="下载数据"><a href="#下载数据" class="headerlink" title="下载数据"></a>下载数据</h2><ul><li><a href="https://rstata.duanshu.com/#/course/e805da4d4ef2467bbe3b87b125a88ca4">中国各省、各市、各区县分年、分月、逐日降水量面板数据（1980 ～ 2020 年）</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前给大家分享过一份 1951～2020 年中国各省市区县的降水量数据，很多其他公众号、经管之家的数据贩卖者也都迅速的搬运到他们那里了。很多小伙伴还使用了这份数据发布了论文，结果很理想。最近根据大家的反馈，对这份数据进行了重新处理，主要是进行了如下调整：&lt;/p&gt;
    
    </summary>
    
    
      <category term="数据分享" scheme="https://tidyfriday.cn/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E4%BA%AB/"/>
    
    
      <category term="Data" scheme="https://tidyfriday.cn/tags/Data/"/>
    
  </entry>
  
  <entry>
    <title>R 语言绘图中如何添加特殊符号文本？</title>
    <link href="https://tidyfriday.cn/posts/17200/"/>
    <id>https://tidyfriday.cn/posts/17200/</id>
    <published>2021-12-07T12:29:00.000Z</published>
    <updated>2022-08-25T21:33:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>今天有个培训班的小伙伴问了一个这样的问题：</p><p>老师，分面facet的时候，想把每个小图的标题带个特殊符号该怎么操作呢。举个例子，原来分面出来的标题是1/2/3现在想改成1℃/2℃/3℃</p><p>解决方法有很多，这里提供一种。</p><span id="more"></span><p>首先我们找个绘制分面图的案例：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">iris <span class="operator">%&gt;%</span> </span><br><span class="line">  as_tibble<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#&gt; # A tibble: 150 x 5</span></span><br><span class="line"><span class="comment">#&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span><br><span class="line"><span class="comment">#&gt;           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span><br><span class="line"><span class="comment">#&gt;  1          5.1         3.5          1.4         0.2 setosa </span></span><br><span class="line"><span class="comment">#&gt;  2          4.9         3            1.4         0.2 setosa </span></span><br><span class="line"><span class="comment">#&gt;  3          4.7         3.2          1.3         0.2 setosa </span></span><br><span class="line"><span class="comment">#&gt;  4          4.6         3.1          1.5         0.2 setosa </span></span><br><span class="line"><span class="comment">#&gt;  5          5           3.6          1.4         0.2 setosa </span></span><br><span class="line"><span class="comment">#&gt;  6          5.4         3.9          1.7         0.4 setosa </span></span><br><span class="line"><span class="comment">#&gt;  7          4.6         3.4          1.4         0.3 setosa </span></span><br><span class="line"><span class="comment">#&gt;  8          5           3.4          1.5         0.2 setosa </span></span><br><span class="line"><span class="comment">#&gt;  9          4.4         2.9          1.4         0.2 setosa </span></span><br><span class="line"><span class="comment">#&gt; 10          4.9         3.1          1.5         0.1 setosa </span></span><br><span class="line"><span class="comment">#&gt; # … with 140 more rows</span></span><br><span class="line"></span><br><span class="line">iris <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>Sepal.Length<span class="punctuation">,</span> Sepal.Width<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>Species<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2021-12-07%20%E4%B8%8A%E5%8D%8811.19.45_20211207111947.png" alt=""></p><p>为了演示如何在小图的标题上添加摄氏度符号，我们把 Species 变量替换下：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">unique<span class="punctuation">(</span>iris<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#&gt; [1] setosa     versicolor virginica </span></span><br><span class="line"><span class="comment">#&gt; Levels: setosa versicolor virginica</span></span><br><span class="line"></span><br><span class="line">iris <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>Species <span class="operator">=</span> case_when<span class="punctuation">(</span></span><br><span class="line">    Species <span class="operator">==</span> <span class="string">&quot;setosa&quot;</span> <span class="operator">~</span> <span class="string">&quot;1&amp;#176;C&quot;</span><span class="punctuation">,</span></span><br><span class="line">    Species <span class="operator">==</span> <span class="string">&quot;versicolor&quot;</span> <span class="operator">~</span> <span class="string">&quot;2&amp;#176;C&quot;</span><span class="punctuation">,</span></span><br><span class="line">    Species <span class="operator">==</span> <span class="string">&quot;virginica&quot;</span> <span class="operator">~</span> <span class="string">&quot;3&amp;#176;C&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> iris2</span><br></pre></td></tr></table></figure><p>这里的 <code>&amp;#176;</code> 在 HTML 里面表示摄氏度的小圆圈，然后我们可以使用 ggtext 包的 element_textbox() 元素：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">iris2 <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>Sepal.Length<span class="punctuation">,</span> Sepal.Width<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>Species<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme<span class="punctuation">(</span>strip.text <span class="operator">=</span> ggtext<span class="operator">::</span>element_textbox<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/%E6%88%AA%E5%B1%8F2021-12-07%20%E4%B8%8A%E5%8D%8811.23.28_20211207112331.png" alt=""></p><p>再例如：</p><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">iris2 <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>Sepal.Length<span class="punctuation">,</span> Sepal.Width<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>Species<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;&amp;omicron;&amp;para;&amp;sect;&amp;times;&amp;frac14;&amp;pi;&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme<span class="punctuation">(</span>strip.text <span class="operator">=</span> ggtext<span class="operator">::</span>element_textbox<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        plot.title <span class="operator">=</span> ggtext<span class="operator">::</span>element_textbox<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://mdniceczx.oss-cn-beijing.aliyuncs.com/image_20211207113107.png" alt=""></p><p>下面是一些的 HTML 特殊符号的表示方法：</p><table><thead><tr><th align="center">符号</th><th align="center">说明</th><th align="center">对应编码(使用时去掉&amp;后的空格)</th><th align="center">英文读法</th></tr></thead><tbody><tr><td align="center">&amp;</td><td align="center">AND 符号</td><td align="center">&amp; amp;</td><td align="center">ampersand</td></tr><tr><td align="center">&lt;</td><td align="center">小于</td><td align="center">&amp; lt;</td><td align="center">little</td></tr><tr><td align="center">·&gt;</td><td align="center">大于</td><td align="center">&amp; gt;</td><td align="center">great</td></tr><tr><td align="center"><code></code></td><td align="center">不断行的空白格</td><td align="center">&amp; nbsp;</td><td align="center">number space</td></tr><tr><td align="center"><code></code></td><td align="center">半方大的空白</td><td align="center">&amp; ensp;</td><td align="center"></td></tr><tr><td align="center"><code></code></td><td align="center">全方大的空白</td><td align="center">&amp; emsp;</td><td align="center"></td></tr><tr><td align="center">¿</td><td align="center">倒问号</td><td align="center">&amp; iquest;</td><td align="center">inverted question</td></tr><tr><td align="center">?</td><td align="center">问号</td><td align="center">&amp; quest;</td><td align="center">question</td></tr><tr><td align="center">«</td><td align="center">左书名号</td><td align="center">&amp; laquo;</td><td align="center">left angle quote</td></tr><tr><td align="center">»</td><td align="center">右书名号</td><td align="center">&amp; raquo;</td><td align="center">right angle quote</td></tr><tr><td align="center">“</td><td align="center">引号</td><td align="center">&amp; quot;</td><td align="center">quote</td></tr><tr><td align="center">‘</td><td align="center">左单引号</td><td align="center">&amp; lsquo;</td><td align="center">left single quote</td></tr><tr><td align="center">’</td><td align="center">右单引号</td><td align="center">&amp; rsquo:</td><td align="center">right single quote</td></tr><tr><td align="center">“</td><td align="center">左双引号</td><td align="center">&amp; ldquo:</td><td align="center">left double quote</td></tr><tr><td align="center">”</td><td align="center">右双引号</td><td align="center">&amp; rdquo:</td><td align="center">right double quote</td></tr><tr><td align="center">¶</td><td align="center">段落符号</td><td align="center">&amp; para;</td><td align="center">paragraph</td></tr><tr><td align="center">§</td><td align="center">章节符</td><td align="center">&amp; sect;</td><td align="center">section</td></tr><tr><td align="center">×</td><td align="center">乘号</td><td align="center">&amp; times;</td><td align="center">times</td></tr><tr><td align="center">÷</td><td align="center">除号</td><td align="center">&amp; divide;</td><td align="center">divide</td></tr><tr><td align="center">±</td><td align="center">加减号</td><td align="center">&amp; plusmn;</td><td align="center">plus minus</td></tr><tr><td align="center">ƒ</td><td align="center">function</td><td align="center">&amp; fnof;</td><td align="center"></td></tr><tr><td align="center">√</td><td align="center">根号</td><td align="center">&amp; radic;</td><td align="center">radic</td></tr><tr><td align="center">∞</td><td align="center">无穷大</td><td align="center">&amp; infin;</td><td align="center">infinite</td></tr><tr><td align="center">°</td><td align="center">度</td><td align="center">&amp; deg;</td><td align="center">degree</td></tr><tr><td align="center">≠</td><td align="center">不等号</td><td align="center">&amp; ne;</td><td align="center">ne</td></tr><tr><td align="center">≡</td><td align="center">恒等于</td><td align="center">&amp; equiv;</td><td align="center">equivalent</td></tr><tr><td align="center">≤</td><td align="center">小于等于</td><td align="center">&amp; le;</td><td align="center">less than or equal to</td></tr><tr><td align="center">≥</td><td align="center">大于等于</td><td align="center">&amp; ge;</td><td align="center">great than or equal to</td></tr><tr><td align="center">⊥</td><td align="center">垂直符号</td><td align="center">&amp; perp;</td><td align="center">perpendicular</td></tr><tr><td align="center">←</td><td align="center">左箭头</td><td align="center">&amp; larr;</td><td align="center">left arrow</td></tr><tr><td align="center">→</td><td align="center">右箭头</td><td align="center">&amp; rarr;</td><td align="center">right arrow</td></tr><tr><td align="center">↑</td><td align="center">上箭头</td><td align="center">&amp; uarr;</td><td align="center">up arrow</td></tr><tr><td align="center">↓</td><td align="center">下箭头</td><td align="center">&amp; darr;</td><td align="center">down arrow</td></tr><tr><td align="center">↔</td><td align="center">水平箭头</td><td align="center">&amp; harr;</td><td align="center">horizontal arrow</td></tr><tr><td align="center">↕</td><td align="center">竖直箭头</td><td align="center">&amp; varr;</td><td align="center">vertical arrow</td></tr><tr><td align="center">⇐</td><td align="center">双线左箭头</td><td align="center">&amp; lArr;</td><td align="center">left arrow</td></tr><tr><td align="center">⇒</td><td align="center">双线右箭头</td><td align="center">&amp; rArr;</td><td align="center">right arrow</td></tr><tr><td align="center">⇑</td><td align="center">双线上箭头</td><td align="center">&amp; uArr;</td><td align="center">up arrow</td></tr><tr><td align="center">⇓</td><td align="center">双线上箭头</td><td align="center">&amp; dArr;</td><td align="center">down arrow</td></tr><tr><td align="center">⇔</td><td align="center">双线水平双箭头</td><td align="center">&amp; hArr;</td><td align="center">horizontal arrow</td></tr><tr><td align="center">⇕</td><td align="center">双线竖直箭头</td><td align="center">&amp; vArr;</td><td align="center">vertical arrow</td></tr><tr><td align="center">♠</td><td align="center">黑桃</td><td align="center">&amp; spades;    spades</td><td align="center"></td></tr><tr><td align="center">♥</td><td align="center">红桃</td><td align="center">&amp; hearts;</td><td align="center">hearts</td></tr><tr><td align="center">♣</td><td align="center">梅花</td><td align="center">&amp; clubs;</td><td align="center">club</td></tr><tr><td align="center">♦</td><td align="center">方块</td><td align="center">&amp; diams;</td><td align="center">diamonds</td></tr><tr><td align="center">©</td><td align="center">版权</td><td align="center">&amp; copy;</td><td align="center">copy right</td></tr><tr><td align="center">®</td><td align="center">注册商标</td><td align="center">&amp; reg;</td><td align="center">registration</td></tr><tr><td align="center">™</td><td align="center">商标</td><td align="center">&amp; trade;</td><td align="center">trade</td></tr><tr><td align="center">¥</td><td align="center">人民币</td><td align="center">&amp; yen;</td><td align="center"></td></tr><tr><td align="center">€</td><td align="center">欧元</td><td align="center">&amp; euro;</td><td align="center">euro</td></tr><tr><td align="center">¢</td><td align="center">美分</td><td align="center">&amp; cent;</td><td align="center">cent</td></tr><tr><td align="center">£</td><td align="center">英磅</td><td align="center">&amp; pound;</td><td align="center">pound</td></tr><tr><td align="center">⊕</td><td align="center"></td><td align="center">&amp; oplus;</td><td align="center"></td></tr><tr><td align="center">½</td><td align="center">二分之一</td><td align="center">&amp; frac12;</td><td align="center">fraction</td></tr><tr><td align="center">¼</td><td align="center">四分之一</td><td align="center">&amp; frac14;</td><td align="center">fraction</td></tr><tr><td align="center">‰</td><td align="center">千分符号</td><td align="center">&amp; permil;</td><td align="center">per mille</td></tr><tr><td align="center">∴</td><td align="center">所以</td><td align="center">&amp; there4;</td><td align="center">there fore</td></tr><tr><td align="center">π</td><td align="center">圆周率</td><td align="center">&amp; pi;</td><td align="center"></td></tr><tr><td align="center">¹</td><td align="center">商标 1</td><td align="center">&amp; sup1;</td><td align="center">super 1</td></tr><tr><td align="center">α</td><td align="center">alpha</td><td align="center">&amp; alpha;</td><td align="center">alpha</td></tr><tr><td align="center">β</td><td align="center">beta</td><td align="center">&amp; beta;</td><td align="center">beta</td></tr><tr><td align="center">γ</td><td align="center">gamma</td><td align="center">&amp; gamma;</td><td align="center">gamma</td></tr><tr><td align="center">δ</td><td align="center">delta</td><td align="center">&amp; delta;</td><td align="center">delta</td></tr><tr><td align="center">θ</td><td align="center">theta</td><td align="center">&amp; theta;</td><td align="center">theta</td></tr><tr><td align="center">λ</td><td align="center">lambda</td><td align="center">&amp; lambda;</td><td align="center">lambda</td></tr><tr><td align="center">σ</td><td align="center">sigma</td><td align="center">&amp; sigma;</td><td align="center">sigma</td></tr><tr><td align="center">τ</td><td align="center">tau</td><td align="center">&amp; tau;</td><td align="center">tau</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天有个培训班的小伙伴问了一个这样的问题：&lt;/p&gt;
&lt;p&gt;老师，分面facet的时候，想把每个小图的标题带个特殊符号该怎么操作呢。举个例子，原来分面出来的标题是1/2/3现在想改成1℃/2℃/3℃&lt;/p&gt;
&lt;p&gt;解决方法有很多，这里提供一种。&lt;/p&gt;
    
    </summary>
    
    
      <category term="问答" scheme="https://tidyfriday.cn/categories/%E9%97%AE%E7%AD%94/"/>
    
    
      <category term="R" scheme="https://tidyfriday.cn/tags/R/"/>
    
  </entry>
  
</feed>
